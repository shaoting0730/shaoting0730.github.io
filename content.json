{"meta":{"title":"å°‘åœ","subtitle":null,"description":"æ„¿å¤©å ‚æ²¡æœ‰bug","author":null,"url":"https://pheromone.github.io"},"pages":[{"title":"","date":"2019-03-26T10:51:22.217Z","updated":"2019-02-18T13:58:34.196Z","comments":true,"path":"README.html","permalink":"https://pheromone.github.io/README.html","excerpt":"","text":"ç°åœ¨çš„åšå®¢ æ—§åšå®¢"},{"title":"å…³äºæˆ‘","date":"2019-03-26T10:51:22.216Z","updated":"2018-07-09T05:39:44.230Z","comments":true,"path":"about/index.html","permalink":"https://pheromone.github.io/about/index.html","excerpt":"","text":""},{"title":"categories","date":"2019-03-26T10:51:22.217Z","updated":"2018-03-18T03:30:29.519Z","comments":true,"path":"categories/index.html","permalink":"https://pheromone.github.io/categories/index.html","excerpt":"","text":""},{"title":"search","date":"2018-04-07T08:31:05.000Z","updated":"2018-04-07T08:31:05.277Z","comments":true,"path":"search/index.html","permalink":"https://pheromone.github.io/search/index.html","excerpt":"","text":""},{"title":"ç•™è¨€æ¿","date":"2019-03-26T10:51:22.215Z","updated":"2018-07-09T05:40:53.460Z","comments":true,"path":"message/index.html","permalink":"https://pheromone.github.io/message/index.html","excerpt":"","text":""},{"title":"tags","date":"2019-03-26T10:51:22.216Z","updated":"2018-03-18T03:30:47.370Z","comments":true,"path":"tags/index.html","permalink":"https://pheromone.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"Flutter~iOSåŸç”Ÿå·¥ç¨‹ä¸­æ·»åŠ Flutteræ¨¡å—","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~iOSåŸç”Ÿå·¥ç¨‹ä¸­æ·»åŠ Flutteræ¨¡å—","date":"2019-05-28T16:00:00.000Z","updated":"2019-05-29T07:48:47.699Z","comments":true,"path":"2019/05/29/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~iOSåŸç”Ÿå·¥ç¨‹ä¸­æ·»åŠ Flutteræ¨¡å—/","link":"","permalink":"https://pheromone.github.io/2019/05/29/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~iOSåŸç”Ÿå·¥ç¨‹ä¸­æ·»åŠ Flutteræ¨¡å—/","excerpt":"ä»Šå¤©,å­¦ä¹ ä¸‹,å¦‚ä½•åœ¨iOSåŸç”Ÿå·¥ç¨‹ä¸­é›†æˆFlutteræ¨¡å—","text":"ä»Šå¤©,å­¦ä¹ ä¸‹,å¦‚ä½•åœ¨iOSåŸç”Ÿå·¥ç¨‹ä¸­é›†æˆFlutteræ¨¡å— ok,é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨Xcodeæ–°å»ºä¸€ä¸ªiOSåŸç”Ÿå·¥ç¨‹,å…ˆæ”¾ç€.ç„¶åé€šè¿‡flutter create -t module flutter_moduleæ–°å»ºä¸€ä¸ªflutterçš„æ¨¡å—,è¿™é‡Œåå­—éšæ„.ä»¥flutter_moduleä¸ºä¾‹. ç„¶ååœ¨iOSåŸç”Ÿå·¥ç¨‹ä¸­,ä½¿ç”¨podå¯¼å…¥flutter:é¦–å…ˆ,ç»ˆç«¯ä¸Šå…ˆé€šè¿‡pod initä¸ºåŸç”Ÿå·¥ç¨‹åˆ›å»ºPodfileæ–‡ä»¶.ç„¶ååœ¨è¯¥Podfileæ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹: 12 flutter_application_path = &apos;../flutter_module/&apos;eval(File.read(File.join(flutter_application_path, &apos;.ios&apos;, &apos;Flutter&apos;, &apos;podhelper.rb&apos;)), binding) æ³¨æ„è·¯å¾„æ­£ç¡®. ç»ˆç«¯ cdåˆ°iOSåŸç”Ÿé¡¹ç›®æ ¹ç›®å½•ä¸‹. æ‰§è¡Œpod install é€šè¿‡ç‚¹å‡»XXXX.xcworkspaceæ–‡ä»¶æ‰“å¼€Xcode.æ‰¾åˆ°â€TAGGETSâ€-&gt;â€Build Settingsâ€-&gt;â€Enable Bitcodeâ€é¦–å…ˆæŠŠé¡¹ç›®bitcodeå…³é—­. æ‰¾åˆ°â€TAGGETSâ€-&gt;â€Build Settingsâ€-&gt;â€Enable Phasesâ€.ç‚¹å‡»+å·,æ–°å»ºä¸€ä¸ªâ€New Run Script Phaseâ€.å…¶ä¸­åŠ å…¥: 12 &quot;$FLUTTER_ROOT/packages/flutter_tools/bin/xcode_backend.sh&quot; build&quot;$FLUTTER_ROOT/packages/flutter_tools/bin/xcode_backend.sh&quot; embed ç„¶å,æŠŠå®ƒç§»åŠ¨Target Dependenciedä¸‹é¢. ok.Xcode buildä¸‹,æ­£ç¡®æƒ…å†µä¸‹æ˜¯å·¥ç¨‹å¥½çš„.é›†æˆæ­¥éª¤å®Œæ¯•. ç„¶åæˆ‘ä»¬åœ¨ ViewController.mä¸­é€šè¿‡presentViewControllerçš„æ–¹å¼è·³è‡³flutteræ¨¡å—å³å¯.é¦–å…ˆ,å¼•å…¥12#import &lt;Flutter/Flutter.h&gt;#import &lt;FlutterPluginRegistrant/GeneratedPluginRegistrant.h&gt; å…¶ä¸­,å¯ä»¥ä¸ºflutteræ¨¡å—ä¼ ä¸ªå‚æ•°,é€šè¿‡setInitialRoute.è¯¥æ–‡ä»¶å®Œæ•´ä»£ç å¦‚ä¸‹:123456789101112131415161718192021222324252627282930313233343536373839404142//// ViewController.m// iOSAddFlutter//// Created by Shaoting Zhou on 2019/5/29.// Copyright Â© 2019 Shaoting Zhou. All rights reserved.//#import &quot;ViewController.h&quot;#import &lt;Flutter/Flutter.h&gt;#import &lt;FlutterPluginRegistrant/GeneratedPluginRegistrant.h&gt;@interface ViewController ()@end@implementation ViewController- (void)viewDidLoad &#123; [super viewDidLoad]; UIButton *button = [[UIButton alloc]init]; [button setTitle:@&quot;è·³è‡³Flutteræ¨¡å—&quot; forState:UIControlStateNormal]; button.backgroundColor=[UIColor redColor]; button.frame = CGRectMake(50, 50, 200, 100); [button setTitleColor:[UIColor redColor] forState:UIControlStateHighlighted]; [button addTarget:self action:@selector(buttonPrint) forControlEvents:UIControlEventTouchUpInside]; [self.view addSubview:button]; // Do any additional setup after loading the view.&#125;- (void)buttonPrint&#123; FlutterViewController * flutterVC = [[FlutterViewController alloc]init]; [flutterVC setInitialRoute:@&quot;æˆ‘æ˜¯Nativeä¼ ç»™FLutteræ¨¡å—çš„&quot;]; [self presentViewController:flutterVC animated:true completion:nil];&#125;@end åœ¨flutter_moduleæ¨¡å—ä¸­,é€šè¿‡window.defaultRouteNameçš„æ–¹å¼å³å¯è·å–åˆ°iOSåŸç”Ÿä¼ è¿‡å»çš„å€¼.å…¶ä¸­éœ€è¦å¼•å…¥ import &#39;dart:ui&#39;;æºç  æ•ˆæœå›¾:","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"React-Nativeä½¿ç”¨è‡ªå®šä¹‰å­—ä½“","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeä½¿ç”¨è‡ªå®šä¹‰å­—ä½“","date":"2019-05-13T16:00:00.000Z","updated":"2019-05-14T11:17:33.130Z","comments":true,"path":"2019/05/14/ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeä½¿ç”¨è‡ªå®šä¹‰å­—ä½“/","link":"","permalink":"https://pheromone.github.io/2019/05/14/ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeä½¿ç”¨è‡ªå®šä¹‰å­—ä½“/","excerpt":"ä»Šå¤©,å­¦ä¹ ä¸€ä¸‹åœ¨React-Nativeä¸­ä½¿ç”¨è‡ªå®šä¹‰å­—ä½“.ä½¿ç”¨ç‰ˆæœ¬æ˜¯&quot;react-native&quot;: &quot;0.59.8&quot;","text":"ä»Šå¤©,å­¦ä¹ ä¸€ä¸‹åœ¨React-Nativeä¸­ä½¿ç”¨è‡ªå®šä¹‰å­—ä½“.ä½¿ç”¨ç‰ˆæœ¬æ˜¯&quot;react-native&quot;: &quot;0.59.8&quot;é¦–å…ˆå…ˆåœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ç”¨æ¥å­˜æ”¾XXXX.ttfå­—ä½“æ–‡ä»¶,æˆ‘ä¸€èˆ¬å–œæ¬¢åœ¨æœ€å¤–é¢åŠ ä¸€ä¸ªassetsæ–‡ä»¶å¤¹,é‡Œé¢å†åŠ ä¸€ä¸ªfontsæ–‡ä»¶å¤¹,ä¹‹åå†æ”¾ç½®å­—ä½“æ–‡ä»¶XXX.ttf.ç„¶å,åœ¨package.jsonä¸­åŠ å…¥è¯¥æ–‡ä»¶è·¯å¾„.å¦‚123456789&#123; .... &quot;rnpm&quot;: &#123; &quot;assets&quot;: [ &quot;./assets/fonts&quot; ] &#125; &#125; å¦‚å›¾:ä¹‹å,ç»ˆç«¯cd åˆ°é¡¹ç›®æ ¹ç›®å½•,ç„¶åè¿è¡Œreact-native link.å®Œæˆä¹‹åæ‰“å¼€Xcodeå¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†Resourcesæ–‡ä»¶å¤¹ä¸‹çš„xxx.ttfå­—ä½“æ–‡ä»¶,åŒæ—¶åœ¨é¡¹ç›®çš„info.plistä¸­å¤šäº†Fonts provided by applicationè¿™ä¸ªæ•°ç»„,å…¶ä¸­å°±æœ‰å‰é¢çš„xxx.ttfæ–‡ä»¶.å¦‚å›¾: OK.å­—ä½“æ–‡ä»¶å·²ç»é…ç½®å®Œæ¯•,æ¥ä¸‹æ¥ä½¿ç”¨å³å¯.åœ¨iOSå¹³å°ä¸Šä¸èƒ½ç›´æ¥ä½¿ç”¨å­—ä½“æ–‡ä»¶å,éœ€è¦ä½¿ç”¨familyNamesæ‰å¯ä»¥.æˆ‘ä»¬å…ˆè·å–ä¸€ä¸‹è¯¥å­—ä½“æ–‡ä»¶çš„çš„familyNames.åœ¨AppDelegate.mä¸­,ä½¿ç”¨123456789for(NSString *fontfamilyname in [UIFont familyNames]) &#123; NSLog(@&quot;family:&apos;%@&apos;&quot;,fontfamilyname); for(NSString *fontName in [UIFont fontNamesForFamilyName:fontfamilyname]) &#123; NSLog(@&quot;\\tfont:&apos;%@&apos;&quot;,fontName); &#125; NSLog(@&quot;-------------&quot;);&#125; å…¶ä¸­ 1NSLog(@&quot;family:&apos;%@&apos;&quot;,fontfamilyname); æ‰“å°çš„å°±æ˜¯familyNames.androidç›´æ¥ä½¿ç”¨å­—ä½“æ–‡ä»¶åxxxå³å¯.å¦‚å›¾:æ•ˆæœå¦‚å›¾(éƒ¨åˆ†å­—ä½“åªèƒ½ä½¿ç”¨çœŸæœºæ‰èƒ½çœ‹å‡ºæ¥): æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"React-Nativeä¸Webçš„åŸºæœ¬äº¤äº’","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeä¸Webçš„åŸºæœ¬äº¤äº’","date":"2019-04-21T16:00:00.000Z","updated":"2019-04-22T07:57:55.761Z","comments":true,"path":"2019/04/22/ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeä¸Webçš„åŸºæœ¬äº¤äº’/","link":"","permalink":"https://pheromone.github.io/2019/04/22/ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeä¸Webçš„åŸºæœ¬äº¤äº’/","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹React Nativeä¸Webç«¯çš„åŸºæœ¬äº¤äº’,æš‚æ—¶æ¶‰åŠåˆ°RNå‘Webç«¯ä¼ å€¼,Webå‘RNç«¯ä¼ å€¼,å› ä¸ºç°åœ¨è½¬ä¸ºFlutterå¼€å‘,æ‰€ä»¥è¿™ä¸€å—æš‚æ—¶åªèƒ½æ¶‰åŠåˆ°è¿™é‡Œ.å…¶ä¸­çš„Webç«¯é‡‡ç”¨æœ¬åœ°htmlé¡µé¢.","text":"ä»Šå¤©å­¦ä¹ ä¸‹React Nativeä¸Webç«¯çš„åŸºæœ¬äº¤äº’,æš‚æ—¶æ¶‰åŠåˆ°RNå‘Webç«¯ä¼ å€¼,Webå‘RNç«¯ä¼ å€¼,å› ä¸ºç°åœ¨è½¬ä¸ºFlutterå¼€å‘,æ‰€ä»¥è¿™ä¸€å—æš‚æ—¶åªèƒ½æ¶‰åŠåˆ°è¿™é‡Œ.å…¶ä¸­çš„Webç«¯é‡‡ç”¨æœ¬åœ°htmlé¡µé¢.æœ¬æ–‡è®¾è®¡çš„äº¤äº’ä¸»è¦é webViewçš„onMessageå’ŒpostMessage.åœ¨RNç«¯å‘é€æ•°æ®ç»™Web,ä¸»è¦ä¾é è°ƒç”¨webViewçš„potsMessageæ–¹æ³•å®ç°,å¦‚:1this.refs.webview.postMessage(this.data); æ¥æ”¶Webç«¯çš„æ•°æ®é çš„æ˜¯WebViewçš„onMessageæ–¹æ³•123onMessage=&#123;(e) =&gt; &#123; this.handleMessage(e) &#125;&#125; ä¸‹é¢æ˜¯å®Œæ•´ä»£ç : App.js12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273import React from &apos;react&apos;;import &#123; View, Text, StyleSheet, WebView&#125; from &apos;react-native&apos;;export default class Web extends React.Component &#123; constructor(props) &#123; super(props); this.state = &#123; webViewData: &apos;&apos; &#125; this.data = &apos;æˆ‘æ˜¯RNä¼ ç»™webç«¯çš„å‚æ•°&apos;; &#125; sendMessage() &#123; this.refs.webview.postMessage(this.data); &#125; handleMessage(e) &#123; this.setState(&#123;webViewData: e.nativeEvent.data&#125;); &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &#123;/*web*/&#125; &lt;View style=&#123;&#123;width: 375, height: 220&#125;&#125;&gt; &lt;WebView ref=&#123;&apos;webview&apos;&#125; source=&#123;require(&apos;./test.html&apos;)&#125; style=&#123;&#123;width: 375, height: 220&#125;&#125; onMessage=&#123;(e) =&gt; &#123; this.handleMessage(e) &#125;&#125; /&gt; &lt;/View&gt; &#123;/*RN*/&#125; &lt;Text&gt;æ¥è‡ªwebviewçš„æ•°æ® : &#123;this.state.webViewData&#125;&lt;/Text&gt; &lt;Text onPress=&#123;() =&gt; &#123; this.sendMessage() &#125;&#125;&gt; å‘é€æ•°æ®åˆ°WebView &lt;/Text&gt; &lt;/View&gt; ) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, marginTop: 22, backgroundColor: &apos;#F5FCFF&apos;, &#125;,&#125;); è€Œåœ¨htmlé‡Œé¢,éœ€è¦ç›‘å¬æ•°æ®,é€šè¿‡:123document.addEventListener(&apos;message&apos;, function (e) &#123; document.getElementById(&apos;data&apos;).textContent = e.data; &#125;); å‘é€æ•°æ®é€šè¿‡:1window.postMessage(data); å®Œæ•´ä»£ç å¦‚ä¸‹: test.html123456789101112131415161718192021222324252627282930313233343536&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;title&gt;&lt;/title&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;&lt;/head&gt;&lt;body&gt;&lt;p style=&quot;text-align: center&quot;&gt; &lt;button id=&quot;button&quot;&gt;å‘é€æ•°æ®åˆ°react native&lt;/button&gt;&lt;p style=&quot;text-align: center&quot;&gt;æ”¶åˆ°react nativeå‘é€çš„æ•°æ®: &lt;span id=&quot;data&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;/p&gt;&lt;script&gt; var data = 0; function sendData(data) &#123; if (window.originalPostMessage) &#123; window.postMessage(data); &#125; else &#123; throw Error(&apos;postMessageæ¥å£è¿˜æœªæ³¨å…¥&apos;); &#125; &#125; window.onload = function () &#123; document.addEventListener(&apos;message&apos;, function (e) &#123; document.getElementById(&apos;data&apos;).textContent = e.data; &#125;); document.getElementById(&apos;button&apos;).onclick = function () &#123; data += 11; sendData(data); &#125; &#125;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; æ•ˆæœå›¾: æºç  å¦å¤–:åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­,å¯èƒ½ä¼šç§»é™¤è‡ªå¸¦çš„webView,æ”¹ç”¨åœ¨å¤–éƒ¨åº“é‡Œå¼•ç”¨çš„æ–¹å¼.åŒæ—¶,åœ¨ä¸‰æ–¹åº“ä¸­,ä¹Ÿæœ‰webView-bridgeåº“ä½¿ç”¨,cookieåº“ä½¿ç”¨.react-native-webviewwebView-bridgecookie","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"Flutterè·¯ç”±ç®¡ç†åº“fluroå­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutterè·¯ç”±ç®¡ç†åº“fluroå­¦ä¹ ","date":"2019-03-29T16:00:00.000Z","updated":"2019-04-22T07:56:11.657Z","comments":true,"path":"2019/03/30/ç§»åŠ¨ç«¯å­¦ä¹ /Flutterè·¯ç”±ç®¡ç†åº“fluroå­¦ä¹ /","link":"","permalink":"https://pheromone.github.io/2019/03/30/ç§»åŠ¨ç«¯å­¦ä¹ /Flutterè·¯ç”±ç®¡ç†åº“fluroå­¦ä¹ /","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­è·¯ç”±ç®¡ç†åº“ fluroä½¿ç”¨ç‰ˆæœ¬æ˜¯:fluro: &quot;^1.4.0&quot;.","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­è·¯ç”±ç®¡ç†åº“ fluroä½¿ç”¨ç‰ˆæœ¬æ˜¯:fluro: &quot;^1.4.0&quot;. fluro ä»£ç ç»“æ„:é¦–å…ˆ,æ–°å»ºæ–‡ä»¶å¤¹å­˜æ”¾fluroçš„å…³é”®ä»£ç : application.dartapplication.dart,è¯¥æ–‡ä»¶ä¸»è¦æ˜¯ç”Ÿæˆä¸€ä¸ªé™æ€æ–‡ä»¶,æ–¹ä¾¿åé¢ç›´æ¥è°ƒç”¨åˆå§‹åŒ–çš„Routerå¯¹è±¡1234import &apos;package:fluro/fluro.dart&apos;;class Application &#123; static Router router;&#125; router_handler.dartrouter_handler.dartæ–‡ä»¶,ä¸»è¦è´Ÿè´£è·¯ç”±è·³è½¬,ä»ä»£ç å¯ä»¥çœ‹å‡º,æœ‰ä¸¤ä¸ªhandler,å…¶ä¸­ä¸€ä¸ªéœ€è¦å¸¦ä¸€ä¸ªå‚æ•°paramsId 12345678910111213141516import &apos;package:flutter/material.dart&apos;;import &apos;package:fluro/fluro.dart&apos;;import &apos;../pages/detailspage.dart&apos;;import &apos;../pages/otherpaage.dart&apos;;Handler detailsHandle = Handler( handlerFunc: (BuildContext context, Map&lt;String, List&lt;String&gt;&gt; params) &#123; String paramsId = params[&apos;id&apos;].first; return DetailsPage(paramsId);&#125;);Handler otherHandle = Handler( handlerFunc: (BuildContext context, Map&lt;String, List&lt;String&gt;&gt; params) &#123; return OtherPage();&#125;); routers.dartrouters.dartè´Ÿè´£å°†ä¸Šé¢åˆ›å»ºå¥½çš„handleæ³¨å†Œè¿›fluro. 123456789101112131415161718import &apos;package:flutter/material.dart&apos;;import &apos;package:fluro/fluro.dart&apos;;import &apos;./router_handler.dart&apos;;class Routers&#123; static String root = &apos;/&apos;; static String detailsPage = &apos;./detail&apos;; static String otherPage = &apos;./other&apos;; static void configureRouters(Router router)&#123; router.notFoundHandler = new Handler( handlerFunc: (BuildContext context,Map&lt;String,List&lt;String&gt;&gt; params)&#123; print(&apos;é”™è¯¯è·¯ç”±&apos;); &#125; ); router.define(detailsPage,handler: detailsHandle); router.define(otherPage,handler: otherHandle); &#125;&#125; ç„¶åéœ€è¦åœ¨é¡¹ç›®å…¥å£å¤„,é…ç½®è‡ªå®šä¹‰è·¯ç”±onGenerateRoute main.dart12345678910111213141516171819202122232425import &apos;package:flutter/material.dart&apos;;import &apos;tabbar.dart&apos;;import &apos;package:fluro/fluro.dart&apos;;import &apos;./routers/application.dart&apos;;import &apos;./routers/routers.dart&apos;;void main() =&gt; runApp(MyApp());class MyApp extends StatelessWidget &#123; // This widget is the root of your application. @override Widget build(BuildContext context) &#123; final router =Router(); Routers.configureRouters(router); Application.router = router; return MaterialApp( title: &apos;Flutter Demo&apos;, onGenerateRoute: Application.router.generator, theme: ThemeData( primarySwatch: Colors.blue, ), home: Tabbar(), ); &#125;&#125; é…ç½®å¥½åå¯ä»¥åœ¨éœ€è¦è·³è½¬çš„æ–¹æ³•è·³è½¬,åŒæ—¶å¯ä»¥é…ç½®pushæ–¹å‘ç­‰.å¦‚:1Application.router.navigateTo(context, &quot;./detail?id=$&#123;dataList[index]&#125;&quot;, transition: TransitionType.inFromLeft); ä¸‹é¢æ˜¯é¡µé¢ä¸­çš„æ‰€æœ‰ä»£ç : homepage.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445import &apos;package:flutter/material.dart&apos;;import &apos;package:fluro/fluro.dart&apos;;import &apos;../routers/application.dart&apos;;class Homepage extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar(title: Text(&apos;HomePage&apos;)), body: HomeContainer(), ); &#125;&#125;class HomeContainer extends StatefulWidget &#123; @override _HomeContainerState createState() =&gt; _HomeContainerState();&#125;class _HomeContainerState extends State&lt;HomeContainer&gt; &#123; List&lt;String&gt; dataList = []; @override void initState() &#123; super.initState(); for (var i = 0; i &lt; 100; i++) &#123; dataList.add(i.toString()); &#125; &#125; @override Widget build(BuildContext context) &#123; return ListView.builder( itemCount: dataList.length, itemBuilder: (context, index) &#123; return ListTile( onTap: ()&#123; Application.router.navigateTo(context, &quot;./detail?id=$&#123;dataList[index]&#125;&quot;, transition: TransitionType.inFromLeft); &#125;, title: Text(dataList[index] + &apos;ğŸ‘Œ&apos;), ); &#125;, ); &#125;&#125; Showpage.dart1234567891011121314151617181920import &apos;package:flutter/material.dart&apos;;import &apos;package:fluro/fluro.dart&apos;;import &apos;../routers/application.dart&apos;;class Showpage extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar(title: Text(&apos;SHOW&apos;)), body: Center( child: RaisedButton( onPressed: ()&#123; Application.router.navigateTo(context, &quot;./other&quot;, transition: TransitionType.nativeModal); &#125;, child: Text(&apos;è·³è½¬&apos;), ), ), ); &#125;&#125; minepage.dart12345678910111213import &apos;package:flutter/material.dart&apos;;class Minepage extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar(title: Text(&apos;Minepage&apos;)), body: Center( child: Text(&apos;Minepage&apos;), ), ); &#125;&#125; æ•ˆæœå¦‚å›¾: æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"Flutter~flutter_blocåº“å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~flutter_blocåº“å­¦ä¹ ","date":"2019-03-06T16:00:00.000Z","updated":"2019-04-22T07:54:40.451Z","comments":true,"path":"2019/03/07/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~flutter_blocåº“å­¦ä¹ /","link":"","permalink":"https://pheromone.github.io/2019/03/07/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~flutter_blocåº“å­¦ä¹ /","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†åº“ blocä¸‹çš„flutter_blocä½¿ç”¨ç‰ˆæœ¬æ˜¯:flutter_bloc 0.7.0.","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†åº“ blocä¸‹çš„flutter_blocä½¿ç”¨ç‰ˆæœ¬æ˜¯:flutter_bloc 0.7.0. blocflutter_bloc ä»£ç ç»“æ„: main.dart1234567891011121314151617181920212223242526import &apos;package:flutter/material.dart&apos;;import &apos;package:flutter_bloc_demo/top_screen.dart&apos;;void main() =&gt; runApp(MyApp());class MyApp extends StatelessWidget &#123; // This widget is the root of your application. @override Widget build(BuildContext context) &#123; return MaterialApp( title: &apos;Flutter Demo&apos;, theme: ThemeData( // This is the theme of your application. // // Try running your application with &quot;flutter run&quot;. You&apos;ll see the // application has a blue toolbar. Then, without quitting the app, try // changing the primarySwatch below to Colors.green and then invoke // &quot;hot reload&quot; (press &quot;r&quot; in the console where you ran &quot;flutter run&quot;, // or simply save your changes to &quot;hot reload&quot; in a Flutter IDE). // Notice that the counter didn&apos;t reset back to zero; the application // is not restarted. primarySwatch: Colors.blue, ), home: TopScreen() ); &#125;&#125; top_screen.dart12345678910111213141516171819202122232425import &apos;package:flutter/material.dart&apos;;import &apos;package:flutter_bloc_demo/bloc/counter_bloc.dart&apos;;import &apos;package:flutter_bloc/flutter_bloc.dart&apos;;import &apos;tabbar.dart&apos;;class TopScreen extends StatefulWidget &#123; @override _TopScreenState createState() =&gt; _TopScreenState();&#125;class _TopScreenState extends State&lt;TopScreen&gt; &#123; final CounterBloc _counterBloc = CounterBloc(); @override Widget build(BuildContext context) &#123; return MaterialApp( title: &apos;Flutter Demo&apos;, home: BlocProvider&lt;CounterBloc&gt;( bloc: _counterBloc, child: Tabbar(), ), ); &#125;&#125; tabbar.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101import &apos;package:flutter/material.dart&apos;;import &apos;package:flutter_bloc_demo/pages/one.dart&apos;;import &apos;package:flutter_bloc_demo/pages/Two.dart&apos;; class Tabbar extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return new MaterialApp( debugShowCheckedModeBanner: false, home: new MainPageWidget()); &#125;&#125; class MainPageWidget extends StatefulWidget &#123; @override State&lt;StatefulWidget&gt; createState() &#123; return new MainPageState(); &#125;&#125; class MainPageState extends State&lt;MainPageWidget&gt; &#123; int _tabIndex = 0; var tabImages; var appBarTitles = [&apos;å£¹&apos;, &apos;è´°&apos;,]; /* * å­˜æ”¾è€Œä¸ªé¡µé¢ï¼Œè·ŸfragmentListä¸€æ · */ var _pageList; /* * æ ¹æ®é€‰æ‹©è·å¾—å¯¹åº”çš„normalæˆ–æ˜¯pressçš„icon */ Image getTabIcon(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return tabImages[curIndex][1]; &#125; return tabImages[curIndex][0]; &#125; /* * è·å–bottomTabçš„é¢œè‰²å’Œæ–‡å­— */ Text getTabTitle(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff1296db))); &#125; else &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff515151))); &#125; &#125; /* * æ ¹æ®imageè·¯å¾„è·å–å›¾ç‰‡ */ Image getTabImage(path) &#123; return new Image.asset(path, width: 24.0, height: 24.0); &#125; void initData() &#123; /* * åˆå§‹åŒ–é€‰ä¸­å’Œæœªé€‰ä¸­çš„icon */ tabImages = [ [getTabImage(&apos;images/tab/one.png&apos;), getTabImage(&apos;images/tab/one_active.png&apos;)], [getTabImage(&apos;images/tab/two.png&apos;), getTabImage(&apos;images/tab/two_active.png&apos;)], ]; /* * 2ä¸ªå­ç•Œé¢ */ _pageList = [ new One(), new Two(), ]; &#125; @override Widget build(BuildContext context) &#123; //åˆå§‹åŒ–æ•°æ® initData(); return Scaffold( body: _pageList[_tabIndex], bottomNavigationBar: new BottomNavigationBar( items: &lt;BottomNavigationBarItem&gt;[ new BottomNavigationBarItem( icon: getTabIcon(0), title: getTabTitle(0)), new BottomNavigationBarItem( icon: getTabIcon(1), title: getTabTitle(1)), ], type: BottomNavigationBarType.fixed, //é»˜è®¤é€‰ä¸­é¦–é¡µ currentIndex: _tabIndex, iconSize: 24.0, //ç‚¹å‡»äº‹ä»¶ onTap: (index) &#123; setState(() &#123; _tabIndex = index; &#125;); &#125;, )); &#125;&#125; one.dart12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849import &apos;package:flutter/material.dart&apos;;import &apos;package:flutter_bloc_demo/bloc/counter_bloc.dart&apos;;import &apos;package:flutter_bloc/flutter_bloc.dart&apos;;class One extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; final CounterBloc _counterBloc = BlocProvider.of&lt;CounterBloc&gt;(context); return Scaffold( appBar: AppBar(title: Text(&apos;One&apos;)), body: BlocBuilder&lt;CounterEvent, int&gt;( bloc: _counterBloc, builder: (BuildContext context, int count) &#123; return Center( child: Text( &apos;$count&apos;, style: TextStyle(fontSize: 24.0), ), ); &#125;, ), floatingActionButton: Column( crossAxisAlignment: CrossAxisAlignment.end, mainAxisAlignment: MainAxisAlignment.end, children: &lt;Widget&gt;[ Padding( padding: EdgeInsets.symmetric(vertical: 5.0), child: FloatingActionButton( child: Icon(Icons.add), onPressed: () &#123; _counterBloc.dispatch(CounterEvent.increment); &#125;, ), ), Padding( padding: EdgeInsets.symmetric(vertical: 5.0), child: FloatingActionButton( child: Icon(Icons.remove), onPressed: () &#123; _counterBloc.dispatch(CounterEvent.decrement); &#125;, ), ), ], ), ); &#125;&#125; two.dart12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849import &apos;package:flutter/material.dart&apos;;import &apos;package:flutter_bloc_demo/bloc/counter_bloc.dart&apos;;import &apos;package:flutter_bloc/flutter_bloc.dart&apos;;class Two extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; final CounterBloc _counterBloc = BlocProvider.of&lt;CounterBloc&gt;(context); return Scaffold( appBar: AppBar(title: Text(&apos;Two&apos;)), body: BlocBuilder&lt;CounterEvent, int&gt;( bloc: _counterBloc, builder: (BuildContext context, int count) &#123; return Center( child: Text( &apos;$count&apos;, style: TextStyle(fontSize: 24.0), ), ); &#125;, ), floatingActionButton: Column( crossAxisAlignment: CrossAxisAlignment.end, mainAxisAlignment: MainAxisAlignment.end, children: &lt;Widget&gt;[ Padding( padding: EdgeInsets.symmetric(vertical: 5.0), child: FloatingActionButton( child: Icon(Icons.remove), onPressed: () &#123; _counterBloc.dispatch(CounterEvent.decrement); &#125;, ), ), Padding( padding: EdgeInsets.symmetric(vertical: 5.0), child: FloatingActionButton( child: Icon(Icons.add), onPressed: () &#123; _counterBloc.dispatch(CounterEvent.increment); &#125;, ), ), ], ), ); &#125;&#125; counter_bloc.dart1234567891011121314151617181920import &apos;package:bloc/bloc.dart&apos;;enum CounterEvent &#123; increment, decrement &#125;class CounterBloc extends Bloc&lt;CounterEvent, int&gt; &#123; @override int get initialState =&gt; 0; @override Stream&lt;int&gt; mapEventToState(int currentState, CounterEvent event) async* &#123; switch (event) &#123; case CounterEvent.decrement: yield currentState - 1; break; case CounterEvent.increment: yield currentState + 1; break; &#125; &#125;&#125; æ•ˆæœå¦‚å›¾: æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"Flutter~json_serializableåº“å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~json_serializableåº“å­¦ä¹ ","date":"2019-03-05T16:00:00.000Z","updated":"2019-04-22T07:55:30.587Z","comments":true,"path":"2019/03/06/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~json_serializableåº“å­¦ä¹ /","link":"","permalink":"https://pheromone.github.io/2019/03/06/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~json_serializableåº“å­¦ä¹ /","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­å®ä½“ç±»ä¸‰æ–¹åº“json_serializable.å…¶ä¸­,json_serializable: ^2.0.0,json_annotation: ^2.0.0,build_runner: ^1.0.0","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­å®ä½“ç±»ä¸‰æ–¹åº“json_serializable.å…¶ä¸­,json_serializable: ^2.0.0,json_annotation: ^2.0.0,build_runner: ^1.0.0 1ã€é¦–å…ˆ,æ–°å»ºä¸€ä¸ªFlutteré¡¹ç›®,å¼•å…¥dioç½‘ç»œè¯·æ±‚åº“,æŒ‰ç…§json_serializableçš„è¯´æ˜,åˆ†åˆ«åœ¨dependenciesä¸‹å¼•å…¥json_annotation,åœ¨dev_dependenciesä¸‹å¼•å…¥json_serializableå’Œbuild_runner(build_runneræ˜¯dartå›¢é˜Ÿæä¾›çš„ä¸€ä¸ªç”Ÿæˆdartä»£ç æ–‡ä»¶çš„å¤–éƒ¨åŒ…).2ã€åœ¨main.darté‡Œé¢å†™ä¸€ä¸ªç½‘ç»œè¯·æ±‚. main.dart1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677import &apos;package:flutter/material.dart&apos;;import &apos;package:dio/dio.dart&apos;;import &apos;dart:async&apos;;import &apos;package:json_demo/Data.dart&apos;;// flutter packages pub run build_runner buildvoid main() =&gt; runApp(MyApp());class MyApp extends StatelessWidget &#123; // This widget is the root of your application. @override Widget build(BuildContext context) &#123; return MaterialApp( title: &apos;Flutter Demo&apos;, theme: ThemeData( primarySwatch: Colors.blue, ), home: DataToModel(), ); &#125;&#125;class DataToModel extends StatefulWidget &#123; final Widget child; DataToModel(&#123;Key key, this.child&#125;) : super(key: key); _DataToModelState createState() =&gt; _DataToModelState();&#125;class _DataToModelState extends State&lt;DataToModel&gt; &#123; Future getHomePageContent() async &#123; try &#123; print(&apos;å¼€å§‹è·å–é¦–é¡µæ•°æ®&apos;); Response response; Dio dio = new Dio(); response = await dio.get(&apos;http://gank.io/api/data/%E7%A6%8F%E5%88%A9/10/1&apos;); if (response.statusCode == 200) &#123; return response.data; &#125; else &#123; throw Exception(&apos;åç«¯æ¥å£å‡ºç°å¼‚å¸¸&apos;); &#125; &#125; catch (e) &#123; print(&apos;ERROR å‘ç”Ÿé”™è¯¯ğŸ‘‡&apos;); return print(e); &#125;&#125; @override void initState() &#123; super.initState(); getHomePageContent().then((val) &#123; Data dd = Data.fromJson(val); print(dd.error); // æ•°ç»„ print(dd.results); // æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ :map print(dd.results[0].createdAt); print(dd.results[0].desc); print(dd.results[0].publishedAt); print(dd.results[0].source); print(dd.results[0].type); print(dd.results[0].url); print(dd.results[0].used); print(dd.results[0].who); &#125;); &#125; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar(title: Text(&apos;json_serializable&apos;)), body: Text(&apos;json_serializable&apos;), ); &#125;&#125; è¿™é‡Œçš„æ¥å£,ç½‘ä¸Šéšæ„æ‰¾ä¸€ä¸ª: http://gank.io/api/data/%E7%A6%8F%E5%88%A9/10/1å¤§è‡´ç»“æ„å¦‚å›¾:3ã€ç„¶åæ ¹æ®è¿”å›æ•°æ®,ä¹¦å†™ä¸¤ä¸ªdartæ–‡ä»¶,Data.dartæ˜¯å¤–éƒ¨map,Dic.dartæ˜¯å†…éƒ¨çš„List. Data.dart123456789101112131415import &apos;package:json_annotation/json_annotation.dart&apos;;import &apos;package:json_demo/Dic.dart&apos;;part &apos;Data.g.dart&apos;;@JsonSerializable()class Data&#123; bool error; List&lt;Dic&gt; results; Data(this.error,this.results); //ååºåˆ—åŒ– factory Data.fromJson(Map&lt;String, dynamic&gt; json) =&gt; _$DataFromJson(json); //åºåˆ—åŒ– Map&lt;String, dynamic&gt; toJson() =&gt; _$DataToJson(this); &#125; Dic.dart12345678910111213141516171819202122import &apos;package:json_annotation/json_annotation.dart&apos;;part &apos;Dic.g.dart&apos;;@JsonSerializable()class Dic&#123; final String createdAt; final String desc; final String publishedAt; final String source; final String type; final String url; final bool used; final String who; Dic(&#123;this.createdAt, this.desc, this.publishedAt, this.source, this.type, this.url, this.used, this.who&#125;); //ååºåˆ—åŒ– factory Dic.fromJson(Map&lt;String, dynamic&gt; json) =&gt; _$DicFromJson(json); //åºåˆ—åŒ– Map&lt;String, dynamic&gt; toJson() =&gt; _$DicToJson(this); &#125; ç„¶å,ideä¼šæŠ¥å‡ ä¸ªé”™è¯¯,è¿™ä¸ªä¸ç”¨ç®¡,é‚£æ˜¯å°šæœªç”Ÿæˆè§£ææ–‡ä»¶çš„åŸå› . 4ã€ç„¶å,ç»ˆç«¯ cd åˆ°é¡¹ç›®æ ¹ç›®å½•,å›è½¦,æ‰§è¡Œå‘½ä»¤flutter packages pub run build_runner build,ä¼šç”Ÿæˆå¯¹åº”çš„è§£ææ–‡ä»¶. 5ã€ok,æ’¸å¥½ä¹‹å,è¾“å‡ºçœ‹ä¸€ä¸‹12345678910111213Data dd = Data.fromJson(val); print(dd.error); // æ•°ç»„ print(dd.results); // æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ :map print(dd.results[0].createdAt); print(dd.results[0].desc); print(dd.results[0].publishedAt); print(dd.results[0].source); print(dd.results[0].type); print(dd.results[0].url); print(dd.results[0].used); print(dd.results[0].who); æ€»ç»“:ä»¥ä¸Šå°±æ˜¯å¯¹flutterä¸­å®ä½“ç±»åº“json_serializableçš„ç®€å•å­¦ä¹ ,èº«è¾¹å¤§ä½¬æœ‰çš„è¯´å¾ˆæœ‰å¿…è¦,å› ä¸ºè§„èŒƒç‚¹,æ— è§„çŸ©ä¸æˆä¸‰è§’å½¢,æœ‰äº†å®ä½“ç±»æ–¹ä¾¿ç»´æŠ¤,æœ¬æ¥åŸç”Ÿå°±æ˜¯è¯¥æœ‰modelçš„,è¿™æ ·ä¸å®¹æ˜“å‡ºç°å–å€¼é”™è¯¯å’Œå…¶ä»–é—®é¢˜;æœ‰çš„å¤§ä½¬è¯´æ²¡å•¥å¿…è¦,æœ‰ç‚¹ç¹çäº†.æˆ‘ä¹Ÿä¸çŸ¥é“è°ç¼©çš„å¯¹,ä½†æ˜¯å­¦ä¸‹æ€»æ²¡é”™,å°±åƒé²è¿…è¯´çš„é‚£æ ·â€äººæ´»ç€ä»€ä¹ˆæœ€é‡è¦,è‚¯å®šæ˜¯å¼€å¿ƒè¾£â€. ç½‘ä¸Šè¿˜æœ‰å…¶ä»–çš„æ–¹æ¡ˆ:a. android studio å®‰è£…æ’ä»¶ dart_json_formatb. https://github.com/debuggerx01/JSONFormat4Flutterc. ä¸€ä¸ªåœ¨çº¿è½¬æ¢å·¥å…·: https://javiercbk.github.io/json_to_dart/ æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"Flutterä¸­çš„sqfliteåº“å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutterä¸­çš„sqfliteåº“å­¦ä¹ ","date":"2019-03-03T16:00:00.000Z","updated":"2019-03-04T16:02:42.924Z","comments":true,"path":"2019/03/04/ç§»åŠ¨ç«¯å­¦ä¹ /Flutterä¸­çš„sqfliteåº“å­¦ä¹ /","link":"","permalink":"https://pheromone.github.io/2019/03/04/ç§»åŠ¨ç«¯å­¦ä¹ /Flutterä¸­çš„sqfliteåº“å­¦ä¹ /","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­SQLiteæ•°æ®åº“ç¬¬ä¸‰æ–¹sqflite.å…¶ä¸­,sqflite: ^1.1.0","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­SQLiteæ•°æ®åº“ç¬¬ä¸‰æ–¹sqflite.å…¶ä¸­,sqflite: ^1.1.0æ¶‰åŠ æ•°æ®åº“çš„åˆ›å»º è¡¨çš„åˆ›å»º å¢åˆ æ”¹æŸ¥æ“ä½œ å…³é—­æ•°æ®åº“ åˆ é™¤æ•°æ®åº“ main.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118import &apos;package:flutter/material.dart&apos;;import &apos;package:sqflite/sqflite.dart&apos;;import &apos;package:path/path.dart&apos;;void main() =&gt; runApp(MyApp());class MyApp extends StatelessWidget &#123; // This widget is the root of your application. @override Widget build(BuildContext context) &#123; return MaterialApp( title: &apos;Flutter Demo&apos;, theme: ThemeData( // This is the theme of your application. // // Try running your application with &quot;flutter run&quot;. You&apos;ll see the // application has a blue toolbar. Then, without quitting the app, try // changing the primarySwatch below to Colors.green and then invoke // &quot;hot reload&quot; (press &quot;r&quot; in the console where you ran &quot;flutter run&quot;, // or simply save your changes to &quot;hot reload&quot; in a Flutter IDE). // Notice that the counter didn&apos;t reset back to zero; the application // is not restarted. primarySwatch: Colors.blue, ), home: CRUD(), ); &#125;&#125;class CRUD extends StatefulWidget &#123; final Widget child; CRUD(&#123;Key key, this.child&#125;) : super(key: key); _CRUDState createState() =&gt; _CRUDState();&#125;class _CRUDState extends State&lt;CRUD&gt; &#123; Database db; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar(title: Text(&apos;æ•°ç»„åº“-å¢åˆ æ”¹æŸ¥&apos;)), body: SingleChildScrollView( child: Column( children: &lt;Widget&gt;[ OutlineButton(child: Text(&apos;åˆ›å»ºæ•°æ®åº“å’Œä¸€å¼ è¡¨&apos;), onPressed: _createTable), OutlineButton(child: Text(&apos;æŸ¥è¯¢æ•°æ®&apos;), onPressed: _queryData), OutlineButton(child: Text(&apos;æ’å…¥æ•°æ®&apos;), onPressed: _insertData), OutlineButton(child: Text(&apos;æ›´æ–°æ•°æ®&apos;), onPressed: _updateData), OutlineButton(child: Text(&apos;åˆ é™¤æ•°æ®&apos;), onPressed: _deleteData), OutlineButton(child: Text(&apos;å…³é—­æ•°æ®åº“&apos;), onPressed: _closeData), OutlineButton(child: Text(&apos;åˆ é™¤æ•°æ®åº“&apos;), onPressed: _deleteTable), ], ), ), ); &#125; // åˆ›å»ºæ•°æ®åº“ å’Œ è¡¨ void _createTable() async &#123; // è·å–æ•°æ®åº“æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ var databasesPath = await getDatabasesPath(); String path = join(databasesPath, &apos;demo.db&apos;); //æ ¹æ®æ•°æ®åº“æ–‡ä»¶è·¯å¾„å’Œæ•°æ®åº“ç‰ˆæœ¬å·åˆ›å»ºæ•°æ®åº“è¡¨ db = await openDatabase(path, version: 1, onCreate: (Database db, int version) async &#123; await db.execute( &apos;CREATE TABLE Test (id INTEGER PRIMARY KEY, name TEXT, value INTEGER, num REAL)&apos;); &#125;); print(&apos;åˆ›å»ºæ•°æ®åº“ å’Œ è¡¨&apos;); &#125; // å¢ void _insertData() async &#123; await db.transaction((txn) async &#123; await txn.rawInsert(&apos;INSERT INTO Test(name, value, num) VALUES(?, ?, ?)&apos;, [&apos;flutter==&gt;&apos;, 0101010101001, 1111111111111111111]); print(&apos;æ’å…¥æ•°æ®&apos;); &#125;); &#125; // åˆ  void _deleteData() async &#123; await db.rawDelete(&apos;DELETE FROM Test WHERE name = ?&apos;, [&apos;updated name&apos;]); print(&apos;åˆ é™¤&apos;); &#125; // æ”¹ void _updateData() async &#123; await db.rawUpdate( &apos;UPDATE Test SET name = ?, VALUE = ?,num = ? &apos;, [&apos;updated name&apos;, 0,1]); print(&apos;ä¿®æ”¹&apos;); &#125; // æŸ¥ void _queryData() async &#123; List&lt;Map&gt; maps = await db.query(&apos;Test&apos;); print(maps); &#125; // å…³é—­æ•°æ®åº“ void _closeData() async &#123; await db.close(); print(&apos;å…³é—­æ•°æ®åº“&apos;); &#125; // åˆ é™¤æ•°æ®åº“ void _deleteTable() async &#123; var databasesPath = await getDatabasesPath(); String path = join(databasesPath, &apos;demo.db&apos;); await deleteDatabase(path); print(&apos;åˆ é™¤æ•°æ®åº“&apos;); &#125;&#125; æ•ˆæœå›¾: æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"Flutter~provideå­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~provideå­¦ä¹ ","date":"2019-03-02T16:00:00.000Z","updated":"2019-04-22T07:55:43.381Z","comments":true,"path":"2019/03/03/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~provideå­¦ä¹ /","link":"","permalink":"https://pheromone.github.io/2019/03/03/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~provideå­¦ä¹ /","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹provide.å…¶ä¸­,provide: ^1.0.2","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹provide.å…¶ä¸­,provide: ^1.0.2ä»£ç ç»“æ„å¦‚å›¾æ‰€ç¤º: ä¸‹é¢æ˜¯å„æ–‡ä»¶çš„æºç .main.dart12345678910111213141516171819202122232425262728293031323334353637import &apos;package:flutter/material.dart&apos;;import &apos;package:provide_demo/tabbar.dart&apos;;import &apos;package:provide/provide.dart&apos;;import &apos;package:provide_demo/model/counter.dart&apos;;void main() &#123; var counter = Counter(); var providers = Providers(); providers ..provide(Provider&lt;Counter&gt;.value(counter)); runApp(ProviderNode(child: MyApp(), providers: providers));&#125;class MyApp extends StatelessWidget &#123; // This widget is the root of your application. @override Widget build(BuildContext context) &#123; return MaterialApp( title: &apos;Flutter Demo&apos;, theme: ThemeData( // This is the theme of your application. // // Try running your application with &quot;flutter run&quot;. You&apos;ll see the // application has a blue toolbar. Then, without quitting the app, try // changing the primarySwatch below to Colors.green and then invoke // &quot;hot reload&quot; (press &quot;r&quot; in the console where you ran &quot;flutter run&quot;, // or simply save your changes to &quot;hot reload&quot; in a Flutter IDE). // Notice that the counter didn&apos;t reset back to zero; the application // is not restarted. primarySwatch: Colors.blue, ), home: Tabbar(), ); &#125;&#125; tabbar.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100import &apos;package:flutter/material.dart&apos;;import &apos;One/one.dart&apos;;import &apos;Two/two.dart&apos;; class Tabbar extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return new MaterialApp( debugShowCheckedModeBanner: false, home: new MainPageWidget()); &#125;&#125; class MainPageWidget extends StatefulWidget &#123; @override State&lt;StatefulWidget&gt; createState() &#123; return new MainPageState(); &#125;&#125; class MainPageState extends State&lt;MainPageWidget&gt; &#123; int _tabIndex = 0; var tabImages; var appBarTitles = [&apos;One&apos;, &apos;Two&apos;]; /* * å­˜æ”¾äºŒä¸ªé¡µé¢ï¼Œè·ŸfragmentListä¸€æ · */ var _pageList; /* * æ ¹æ®é€‰æ‹©è·å¾—å¯¹åº”çš„normalæˆ–æ˜¯pressçš„icon */ Image getTabIcon(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return tabImages[curIndex][1]; &#125; return tabImages[curIndex][0]; &#125; /* * è·å–bottomTabçš„é¢œè‰²å’Œæ–‡å­— */ Text getTabTitle(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff1296db))); &#125; else &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff515151))); &#125; &#125; /* * æ ¹æ®imageè·¯å¾„è·å–å›¾ç‰‡ */ Image getTabImage(path) &#123; return new Image.asset(path, width: 24.0, height: 24.0); &#125; void initData() &#123; /* * åˆå§‹åŒ–é€‰ä¸­å’Œæœªé€‰ä¸­çš„icon */ tabImages = [ [getTabImage(&apos;images/tab/one.png&apos;), getTabImage(&apos;images/tab/one_active.png&apos;)], [getTabImage(&apos;images/tab/two.png&apos;), getTabImage(&apos;images/tab/two_active.png&apos;)], ]; /* * å­ç•Œé¢ */ _pageList = [ new One(), new Two(), ]; &#125; @override Widget build(BuildContext context) &#123; //åˆå§‹åŒ–æ•°æ® initData(); return Scaffold( body: _pageList[_tabIndex], bottomNavigationBar: new BottomNavigationBar( items: &lt;BottomNavigationBarItem&gt;[ new BottomNavigationBarItem( icon: getTabIcon(0), title: getTabTitle(0)), new BottomNavigationBarItem( icon: getTabIcon(1), title: getTabTitle(1)), ], type: BottomNavigationBarType.fixed, //é»˜è®¤é€‰ä¸­é¦–é¡µ currentIndex: _tabIndex, iconSize: 24.0, //ç‚¹å‡»äº‹ä»¶ onTap: (index) &#123; setState(() &#123; _tabIndex = index; &#125;); &#125;, )); &#125;&#125; counter.dart12345678910import &apos;package:flutter/material.dart&apos;;class Counter with ChangeNotifier&#123; int value = 0; increment()&#123; value++; notifyListeners(); &#125;&#125; one.dart1234567891011121314151617181920212223242526272829303132import &apos;package:flutter/material.dart&apos;;import &apos;package:provide/provide.dart&apos;;import &apos;package:provide_demo/model/counter.dart&apos;;class One extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar(title: Text(&apos;One&apos;)), body: Padding( padding: EdgeInsets.only(top: 400.0,left: 200.0), child: Column( children: &lt;Widget&gt;[ Provide&lt;Counter&gt;( builder: (context, child, counter) &#123; return Text( &apos;$&#123;counter.value&#125;&apos;, ); &#125;, ), IconButton( icon: Icon(Icons.add), onPressed: () &#123; Provide.value&lt;Counter&gt;(context).increment(); &#125;, ), ], ), ), ); &#125;&#125; two.dart123456789101112131415161718192021import &apos;package:flutter/material.dart&apos;;import &apos;package:provide/provide.dart&apos;;import &apos;package:provide_demo/model/counter.dart&apos;;class Two extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar(title: Text(&apos;Two&apos;)), body: Center( child: Provide&lt;Counter&gt;( builder: (context, child, counter) &#123; return Text( &apos;$&#123;counter.value&#125;&apos;, ); &#125;, ), ), ); &#125;&#125; æ•ˆæœå›¾: æºç å¦å¤–:scoped_modelå­¦ä¹ å¦å¤–:reduxå­¦ä¹ å¦å¤–:Flutterå­¦ä¹ demo","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"Flutter~reduxå­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~reduxå­¦ä¹ ","date":"2019-02-16T16:00:00.000Z","updated":"2019-04-22T07:54:28.809Z","comments":true,"path":"2019/02/17/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~reduxå­¦ä¹ /","link":"","permalink":"https://pheromone.github.io/2019/02/17/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~reduxå­¦ä¹ /","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹redux.å…¶ä¸­,redux: 3.0.0 flutter_redux: 0.5.3","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹redux.å…¶ä¸­,redux: 3.0.0 flutter_redux: 0.5.3ä»£ç ç»“æ„å¦‚å›¾æ‰€ç¤º: ä¸‹é¢æ˜¯å„æ–‡ä»¶çš„æºç .main.dart12345678910111213141516171819202122232425262728293031import &apos;package:flutter/material.dart&apos;;import &apos;package:flutter_redux/flutter_redux.dart&apos;;import &apos;package:redux/redux.dart&apos;;import &apos;package:redux_demo/model/count_state.dart&apos;;import &apos;package:redux_demo/top_screen.dart&apos;;void main() &#123; final store = Store&lt;CountState&gt;(reducer, initialState: CountState.initState()); runApp(new MyApp(store));&#125;class MyApp extends StatelessWidget &#123; final Store&lt;CountState&gt; store; MyApp(this.store); @override Widget build(BuildContext context) &#123; return StoreProvider&lt;CountState&gt;( store: store, child: new MaterialApp( title: &apos;Flutter Demo&apos;, theme: new ThemeData( primarySwatch: Colors.blue, ), home: TopScreen(), ), ); &#125;&#125; tabbar.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110import &apos;package:flutter/material.dart&apos;;import &apos;package:redux_demo/one/one.dart&apos;;import &apos;package:redux_demo/two/two.dart&apos;;class Tabbar extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return new MaterialApp( debugShowCheckedModeBanner: false, home: new MainPageWidget()); &#125;&#125;class MainPageWidget extends StatefulWidget &#123; @override State&lt;StatefulWidget&gt; createState() &#123; return new MainPageState(); &#125;&#125;class MainPageState extends State&lt;MainPageWidget&gt; &#123; int _tabIndex = 0; var tabImages; var appBarTitles = [&apos;One&apos;, &apos;Two&apos;]; /* * å­˜æ”¾äºŒä¸ªé¡µé¢ï¼Œè·ŸfragmentListä¸€æ · */ var _pageList; /* * æ ¹æ®é€‰æ‹©è·å¾—å¯¹åº”çš„normalæˆ–æ˜¯pressçš„icon */ Image getTabIcon(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return tabImages[curIndex][1]; &#125; return tabImages[curIndex][0]; &#125; /* * è·å–bottomTabçš„é¢œè‰²å’Œæ–‡å­— */ Text getTabTitle(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff1296db))); &#125; else &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff515151))); &#125; &#125; /* * æ ¹æ®imageè·¯å¾„è·å–å›¾ç‰‡ */ Image getTabImage(path) &#123; return new Image.asset(path, width: 24.0, height: 24.0); &#125; void initData() &#123; /* * åˆå§‹åŒ–é€‰ä¸­å’Œæœªé€‰ä¸­çš„icon */ tabImages = [ [ getTabImage(&apos;images/tab/one.png&apos;), getTabImage(&apos;images/tab/one_active.png&apos;) ], [ getTabImage(&apos;images/tab/two.png&apos;), getTabImage(&apos;images/tab/two_active.png&apos;) ], ]; /* * å­ç•Œé¢ */ _pageList = [ new One(), new Two(), ]; &#125; @override Widget build(BuildContext context) &#123; //åˆå§‹åŒ–æ•°æ® initData(); return Scaffold( body: _pageList[_tabIndex], bottomNavigationBar: new BottomNavigationBar( items: &lt;BottomNavigationBarItem&gt;[ new BottomNavigationBarItem( icon: getTabIcon(0), title: getTabTitle(0)), new BottomNavigationBarItem( icon: getTabIcon(1), title: getTabTitle(1)), ], type: BottomNavigationBarType.fixed, //é»˜è®¤é€‰ä¸­é¦–é¡µ currentIndex: _tabIndex, iconSize: 24.0, //ç‚¹å‡»äº‹ä»¶ onTap: (index) &#123; setState( () &#123; _tabIndex = index; &#125;, ); &#125;, ), ); &#125;&#125; top_screen.dart1234567891011121314import &apos;package:flutter/material.dart&apos;;import &apos;package:redux_demo/tabbar.dart&apos;;class TopScreen extends StatefulWidget &#123; @override _TopScreenState createState() =&gt; _TopScreenState();&#125;class _TopScreenState extends State&lt;TopScreen&gt; &#123; @override Widget build(BuildContext context) &#123; return Tabbar(); &#125;&#125; count_state.dart12345678910111213141516171819202122232425262728293031import &apos;package:meta/meta.dart&apos;;/* * Stateä¸­æ‰€æœ‰å±æ€§éƒ½åº”è¯¥æ˜¯åªè¯»çš„ */@immutableclass CountState &#123; final int _count; get count =&gt; _count; CountState(this._count); CountState.initState() : _count = 0;&#125;/* * å®šä¹‰æ“ä½œè¯¥Stateçš„å…¨éƒ¨Action * è¿™é‡Œåªæœ‰å¢åŠ countä¸€ä¸ªåŠ¨ä½œ */enum Action &#123; increment &#125;/* * reducerä¼šæ ¹æ®ä¼ è¿›æ¥çš„actionç”Ÿæˆæ–°çš„CountState */CountState reducer(CountState state, action) &#123; //åŒ¹é…Action if (action == Action.increment) &#123; return CountState(state.count + 1); &#125; return state;&#125; one.dart12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849import &apos;package:flutter/material.dart&apos;;import &apos;package:flutter_redux/flutter_redux.dart&apos;;import &apos;package:redux_demo/model/count_state.dart&apos;;class One extends StatefulWidget &#123; @override _OneState createState() =&gt; _OneState();&#125;class _OneState extends State&lt;One&gt; &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar( title: Text(&apos;one Screen&apos;), ), body: Center( child: new Column( mainAxisAlignment: MainAxisAlignment.center, children: &lt;Widget&gt;[ new Text( &apos;You have pushed the button this many times:&apos;, ), StoreConnector&lt;CountState,int&gt;( converter: (store) =&gt; store.state.count, builder: (context, count) &#123; return Text( count.toString(), style: Theme.of(context).textTheme.display1, ); &#125;, ), ], ), ), floatingActionButton: StoreConnector&lt;CountState,VoidCallback&gt;( converter: (store) &#123; return () =&gt; store.dispatch(Action.increment); &#125;, builder: (context, callback) &#123; return FloatingActionButton( onPressed: callback, child: Icon(Icons.add), ); &#125;, ), ); &#125;&#125; two.dart123456789101112131415161718192021222324252627282930import &apos;package:flutter/material.dart&apos;;import &apos;package:flutter_redux/flutter_redux.dart&apos;;import &apos;package:redux_demo/model/count_state.dart&apos;;class Two extends StatefulWidget &#123; @override _TwoState createState() =&gt; _TwoState();&#125;class _TwoState extends State&lt;Two&gt; &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar( title: Text(&apos;two Screen&apos;), ), body: Center( child: StoreConnector&lt;CountState, int&gt;( converter: (store) =&gt; store.state.count, builder: (context, count) &#123; return Text( count.toString(), style: Theme.of(context).textTheme.display1, ); &#125;, ), ), ); &#125;&#125; æ•ˆæœå›¾: æºç å¦å¤–:scoped_modelå­¦ä¹ å¦å¤–:provideå­¦ä¹ å¦å¤–:Flutterå­¦ä¹ demo","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"Flutter~scoped_modelå­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~scoped_modelå­¦ä¹ ","date":"2019-02-15T16:00:00.000Z","updated":"2019-04-22T07:56:01.052Z","comments":true,"path":"2019/02/16/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~scoped_modelå­¦ä¹ /","link":"","permalink":"https://pheromone.github.io/2019/02/16/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~scoped_modelå­¦ä¹ /","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹scoped_model.å…¶ä¸­,scoped_model: 1.0.1","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹scoped_model.å…¶ä¸­,scoped_model: 1.0.1ä»£ç ç»“æ„å¦‚å›¾æ‰€ç¤º: ä¸‹é¢æ˜¯å„æ–‡ä»¶çš„æºç .main.dart123456789101112131415161718192021222324252627import &apos;package:flutter/material.dart&apos;;import &apos;package:scoped_model_demo/model/main_model.dart&apos;;import &apos;package:scoped_model/scoped_model.dart&apos;;import &apos;top_screen.dart&apos;;void main() =&gt; runApp(MyApp());class MyApp extends StatelessWidget &#123; //åˆ›å»ºé¡¶å±‚çŠ¶æ€ MainModel countModel = MainModel(); // This widget is the root of your application. @override Widget build(BuildContext context) &#123; return ScopedModel&lt;MainModel&gt;( model: countModel, child: new MaterialApp( title: &apos;Flutter Demo&apos;, theme: new ThemeData( primarySwatch: Colors.blue, ), home: TopScreen(), ), ); &#125;&#125; tabbar.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100import &apos;package:flutter/material.dart&apos;;import &apos;One/one.dart&apos;;import &apos;Two/two.dart&apos;; class Tabbar extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return new MaterialApp( debugShowCheckedModeBanner: false, home: new MainPageWidget()); &#125;&#125; class MainPageWidget extends StatefulWidget &#123; @override State&lt;StatefulWidget&gt; createState() &#123; return new MainPageState(); &#125;&#125; class MainPageState extends State&lt;MainPageWidget&gt; &#123; int _tabIndex = 0; var tabImages; var appBarTitles = [&apos;One&apos;, &apos;Two&apos;]; /* * å­˜æ”¾äºŒä¸ªé¡µé¢ï¼Œè·ŸfragmentListä¸€æ · */ var _pageList; /* * æ ¹æ®é€‰æ‹©è·å¾—å¯¹åº”çš„normalæˆ–æ˜¯pressçš„icon */ Image getTabIcon(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return tabImages[curIndex][1]; &#125; return tabImages[curIndex][0]; &#125; /* * è·å–bottomTabçš„é¢œè‰²å’Œæ–‡å­— */ Text getTabTitle(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff1296db))); &#125; else &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff515151))); &#125; &#125; /* * æ ¹æ®imageè·¯å¾„è·å–å›¾ç‰‡ */ Image getTabImage(path) &#123; return new Image.asset(path, width: 24.0, height: 24.0); &#125; void initData() &#123; /* * åˆå§‹åŒ–é€‰ä¸­å’Œæœªé€‰ä¸­çš„icon */ tabImages = [ [getTabImage(&apos;images/tab/one.png&apos;), getTabImage(&apos;images/tab/one_active.png&apos;)], [getTabImage(&apos;images/tab/two.png&apos;), getTabImage(&apos;images/tab/two_active.png&apos;)], ]; /* * å­ç•Œé¢ */ _pageList = [ new One(), new Two(), ]; &#125; @override Widget build(BuildContext context) &#123; //åˆå§‹åŒ–æ•°æ® initData(); return Scaffold( body: _pageList[_tabIndex], bottomNavigationBar: new BottomNavigationBar( items: &lt;BottomNavigationBarItem&gt;[ new BottomNavigationBarItem( icon: getTabIcon(0), title: getTabTitle(0)), new BottomNavigationBarItem( icon: getTabIcon(1), title: getTabTitle(1)), ], type: BottomNavigationBarType.fixed, //é»˜è®¤é€‰ä¸­é¦–é¡µ currentIndex: _tabIndex, iconSize: 24.0, //ç‚¹å‡»äº‹ä»¶ onTap: (index) &#123; setState(() &#123; _tabIndex = index; &#125;); &#125;, )); &#125;&#125; top_screen.dart12345678910111213141516171819202122232425262728293031323334import &apos;package:flutter/material.dart&apos;;import &apos;package:scoped_model_demo/model/main_model.dart&apos;;import &apos;package:scoped_model/scoped_model.dart&apos;;import &apos;tabbar.dart&apos;;class TopScreen extends StatefulWidget &#123; @override _TopScreenState createState() =&gt; _TopScreenState();&#125;class _TopScreenState extends State&lt;TopScreen&gt; &#123; //é™æ€è·å–modelç”¨æ³•å®ä¾‹ Model getModel(BuildContext context) &#123; //ç›´æ¥ä½¿ç”¨of final countModel = ScopedModel.of&lt;MainModel&gt;(context); //ä½¿ç”¨CountModelä¸­é‡å†™çš„of final countModel2 = MainModel().of(context); countModel.increment(); countModel2.increment(); return countModel; // return countMode2; &#125; @override Widget build(BuildContext context) &#123; return ScopedModelDescendant&lt;MainModel&gt;( builder: (context,child,model)&#123; return Tabbar(); &#125;, ); &#125;&#125; main_model.dart1234567891011121314import &apos;package:scoped_model/scoped_model.dart&apos;;class MainModel extends Model&#123; int _count = 0; get count =&gt; _count; void increment()&#123; _count++; notifyListeners(); &#125; MainModel of(context) =&gt; ScopedModel.of&lt;MainModel&gt;(context);&#125; one.dart1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import &apos;package:flutter/material.dart&apos;;import &apos;package:scoped_model_demo/model/main_model.dart&apos;;import &apos;package:scoped_model/scoped_model.dart&apos;;class One extends StatefulWidget &#123; @override _OneState createState() =&gt; _OneState();&#125;class _OneState extends State&lt;One&gt; &#123; //é™æ€è·å–modelç”¨æ³•å®ä¾‹ Model getModel(BuildContext context) &#123; //ç›´æ¥ä½¿ç”¨of final countModel = ScopedModel.of&lt;MainModel&gt;(context); //ä½¿ç”¨CountModelä¸­é‡å†™çš„of final countModel2 = MainModel().of(context); countModel.increment(); countModel2.increment(); return countModel; // return countMode2; &#125; @override Widget build(BuildContext context) &#123; return ScopedModelDescendant&lt;MainModel&gt;( builder: (context, child, model) &#123; return Scaffold( appBar: AppBar( title: Text(&apos;One One&apos;), ), body: Center( child: Column( children: &lt;Widget&gt;[ Text( model.count.toString(), style: TextStyle(fontSize: 22.0), ), RaisedButton( child: Text(&apos;åŠ 1&apos;), onPressed: () =&gt; model.increment(), ), ], ), ), ); &#125;, ); &#125;&#125; two.dart123456789101112131415161718192021222324252627282930313233343536373839404142import &apos;package:flutter/material.dart&apos;;import &apos;package:scoped_model_demo/model/main_model.dart&apos;;import &apos;package:scoped_model/scoped_model.dart&apos;;class Two extends StatefulWidget &#123; @override _TwoState createState() =&gt; _TwoState();&#125;class _TwoState extends State&lt;Two&gt; &#123; //é™æ€è·å–modelç”¨æ³•å®ä¾‹ Model getModel(BuildContext context)&#123; //ç›´æ¥ä½¿ç”¨of final countModel = ScopedModel.of&lt;MainModel&gt;(context); //ä½¿ç”¨CountModelä¸­é‡å†™çš„of final countModel2 = MainModel().of(context); countModel.increment(); countModel2.increment(); return countModel; // return countMode2; &#125; @override Widget build(BuildContext context) &#123; return ScopedModelDescendant&lt;MainModel&gt;( builder: (context,child,model)&#123; return Scaffold( appBar: AppBar( title: Text(&apos;Two Screen&apos;), ), body: Center( child: Text( model.count.toString(), style: TextStyle(fontSize: 48.0), ), ) ); &#125;, ); &#125;&#125; æ•ˆæœå›¾: æºç  å¦å¤–:flutter redux å­¦ä¹  å¦å¤–:provideå­¦ä¹  å¦å¤–:Flutterå­¦ä¹ demo","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"React-Nativeæ¨é€é€šçŸ¥è‡³RNä¸”æ˜¾ç¤ºæ¨é€å†…å®¹","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeæ¨é€é€šçŸ¥è‡³RNä¸”æ˜¾ç¤ºæ¨é€å†…å®¹","date":"2018-09-07T16:00:00.000Z","updated":"2019-04-22T07:57:41.531Z","comments":true,"path":"2018/09/08/ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeæ¨é€é€šçŸ¥è‡³RNä¸”æ˜¾ç¤ºæ¨é€å†…å®¹/","link":"","permalink":"https://pheromone.github.io/2018/09/08/ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeæ¨é€é€šçŸ¥è‡³RNä¸”æ˜¾ç¤ºæ¨é€å†…å®¹/","excerpt":"APPæ¨é€æ˜¯åŸºæœ¬çš„è¦æ±‚,ä»Šå¤©è®°å½•ä¸€ä¸‹,å¤§è‡´æ˜¯iOSåŸç”Ÿæ”¶åˆ°æ¨é€åç›´æ¥å‘é€šçŸ¥ç»™RN,RNè¿™è¾¹ç›‘å¬ç€iOSåŸç”Ÿçš„è¿™ä¸ªé€šçŸ¥,ä»¥æ­¤è·å–åˆ°æ¨é€çš„æ¶ˆæ¯.","text":"APPæ¨é€æ˜¯åŸºæœ¬çš„è¦æ±‚,ä»Šå¤©è®°å½•ä¸€ä¸‹,å¤§è‡´æ˜¯iOSåŸç”Ÿæ”¶åˆ°æ¨é€åç›´æ¥å‘é€šçŸ¥ç»™RN,RNè¿™è¾¹ç›‘å¬ç€iOSåŸç”Ÿçš„è¿™ä¸ªé€šçŸ¥,ä»¥æ­¤è·å–åˆ°æ¨é€çš„æ¶ˆæ¯.æ•ˆæœå›¾: å®ç°æ€è·¯ ==&gt;è¿™æ¬¡é‡‡ç”¨çš„å‹ç›Ÿæ¨é€,è‡³äºé‡‡ç”¨ä»€ä¹ˆæ¨é€éƒ½æ˜¯ä¸€æ ·çš„.å‡†å¤‡å·¥ä½œ:iOS é›†æˆæ¨é€,ç¼–å†™ä¸­é—´ç±»,ç”¨äºä¼ å€¼ç»™RN. RN ç•Œé¢å®ç°ç›‘å¬iOSåŸç”Ÿçš„é€šçŸ¥,é€šè¿‡ä»¥ä¸Šè·å–åˆ°æ¨é€çš„å†…å®¹. iOSåŸç”Ÿå‡†å¤‡é›†æˆæ¨é€: â€¦iOSå†™ä¸€ä¸ªä¸­é—´ç±»ä¼ è¾“é€šçŸ¥ç»™RN:CheckInvoice.h 1234567891011121314151617//// CheckInvoice.h// aitepiao//// Created by tc on 2018/8/28.// Copyright Â© 2018å¹´ Facebook. All rights reserved.//#import &lt;Foundation/Foundation.h&gt;#import &lt;React/RCTBridgeModule.h&gt;#import &lt;React/RCTEventEmitter.h&gt;@interface CheckInvoice : RCTEventEmitter&lt;RCTBridgeModule&gt;@end CheckInvoice.m 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556//// CheckInvoice.m// aitepiao//// Created by tc on 2018/8/28.// Copyright Â© 2018å¹´ Facebook. All rights reserved.//#import &quot;CheckInvoice.h&quot;#import &lt;React/RCTEventDispatcher.h&gt;#import &lt;React/RCTBridge.h&gt;static CheckInvoice *_manager = nil;@implementation CheckInvoiceRCT_EXPORT_MODULE()-(instancetype)init&#123; if (self = [super init]) &#123; [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(messageDidReceived:) name:@&quot;didReceiveNotification&quot; object:nil]; &#125; return self;&#125;- (NSArray&lt;NSString *&gt; *)supportedEvents&#123; return @[@&quot;didReceiveNotification&quot;, ];//æœ‰å‡ ä¸ªå°±å†™å‡ ä¸ª&#125;-(void)messageDidReceived:(NSNotification *)notification&#123; NSDictionary *body = notification.object; [self sendEventWithName:@&quot;didReceiveNotification&quot; body:body];&#125;+ (BOOL)requiresMainQueueSetup &#123; return YES;&#125;- (dispatch_queue_t)methodQueue&#123; return dispatch_get_main_queue();&#125;@end ok.ä¼ è¾“ç±»å†™å®Œ.ç„¶ååœ¨AppDelegateé‡Œé¢ç›´æ¥é€šè¿‡é€šçŸ¥ä¼ å³å¯:å¦‚: 12345678910111213141516171819202122232425262728293031323334353637383940// iOS 10ä»¥ä¸Š-(void)userNotificationCenter:(UNUserNotificationCenter *)center willPresentNotification:(UNNotification *)notification withCompletionHandler:(void (^)(UNNotificationPresentationOptions))completionHandler&#123; NSDictionary * userInfo = notification.request.content.userInfo; NSLog(@&quot;iOS 10ä»¥ä¸Š%@&quot;,userInfo); if([notification.request.trigger isKindOfClass:[UNPushNotificationTrigger class]]) &#123; //åº”ç”¨å¤„äºå‰å°æ—¶çš„è¿œç¨‹æ¨é€æ¥å— //å…³é—­U-Pushè‡ªå¸¦çš„å¼¹å‡ºæ¡† [UMessage setAutoAlert:NO]; //å¿…é¡»åŠ è¿™å¥ä»£ç  [UMessage didReceiveRemoteNotification:userInfo]; &#125;else&#123; //åº”ç”¨å¤„äºå‰å°æ—¶çš„æœ¬åœ°æ¨é€æ¥å— &#125; //å½“åº”ç”¨å¤„äºå‰å°æ—¶æç¤ºè®¾ç½®ï¼Œéœ€è¦å“ªä¸ªå¯ä»¥è®¾ç½®å“ªä¸€ä¸ª if (@available(iOS 10.0, *)) &#123; completionHandler(UNNotificationPresentationOptionSound|UNNotificationPresentationOptionBadge|UNNotificationPresentationOptionAlert); &#125; else &#123; // Fallback on earlier versions &#125; [[NSNotificationCenter defaultCenter] postNotificationName:@&quot;didReceiveNotification&quot; object:userInfo];&#125;// æ”¶åˆ°é€šçŸ¥-(void)userNotificationCenter:(UNUserNotificationCenter *)center didReceiveNotificationResponse:(UNNotificationResponse *)response withCompletionHandler:(void (^)(void))completionHandler&#123; NSDictionary * userInfo = response.notification.request.content.userInfo; NSLog(@&quot;iOSå¤–éƒ¨ %@&quot;,userInfo); [[NSNotificationCenter defaultCenter] postNotificationName:@&quot;didReceiveNotification&quot; object:userInfo];&#125;- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo&#123; NSLog(@&quot;iOS 10ä»¥ä¸‹%@&quot;,userInfo); [[NSNotificationCenter defaultCenter] postNotificationName:@&quot;didReceiveNotification&quot; object:userInfo];&#125;- (void)application:(UIApplication *)app didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken&#123; NSLog(@&quot;deviceToken==%@&quot;,[[[[deviceToken description] stringByReplacingOccurrencesOfString: @&quot;&lt;&quot; withString: @&quot;&quot;] stringByReplacingOccurrencesOfString: @&quot;&gt;&quot; withString: @&quot;&quot;] stringByReplacingOccurrencesOfString: @&quot; &quot; withString: @&quot;&quot;]); [UMessage registerDeviceToken:deviceToken];&#125; ok,iOSåŸç”Ÿè¿™è¾¹åŸºæœ¬å®Œæˆ.å‰©ä¸‹RNè¿™è¾¹:å¼•å…¥NativeModuleså’ŒNativeEventEmitterç»„ä»¶å¼•å…¥åŸç”Ÿä¸­é—´ç±» 12const &#123; CheckInvoice &#125; = NativeModules;const checkInvoiceEmitter = new NativeEventEmitter(CheckInvoice); ç„¶åç›´æ¥åœ¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•é‡Œé¢ç›‘å¬iOSé€šçŸ¥å³å¯. 1234567891011componentDidMount() &#123; // ç›‘å¬iOSåŸç”Ÿ UM push ç›‘å¬å¤–éƒ¨é€šçŸ¥ checkInvoiceEmitter.addListener( &apos;didReceiveNotification&apos;, (info) =&gt; &#123; alert(info.aps.alert.body) this.setState(&#123; info:info.aps.alert.body &#125;) &#125; )&#125; æºç :åªæœ‰iOSæ¨é€ Androidä¹Ÿå¦‚æ­¤,é›†æˆæ¨é€.ä¹¦å†™ä¸­é—´ç±»ä¼ é€šçŸ¥ç»™RN. è¿™é‡Œå°±è´´ä¸€ä¸‹æ¡¥æ¥ä»£ç äº†: CommModule.java 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950package com.eazytec.zqtong.gov.baseapp.RN;import android.content.Intent;import android.net.Uri;import android.util.Log;import com.facebook.react.bridge.Callback;import com.facebook.react.bridge.Promise;import com.facebook.react.bridge.ReactApplicationContext;import com.facebook.react.bridge.ReactContextBaseJavaModule;import com.facebook.react.bridge.ReactMethod;import com.facebook.react.modules.core.DeviceEventManagerModule;/** * é€šä¿¡Moduleç±» * Created by Song on 2017/2/17. */public class CommModule extends ReactContextBaseJavaModule &#123; private ReactApplicationContext mContext; public static final String MODULE_NAME = &quot;commModule&quot;; public static final String EVENT_NAME = &quot;EventName&quot;; /** * æ„é€ æ–¹æ³•å¿…é¡»å®ç° * @param reactContext */ public CommModule(ReactApplicationContext reactContext) &#123; super(reactContext); this.mContext = reactContext; &#125; /** * åœ¨rnä»£ç é‡Œé¢æ˜¯éœ€è¦è¿™ä¸ªåå­—æ¥è°ƒç”¨è¯¥ç±»çš„æ–¹æ³• * @return */ @Override public String getName() &#123; return MODULE_NAME; &#125; /** * Nativeè°ƒç”¨RN * @param msg */ public void nativeCallRn(String msg) &#123; mContext.getJSModule(DeviceEventManagerModule.RCTDeviceEventEmitter.class) .emit(EVENT_NAME,msg); &#125;&#125; CommPackage.java 1234567891011121314151617181920212223242526272829303132333435363738394041package com.eazytec.zqtong.gov.baseapp.RN;import com.facebook.react.ReactPackage;import com.facebook.react.bridge.JavaScriptModule;import com.facebook.react.bridge.NativeModule;import com.facebook.react.bridge.ReactApplicationContext;import com.facebook.react.uimanager.ViewManager;import java.util.ArrayList;import java.util.Collections;import java.util.List;/** * é€šä¿¡Moduleç±» * Created by Song on 2017/2/17. */public class CommPackage implements ReactPackage &#123; private static final CommPackage mCommPackage = new CommPackage(); public CommModule mModule; /** * åˆ›å»ºNative Module * @param reactContext * @return */ @Override public List&lt;NativeModule&gt; createNativeModules(ReactApplicationContext reactContext) &#123; List&lt;NativeModule&gt; modules = new ArrayList&lt;&gt;(); mModule = new CommModule(reactContext); modules.add(mModule); return modules; &#125; @Override public List&lt;ViewManager&gt; createViewManagers(ReactApplicationContext reactContext) &#123; return Collections.emptyList(); &#125;&#125; ok.ä¸Šé¢å°±æ˜¯æ¡¥æ¥æ–‡ä»¶.ç„¶ååªéœ€è¦åœ¨è¿”å›é€šçŸ¥ç±»ä¸­å‘é€é€šçŸ¥ç»™RNå³å¯.å¦‚: MainActivity.java 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185package com.eazytec.zqtong.gov.baseapp;import android.app.Application;import android.widget.Toast;import org.json.JSONObject;import com.eazytec.zqtong.gov.baseapp.RN.CommModule;import com.facebook.react.bridge.ReactContextBaseJavaModule;import com.google.gson.Gson;import android.content.Context;import android.util.Log;import com.eazytec.zqtong.gov.baseapp.BuildConfig;import com.learnium.RNDeviceInfo.RNDeviceInfo;import com.facebook.react.ReactApplication;import cn.reactnative.httpcache.HttpCachePackage;import com.facebook.react.ReactNativeHost;import com.facebook.react.ReactPackage;import com.facebook.react.shell.MainReactPackage;import com.facebook.soloader.SoLoader;import com.react.rnspinkit.RNSpinkitPackage;import java.util.Arrays;import java.util.List;import com.imagepicker.ImagePickerPackage;import com.umeng.message.PushAgent;import com.umeng.commonsdk.UMConfigure;import com.umeng.message.IUmengRegisterCallback;import com.umeng.message.MsgConstant;import com.umeng.message.PushAgent;import com.umeng.message.UTrack;import com.umeng.message.UmengMessageHandler;import com.umeng.message.UmengNotificationClickHandler;import com.umeng.message.entity.UMessage;import com.facebook.react.bridge.ReactApplicationContext;import android.provider.Settings;import android.support.annotation.Nullable;import com.facebook.react.bridge.Arguments;import com.facebook.react.bridge.ReactContext;import com.facebook.react.bridge.WritableMap;import com.facebook.react.modules.core.DeviceEventManagerModule;import com.eazytec.zqtong.gov.baseapp.RN.CommPackage;import java.util.List;import android.app.Activity;import android.app.ActivityManager;import android.app.ActivityManager.RunningAppProcessInfo;import android.content.Context;public class MainApplication extends Application implements ReactApplication &#123; //å®šä¹‰ä¸Šä¸‹æ–‡å¯¹è±¡ public static ReactContext myContext; private static final CommPackage mCommPackage = new CommPackage(); private final ReactNativeHost mReactNativeHost = new ReactNativeHost(this) &#123; @Override public boolean getUseDeveloperSupport() &#123; return BuildConfig.DEBUG; &#125; private ReactApplicationContext mContext; @Override protected List&lt;ReactPackage&gt; getPackages() &#123; return Arrays.&lt;ReactPackage&gt;asList( new MainReactPackage(), new HttpCachePackage(), new RNSpinkitPackage(), new RNDeviceInfo(), new ImagePickerPackage(), mCommPackage ); &#125; @Override protected String getJSMainModuleName() &#123; return &quot;index&quot;; &#125; &#125;; @Override public ReactNativeHost getReactNativeHost() &#123; return mReactNativeHost; &#125; //å®šä¹‰å‘é€äº‹ä»¶çš„å‡½æ•° public void sendEvent(ReactContext reactContext, String eventName, @Nullable WritableMap params) &#123; System.out.println(&quot;reactContext=&quot;+reactContext); reactContext .getJSModule(DeviceEventManagerModule.RCTDeviceEventEmitter.class) .emit(eventName,params); &#125; @Override public void onCreate() &#123; super.onCreate(); UMConfigure.setLogEnabled(true); SoLoader.init(this, /* native exopackage */ false); //å‹ç›Ÿ push PushAgent mPushAgent = PushAgent.getInstance(this); UmengMessageHandler messageHandler = new UmengMessageHandler() &#123; /** * é€šçŸ¥çš„å›è°ƒæ–¹æ³•ï¼ˆé€šçŸ¥é€è¾¾æ—¶ä¼šå›è°ƒï¼‰ */ @Override public void dealWithNotificationMessage(Context context, UMessage msg) &#123; //è°ƒç”¨superï¼Œä¼šå±•ç¤ºé€šçŸ¥ï¼Œä¸è°ƒç”¨superï¼Œåˆ™ä¸å±•ç¤ºé€šçŸ¥ã€‚ super.dealWithNotificationMessage(context, msg); Gson gson = new Gson(); // æ¨é€çš„å†…å®¹ Log.i(&quot;msgæ¥äº†å†…å®¹&quot;, msg.text); Log.i(&quot;msgæ¥äº†å¤´&quot;, msg.title); String jsonStr = gson.toJson(msg); Log.i(&quot;å®Œæ•´è¾“å‡º&quot;, jsonStr); mCommPackage.mModule.nativeCallRn(jsonStr); &#125; &#125;; mPushAgent.setMessageHandler(messageHandler); //æ³¨å†Œæ¨é€æœåŠ¡ï¼Œæ¯æ¬¡è°ƒç”¨registeræ–¹æ³•éƒ½ä¼šå›è°ƒè¯¥æ¥å£ mPushAgent.register(new IUmengRegisterCallback() &#123; @Override public void onSuccess(String deviceToken) &#123; //æ³¨å†ŒæˆåŠŸä¼šè¿”å›device token Log.i(deviceToken,&quot;deviceTokenæ¥äº†&quot;); Log.i(deviceToken,deviceToken); &#125; @Override public void onFailure(String s, String s1) &#123; Log.i(s,s); Log.i(s1,s1); &#125; /** * ç¨‹åºæ˜¯å¦åœ¨å‰å°è¿è¡Œ * * @return */ public boolean isAppOnForeground() &#123; // Returns a list of application processes that are running on the // device ActivityManager activityManager = (ActivityManager) getApplicationContext().getSystemService(Context.ACTIVITY_SERVICE); String packageName = getApplicationContext().getPackageName(); List&lt;RunningAppProcessInfo&gt; appProcesses = activityManager .getRunningAppProcesses(); if (appProcesses == null) return false; for (RunningAppProcessInfo appProcess : appProcesses) &#123; // The name of the process that this object is associated with. if (appProcess.processName.equals(packageName) &amp;&amp; appProcess.importance == RunningAppProcessInfo.IMPORTANCE_FOREGROUND) &#123; return true; &#125; &#125; return false; &#125; &#125;); &#125;&#125;","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"React-Nativeç±»ä¼¼æ”¯ä»˜å®çš„åº”ç”¨å¢åˆ æ¨¡å—çš„ç®€å•å®ç°","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeç±»ä¼¼æ”¯ä»˜å®çš„åº”ç”¨å¢åˆ æ¨¡å—çš„ç®€å•å®ç°","date":"2018-08-16T16:00:00.000Z","updated":"2019-04-22T07:57:24.231Z","comments":true,"path":"2018/08/17/ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeç±»ä¼¼æ”¯ä»˜å®çš„åº”ç”¨å¢åˆ æ¨¡å—çš„ç®€å•å®ç°/","link":"","permalink":"https://pheromone.github.io/2018/08/17/ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeç±»ä¼¼æ”¯ä»˜å®çš„åº”ç”¨å¢åˆ æ¨¡å—çš„ç®€å•å®ç°/","excerpt":"é¡¹ç›®ä¸­,æ¶‰åŠåˆ°ç±»ä¼¼æ”¯ä»˜å®çš„åº”ç”¨å¢åˆ æ¨¡å—,è¿™å‡ å¤©ç®€å•çš„å®ç°äº†ä¸‹.åŸºæœ¬é›å½¢å®ç°äº†.åé¢çš„ç»†èŠ‚ç¨åå†åšå¤„ç†.å†™ç¯‡åšå®¢è®°å½•ä¸‹.","text":"é¡¹ç›®ä¸­,æ¶‰åŠåˆ°ç±»ä¼¼æ”¯ä»˜å®çš„åº”ç”¨å¢åˆ æ¨¡å—,è¿™å‡ å¤©ç®€å•çš„å®ç°äº†ä¸‹.åŸºæœ¬é›å½¢å®ç°äº†.åé¢çš„ç»†èŠ‚ç¨åå†åšå¤„ç†.å†™ç¯‡åšå®¢è®°å½•ä¸‹.æ•ˆæœå›¾: å®ç°æ€è·¯ ==&gt;UI: ä¸€å¼€å§‹é‡‡ç”¨å¤–éƒ¨ScrollViewå†…éƒ¨FlatListå’ŒScrollViewå®ç°,åæ¥å‘ç°æœ‰ç‚¹è‡ƒè‚¿,äºæ˜¯é‡‡ç”¨å¤–éƒ¨FlatList,å†…éƒ¨ScrollViewå®ç°.ç„¶åå‘ç°å…¶å®ä»£ç å·®ä¸å¤ªå¤šâ€¦â€¦.æµªè´¹è¡¨æƒ…,å…¶ä¸­ä¾èµ–å‡ ä¸ªä¸‰æ–¹åº“:react-native-scrollable-tab-view,react-native-underline-tabbar.æœ¬æ¥æƒ³ä½¿ç”¨SectionListå®ç°çš„,ä½†æ˜¯æ„Ÿè§‰ä½¿ç”¨SectionListä¼šæ›´éº»çƒ¦.é€»è¾‘: é€šè¿‡æ•°æ®ä¸­ id å’Œ tagå®ç° åºŸè¯ä¸å¤šç¼©,é¦–å…ˆ,æ–°å»ºä¸€ä¸ªé¡¹ç›®,æ·»åŠ ç›¸åº”åº“:ç¬¬ä¸€ç§å®ç°:123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576/** * UI é€šè¿‡ å¤–éƒ¨ScrollView å†…éƒ¨ FlatListæˆ–è€… ScrollView å®ç° (ä½¿ç”¨ä¸‰æ–¹åº“react-native-scrollable-tab-view&amp;&amp;react-native-underline-tabbar) * é€»è¾‘ é€šè¿‡ æ•°æ®ä¸­ id å’Œ tagå®ç° * */import React, &#123; Component &#125; from &apos;react&apos;import &#123; StyleSheet, View, Image, Text, Dimensions, TouchableOpacity, FlatList, Linking, ScrollView&#125; from &apos;react-native&apos;const &#123; width &#125; = Dimensions.get(&apos;window&apos;)import ScrollableTabView from &apos;react-native-scrollable-tab-view&apos;import TabBar from &apos;react-native-underline-tabbar&apos;export default class One extends Component &#123; // æ„é€  constructor(props) &#123; super(props) // åˆå§‹çŠ¶æ€ this.state = &#123; startEdit: false, // æ˜¯å¦ç‚¹å‡»äº†ç¼–è¾‘ é»˜è®¤æœªç‚¹å‡»false myApplyData: [], otherApplyData: [], applyData: [ &#123; title: &apos;æˆ‘çš„åº”ç”¨&apos;, sub: [ &#123; id: &apos;10086&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqgy1fu39hosiwoj30j60qyq96.jpg&apos;, name: &apos;ä»·è´¹é€š10086&apos;, &#125;, &#123; id: &apos;10010&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&apos;, name: &apos;å±•ç¤ºä¸­å¿ƒ10010&apos;, &#125; ], &#125;, &#123; title: &apos;æ”¿åŠ¡æœåŠ¡&apos;, sub: [ &#123; subTitle: &apos;æ”¿ä¼&apos;, sub: [ &#123; id: &apos;10086&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqgy1fu39hosiwoj30j60qyq96.jpg&apos;, name: &apos;ä»·è´¹é€š10086&apos;, tag: true, &#125;, &#123; id: &apos;10010&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&apos;, name: &apos;å±•ç¤ºä¸­å¿ƒ10010&apos;, tag: true, &#125;, &#123; id: &apos;9&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&apos;, name: &apos;åŠäº‹å¹³å°&apos;, tag: false, &#125;, &#123; id: &apos;10&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqgy1ftwcw4f4a5j30sg10j1g9.jpg&apos;, name: &apos;å°‘å„¿å›¾ä¹¦é¦†&apos;, tag: false, &#125;, ], &#125;, &#123; subTitle: &apos;ç¬¬ä¸‰æ–¹æœåŠ¡&apos;, sub: [ &#123; id: &apos;11&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;12&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqgy1ftwcw4f4a5j30sg10j1g9.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;13&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;14&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqgy1ftwcw4f4a5j30sg10j1g9.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;15&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqgy1ftwcw4f4a5j30sg10j1g9.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;16&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftu6gl83ewj30k80tites.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;17&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftu6gl83ewj30k80tites.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;18&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftu6gl83ewj30k80tites.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, ], &#125;, ], &#125;, &#123; title: &apos;æ”¿ä¼åº”ç”¨&apos;, sub: [ &#123; subTitle: &apos;æŒ‰ä¸»é¢˜&apos;, sub: [ &#123; id: &apos;19&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftdtot8zd3j30ju0pt137.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;20&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ft5q7ys128j30sg10gnk5.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, ], &#125;, &#123; subTitle: &apos;æŒ‰éƒ¨é—¨&apos;, sub: [ &#123; id: &apos;21&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftdtot8zd3j30ju0pt137.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, ], &#125;, &#123; subTitle: &apos;æŒ‰è¯ä»¶&apos;, sub: [ &#123; id: &apos;22&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ft5q7ys128j30sg10gnk5.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, ], &#125;, &#123; subTitle: &apos;ä¸»ä½“å‘¨æœŸ&apos;, sub: [ &#123; id: &apos;23&apos;, icon: &apos;http://ww1.sinaimg.cn/large/0065oQSqly1fsoe3k2gkkj30g50niwla.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;24&apos;, icon: &apos;http://ww1.sinaimg.cn/large/0065oQSqly1fsoe3k2gkkj30g50niwla.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, ], &#125;, ], &#125;, ], &#125; &#125; componentDidMount() &#123; var data = this.state.applyData //èµ‹å€¼ æˆ‘çš„åº”ç”¨æ•°æ® this.setState(&#123; myApplyData: data[0].sub, &#125;) //èµ‹å€¼ å…¶ä»–åº”ç”¨æ•°æ® this.setState(&#123; otherApplyData: data.slice(1), &#125;) &#125; /** * ç‚¹å‡»ç¼–è¾‘ * */ editAction = () =&gt; &#123; this.setState(&#123; startEdit:!this.state.startEdit &#125;) &#125; /** * å»é™¤æˆ‘çš„åº”ç”¨ * */ subAction = item =&gt; &#123; var data = this.state.myApplyData // æˆ‘çš„åº”ç”¨æ•°æ® var otherData = this.state.otherApplyData //å…¶ä»–åº”ç”¨æ•°æ® var selectId = item.item.id // é€‰ä¸­çš„id //ä¿®æ”¹æˆ‘çš„åº”ç”¨æ•°æ®æº data.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; data.splice(index,1) &#125; &#125;) //ä¿®æ”¹å…¶ä»–åº”ç”¨æ•°æ®æº otherData.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; item.tag = false &#125; &#125;) &#125;) &#125;) // é‡æ–°èµ‹å€¼ this.setState(&#123; myApplyData:data, otherApplyData:otherData &#125;) &#125; /** * ç‚¹å‡»å…¶ä»–åº”ç”¨ * */ otherAction =(item) =&gt;&#123; var data = this.state.myApplyData // æˆ‘çš„åº”ç”¨æ•°æ® var otherData = this.state.otherApplyData //å…¶ä»–åº”ç”¨æ•°æ® var selectId = item.id //id console.log(item) //æ ¹æ®æ•°æ®ä¸­tagå€¼åˆ¤æ–­ if(item.tag == true)&#123; //åœ¨æˆ‘çš„åº”ç”¨å½“ä¸­,éœ€è¦å»é™¤ data.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; data.splice(index,1) &#125; &#125;) otherData.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; item.tag = false &#125; &#125;) &#125;) &#125;) &#125;else &#123; //ä¸åœ¨æˆ‘çš„åº”ç”¨å½“ä¸­,éœ€è¦æ·»åŠ  data.push(item) otherData.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; item.tag = true &#125; &#125;) &#125;) &#125;) &#125; // é‡æ–°èµ‹å€¼ this.setState(&#123; myApplyData:data, otherApplyData:otherData &#125;) &#125; /** * å»è¯¦æƒ…é¡µé¢ * */ goDetailsAction = item =&gt; &#123; alert(&apos;å»è¯¦æƒ…&apos;) &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &#123;/*æˆ‘çš„åº”ç”¨æ¡-ç¼–è¾‘*/&#125; &lt;MyApplyEdit applyEditData=&#123;this.state.myApplyData&#125; editAction=&#123;() =&gt; &#123; this.editAction() &#125;&#125; /&gt; &lt;ScrollView&gt; &#123;/*æˆ‘çš„åº”ç”¨*/&#125; &lt;View style=&#123;&#123; marginTop: 10, backgroundColor: &apos;#ffffff&apos; &#125;&#125;&gt; &lt;View style=&#123;&#123; flexDirection: &apos;row&apos;, alignItems: &apos;center&apos;, marginTop: 10, &#125;&#125; &gt; &lt;View style=&#123;&#123; marginLeft: 10, width: 8, height: 20, backgroundColor: &apos;blue&apos;, &#125;&#125; /&gt; &lt;Text style=&#123;&#123; marginLeft: 10, fontWeight: &apos;700&apos; &#125;&#125;&gt; æˆ‘çš„åº”ç”¨ &lt;/Text&gt; &lt;/View&gt; &lt;FlatList data=&#123;this.state.myApplyData&#125; style=&#123;&#123; marginBottom: 20 &#125;&#125; renderItem=&#123;item =&gt; this.renderMyApplyRow(item)&#125; keyExtractor=&#123;this.keyMyApplyExtractor&#125; numColumns=&#123;4&#125; /&gt; &lt;/View&gt; &#123;/*å…¶ä»–åº”ç”¨*/&#125; &#123;this.state.otherApplyData.map((item, index) =&gt; ( &lt;View key=&#123;index&#125;&gt; &#123;/*æ ‡é¢˜*/&#125; &lt;View style=&#123;&#123; paddingTop: 10, alignItems: &apos;center&apos;, backgroundColor: &apos;white&apos;, flexDirection: &apos;row&apos;, alignItems: &apos;center&apos;, marginTop: 10, &#125;&#125; &gt; &lt;View style=&#123;&#123; marginLeft: 10, width: 8, height: 20, backgroundColor: &apos;blue&apos;, &#125;&#125; /&gt; &lt;Text style=&#123;&#123; marginLeft: 10, fontWeight: &apos;700&apos; &#125;&#125;&gt; &#123;item.title&#125; &lt;/Text&gt; &lt;/View&gt; &#123;/*ä¸»ä½“å†…å®¹*/&#125; &lt;ScrollableTabView style=&#123;&#123; backgroundColor: &apos;white&apos; &#125;&#125; tabBarActiveTextColor=&quot;#118EE9&quot; renderTabBar=&#123;() =&gt; &lt;TabBar underlineColor=&quot;#118EE9&quot; /&gt;&#125; &gt; &#123;item.sub.map((item, index) =&gt; ( &lt;View key=&#123;index&#125; tabLabel=&#123;&#123; label: item.subTitle &#125;&#125;&gt; &lt;ScrollView&gt; &lt;View style=&#123;&#123; flexDirection: &apos;row&apos;, height: 250, flexWrap: &apos;wrap&apos;, &#125;&#125; &gt; &#123;item.sub.map((item, index) =&gt; ( &lt;TouchableOpacity key=&#123;index&#125; onPress=&#123;() =&gt; this.goDetailsAction(item)&#125; &gt; &lt;View style=&#123;&#123; marginTop: 25 &#125;&#125;&gt; &lt;Image style=&#123;&#123; width: 55, height: 55, marginLeft: (width - 55 * 4) / 8, marginRight: (width - 55 * 4) / 8, &#125;&#125; source=&#123;&#123; uri: item.icon &#125;&#125; /&gt; &lt;Text style=&#123;&#123; alignSelf: &apos;center&apos;, marginTop: 15, marginBottom: 10, &#125;&#125; &gt; &#123;item.name&#125; &lt;/Text&gt; &lt;TouchableOpacity style=&#123;&#123; position: &apos;absolute&apos;, top: -10, right: 10, &#125;&#125; onPress=&#123;() =&gt; this.otherAction(item)&#125; &gt; &lt;Image source=&#123; item.tag ? require(&apos;./image/sub.png&apos;) : require(&apos;./image/add.png&apos;) &#125; style=&#123;&#123; opacity: this.state.startEdit ? 1 : 0, width: 15, height: 15, &#125;&#125; /&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; &lt;/TouchableOpacity&gt; ))&#125; &lt;/View&gt; &lt;/ScrollView&gt; &lt;/View&gt; ))&#125; &lt;/ScrollableTabView&gt; &lt;/View&gt; ))&#125; &lt;/ScrollView&gt; &lt;/View&gt; ) &#125; //-------------------------------æˆ‘çš„åº”ç”¨start -------------------------------- /** * æˆ‘çš„åº”ç”¨render * */ renderMyApplyRow = item =&gt; ( &lt;TouchableOpacity onPress=&#123;() =&gt; this.goDetailsAction(item)&#125;&gt; &lt;View style=&#123;&#123; marginTop: 25 &#125;&#125;&gt; &lt;Image style=&#123;&#123; width: 55, height: 55, marginLeft: (width - 55 * 4) / 8, marginRight: (width - 55 * 4) / 8, &#125;&#125; source=&#123;&#123; uri: item.item.icon &#125;&#125; /&gt; &lt;Text style=&#123;&#123; alignSelf: &apos;center&apos;, marginTop: 15, marginBottom: 10 &#125;&#125;&gt; &#123;item.item.name&#125; &lt;/Text&gt; &lt;TouchableOpacity style=&#123;&#123; position: &apos;absolute&apos;, top: -10, right: 10 &#125;&#125; onPress=&#123;() =&gt; this.subAction(item)&#125; &gt; &lt;Image source=&#123;require(&apos;./image/sub.png&apos;)&#125; style=&#123;&#123; opacity: this.state.startEdit ? 1 : 0, width: 15, height: 15, &#125;&#125; /&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; &lt;/TouchableOpacity&gt; ) // ä½¿ç”¨jsonä¸­çš„keyåŠ¨æ€ç»‘å®škey keyMyApplyExtractor = item =&gt; item.id //-------------------------------æˆ‘çš„åº”ç”¨end --------------------------------&#125;// ä¸Šæ–¹çš„ç¼–è¾‘ æˆ‘çš„åº”ç”¨æ¡† UIclass MyApplyEdit extends React.Component &#123; render() &#123; const &#123; applyEditData &#125; = this.props return ( &lt;View style=&#123;&#123; paddingTop: 5, paddingBottom: 5, alignItems: &apos;center&apos;, flexDirection: &apos;row&apos;, backgroundColor: &apos;#ffffff&apos;, &#125;&#125; &gt; &lt;Text style=&#123;&#123; marginLeft: 10, fontWeight: &apos;700&apos; &#125;&#125;&gt;æˆ‘çš„åº”ç”¨&lt;/Text&gt; &lt;ScrollView showsHorizontalScrollIndicator=&#123;false&#125; showsVerticalScrollIndicator=&#123;false&#125; horizontal=&#123;true&#125; style=&#123;&#123; marginRight: 15 &#125;&#125; &gt; &#123;applyEditData.map((item, index) =&gt; ( &lt;Image key=&#123;index&#125; style=&#123;&#123; width: 30, height: 30, marginLeft: 10 &#125;&#125; source=&#123;&#123; uri: item.icon &#125;&#125; /&gt; ))&#125; &lt;/ScrollView&gt; &lt;TouchableOpacity onPress=&#123;() =&gt; this.props.editAction()&#125;&gt; &lt;View style=&#123;&#123; borderRadius: 4, marginRight: 10, paddingTop: 5, paddingBottom: 5, paddingLeft: 10, paddingRight: 10, borderWidth: 1, borderColor: &apos;blue&apos;, &#125;&#125; &gt; &lt;Text style=&#123;&#123; color: &apos;blue&apos; &#125;&#125;&gt;ç¼–è¾‘&lt;/Text&gt; &lt;/View&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; ) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, &#125;, icon: &#123; width: 22, height: 22, &#125;,&#125;) ç¬¬äºŒç§å®ç°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569/** * UI é€šè¿‡ å¤–éƒ¨FlatList å†…éƒ¨ ScrollView + view å®ç° (ä½¿ç”¨ä¸‰æ–¹åº“react-native-scrollable-tab-view&amp;&amp;react-native-underline-tabbar) * é€»è¾‘ é€šè¿‡ æ•°æ®ä¸­ id å’Œ tagå®ç° * */import React, &#123; Component &#125; from &apos;react&apos;import &#123; StyleSheet, View, Image, Text, Dimensions, TouchableOpacity, FlatList, Linking, ScrollView&#125; from &apos;react-native&apos;const &#123; width &#125; = Dimensions.get(&apos;window&apos;)import ScrollableTabView from &apos;react-native-scrollable-tab-view&apos;import TabBar from &apos;react-native-underline-tabbar&apos;export default class Two extends Component &#123; // æ„é€  constructor(props) &#123; super(props) // åˆå§‹çŠ¶æ€ this.state = &#123; startEdit: false, // æ˜¯å¦ç‚¹å‡»äº†ç¼–è¾‘ é»˜è®¤æœªç‚¹å‡»false myApplyData: [], otherApplyData: [], applyData: [ &#123; title: &apos;æˆ‘çš„åº”ç”¨&apos;, sub: [ &#123; id: &apos;10086&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqgy1fu39hosiwoj30j60qyq96.jpg&apos;, name: &apos;ä»·è´¹é€š10086&apos;, &#125;, &#123; id: &apos;10010&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&apos;, name: &apos;å±•ç¤ºä¸­å¿ƒ10010&apos;, &#125; ], &#125;, &#123; title: &apos;æ”¿åŠ¡æœåŠ¡&apos;, sub: [ &#123; subTitle: &apos;æ”¿ä¼&apos;, sub: [ &#123; id: &apos;10086&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqgy1fu39hosiwoj30j60qyq96.jpg&apos;, name: &apos;ä»·è´¹é€š10086&apos;, tag: true, &#125;, &#123; id: &apos;10010&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&apos;, name: &apos;å±•ç¤ºä¸­å¿ƒ10010&apos;, tag: true, &#125;, &#123; id: &apos;9&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&apos;, name: &apos;åŠäº‹å¹³å°&apos;, tag: false, &#125;, &#123; id: &apos;10&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqgy1ftwcw4f4a5j30sg10j1g9.jpg&apos;, name: &apos;å°‘å„¿å›¾ä¹¦é¦†&apos;, tag: false, &#125;, ], &#125;, &#123; subTitle: &apos;ç¬¬ä¸‰æ–¹æœåŠ¡&apos;, sub: [ &#123; id: &apos;11&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;12&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqgy1ftwcw4f4a5j30sg10j1g9.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;13&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;14&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqgy1ftwcw4f4a5j30sg10j1g9.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;15&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqgy1ftwcw4f4a5j30sg10j1g9.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;16&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftu6gl83ewj30k80tites.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;17&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftu6gl83ewj30k80tites.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;18&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftu6gl83ewj30k80tites.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, ], &#125;, ], &#125;, &#123; title: &apos;æ”¿ä¼åº”ç”¨&apos;, sub: [ &#123; subTitle: &apos;æŒ‰ä¸»é¢˜&apos;, sub: [ &#123; id: &apos;19&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftdtot8zd3j30ju0pt137.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;20&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ft5q7ys128j30sg10gnk5.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, ], &#125;, &#123; subTitle: &apos;æŒ‰éƒ¨é—¨&apos;, sub: [ &#123; id: &apos;21&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ftdtot8zd3j30ju0pt137.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, ], &#125;, &#123; subTitle: &apos;æŒ‰è¯ä»¶&apos;, sub: [ &#123; id: &apos;22&apos;, icon: &apos;https://ww1.sinaimg.cn/large/0065oQSqly1ft5q7ys128j30sg10gnk5.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, ], &#125;, &#123; subTitle: &apos;ä¸»ä½“å‘¨æœŸ&apos;, sub: [ &#123; id: &apos;23&apos;, icon: &apos;http://ww1.sinaimg.cn/large/0065oQSqly1fsoe3k2gkkj30g50niwla.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, &#123; id: &apos;24&apos;, icon: &apos;http://ww1.sinaimg.cn/large/0065oQSqly1fsoe3k2gkkj30g50niwla.jpg&apos;, name: &apos;ä»·è´¹é€š&apos;, tag: false, &#125;, ], &#125;, ], &#125;, ], &#125; &#125; componentDidMount() &#123; var data = this.state.applyData //èµ‹å€¼ æˆ‘çš„åº”ç”¨æ•°æ® this.setState(&#123; myApplyData: data[0].sub, &#125;) //èµ‹å€¼ å…¶ä»–åº”ç”¨æ•°æ® this.setState(&#123; otherApplyData: data.slice(1), &#125;) &#125; render() &#123; return ( &lt;View&gt; &#123;/*æˆ‘çš„åº”ç”¨æ¡-ç¼–è¾‘*/&#125; &lt;MyApplyEdit applyEditData=&#123;this.state.myApplyData&#125; editAction=&#123;() =&gt; &#123; this.editAction() &#125;&#125; /&gt; &#123;/*åº”ç”¨åˆ—è¡¨*/&#125; &lt;FlatList data=&#123;this.state.otherApplyData&#125; style=&#123;&#123; marginBottom: 20 &#125;&#125; ListHeaderComponent=&#123;this.ListHeaderComponent&#125; renderItem=&#123;item =&gt; this.renderItem(item)&#125; keyExtractor=&#123;this.keyExtractor&#125; /&gt; &lt;/View&gt; ) &#125; /** * å»è¯¦æƒ… * */ goDetailsAction =(item) =&gt;&#123; alert(&apos;å»è¯¦æƒ…&apos;) &#125; /** * å»é™¤æˆ‘çš„åº”ç”¨ * */ subAction = item =&gt; &#123; var data = this.state.myApplyData // æˆ‘çš„åº”ç”¨æ•°æ® var otherData = this.state.otherApplyData //å…¶ä»–åº”ç”¨æ•°æ® var selectId = item.id // é€‰ä¸­çš„id //ä¿®æ”¹æˆ‘çš„åº”ç”¨æ•°æ®æº data.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; data.splice(index,1) &#125; &#125;) //ä¿®æ”¹å…¶ä»–åº”ç”¨æ•°æ®æº otherData.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; item.tag = false &#125; &#125;) &#125;) &#125;) // é‡æ–°èµ‹å€¼ this.setState(&#123; myApplyData:data, otherApplyData:otherData &#125;) &#125; /** * ç‚¹å‡»å…¶ä»–åº”ç”¨ * */ otherAction =(item) =&gt;&#123; var data = this.state.myApplyData // æˆ‘çš„åº”ç”¨æ•°æ® var otherData = this.state.otherApplyData //å…¶ä»–åº”ç”¨æ•°æ® var selectId = item.id //id console.log(item) //æ ¹æ®æ•°æ®ä¸­tagå€¼åˆ¤æ–­ if(item.tag == true)&#123; //åœ¨æˆ‘çš„åº”ç”¨å½“ä¸­,éœ€è¦å»é™¤ data.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; data.splice(index,1) &#125; &#125;) otherData.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; item.tag = false &#125; &#125;) &#125;) &#125;) &#125;else &#123; //ä¸åœ¨æˆ‘çš„åº”ç”¨å½“ä¸­,éœ€è¦æ·»åŠ  data.push(item) otherData.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; item.tag = true &#125; &#125;) &#125;) &#125;) &#125; // é‡æ–°èµ‹å€¼ this.setState(&#123; myApplyData:data, otherApplyData:otherData &#125;) &#125; ListHeaderComponent =()=&gt;&#123; var data = this.state.myApplyData return( &lt;View style=&#123;&#123;marginTop:10&#125;&#125;&gt; &lt;HeaderView title=&apos;æˆ‘çš„åº”ç”¨&apos;/&gt; &lt;View style=&#123;&#123;flexDirection:&apos;row&apos;,backgroundColor:&apos;#ffffff&apos;&#125;&#125;&gt; &#123; data.map((item,index) =&gt;( &lt;TouchableOpacity key=&#123;index&#125; onPress=&#123;() =&gt; this.goDetailsAction(item)&#125;&gt; &lt;View style=&#123;&#123; marginTop: 25 &#125;&#125;&gt; &lt;Image style=&#123;&#123; width: 55, height: 55, marginLeft: (width - 55 * 4) / 8, marginRight: (width - 55 * 4) / 8, &#125;&#125; source=&#123;&#123; uri: item.icon &#125;&#125; /&gt; &lt;Text style=&#123;&#123; alignSelf: &apos;center&apos;, marginTop: 15, marginBottom: 10 &#125;&#125;&gt; &#123;item.name&#125; &lt;/Text&gt; &lt;TouchableOpacity style=&#123;&#123; position: &apos;absolute&apos;, top: -10, right: 10 &#125;&#125; onPress=&#123;() =&gt; this.subAction(item)&#125; &gt; &lt;Image source=&#123;require(&apos;./image/sub.png&apos;)&#125; style=&#123;&#123; opacity: this.state.startEdit ? 1 : 0, width: 15, height: 15, &#125;&#125; /&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; &lt;/TouchableOpacity&gt; )) &#125; &lt;/View&gt; &lt;/View&gt; ) &#125; renderItem =(item)=&gt;&#123; console.log(item) return( &lt;View style=&#123;&#123;marginTop:10&#125;&#125;&gt; &lt;HeaderView title=&#123;item.item.title&#125;/&gt; &lt;ScrollableTabView style=&#123;&#123; backgroundColor: &apos;white&apos; &#125;&#125; tabBarActiveTextColor=&quot;#118EE9&quot; renderTabBar=&#123;() =&gt; &lt;TabBar underlineColor=&quot;#118EE9&quot; /&gt;&#125; &gt; &#123;item.item.sub.map((item, index) =&gt; ( &lt;View key=&#123;index&#125; tabLabel=&#123;&#123; label: item.subTitle &#125;&#125;&gt; &lt;ScrollView&gt; &lt;View style=&#123;&#123; flexDirection: &apos;row&apos;, height: 250, flexWrap: &apos;wrap&apos;, &#125;&#125; &gt; &#123;item.sub.map((item, index) =&gt; ( &lt;TouchableOpacity key=&#123;index&#125; onPress=&#123;() =&gt; this.goDetailsAction(item)&#125; &gt; &lt;View style=&#123;&#123; marginTop: 25 &#125;&#125;&gt; &lt;Image style=&#123;&#123; width: 55, height: 55, marginLeft: (width - 55 * 4) / 8, marginRight: (width - 55 * 4) / 8, &#125;&#125; source=&#123;&#123; uri: item.icon &#125;&#125; /&gt; &lt;Text style=&#123;&#123; alignSelf: &apos;center&apos;, marginTop: 15, marginBottom: 10, &#125;&#125; &gt; &#123;item.name&#125; &lt;/Text&gt; &lt;TouchableOpacity style=&#123;&#123; position: &apos;absolute&apos;, top: -10, right: 10, &#125;&#125; onPress=&#123;() =&gt; this.otherAction(item)&#125; &gt; &lt;Image source=&#123; item.tag ? require(&apos;./image/sub.png&apos;) : require(&apos;./image/add.png&apos;) &#125; style=&#123;&#123; opacity: this.state.startEdit ? 1 : 0, width: 15, height: 15, &#125;&#125; /&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; &lt;/TouchableOpacity&gt; ))&#125; &lt;/View&gt; &lt;/ScrollView&gt; &lt;/View&gt; ))&#125; &lt;/ScrollableTabView&gt; &lt;/View&gt; ) &#125; keyExtractor = item =&gt; item.title /** * ç‚¹å‡»ç¼–è¾‘ * */ editAction = () =&gt; &#123; this.setState(&#123; startEdit:!this.state.startEdit &#125;) &#125;&#125;// ä¸Šæ–¹çš„ç¼–è¾‘ æˆ‘çš„åº”ç”¨æ¡† UIclass MyApplyEdit extends React.Component &#123; render() &#123; const &#123; applyEditData &#125; = this.props return ( &lt;View style=&#123;&#123; paddingTop: 5, paddingBottom: 5, alignItems: &apos;center&apos;, flexDirection: &apos;row&apos;, backgroundColor: &apos;#ffffff&apos;, &#125;&#125; &gt; &lt;Text style=&#123;&#123; marginLeft: 10, fontWeight: &apos;700&apos; &#125;&#125;&gt;æˆ‘çš„åº”ç”¨&lt;/Text&gt; &lt;ScrollView showsHorizontalScrollIndicator=&#123;false&#125; showsVerticalScrollIndicator=&#123;false&#125; horizontal=&#123;true&#125; style=&#123;&#123; marginRight: 15 &#125;&#125; &gt; &#123;applyEditData.map((item, index) =&gt; ( &lt;Image key=&#123;index&#125; style=&#123;&#123; width: 30, height: 30, marginLeft: 10 &#125;&#125; source=&#123;&#123; uri: item.icon &#125;&#125; /&gt; ))&#125; &lt;/ScrollView&gt; &lt;TouchableOpacity onPress=&#123;() =&gt; this.props.editAction()&#125;&gt; &lt;View style=&#123;&#123; borderRadius: 4, marginRight: 10, paddingTop: 5, paddingBottom: 5, paddingLeft: 10, paddingRight: 10, borderWidth: 1, borderColor: &apos;blue&apos;, &#125;&#125; &gt; &lt;Text style=&#123;&#123; color: &apos;blue&apos; &#125;&#125;&gt;ç¼–è¾‘&lt;/Text&gt; &lt;/View&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; ) &#125;&#125;// å¤´è§†å›¾class HeaderView extends React.Component &#123; render() &#123; const &#123; title &#125; = this.props return ( &lt;View style=&#123;&#123; backgroundColor:&apos;#ffffff&apos;, flexDirection: &apos;row&apos;, alignItems: &apos;center&apos;, paddingTop:10 &#125;&#125; &gt; &lt;View style=&#123;&#123; marginLeft: 10, width: 8, height: 20, backgroundColor: &apos;blue&apos;, &#125;&#125; /&gt; &lt;Text style=&#123;&#123; marginLeft: 10, fontWeight: &apos;700&apos; &#125;&#125;&gt; &#123;title&#125; &lt;/Text&gt; &lt;/View&gt; ) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, &#125;, icon: &#123; width: 22, height: 22, &#125;,&#125;) ä»¥åå°±æ˜¯ä¸¤ç§å®ç°,åŸºæœ¬çš„åŠŸèƒ½å®ç°äº†,è‡³äºç»†èŠ‚ä¼˜åŒ–ç‚¹ç­‰æ—¥åæ…¢æ…¢å†åšå§.æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"React-Native\"æ”¶èµ·-å±•å¼€\"åŠŸèƒ½å®ç°","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /React-Native<æ”¶èµ·-å±•å¼€>åŠŸèƒ½å®ç°","date":"2018-08-10T16:00:00.000Z","updated":"2019-04-22T07:57:09.160Z","comments":true,"path":"2018/08/11/ç§»åŠ¨ç«¯å­¦ä¹ /React-Native<æ”¶èµ·-å±•å¼€>åŠŸèƒ½å®ç°/","link":"","permalink":"https://pheromone.github.io/2018/08/11/ç§»åŠ¨ç«¯å­¦ä¹ /React-Native<æ”¶èµ·-å±•å¼€>åŠŸèƒ½å®ç°/","excerpt":"è¿‘æ¥å…¬å¸çš„é¡¹ç›®é‡Œé¢æ¶‰åŠåˆ°ä¸€ä¸ªç±»ä¼¼â€æ”¶èµ·-å±•å¼€â€çš„UIåŠŸèƒ½æ¨¡å—,å…ˆæ˜¯åœ¨ç½‘ä¸ŠçŒ¥çä¸€ç•ªä¹‹å,å¹¶æœªå‘ç°ä»€ä¹ˆ.æ— å¥ˆä¹‹ä¸‹,åªèƒ½è‡ªå·±æ‰‹æ’¸ä¸€ä¸ªäº†.","text":"è¿‘æ¥å…¬å¸çš„é¡¹ç›®é‡Œé¢æ¶‰åŠåˆ°ä¸€ä¸ªç±»ä¼¼â€æ”¶èµ·-å±•å¼€â€çš„UIåŠŸèƒ½æ¨¡å—,å…ˆæ˜¯åœ¨ç½‘ä¸ŠçŒ¥çä¸€ç•ªä¹‹å,å¹¶æœªå‘ç°ä»€ä¹ˆ.æ— å¥ˆä¹‹ä¸‹,åªèƒ½è‡ªå·±æ‰‹æ’¸ä¸€ä¸ªäº†.ä¸€å¼€å§‹åšäº†ä¸ªâ€äº’æ–¥æ”¶èµ·-å±•å¼€â€,å…¬å¸å¯èƒ½ä¸å¤ªæ»¡æ„,è®©æˆ‘æŠ„å¦å¤–ä¸€ä¸ªAPPâ€éäº’æ–¥æ”¶èµ·-å±•å¼€â€,å“â€¦å…ˆä¸Šå›¾:éäº’æ–¥ç¼©ä¸€ç¼© äº’æ–¥ç¼©ä¸€ç¼© å®ç°åŸç†å¾ˆç®€å•:éäº’æ–¥ç¼©ä¸€ç¼©: å…ˆåœ¨jsonæ•°æ®é‡Œé¢å®šä¹‰typeæ ‡ç¤º,æ ‡ç¤ºä¸€çº§å±•å¼€|æ”¶èµ·çŠ¶æ€,åœ¨UIé‡Œé¢å°±æ ¹æ®è¿™ä¸ªæ ‡ç¤ºåˆ¤æ–­æ˜¯æ”¶èµ·è¿˜æ˜¯å±•å¼€,è€ŒäºŒçº§æ”¶èµ·|å±•å¼€éœ€è¦ä¸ºæ¯ç»„æ•°æ®å®šä¹‰ä¸€ä¸ªå”¯ä¸€æ ‡ç¤º.äº’æ–¥ç¼©ä¸€ç¼©:å…ˆå®šä¹‰ä¸€ä¸ªstate,æ ¹æ®è¯¥stateæ¥æ˜¾ç¤ºæ”¶èµ·UIè¿˜æ˜¯å±•å¼€,å› ä¸ºstateåªæœ‰ä¸€ä¸ª,ä¹Ÿå°±å½¢æˆäº†åªæœ‰ä¸€ç»„æ˜¯å±•å¼€.åŒæ—¶,åœ¨åˆ¤æ–­äºŒæ¬¡å±•å¼€|æ”¶èµ·è¿™é‡Œä¹Ÿéœ€è¦åœ¨jsoné‡Œé¢å®šä¹‰ä¸€ä¸ªå”¯ä¸€æ ‡ç¤º.è¿™äº›æ•°æ®æ ‡ç¤ºå¯ä»¥äº‹å…ˆå’Œåç«¯äººå‘˜å•†é‡å¥½,è®©åç«¯äººå‘˜å¸®ä½ å¼„å¥½,ä¹Ÿå¯ä»¥è‡ªå·±æ‹¿åˆ°æ•°æ®ä¹‹åå†æ’å…¥.åºŸè¯ä¸å¤šå°‘,æˆ´èµ·ç£¨ç ‚æ‰‹å¥—å¼€å§‹æ’¸!!!ç›´æ¥ä¸Šæºç :éäº’æ–¥ç¼©ä¸€ç¼©123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302/* eslint-disable */import React, &#123; Component &#125; from &apos;react&apos;import &#123; StyleSheet, View, Image, Text, Dimensions, TouchableOpacity, FlatList, Linking,&#125; from &apos;react-native&apos;const &#123; width &#125; = Dimensions.get(&apos;window&apos;)export default class One extends Component &#123; // æ„é€  constructor(props) &#123; super(props) // åˆå§‹çŠ¶æ€ this.row = null this.state = &#123; governmentData: [ &#123; id: &apos;0&apos;, name: &apos;ç¤¾ä¼šä¿éšœå±€&apos;, type: false, childs: [ &#123; index: &apos;00&apos;, name: &apos;èµ„æ–™æ•™å®¤&apos;, type: false, tel: &apos;5233&apos;, message: &apos;æŸ¥è¯¢èµ„æ–™,æ³¨é”€æ¡£æ¡ˆ&apos;, &#125;, &#123; name: &apos;åå‹¤éƒ¨&apos;, type: false, index: &apos;01&apos;, tel: &apos;1645682&apos;, message: &apos;ä¸å¯¹å¤–æœåŠ¡&apos;, &#125;, ], &#125;, &#123; id: &apos;1&apos;, name: &apos;å«ç”Ÿå±€&apos;, type: false, childs: [ &#123; name: &apos;å¦‡äº§ç§‘&apos;, type: false, index: &apos;10&apos;, tel: &apos;112è½¬678&apos;, message: &apos;æ¥å¾…å­•å¦‡,å¾…äº§å­•å¦‡,å†›å«‚é¢„å…ˆ&apos;, &#125;, &#123; name: &apos;å„¿ç§‘&apos;, type: false, index: &apos;11&apos;, tel: &apos;112è½¬008&apos;, message: &apos;å°äº12å‘¨å²å„¿ç«¥å°±åŒ»&apos;, &#125;, &#123; name: &apos;å¤±æ‹ç§‘&apos;, type: false, index: &apos;12&apos;, tel: &apos;112è½¬å‡ºå»&apos;, message: &apos;å›å®¶ç©è›‹å»!!!&apos;, &#125;, ], &#125;, &#123; id: &apos;2&apos;, name: &apos;ç¥ç›¾å±€&apos;, type: false, childs: [ &#123; name: &apos;åŸç®¡å¤§é˜Ÿ&apos;, type: false, index: &apos;20&apos;, tel: &apos;110&apos;, title: &apos;æ‰“æ‰“æ‰“&apos;, message: &apos;é•‡å‹èµ·ä¹‰&apos;, &#125;, ], &#125;, ], isRefresh: true, index: -1, //é»˜è®¤å±•å¼€è´Ÿä¸€è¡Œ indexIndex: -1, &#125; &#125; componentDidMount() &#123; this.flatlist = null this.setState(&#123; isRefresh: false, &#125;) &#125; /** * ä¸‹æ‹‰åˆ·æ–° * */ onRefresh = () =&gt; &#123; this.setState(&#123; isRefresh: false, &#125;) &#125; /** * ç‚¹å‡»ä¸€çº§ * */ itemOnclick = item =&gt; &#123; var data = this.state.governmentData data.map((itemm, i) =&gt; &#123; if (i == item.index) &#123; itemm.type = !itemm.type &#125; &#125;) this.setState(&#123; governmentData: data, &#125;) &#125; /** * ç‚¹å‡»äºŒçº§ * */ itemitemOnclick = e =&gt; &#123; var data = this.state.governmentData data.map((item, index) =&gt; &#123; item.childs.map((item, index) =&gt; &#123; if (item.index == e.index) &#123; item.type = !item.type &#125; &#125;) &#125;) this.setState(&#123; governmentData: data, &#125;) &#125; /** * æ‰“ç”µè¯ * */ tellPhone = item =&gt; &#123; Linking.openURL(`tel:$&#123;item.tel&#125;`) &#125; /** * FlatList render * */ renderRow = item =&gt; ( &lt;View ref=&#123;item.index&#125;&gt; &lt;View&gt; &lt;TouchableOpacity onPress=&#123;() =&gt; this.itemOnclick(item)&#125;&gt; &lt;View style=&#123;&#123; flexDirection: &apos;row&apos;, backgroundColor: &apos;white&apos;, height: 30, alignItems: &apos;center&apos;, &#125;&#125; &gt; &lt;View style=&#123;&#123; marginLeft: 5, width: 4, height: 10, paddingTop: 7, paddingBottom: 7, backgroundColor:&apos;red&apos; &#125;&#125; /&gt; &lt;Text style=&#123;&#123; color: &apos;#333333&apos;, marginLeft: 5, fontSize: 16 &#125;&#125;&gt; &#123;item.item.name&#125; &lt;/Text&gt; &#123;/* å³è¾¹ç®­å¤´ */&#125; &lt;Image source=&#123; item.item.type ? require(&apos;./image/btnDown.png&apos;) : require(&apos;./image/right.png&apos;) &#125; style=&#123;&#123; position: &apos;absolute&apos;, right: 15, width: 15, height: 15 &#125;&#125; /&gt; &lt;/View&gt; &lt;/TouchableOpacity&gt; &lt;View style=&#123;&#123; backgroundColor: &apos;rgb(228,228,228)&apos;, width: width, height: 1, &#125;&#125; /&gt; &lt;/View&gt; &#123;item.item.type ? item.item.childs.map((item, index) =&gt; ( &lt;View style=&#123;&#123; backgroundColor: &apos;white&apos; &#125;&#125; key=&#123;index&#125;&gt; &lt;View style=&#123;&#123; marginLeft: 7, marginTop: 10 &#125;&#125;&gt; &lt;View style=&#123;&#123; flexDirection: &apos;row&apos; &#125;&#125;&gt; &lt;Image source=&#123; item.type ? require(&apos;./image/btnDownB.png&apos;) : require(&apos;./image/btnRightB.png&apos;) &#125; style=&#123;&#123; width: 10, height: 10 &#125;&#125; /&gt; &lt;Text onPress=&#123;() =&gt; this.itemitemOnclick(item)&#125; style=&#123;&#123; marginLeft: 7 &#125;&#125; &gt; &#123;item.name&#125; &lt;/Text&gt; &lt;/View&gt; &lt;View style=&#123;&#123; backgroundColor: &apos;rgb(228,228,228)&apos;, width: width, height: 1, marginTop: 10, &#125;&#125; /&gt; &lt;/View&gt; &#123;item.type ? ( &lt;View&gt; &lt;View style=&#123;&#123; height: 40, alignItems: &apos;center&apos;, flexDirection: &apos;row&apos;, &#125;&#125; &gt; &lt;TouchableOpacity style=&#123;&#123; flexDirection: &apos;row&apos; &#125;&#125; onPress=&#123;() =&gt; this.tellPhone(item)&#125; &gt; &lt;Image source=&#123;require(&apos;./image/phone.png&apos;)&#125; style=&#123;&#123; marginLeft: 10, width: 15, height: 15 &#125;&#125; /&gt; &lt;Text style=&#123;&#123; marginLeft: 10 &#125;&#125;&gt;ç”µè¯ &#123;item.tel&#125;&lt;/Text&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; &lt;View style=&#123;&#123; backgroundColor: &apos;rgb(228,228,228)&apos;, width: width, height: 1, &#125;&#125; /&gt; &lt;View style=&#123;&#123; height: 40, alignItems: &apos;center&apos;, flexDirection: &apos;row&apos;, &#125;&#125; &gt; &lt;Image source=&#123;require(&apos;./image/tlak.png&apos;)&#125; style=&#123;&#123; marginLeft: 10, width: 15, height: 15 &#125;&#125; /&gt; &lt;Text style=&#123;&#123; marginLeft: 10 &#125;&#125;&gt;ç•™è¨€ &#123;item.message&#125;&lt;/Text&gt; &lt;/View&gt; &lt;View style=&#123;&#123; backgroundColor: &apos;rgb(228,228,228)&apos;, width: width, height: 1, &#125;&#125; /&gt; &lt;/View&gt; ) : null&#125; &lt;/View&gt; )) : null&#125; &lt;/View&gt; ) render() &#123; return ( &lt;FlatList data=&#123;this.state.governmentData&#125; renderItem=&#123;this.renderRow&#125; onRefresh=&#123;() =&gt; this.onRefresh()&#125; refreshing=&#123;this.state.isRefresh&#125; /&gt; ) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, &#125;, icon: &#123; width: 22, height: 22, &#125;,&#125;) äº’æ–¥ç¼©ä¸€ç¼©123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275/* eslint-disable */import React, &#123; Component &#125; from &apos;react&apos;import &#123; StyleSheet, View, Image, Text, Dimensions, TouchableOpacity, FlatList, Linking,&#125; from &apos;react-native&apos;const &#123; width &#125; = Dimensions.get(&apos;window&apos;)export default class Two extends Component &#123; // æ„é€  constructor(props) &#123; super(props) // åˆå§‹çŠ¶æ€ this.state = &#123; governmentData: [ &#123; name: &apos;ç¤¾ä¼šä¿éšœå±€&apos;, childs: [ &#123; index:0, name: &apos;èµ„æ–™æ•™å®¤&apos;, tel: &apos;5233&apos;, message: &apos;æŸ¥è¯¢èµ„æ–™,æ³¨é”€æ¡£æ¡ˆ&apos;, &#125;, &#123; index:1, name: &apos;åå‹¤éƒ¨&apos;, tel: &apos;1645682&apos;, message: &apos;ä¸å¯¹å¤–æœåŠ¡&apos;, &#125;, ], &#125;, &#123; name: &apos;å«ç”Ÿå±€&apos;, childs: [ &#123; index:0, name: &apos;å¦‡äº§ç§‘&apos;, tel: &apos;112è½¬678&apos;, message: &apos;æ¥å¾…å­•å¦‡,å¾…äº§å­•å¦‡,å†›å«‚é¢„å…ˆ&apos;, &#125;, &#123; index:1, name: &apos;å„¿ç§‘&apos;, tel: &apos;112è½¬008&apos;, message: &apos;å°äº12å‘¨å²å„¿ç«¥å°±åŒ»&apos;, &#125;, &#123; index:2, name: &apos;å¤±æ‹ç§‘&apos;, tel: &apos;112è½¬å‡ºå»&apos;, message: &apos;å›å®¶ç©è›‹å»!!!&apos;, &#125;, ], &#125;, &#123; name: &apos;ç¥ç›¾å±€&apos;, childs: [ &#123; index:0, name: &apos;åŸç®¡å¤§é˜Ÿ&apos;, tel: &apos;110&apos;, title: &apos;æ‰“æ‰“æ‰“&apos;, message: &apos;é•‡å‹èµ·ä¹‰&apos;, &#125;, ], &#125;, ], isRefresh: true, index: -1, //é»˜è®¤å±•å¼€è´Ÿä¸€è¡Œ indexIndex: -1, &#125; &#125; componentDidMount() &#123; this.setState(&#123; isRefresh: false, &#125;) &#125; /** * ä¸‹æ‹‰åˆ·æ–° * */ onRefresh = () =&gt; &#123; this.setState(&#123; isRefresh: false, &#125;) &#125; /** * ç‚¹å‡»ä¸€çº§ * */ itemOnclick = item =&gt; &#123; this.setState(&#123; index: item.index, indexIndex: -1 &#125;) &#125; /** * ç‚¹å‡»äºŒçº§ * */ itemitemOnclick = e =&gt; &#123; this.setState(&#123; indexIndex: e.index, &#125;) &#125; /** * æ‰“ç”µè¯ * */ tellPhone = item =&gt; &#123; Linking.openURL(`tel:$&#123;item.tel&#125;`) &#125; /** * FlatList render * */ renderRow = item =&gt; ( &lt;View ref=&#123;item.index&#125;&gt; &lt;View&gt; &lt;TouchableOpacity onPress=&#123;() =&gt; this.itemOnclick(item)&#125;&gt; &lt;View style=&#123;&#123; flexDirection: &apos;row&apos;, backgroundColor: &apos;white&apos;, height: 30, alignItems: &apos;center&apos;, &#125;&#125; &gt; &lt;View style=&#123;&#123; marginLeft: 5, width: 4, height: 10, paddingTop: 7, paddingBottom: 7, backgroundColor:&apos;red&apos; &#125;&#125; /&gt; &lt;Text style=&#123;&#123; color: &apos;#333333&apos;, marginLeft: 5, fontSize: 16 &#125;&#125;&gt; &#123;item.item.name&#125; &lt;/Text&gt; &#123;/* å³è¾¹ç®­å¤´ */&#125; &lt;Image source=&#123; item.index == this.state.index ? require(&apos;./image/btnDown.png&apos;) : require(&apos;./image/right.png&apos;) &#125; style=&#123;&#123; position: &apos;absolute&apos;, right: 15, width: 15, height: 15 &#125;&#125; /&gt; &lt;/View&gt; &lt;/TouchableOpacity&gt; &lt;View style=&#123;&#123; backgroundColor: &apos;rgb(228,228,228)&apos;, width: width, height: 1, &#125;&#125; /&gt; &lt;/View&gt; &#123;item.index == this.state.index ? item.item.childs.map((item, index) =&gt; ( &lt;View style=&#123;&#123; backgroundColor: &apos;white&apos; &#125;&#125; key=&#123;index&#125;&gt; &lt;View style=&#123;&#123; marginLeft: 7, marginTop: 10 &#125;&#125;&gt; &lt;View style=&#123;&#123; flexDirection: &apos;row&apos; &#125;&#125;&gt; &lt;Image source=&#123; index == this.state.indexIndex ? require(&apos;./image/btnDownB.png&apos;) : require(&apos;./image/btnRightB.png&apos;) &#125; style=&#123;&#123; width: 10, height: 10 &#125;&#125; /&gt; &lt;Text onPress=&#123;() =&gt; this.itemitemOnclick(item)&#125; style=&#123;&#123; marginLeft: 7 &#125;&#125; &gt; &#123;item.name&#125; &lt;/Text&gt; &lt;/View&gt; &lt;View style=&#123;&#123; backgroundColor: &apos;rgb(228,228,228)&apos;, width: width, height: 1, marginTop: 10, &#125;&#125; /&gt; &lt;/View&gt; &#123;item.index == this.state.indexIndex ? ( &lt;View&gt; &lt;View style=&#123;&#123; height: 40, alignItems: &apos;center&apos;, flexDirection: &apos;row&apos;, &#125;&#125; &gt; &lt;TouchableOpacity style=&#123;&#123; flexDirection: &apos;row&apos; &#125;&#125; onPress=&#123;() =&gt; this.tellPhone(item)&#125; &gt; &lt;Image source=&#123;require(&apos;./image/phone.png&apos;)&#125; style=&#123;&#123; marginLeft: 10, width: 15, height: 15 &#125;&#125; /&gt; &lt;Text style=&#123;&#123; marginLeft: 10 &#125;&#125;&gt;ç”µè¯ &#123;item.tel&#125;&lt;/Text&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; &lt;View style=&#123;&#123; backgroundColor: &apos;rgb(228,228,228)&apos;, width: width, height: 1, &#125;&#125; /&gt; &lt;View style=&#123;&#123; height: 40, alignItems: &apos;center&apos;, flexDirection: &apos;row&apos;, &#125;&#125; &gt; &lt;Image source=&#123;require(&apos;./image/tlak.png&apos;)&#125; style=&#123;&#123; marginLeft: 10, width: 15, height: 15 &#125;&#125; /&gt; &lt;Text style=&#123;&#123; marginLeft: 10 &#125;&#125;&gt;ç•™è¨€ &#123;item.message&#125;&lt;/Text&gt; &lt;/View&gt; &lt;View style=&#123;&#123; backgroundColor: &apos;rgb(228,228,228)&apos;, width: width, height: 1, &#125;&#125; /&gt; &lt;/View&gt; ) : null&#125; &lt;/View&gt; )) : null&#125; &lt;/View&gt; ) render() &#123; return ( &lt;FlatList data=&#123;this.state.governmentData&#125; renderItem=&#123;this.renderRow&#125; onRefresh=&#123;() =&gt; this.onRefresh()&#125; refreshing=&#123;this.state.isRefresh&#125; /&gt; ) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, &#125;, icon: &#123; width: 22, height: 22, &#125;,&#125;) æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"dvaå’Œreact-navigationçš„ç»“åˆä½¿ç”¨","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /dvaå’Œreact-navigationçš„ç»“åˆä½¿ç”¨","date":"2018-07-28T16:00:00.000Z","updated":"2019-04-22T08:03:07.283Z","comments":true,"path":"2018/07/29/ç§»åŠ¨ç«¯å­¦ä¹ /dvaå’Œreact-navigationçš„ç»“åˆä½¿ç”¨/","link":"","permalink":"https://pheromone.github.io/2018/07/29/ç§»åŠ¨ç«¯å­¦ä¹ /dvaå’Œreact-navigationçš„ç»“åˆä½¿ç”¨/","excerpt":"ä»Šå¤©,å­¦ä¹ ä¸‹RNä¸­çš„å¦å¤–ä¸€ä¸ªå…¨å®¶æ¡¶å¥—é¤æ¶æ„:dva+React-Navigation,æœ¬æ–‡åŸºäºreact-native:0.55.4,dva-core:^1.3.0,react-navigation:^2.5.1,react-navigation-redux-helpers:^2.0.4,react-redux:0^5.0.7æ‰€æ’¸.","text":"ä»Šå¤©,å­¦ä¹ ä¸‹RNä¸­çš„å¦å¤–ä¸€ä¸ªå…¨å®¶æ¡¶å¥—é¤æ¶æ„:dva+React-Navigation,æœ¬æ–‡åŸºäºreact-native:0.55.4,dva-core:^1.3.0,react-navigation:^2.5.1,react-navigation-redux-helpers:^2.0.4,react-redux:0^5.0.7æ‰€æ’¸. react-nativeçš„å®˜æ–¹dva-demodvaå®˜æ–¹github åºŸè¯ä¸å¤šç¼©,é¦–å…ˆ,æ–°å»ºä¸€ä¸ªé¡¹ç›®,æ·»åŠ ä¸€å †ç›¸åº”åº“:npm install mobx dva-core --save å¼•å…¥dvanpm install mobx react-navigation-redux-helpers --save å¼•å…¥react-navigation-redux-helpersnpm install mobx react-redux --save å¼•å…¥react-reduxnpm install babel-plugin-transform-decorators-legacy babel-preset-react-native-stage-0 --save-dev èƒ½å¤Ÿä½¿ç”¨@æ ‡ç­¾npm install react-navigation --save å¼•å…¥å¯¼èˆªåº“ç„¶åä¿®æ”¹ä¸€ä¸‹å·¥ç¨‹é‡Œé¢çš„.babelrc: 1234&#123; &quot;presets&quot;: [&quot;react-native&quot;], &quot;plugins&quot;: [&quot;transform-decorators-legacy&quot;]&#125; OK,åŸºæœ¬çš„æ¶å­å·²ç»æ­å¥½.ç„¶åæ–°å»ºä¸€ä¸ªsrcç›®å½•.è¿™é‡Œå­˜æ”¾åŸºæœ¬ä»£ç å’ŒåŸºæœ¬å›¾ç‰‡ä¹‹ç±»çš„. ç„¶å,åœ¨å…¥å£æ–‡ä»¶index.jsä¸­,ä¿®æ”¹ä¸€ä¸‹ä»£ç :12345678import &apos;./App&apos;;console.ignoredYellowBox = [ &apos;Warning: componentWillMount is deprecated&apos;, &apos;Warning: componentWillReceiveProps is deprecated&apos;, &apos;Warning: componentWillUpdate is deprecated&apos;, &apos;Warning: isMounted(...) is deprecated&apos;,] åœ¨App.jsä¸­åŸºç¡€ä»£ç :1234567891011121314151617181920import React from &apos;react&apos;import &#123; AppRegistry &#125; from &apos;react-native&apos;import dva from &apos;./src/Utils/dva&apos;import Router, &#123; routerMiddleware, routerReducer &#125; from &apos;./router&apos;import appModel from &apos;./src/models/app&apos;const app = dva(&#123; initialState: &#123;&#125;, models: [appModel], extraReducers: &#123; router: routerReducer &#125;, onAction: [routerMiddleware], onError(e) &#123; console.log(&apos;onError&apos;, e) &#125;,&#125;)const App = app.start(&lt;Router /&gt;)AppRegistry.registerComponent(&apos;rn_dva&apos;, () =&gt; App) ok,å¦‚ä¸Šå›¾æ‰€ç¤º,dvaçš„ä»£ç ç›¸æ¯”reduxæ¥è¯´å°‘äº†å¾ˆå¤š,ä¸åœ¨éœ€è¦å¤§é‡çš„èµ‹å€¼ç²˜è´´,åŸºæœ¬çš„é€»è¾‘ä»£ç å‡å¯ä»¥æ”¾åœ¨modelsä¸­,å…¶ä¸­çš„Utilsåªæ˜¯dvaçš„ä¸€ä¸ªå·¥å…·ç»„,å…¶ä¸­çš„ä»£ç å¹¶ä¸å¤š.ä¸€å¦‚æ—¢å¾€,å¯¹ç€IDEå°±æ˜¯ä¸€å †ç–¯ç‹‚è¾“å‡º.å®Œæˆçš„åŠŸèƒ½å’Œä¹‹å‰çš„reduxå’ŒMobxä¸€æ ·.modelsä¸‹çš„app.js12345678910111213141516171819202122232425import &#123; createAction, NavigationActions &#125; from &apos;../Utils&apos;export default &#123; namespace: &apos;app&apos;, state: &#123; num: 0, mineType: &apos;çº¢&apos;, &#125;, reducers: &#123; updateState(state, &#123; payload &#125;) &#123; return &#123; ...state, ...payload &#125; &#125;, &#125;, effects: &#123; *add(&#123; payload &#125;, &#123; call, put &#125;) &#123; yield put(createAction(&apos;updateState&apos;)(&#123; num:payload ,mineType:&apos;çº¢&apos;&#125;)) &#125;, *sub(&#123; payload &#125;, &#123; call, put &#125;) &#123; yield put(createAction(&apos;updateState&apos;)(&#123; num:payload ,mineType:&apos;è“&apos; &#125;)) &#125; &#125;, subscriptions: &#123; &#125;,&#125; Utilsä¸‹çš„dva.js 123456789101112131415161718192021import React from &apos;react&apos;import &#123; create &#125; from &apos;dva-core&apos;import &#123; Provider, connect &#125; from &apos;react-redux&apos;export &#123; connect &#125;export default function(options) &#123; const app = create(options) // HMR workaround if (!global.registered) options.models.forEach(model =&gt; app.model(model)) global.registered = true app.start() // eslint-disable-next-line no-underscore-dangle const store = app._store app.start = container =&gt; () =&gt; &lt;Provider store=&#123;store&#125;&gt;&#123;container&#125;&lt;/Provider&gt; app.getStore = () =&gt; store return app&#125; Utilsä¸‹çš„index.js 123export &#123; NavigationActions, StackActions &#125; from &apos;react-navigation&apos;export const createAction = type =&gt; payload =&gt; (&#123; type, payload &#125;) å‰©ä¸‹çš„å°±æ˜¯ä¸¤ä¸ªUIç•Œé¢äº†:One.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &apos;react&apos;;import &#123; Platform, StyleSheet, Text, View, Image&#125; from &apos;react-native&apos;;import &#123; connect &#125; from &apos;react-redux&apos;import &#123; createAction, NavigationActions &#125; from &apos;../Utils&apos;import &#123;Images&#125; from &quot;../Image&quot;;const instructions = Platform.select(&#123; ios: &apos;Press Cmd+R to reload,\\n&apos; + &apos;Cmd+D or shake for dev menu&apos;, android: &apos;Double tap R on your keyboard to reload,\\n&apos; + &apos;Shake or press menu button for dev menu&apos;,&#125;);type Props = &#123;&#125;;@connect((&#123; app &#125;) =&gt; (&#123; ...app &#125;))export default class One extends Component&lt;Props&gt; &#123; static navigationOptions = &#123; tabBarLabel: &apos;è‹¹æœ&apos;, tabBarIcon: (&#123; focused, tintColor &#125;) =&gt; ( &lt;Image source=&#123;focused ? Images.Tab.OneActive : Images.Tab.One&#125; style=&#123;&#123; width: 25, height: 25 &#125;&#125; /&gt; ), &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text onPress=&#123;()=&gt;this.add()&#125;&gt; + çº¢ &lt;/Text&gt; &lt;Text&gt; One &#123;this.props.num&#125; &lt;/Text&gt; &lt;Text onPress=&#123;()=&gt;this.sub()&#125;&gt; - è“ &lt;/Text&gt; &lt;/View&gt; ); &#125; add =() =&gt;&#123; this.props.dispatch(createAction(&apos;app/add&apos;)(this.props.num + 1)) &#125; sub =() =&gt;&#123; this.props.dispatch(createAction(&apos;app/sub&apos;)(this.props.num - 1)) &#125; componentDidMount() &#123; console.log(this.props) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;); Two.js12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &apos;react&apos;;import &#123; Platform, StyleSheet, Text, View, Image&#125; from &apos;react-native&apos;;import &#123; connect &#125; from &apos;react-redux&apos;import &#123; createAction, NavigationActions &#125; from &apos;../Utils&apos;import &#123;Images&#125; from &quot;../Image&quot;;const instructions = Platform.select(&#123; ios: &apos;Press Cmd+R to reload,\\n&apos; + &apos;Cmd+D or shake for dev menu&apos;, android: &apos;Double tap R on your keyboard to reload,\\n&apos; + &apos;Shake or press menu button for dev menu&apos;,&#125;);type Props = &#123;&#125;;@connect((&#123; app &#125;) =&gt; (&#123; ...app &#125;))export default class Two extends Component&lt;Props&gt; &#123; static navigationOptions = &#123; tabBarLabel: &apos;å®‰å“&apos;, tabBarIcon: (&#123; focused, tintColor &#125;) =&gt; ( &lt;Image source=&#123;focused ? Images.Tab.TwoActive : Images.Tab.Two&#125; style=&#123;&#123; width: 25, height: 25 &#125;&#125; /&gt; ), &#125; render() &#123; return ( &lt;View style=&#123;[styles.container,&#123;backgroundColor:this.props.mineType == &apos;çº¢&apos; ? &apos;red&apos; : &apos;blue&apos;&#125;]&#125;&gt; &lt;Text style=&#123;styles.welcome&#125;&gt; TWO + &#123;this.props.mineType&#125; &lt;/Text&gt; &lt;/View&gt; ); &#125; componentDidMount() &#123; console.log(this.props.mineType) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;); OK,ä»¥ä¸Šå°±æ˜¯å…¨éƒ¨ä»£ç .æ•ˆæœå›¾: æºç åœ°å€ å¦å¤–:redux+react-navigationå¦å¤–:Mbox+react-navigation","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"Reactå­¦ä¹ :ç®€å•ä¸ªäººæ¶ˆè´¹è®°è´¦ç³»ç»Ÿ","slug":"å‰ç«¯å­¦ä¹ /Reactå­¦ä¹ -ç®€å•ä¸ªäººæ¶ˆè´¹è®°è´¦ç³»ç»Ÿ","date":"2018-06-28T16:00:00.000Z","updated":"2019-03-03T12:33:42.386Z","comments":true,"path":"2018/06/29/å‰ç«¯å­¦ä¹ /Reactå­¦ä¹ -ç®€å•ä¸ªäººæ¶ˆè´¹è®°è´¦ç³»ç»Ÿ/","link":"","permalink":"https://pheromone.github.io/2018/06/29/å‰ç«¯å­¦ä¹ /Reactå­¦ä¹ -ç®€å•ä¸ªäººæ¶ˆè´¹è®°è´¦ç³»ç»Ÿ/","excerpt":"ä»Šå¤©å­¦ä¹ React,å†™ä¸€ä¸ªå°demoè®°å½•ä¸€ä¸‹,å¼„ä¸€ä¸ªç®€å•çš„ä¸ªäººæ¶ˆè´¹è®°è´¦ç³»ç»Ÿ.","text":"ä»Šå¤©å­¦ä¹ React,å†™ä¸€ä¸ªå°demoè®°å½•ä¸€ä¸‹,å¼„ä¸€ä¸ªç®€å•çš„ä¸ªäººæ¶ˆè´¹è®°è´¦ç³»ç»Ÿ.ä½¿ç”¨è„šæ‰‹æ¶ create-react-app ,åå°ä½¿ç”¨mockAPIæ¨¡æ‹Ÿ,ç½‘ç»œè¯·æ±‚ä½¿ç”¨axios,cssæ•ˆæœä½¿ç”¨bootstrap/4.0.0 .å…ˆæ¥ä¸ªæ•ˆæœå›¾:å…¶ä¸»è¦ä»£ç å‡åœ¨../src/componentsä¸­,ä¸»æ–‡ä»¶æ˜¯Records.js,å…·ä½“çš„æ¶ˆè´¹è®°å½•æ˜¯Record.js,æ€»æ¶ˆè´¹è®°å½•æ˜¯Box.js,æ¶ˆè´¹è®°å½•çš„åˆ›å»ºæ˜¯RecordForm.js,ä¸‹é¢æ˜¯å…¶æºç :Records.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175import React, &#123; Component &#125; from &apos;react&apos;;import Record from &apos;./Record&apos;import RecordForm from &apos;./RecordForm&apos;import Box from &apos;./Box&apos;import axios from &apos;axios&apos;export default class Records extends Component &#123; // æ„é€  constructor(props) &#123; super(props); // åˆå§‹çŠ¶æ€ this.state = &#123; error:null, //ç½‘ç»œé”™è¯¯ä¿¡æ¯ isLoader:true, //åŠ è½½æ ‡ç¤º records:[] //æ•°æ® &#125;; &#125; render() &#123; //æ ¹æ® error isLoader æ˜¾ç¤ºä¸åŒUI //å¦‚æœerroræœ‰å€¼,æ˜¾ç¤ºerrorUI //å¦‚æœisLoader ä¸ºtrue,æ˜¾ç¤ºåŠ è½½UI //å¦‚æœisLoader ä¸ºfalse,æ˜¾ç¤ºæ­£ç¡®æ•°æ®UI const &#123;error,isLoader,records&#125; = this.state let renderRecords; if(error)&#123; renderRecords = &lt;div&gt;å‡ºé”™äº†:&#123;error&#125;&lt;/div&gt; &#125;else if(isLoader)&#123; renderRecords = &lt;div&gt;&lt;img src=&#123;require(&apos;./loading.gif&apos;)&#125; /&gt;&lt;/div&gt; &#125;else &#123; renderRecords = ( &lt;div&gt; &lt;table className=&quot;table table-bordered&quot;&gt; &lt;thead&gt; &lt;tr&gt; &lt;th&gt;æ—¥æœŸ&lt;/th&gt; &lt;th&gt;æ ‡é¢˜&lt;/th&gt; &lt;th&gt;é‡‘é¢&lt;/th&gt; &lt;th&gt;äº‹ä»¶&lt;/th&gt; &lt;/tr&gt; &lt;/thead&gt; &lt;tbody&gt; &#123;records.map((item,index)=&gt; &lt;Record key =&#123;item.id&#125; record=&#123;item&#125; updateData=&#123;this.updateRecord.bind(this)&#125; deleteData=&#123;this.deleteRecord.bind(this)&#125; /&gt; )&#125; &lt;/tbody&gt; &lt;/table&gt; &lt;/div&gt; ); &#125; return( &lt;div&gt; &lt;h2&gt;æ¶ˆè´¹è®°å½•&lt;/h2&gt; &lt;div className=&quot;row mb-3&quot;&gt; &lt;Box text=&quot;æ”¶å…¥&quot; type=&quot;success&quot; amount=&#123;this.credits()&#125; /&gt; &lt;Box text=&quot;æ”¯å‡º&quot; type=&quot;danger&quot; amount=&#123;this.debits()&#125; /&gt; &lt;Box text=&quot;ä½™é¢&quot; type=&quot;info&quot; amount=&#123;this.balance()&#125; /&gt; &lt;/div&gt; &lt;RecordForm handleNewRecord = &#123;this.addRecord.bind(this)&#125; /&gt; &#123;renderRecords&#125; &lt;/div&gt; ) &#125; /** * æ”¶å…¥è®¡ç®— * */ credits() &#123; let credits = this.state.records.filter((record) =&gt; &#123; return record.account &gt;= 0; &#125;) return credits.reduce((prev, curr) =&gt; &#123; return prev + Number.parseInt(curr.account, 0) &#125;, 0) &#125; /** * æ”¯å‡ºè®¡ç®— * */ debits() &#123; let credits = this.state.records.filter((record) =&gt; &#123; return record.account &lt; 0; &#125;) return credits.reduce((prev, curr) =&gt; &#123; return prev + Number.parseInt(curr.account, 0) &#125;, 0) &#125; /** * ä½™é¢è®¡ç®— * */ balance() &#123; return this.credits() + this.debits(); &#125; /** * æ›´æ–°è´¦å• * */ updateRecord(record, data) &#123; const recordIndex = this.state.records.indexOf(record); const newRecords = this.state.records.map( (item, index) =&gt; &#123; if(index !== recordIndex) &#123; // This isn&apos;t the item we care about - keep it as-is return item; &#125; // Otherwise, this is the one we want - return an updated value return &#123; ...item, ...data &#125;; &#125;); this.setState(&#123; records: newRecords &#125;); &#125; /** * åˆ é™¤è´¦å• * */ deleteRecord(record)&#123; // console.log(record) const recordIndex = this.state.records.indexOf(record); const newRecords = this.state.records.filter( (item, index) =&gt; index !== recordIndex); this.setState(&#123; records: newRecords &#125;); &#125; /** * æŠŠæœ€æ–°æ•°æ®èµ‹å€¼state * */ addRecord (record) &#123; console.log(record) this.setState(&#123; error:null, isLoader:false, //åŠ è½½æ ‡ç¤º records:[ ...this.state.records, record ] &#125;) &#125; //è¯·æ±‚æ•°æ® componentDidMount() &#123; var that = this axios.get(&apos;http://5b3450a9d167760014c265b5.mockapi.io/accounts/v1/accounts&apos;) .then(response =&gt; that.setState(&#123; isLoader:false, records:response.data &#125;) ) .catch(err =&gt; that.setState(&#123; error:err.message, &#125;) ) &#125;&#125; Record.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123import React, &#123; Component &#125; from &apos;react&apos;;import moment from &quot;moment&quot;; //æ—¥æœŸæ ¼å¼import axios from &apos;axios&apos;export default class Record extends Component &#123; // æ„é€  constructor(props) &#123; super(props); // åˆå§‹çŠ¶æ€ this.state = &#123; edit:false //ç¼–è¾‘æŒ‰é’®çŠ¶æ€ &#125;; &#125; render() &#123; //å¦‚æœç¼–è¾‘çŠ¶æ€ä¸ºtrue,æ˜¾ç¤ºç¼–è¾‘çŠ¶æ€,å¦åˆ™æ˜¾ç¤ºé»˜è®¤çŠ¶æ€ if(this.state.edit)&#123; return this.renderEditRow() &#125;else &#123; return this.renderRow() &#125; &#125; renderEditRow () &#123; var date = this.props.record.date var newDate = moment(date).format(&apos;YYYY-MM-DD&apos;); return ( &lt;tr&gt; &lt;td&gt;&lt;input type=&quot;text&quot; className=&quot;form-cantrol&quot; defaultValue=&#123;newDate&#125; ref=&quot;date&quot; /&gt;&lt;/td&gt; &lt;td&gt;&lt;input type=&quot;text&quot; className=&quot;form-cantrol&quot; defaultValue=&#123;this.props.record.title&#125; ref=&quot;title&quot; /&gt;&lt;/td&gt; &lt;td&gt;&lt;input type=&quot;text&quot; className=&quot;form-cantrol&quot; defaultValue=&#123;this.props.record.account&#125; ref=&quot;account&quot; /&gt;&lt;/td&gt; &lt;td&gt; &lt;button className=&quot;btn btn-info mr-1&quot; onClick=&#123;this.handleUpdate.bind(this)&#125;&gt;æ›´æ–°&lt;/button&gt; &lt;button className=&quot;btn btn-danger &quot; onClick=&#123;this.handleToggle.bind(this)&#125;&gt;å–æ¶ˆ&lt;/button&gt; &lt;/td&gt; &lt;/tr&gt; ); &#125; renderRow () &#123; var date = this.props.record.date var newDate = moment(date).format(&apos;YYYY-MM-DD&apos;); return ( &lt;tr&gt; &lt;td&gt;&#123;newDate&#125;&lt;/td&gt; &lt;td&gt;&#123;this.props.record.title&#125;&lt;/td&gt; &lt;td&gt;&#123;this.props.record.account&#125;&lt;/td&gt; &lt;td&gt; &lt;button className=&quot;btn btn-info mr-1&quot; onClick=&#123;this.handleToggle.bind(this)&#125;&gt;ç¼–è¾‘&lt;/button&gt; &lt;button className=&quot;btn btn-danger&quot; onClick=&#123;this.handleDelete.bind(this)&#125;&gt;åˆ é™¤&lt;/button&gt; &lt;/td&gt; &lt;/tr&gt; ); &#125; /** * ç¼–è¾‘æŒ‰é’®ç‚¹å‡»äº‹ä»¶ * å¯¹state editåšå–åæ“ä½œ * */ handleToggle () &#123; this.setState(&#123; edit:!this.state.edit &#125;) &#125; /** * åˆ é™¤ æŒ‰é’®ç‚¹å‡»äº‹ä»¶ * */ handleDelete (event) &#123; event.preventDefault() var that = this // alert(that.props.record.id) axios.delete(&apos;http://5b3450a9d167760014c265b5.mockapi.io/accounts/v1/accounts/&apos; + that.props.record.id) .then(response =&gt;&#123; console.log(response) this.props.deleteData(that.props.record) &#125;) .catch(err =&gt;&#123; &#125;) &#125; /** * æ›´æ–°è®°å½•äº‹ä»¶ * */ handleUpdate (event) &#123; event.preventDefault() // æ–¹æ³•é˜»æ­¢å…ƒç´ å‘ç”Ÿé»˜è®¤çš„è¡Œä¸º const record =&#123; date:this.refs.date.value, title:this.refs.title.value, account:this.refs.account.value &#125; var that = this // alert(that.props.record.id) axios.put(&apos;http://5b3450a9d167760014c265b5.mockapi.io/accounts/v1/accounts/&apos; + that.props.record.id,&#123; date:record.date, title:record.title, account:record.account &#125;) .then(response =&gt;&#123; this.props.updateData(this.props.record,response.data) this.setState(&#123; edit:false &#125;) &#125;) .catch(err =&gt; that.setState(&#123; error:err.message, &#125;) ) &#125;&#125; Box.js123456789101112131415161718192021/** * ä¸Šéƒ¨çš„æ€»æ¶ˆè´¹è®°å½• * */import React from &apos;react&apos;;const Box = (&#123; text, type, amount &#125;) =&gt; &#123; return ( &lt;div className=&quot;col&quot;&gt; &lt;div className=&quot;card&quot;&gt; &lt;div className=&#123;`card-header bg-$&#123;type&#125; text-white`&#125;&gt; &#123;text&#125; &lt;/div&gt; &lt;div className=&quot;card-body&quot;&gt; &#123;amount&#125; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; );&#125;export default Box RecordForm.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081import React, &#123; Component &#125; from &apos;react&apos;;import axios from &apos;axios&apos;export default class RecordForm extends Component &#123; // æ„é€  constructor(props) &#123; super(props); // åˆå§‹çŠ¶æ€ this.state = &#123; date:&quot;&quot;, title:&quot;&quot;, account:&quot;&quot; &#125;; &#125; /** * åˆ¤æ–­æŒ‰é’®æ˜¯å¦å¯ç”¨ * */ valid()&#123; return this.state.date &amp;&amp; this.state.title &amp;&amp; this.state.account; &#125; /** * è¾“å…¥æ”¹å˜è§¦å‘ * */ handleChange (event)&#123; let name,obj; name = event.target.name; this.setState(( obj = &#123;&#125;, obj[&quot;&quot; + name] = event.target.value, obj )) &#125; /** * æäº¤æŒ‰é’®è§¦å‘ * */ handleSubmit (event)&#123; event.preventDefault() var that = this axios.post(&apos;http://5b3450a9d167760014c265b5.mockapi.io/accounts/v1/accounts&apos;,&#123; date:that.state.date, title:that.state.title, account:that.state.account &#125;) .then(response =&gt;&#123; console.log(response); this.props.handleNewRecord(response.data) that.setState(&#123; date:&quot;&quot;, title:&quot;&quot;, account:&quot;&quot; &#125;) &#125;) .catch(err =&gt; that.setState(&#123; error:err.message, &#125;) ) &#125; render() &#123; return ( &lt;form className=&quot;form-inline mb-2&quot; onSubmit=&#123;this.handleSubmit.bind(this)&#125; &gt; &lt;div className=&quot;form-group mr-1&quot;&gt; &lt;input type=&quot;text&quot; onChange=&#123;this.handleChange.bind(this)&#125; value=&#123;this.state.date&#125; className=&quot;form-control&quot; placeholder=&quot;æ—¶é—´&quot; name=&quot;date&quot; /&gt; &lt;/div&gt; &lt;div className=&quot;form-group mr-1&quot;&gt; &lt;input type=&quot;text&quot; onChange=&#123;this.handleChange.bind(this)&#125; value=&#123;this.state.title&#125; className=&quot;form-control&quot; placeholder=&quot;æ ‡é¢˜&quot; name=&quot;title&quot; /&gt; &lt;/div&gt; &lt;div className=&quot;form-group mr-1&quot;&gt; &lt;input type=&quot;text&quot; onChange=&#123;this.handleChange.bind(this)&#125; value=&#123;this.state.account&#125; className=&quot;form-control&quot; placeholder=&quot;è´¦ç›®&quot; name=&quot;account&quot; /&gt; &lt;/div&gt; &lt;button type=&quot;submit&quot; className=&quot;btn btn-primary&quot; disabled=&#123;!this.valid()&#125; &gt;åˆ›å»º&lt;/button&gt; &lt;/form&gt; ); &#125;&#125; ok,ä¸‹é¢æ˜¯æºç :æºç åœ°å€å­¦ä¹ å‰ç«¯","categories":[{"name":"å‰ç«¯å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/å‰ç«¯å­¦ä¹ /"}],"tags":[{"name":"å‰ç«¯å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/å‰ç«¯å­¦ä¹ /"}]},{"title":"react-nativeä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /react-nativeä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡","date":"2018-06-25T16:00:00.000Z","updated":"2018-06-26T14:17:32.331Z","comments":true,"path":"2018/06/26/ç§»åŠ¨ç«¯å­¦ä¹ /react-nativeä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡/","link":"","permalink":"https://pheromone.github.io/2018/06/26/ç§»åŠ¨ç«¯å­¦ä¹ /react-nativeä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡/","excerpt":"ä»Šå¤©è¯•ä¸€ä¸‹React Native ä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡.å‘ä¹Ÿå°±éšä¹‹å¼€å§‹äº†.ä»¥demoä¸ºä¾‹.react-native:â€0.55.4â€,react-native-qiniu:â€™â€™0.3.0â€","text":"ä»Šå¤©è¯•ä¸€ä¸‹React Native ä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡.å‘ä¹Ÿå°±éšä¹‹å¼€å§‹äº†.ä»¥demoä¸ºä¾‹.react-native:â€0.55.4â€,react-native-qiniu:â€™â€™0.3.0â€é¦–å…ˆæœ€å¤§çš„å‘å°±æ˜¯ä¸ƒç‰›å®˜æ–¹çš„è¿™ä¸ªåº“:react-native-qiniu,å¥½åƒæ˜¯è¯¥åº“çš„åˆ›å§‹äººç¦»èŒäº†,å¯¼è‡´äº†è¯¥åº“å·²ç»è’åºŸ,æ— äººæ›´æ–°ç»´æŠ¤.å¦‚æœä½ åªæ˜¯å•çº¯æŒ‰ç…§githubçš„è¯´æ˜å¯¼å…¥è¯¥åº“å°±ä½¿ç”¨çš„è¯,æ— è®ºä½ ä»¥ä»€ä¹ˆå§¿åŠ¿æ’¸.ç»“æœéƒ½æ˜¯Rpc.uploadFileçš„catchè¾“å‡ºé”™è¯¯,é”™è¯¯ä¿¡æ¯ä¸ºnullâ€¦â€¦â€¦..è¿™ä¸ªé”™è¯¯ä¿¡æ¯çœŸè®©æˆ‘å¤´å¤§.å¯å–œæœ‰äººåœ¨ç½‘ä¸Šåšå‡ºäº†æ›´æ–°,æ›´æ–°ä»£ç (éœ€è¦ä¿®æ”¹åº“ä¸­çš„ä¸¤ä¸ªæºæ–‡ä»¶../react-native-qiniu/core)å¦‚ä¸‹:rpc.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163import conf from &apos;./conf.js&apos;;import Auth from &apos;./auth&apos;;//å‘é€ç®¡ç†å’Œfopå‘½ä»¤,æ€»ä¹‹å°±æ˜¯ä¸ä¸Šä¼ æ–‡ä»¶function post(uri, adminToken, content) &#123;var headers = &#123;&apos;Content-Type&apos;: &apos;application/x-www-form-urlencoded&apos;,&#125;;let payload = &#123;headers: headers,method: &apos;POST&apos;,dataType: &apos;json&apos;,timeout: conf.RPC_TIMEOUT,&#125;;if (typeof content === &apos;undefined&apos;) &#123;payload.headers[&apos;Content-Length&apos;] = 0;&#125; else &#123;//carry datapayload.body = content;&#125;if (adminToken) &#123;headers[&apos;Authorization&apos;] = adminToken;&#125;return fetch(uri, payload);&#125;/*** ç›´ä¼ æ–‡ä»¶* formInputå¯¹è±¡å¦‚ä½•é…ç½®è¯·å‚è€ƒä¸ƒç‰›å®˜æ–¹æ–‡æ¡£â€œç›´ä¼ æ–‡ä»¶â€ä¸€èŠ‚*/function uploadFile(dataParams, policy, callbackUpDate = function () &#123; &#125;, callBackMethod = function () &#123; &#125;) &#123;let params = getParams(dataParams, policy);let uri = params.uri;let data = params.data;let oloaded = null;let responseObj = &#123;&#125;;return new Promise((resolve, reject) =&gt; &#123;if (typeof uri != &apos;string&apos; || uri == &apos;&apos; || typeof data.key == &apos;undefined&apos;) &#123;reject &amp;&amp; reject(null);return;&#125;if (uri[0] == &apos;/&apos;) &#123;uri = &quot;file://&quot; + uri;&#125;//åˆ›å»ºxhrå¹¶openvar xhr = new XMLHttpRequest();xhr.onreadystatechange = function () &#123;responseObj.readyState = xhr.readyState; //çŠ¶æ€0-4responseObj.data = xhr.response;//è¿”å›å€¼responseObj.textData = xhr.responseText; //è¿”å›å€¼TextresponseObj.status = xhr.status; //çŠ¶æ€ç // responseObj.message = &quot;&quot;switch (xhr.readyState) &#123;case 0:callBackMethod(responseObj)break;case 1:callBackMethod(responseObj)break;case 2:callBackMethod(responseObj)break;case 3:callBackMethod(responseObj)break;case 4:if ((xhr.status &gt;= 200 &amp;&amp; xhr.status &lt; 300) || xhr.status == 304) &#123;if (xhr.status == 200) &#123;callBackMethod(responseObj)&#125;&#125; else &#123;callBackMethod(responseObj)&#125;break;&#125;&#125;;xhr.open(&apos;POST&apos;, conf.UP_HOST);xhr.onload = () =&gt; &#123;if (xhr.status !== 200) &#123;reject &amp;&amp; reject(responseObj);return;&#125;resolve &amp;&amp; resolve(JSON.parse(responseObj.data));&#125;;xhr.onerror = (evt) =&gt; &#123;reject &amp;&amp; reject(evt);return;&#125;; //è¯·æ±‚å¤±è´¥xhr.upload.onloadstart = () =&gt; &#123;//ä¸Šä¼ å¼€å§‹æ‰§è¡Œæ–¹æ³•oloaded = 0;//è®¾ç½®ä¸Šä¼ å¼€å§‹æ—¶ï¼Œä»¥ä¸Šä¼ çš„æ–‡ä»¶å¤§å°ä¸º0console(&quot;ä¸Šä¼ å¼€å§‹&quot;)&#125;;xhr.upload.onprogress = (evt) =&gt; &#123;oloaded = evt.loaded;//é‡æ–°èµ‹å€¼å·²ä¸Šä¼ æ–‡ä»¶å¤§å°ï¼Œç”¨ä»¥ä¸‹æ¬¡è®¡ç®—callbackUpDate(Math.round(oloaded / evt.total * 100), oloaded, evt.total)&#125;;xhr.upload.onloadend = (evt) =&gt; &#123;console(&quot;ä¸Šä¼ ç»“æŸ&quot;)&#125;;let formdata = creatFormData(params);xhr.send(formdata);&#125;);&#125;//æ„é€ ä¸Šä¼ å‚æ•°function getParams(data, policy) &#123;let putPolicy = new Auth.Policy(policy);let uptoken = putPolicy.token();data.token = uptoken;let params = &#123;&#125;;params.uri = data.uri;delete data.uri;params.data = data;return params;&#125;/*** åˆ›å»ºä¸€ä¸ªè¡¨å•å¯¹è±¡,ç”¨äºä¸Šä¼ å‚æ•°* @param &#123;*&#125; params*/function creatFormData(params) &#123;let formdata = new FormData();let uri = params.uri;let formInput = creatFormInput(uri);let data = params.data;console.log(data)for (let key of Object.keys(data)) &#123;let value = data[key];if (key.charAt(0) === &quot;_&quot;) &#123;formdata.append(&quot;x:&quot; + key.substring(1, key.length), value);&#125; else &#123;formdata.append(key, value);&#125;&#125;formdata.append(&quot;file&quot;, &#123; uri: uri, type: formInput.type, name: formInput.name &#125;);console.log(formdata)return formdata;&#125;/*** æ„é€ è¡¨å•å¯¹è±¡ä¸­fileå¯¹è±¡* @param &#123;*&#125; params*/function creatFormInput(uri) &#123;let formInput = &#123;&#125;;if (typeof formInput.type == &apos;undefined&apos;)formInput.type = &apos;application/octet-stream&apos;;if (typeof formInput.name == &apos;undefined&apos;) &#123;var filePath = uri.split(&quot;/&quot;);if (filePath.length &gt; 0)formInput.name = filePath[filePath.length - 1];elseformInput.name = &quot;&quot;;&#125;return formInput;&#125;export default &#123; uploadFile, post &#125; auth.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152import base64 from &apos;base-64&apos;;import CryptoJS from &quot;crypto-js&quot;;import conf from &quot;./conf.js&quot;;import parse from &apos;url-parse&apos;;function urlsafeBase64Encode(jsonFlags) &#123;var encoded = base64.encode(jsonFlags);return base64ToUrlSafe(encoded);&#125;;function base64ToUrlSafe(v) &#123;return v.replace(/\\//g, &apos;_&apos;).replace(/\\+/g, &apos;-&apos;);&#125;;function hmacSha1(encodedFlags, secretKey) &#123;var encoded = CryptoJS.HmacSHA1(encodedFlags, secretKey).toString(CryptoJS.enc.Base64);return encoded;&#125;;function generateAccessToken(url, body) &#123;var u = parse(url, true);var path = u.pathname;var access = path + &apos;\\n&apos;;if (body) &#123;access += body;&#125;var digest = hmacSha1(access, conf.SECRET_KEY);var safeDigest = base64ToUrlSafe(digest);let token = &apos;QBox &apos; + conf.ACCESS_KEY + &apos;:&apos; + safeDigest;//console.log(token);return token;&#125;;class Policy &#123;constructor(policy) &#123;if (typeof (policy) == &quot;undefined&quot;) &#123;&#125; else &#123;this.policy = policy;if (typeof (policy.deadline) == &quot;undefined&quot; || policy.deadline == null) &#123;this.policy.deadline = 3600 + Math.floor(Date.now() / 1000);&#125;&#125;&#125;_parse2Str(putPolicy) &#123;let str = &quot;&#123;&quot;;let keys = Object.keys(putPolicy);keys.forEach((key, i) =&gt; &#123;let value = putPolicy[key];if (typeof (value) == &quot;object&quot;) &#123;str = `$&#123;str&#125;&quot;$&#123;key&#125;&quot;:`str = `$&#123;str&#125;&quot;&#123;`Object.keys(value).forEach((key2) =&gt; &#123;let value2 = value[key2];let re = /(\\$\\(.*?\\))/g;if(re.test(value2))&#123;str = `$&#123;str&#125;\\\\\\&quot;$&#123;key2&#125;\\\\\\&quot;:$&#123;value2&#125;,`&#125;else&#123;str = `$&#123;str&#125;\\\\\\&quot;$&#123;key2&#125;\\\\\\&quot;:&quot;$&#123;value2&#125;&quot;,`&#125;&#125;)console.log(keys.length + &quot;::&quot; + i)if (i &gt;= keys.length) &#123;str = `$&#123;str.substring(0, str.length - 1)&#125;&#125;&quot;`&#125;else&#123;str = `$&#123;str.substring(0, str.length - 1)&#125;&#125;&quot;,`&#125;&#125;else if (typeof (value) == &quot;number&quot;) &#123;str = `$&#123;str&#125;&quot;$&#123;key&#125;&quot;:$&#123;value&#125;,`&#125;else if (typeof (value) == &quot;string&quot;) &#123;str = `$&#123;str&#125;&quot;$&#123;key&#125;&quot;:&quot;$&#123;value&#125;&quot;,`&#125;else &#123;str = `$&#123;str&#125;&quot;$&#123;key&#125;&quot;:&quot;$&#123;value&#125;&quot;,`&#125;&#125;)str = `$&#123;str.substring(0, str.length - 1)&#125;&#125;`;return str;&#125;// _creatStr = (policy) =&gt; &#123;// policy[&apos;deadline&apos;] = this.expires + Math.floor(Date.now() / 1000);// let policyStr = JSON.stringify(policy);// let re = /(\\&quot;\\$\\(.*?\\)\\&quot;)/g;// let newStr = policyStr.replace(re, (value) =&gt; &#123;// return value.substring(1, value.length - 1);// &#125;)// return newStr;// &#125;token = () =&gt; &#123;policStr = this._parse2Str(this.policy);console.log(&quot;policStr&quot;, policStr);var encodedPutPolicy = this._urlsafeBase64Encode(policStr);console.log(&quot;encodedPutPolicy&quot;, encodedPutPolicy);var sign = this._hmacSha1(encodedPutPolicy, conf.SECRET_KEY);var encodedSign = this._base64ToUrlSafe(sign);console.log(&quot;encodedSign&quot;, encodedSign);var uploadToken = conf.ACCESS_KEY + &apos;:&apos; + encodedSign + &apos;:&apos; + encodedPutPolicy;console.log(&quot;uploadToken&quot;, uploadToken);return uploadToken;&#125;_urlsafeBase64Encode = (jsonFlags) =&gt; &#123;var encoded = base64.encode(jsonFlags);return base64ToUrlSafe(encoded);&#125;;_base64ToUrlSafe = (v) =&gt; &#123;return v.replace(/\\//g, &apos;_&apos;).replace(/\\+/g, &apos;-&apos;);&#125;;_hmacSha1 = (encodedFlags, secretKey) =&gt; &#123;var encoded = CryptoJS.HmacSHA1(encodedFlags, secretKey).toString(CryptoJS.enc.Base64);return encoded;&#125;;&#125;class GetPolicy &#123;constructor(expires) &#123;this.expires = expires || 3600;&#125;makeRequest(baseUrl) &#123;var deadline = this.expires + Math.floor(Date.now() / 1000);if (baseUrl.indexOf(&apos;?&apos;) &gt;= 0) &#123;baseUrl += &apos;&amp;e=&apos;;&#125; else &#123;baseUrl += &apos;?e=&apos;;&#125;baseUrl += deadline;var signature = hmacSha1(baseUrl, conf.SECRET_KEY);var encodedSign = base64ToUrlSafe(signature);var downloadToken = conf.ACCESS_KEY + &apos;:&apos; + encodedSign;return baseUrl + &apos;&amp;token=&apos; + downloadToken;&#125;&#125;export default &#123; urlsafeBase64Encode, generateAccessToken, Policy, GetPolicy &#125; ok,æ”¹å®Œä¹‹å,ä½ å°±å¯ä»¥æ„‰å¿«çš„æ’¸è‡ªå·±çš„ä¸šåŠ¡ä»£ç äº†.è‡³äºä¸šåŠ¡ä»£ç æˆ‘å°±ç®€å•å†™ä¸ªä¾‹å­:å…¶ä¸­,Conf.ACCESS_KEYå’ŒConf.SECRET_KEYä»ä¸ƒç‰›è´¦å·é‡Œé¢è·å–,Conf.UP_HOST ä»https://developer.qiniu.com/kodo/manual/1671/region-endpoint é‡Œé¢è·å–,å…¶ä¸­,scopeå°±æ˜¯ä¸ƒç‰›é‡Œé¢ä½ è‡ªå·±å»ºç«‹çš„å­˜å‚¨ç©ºé—´å123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107/*** Sample React Native App* https://github.com/facebook/react-native* @flow*/import React, &#123; Component &#125; from &apos;react&apos;;import &#123;Platform,StyleSheet,Text,View,Image&#125; from &apos;react-native&apos;;import Qiniu, &#123; Auth, ImgOps, Conf, Rs, Rpc &#125; from &apos;react-native-qiniu&apos;;//å¯¹äºä¸ƒç‰›ä¿®æ”¹æ–‡ä»¶å‚è€ƒ: https://blog.csdn.net/qq_33935895/article/details/78775819Conf.ACCESS_KEY = &quot;ä»ä¸ƒç‰›è´¦å·é‡Œé¢è·å–&quot;;Conf.SECRET_KEY = &quot;ä»ä¸ƒç‰›è´¦å·é‡Œé¢è·å–&quot;;Conf.UP_HOST = &apos;ä»ä¸ƒç‰›è´¦å·é‡Œé¢è·å–&apos;; // https://developer.qiniu.com/kodo/manual/1671/region-endpointtype Props = &#123;&#125;;export default class App extends Component&lt;Props&gt; &#123;// æ„é€ constructor(props) &#123;super(props);// åˆå§‹çŠ¶æ€this.state = &#123;img:&apos;å›¾ç‰‡url&apos;&#125;;&#125;render() &#123;return (&lt;View style=&#123;styles.container&#125;&gt;&lt;Text style=&#123;styles.instructions&#125; onPress=&#123;()=&gt;this.upload()&#125;&gt;ä¸Šä¼ &lt;/Text&gt;&lt;Text&gt;&#123;this.state.img&#125;&lt;/Text&gt;&lt;Imagesource=&#123;&#123;uri: this.state.img&#125;&#125;style=&#123;&#123;width:200,height:400&#125;&#125;/&gt;&lt;/View&gt;);&#125;/*** å…ˆä¸Šä¼ ä¸ƒç‰› è·å–url* */upload =() =&gt;&#123;var img = &apos;/Users/shaotingzhou/Desktop/qiniuDemo/uploadImg.jpg&apos; //å›¾ç‰‡è·¯å¾„ å¦‚æœæ˜¯ä»ç›¸å†Œè·å–å›¾ç‰‡çš„è¯,å…¶ç›¸å†Œä¼šè¿”å›var myDate = new Date();const key = myDate.getTime() + &apos;.jpg&apos;; //ä¸Šä¼ æˆåŠŸåè¯¥keyå°±æ˜¯å›¾ç‰‡çš„urlè·¯å¾„//ä¸Šä¼ å‚æ•°let params = &#123;uri: img,//å›¾ç‰‡è·¯å¾„ å¯ä»¥é€šè¿‡ç¬¬ä¸‰æ–¹å·¥å…· å¦‚:ImageCropPickerç­‰è·å–æœ¬åœ°å›¾ç‰‡è·¯å¾„key: key,//è¦ä¸Šä¼ çš„key&#125;//æ„å»ºä¸Šä¼ ç­–ç•¥let policy = &#123;scope: &quot;demo&quot;,//è®°å¾—è¿™é‡Œå¦‚æœæ ¼å¼ä¸º&lt;bucket&gt;:&lt;key&gt;å½¢å¼çš„è¯,keyè¦ä¸paramsé‡Œçš„keyä¿æŒä¸€è‡´,è¯¦è§ä¸ƒç‰›ä¸Šä¼ ç­–ç•¥returnBody://returnBody è¯¦è§ä¸Šä¼ ç­–ç•¥&#123;name: &quot;$(fname)&quot;,//è·å–æ–‡ä»¶åsize: &quot;$(fsize)&quot;,//è·å–æ–‡ä»¶å¤§å°w: &quot;$(imageInfo.width)&quot;,//...h: &quot;$(imageInfo.height)&quot;,//...hash: &quot;$(etag)&quot;,//...&#125;,&#125;//è¿›è¡Œæ–‡ä»¶ä¸Šä¼ Rpc.uploadFile(params, policy).then((data) =&gt; &#123;console.log(&apos;ä¸Šä¼ æˆåŠŸ&apos;)var imgUrl = key //ä¸ƒç‰›ä¸Šçš„å›¾ç‰‡URL å°±æ˜¯ä¹‹å‰çš„key + ä½ å…¬å¸åŸŸåthis.setState(&#123;img: &apos;http://pax8cso07.bkt.clouddn.com/&apos; + key&#125;)&#125;).catch((err) =&gt; &#123;console.log(err)&#125;);&#125;&#125;const styles = StyleSheet.create(&#123;container: &#123;flex: 1,justifyContent: &apos;center&apos;,alignItems: &apos;center&apos;,backgroundColor: &apos;#F5FCFF&apos;,&#125;,welcome: &#123;fontSize: 20,textAlign: &apos;center&apos;,margin: 10,&#125;,instructions: &#123;textAlign: &apos;center&apos;,color: &apos;#333333&apos;,marginBottom: 5,&#125;,&#125;); ok.ä¸‹é¢æ˜¯ä¸ƒç‰›é‡Œé¢çš„keyå¯¹åº”å›¾,ä¿®æ”¹åçš„è¾“å‡ºå›¾,æœ€åçš„ä¾‹å­å±•ç¤ºå›¾:ä¸‹é¢æ˜¯æºç .å…¶ä¸­ä¸ƒç‰›çš„ä¿®æ”¹æ–‡ä»¶åœ¨0.3.0ä¸­.æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"react-navigationå‰ç½®ç™»å½•","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /react-navigationå‰ç½®ç™»å½•","date":"2018-06-15T16:00:00.000Z","updated":"2018-06-16T06:36:06.531Z","comments":true,"path":"2018/06/16/ç§»åŠ¨ç«¯å­¦ä¹ /react-navigationå‰ç½®ç™»å½•/","link":"","permalink":"https://pheromone.github.io/2018/06/16/ç§»åŠ¨ç«¯å­¦ä¹ /react-navigationå‰ç½®ç™»å½•/","excerpt":"å¥½å¤šåº”ç”¨éƒ½éœ€è¦æ¶‰åŠåˆ°å‰ç½®ç™»å½•,ä»Šå¤©å°±æ¥å®æ“ä¸€ä¸‹.æ‰€ç”¨çš„åº“æœ‰react-natigationå¯¼èˆªåº“å’ŒmobxçŠ¶æ€ç®¡ç†åº“.","text":"å¥½å¤šåº”ç”¨éƒ½éœ€è¦æ¶‰åŠåˆ°å‰ç½®ç™»å½•,ä»Šå¤©å°±æ¥å®æ“ä¸€ä¸‹.æ‰€ç”¨çš„åº“æœ‰react-natigationå¯¼èˆªåº“å’ŒmobxçŠ¶æ€ç®¡ç†åº“. è¿™é‡Œè´´ä¸€ä¸‹å„åº“çš„ä½¿ç”¨ç‰ˆæœ¬: 123456789101112131415161718192021222324252627 &#123; &quot;name&quot;: &quot;lead_the_login&quot;, &quot;version&quot;: &quot;0.0.1&quot;, &quot;private&quot;: true, &quot;scripts&quot;: &#123; &quot;start&quot;: &quot;node node_modules/react-native/local-cli/cli.js start&quot;, &quot;test&quot;: &quot;jest&quot; &#125;, &quot;dependencies&quot;: &#123; &quot;mobx&quot;: &quot;^4.3.0&quot;, &quot;mobx-react&quot;: &quot;^5.1.2&quot;, &quot;react&quot;: &quot;16.3.1&quot;, &quot;react-native&quot;: &quot;0.55.4&quot;, &quot;react-navigation&quot;: &quot;1.5.3&quot; &#125;, &quot;devDependencies&quot;: &#123; &quot;babel-jest&quot;: &quot;23.0.1&quot;, &quot;babel-plugin-transform-decorators-legacy&quot;: &quot;^1.3.5&quot;, &quot;babel-preset-react-native&quot;: &quot;4.0.0&quot;, &quot;babel-preset-react-native-stage-0&quot;: &quot;^1.0.1&quot;, &quot;jest&quot;: &quot;23.1.0&quot;, &quot;react-test-renderer&quot;: &quot;16.3.1&quot; &#125;, &quot;jest&quot;: &#123; &quot;preset&quot;: &quot;react-native&quot; &#125;&#125; å‰ç½®ç™»å½•ä¸»è¦ä½¿ç”¨çš„æ˜¯react-navigationçš„tabbarçš„ç‚¹å‡»äº‹ä»¶. ä½¿ç”¨æ–¹æ³•å¯ä»¥çœ‹ react navigationå®˜æ–¹ç½‘ç«™ æˆ–è€… å…”ä½¬çš„ç®€ä¹¦,è‡³äºmboxå’Œreact-navigationçš„ä½¿ç”¨å¯ä»¥å‚è€ƒä¹‹å‰å†™çš„è¿™ç¯‡æ–‡ç« :Mobxå’Œreact-navigationçš„ä½¿ç”¨. è¿™é‡Œä¸åšç»†è¯´.ç›´æ¥ä¸Šä»£ç .ä¸‹é¢æ˜¯åŸºæœ¬ä»£ç ç»“æ„.å‡†å¤‡å·¥ä½œ,å…ˆæŠŠmobx+react-navigationæ­å»ºå®Œæ¯•ä¹‹å.æˆ‘ä»¬åœ¨ç‚¹å‡»æˆ‘çš„Tabæ—¶,å¯¹tabBarç‚¹å‡»äº‹ä»¶åšå¤„ç†å³å¯,åœ¨ç‚¹å‡»äº‹ä»¶é‡Œé¢å…ˆè·å–æˆ‘ä»¬å­˜åœ¨Storeä¸­çš„ç™»å½•çŠ¶æ€,æ ¹æ®çŠ¶æ€åšä¸åŒçš„äº‹æƒ…,è¿™é‡Œæˆ‘æœªå¤„ç†æœ¬åœ°æ•°æ®æŒä¹…åŒ–å·¥ä½œ,åªæ˜¯å•çº¯çš„å­˜åœ¨Mobxä¸­çš„storeä¸­,æ˜¯ä¸ºäº†æ–¹ä¾¿å…¶ä»–åœ°æ–¹ä½¿ç”¨.å®é™…å¼€å‘ä¸­,æˆ‘ä»¬è¿˜éœ€è¦å¯¹æ•°æ®è¿›è¡ŒæŒä¹…åŒ–æ“ä½œ.ä¸»è¦ä»£ç æœ‰:123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &apos;react&apos;;import &#123; Platform, StyleSheet, Text, View&#125; from &apos;react-native&apos;;import &#123; observer, inject &#125; from &apos;mobx-react&apos;import &#123; action, autorun, computed &#125; from &apos;mobx&apos;import &#123; NavigationActions &#125; from &apos;react-navigation&apos;const resetAction = NavigationActions.reset(&#123; index: 0, actions: [ NavigationActions.navigate(&#123;routeName: &apos;Tab&apos;, params: &#123;&#125;&#125;) ]&#125;)@inject(&apos;rootStore&apos;)@observerexport default class TwoView extends Component&lt;Props&gt; &#123; static navigationOptions = (&#123; navigation &#125;) =&gt; (&#123; header:null, tabBarOnPress: (tab) =&gt; &#123; //è®©tabBarå¯ç‚¹å‡»,åšå‰ç½®ç™»å½• // navigation.state.params.navigatePress() tab.jumpToIndex(tab.scene.index) &#125;, &#125;); render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text&gt; ç™»å½•çŠ¶æ€:&#123;this.loginStatus ? &apos;å·²ç»ç™»å½•&apos; : &apos;æœªç™»å½•&apos;&#125; &lt;/Text&gt; &lt;Text onPress=&#123;()=&gt;this.loginOutAction()&#125;&gt; æ³¨é”€ &lt;/Text&gt; &lt;/View&gt; ); &#125; @computed get loginStatus() &#123; return this.props.rootStore.TwoStore.allDatas.loginStatus; &#125; componentDidMount() &#123; this.props.navigation.setParams(&#123; navigatePress: this.needLogin() &#125;) // ä½¿ç”¨è¿™ä¸ªæ¥è°ƒç”¨this &#125; /** * åˆ¤æ–­æ˜¯å¦éœ€è¦ç™»å½• * */ needLogin =() =&gt;&#123; //åˆ¤æ–­ç™»å½• console.log(&apos;loginStatus&apos;) console.log(this.loginStatus) if(this.loginStatus)&#123; //å·²ç»ç™»å½• return; &#125;else &#123; //æœªç™»å½• è·³è½¬è‡³ç™»å½•ç•Œé¢ this.props.navigation.navigate(&apos;LoginView&apos;,&#123;callback:()=&gt;this.getPersonalInfo()&#125;) &#125; &#125; /** * ç™»å½•æˆåŠŸçš„å›è°ƒæ–¹æ³• * */ getPersonalInfo =() =&gt;&#123; // è¯·æ±‚æ•°æ®èµ‹å€¼å³å¯ &#125; loginOutAction =() =&gt;&#123; //æ³¨é”€ç™»å½• æ¸…ç©ºæœ¬åœ°åŒ–æ•°æ® å’Œ é‡ç½®storeä¸­çš„loginStatus this.props.rootStore.TwoStore.allDatas.loginStatus = false this.props.navigation.dispatch(resetAction); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;); å’Œç™»å½•ä¹‹åä¿®æ”¹storeä¸­çŠ¶æ€123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &apos;react&apos;;import &#123; Platform, StyleSheet, Text, View&#125; from &apos;react-native&apos;;import &#123; observer, inject &#125; from &apos;mobx-react&apos;import &#123; action, autorun, computed &#125; from &apos;mobx&apos;@inject(&apos;rootStore&apos;)@observerexport default class LoginView extends Component&lt;Props&gt; &#123; static navigationOptions = (&#123; navigation &#125;) =&gt; (&#123; header:null, &#125;); render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text onPress=&#123;()=&gt;this.loginAction()&#125;&gt; ç™»å½• &lt;/Text&gt; &lt;/View&gt; ); &#125; /** * ç™»å½•/æ³¨é”€ å¯ä»¥åœ¨storeé‡Œé¢æ‰§è¡Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨è¿™é‡Œæ‰§è¡Œ,çœ‹ä½ ä¹ æƒ¯ * */ loginAction =() =&gt;&#123; //ç™»å½•è¯·æ±‚ //æˆåŠŸä¹‹å,ä¿®æ”¹loginStatus.æœ¬åœ°åŒ–æ•°æ®ç­‰ç­‰ this.props.rootStore.TwoStore.allDatas.loginStatus = true //è¿”å›ä¸Šä¸€ä¸ªç•Œé¢,å¹¶å›è°ƒåˆ·æ–° this.props.navigation.goBack() this.props.navigation.state.params.callback(); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;); æ•ˆæœå¦‚å›¾:æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"Mobxä¸react-navigationçš„ç»“åˆä½¿ç”¨","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Mobxä¸react-navigationçš„ä½¿ç”¨","date":"2018-05-26T16:00:00.000Z","updated":"2019-04-22T08:01:49.177Z","comments":true,"path":"2018/05/27/ç§»åŠ¨ç«¯å­¦ä¹ /Mobxä¸react-navigationçš„ä½¿ç”¨/","link":"","permalink":"https://pheromone.github.io/2018/05/27/ç§»åŠ¨ç«¯å­¦ä¹ /Mobxä¸react-navigationçš„ä½¿ç”¨/","excerpt":"ä»Šå¤©,å­¦ä¹ ä¸‹RNä¸­çš„å¦å¤–ä¸€ä¸ªå…¨å®¶æ¡¶å¥—é¤æ¶æ„:Mobx+React-Navigation,æœ¬æ–‡åŸºäºreact-native:0.55.4,Mbox:^4.3.0,react-navigation:^2.0.1æ‰€æ’¸.","text":"ä»Šå¤©,å­¦ä¹ ä¸‹RNä¸­çš„å¦å¤–ä¸€ä¸ªå…¨å®¶æ¡¶å¥—é¤æ¶æ„:Mobx+React-Navigation,æœ¬æ–‡åŸºäºreact-native:0.55.4,Mbox:^4.3.0,react-navigation:^2.0.1æ‰€æ’¸.Mboxä¸­æ–‡æ–‡æ¡£å¦å¤–ä¸€ä¸ªåŸºäºMboxå’Œreact-navigationçš„ä¸é”™é¡¹ç›® åºŸè¯ä¸å¤šç¼©,é¦–å…ˆ,æ–°å»ºä¸€ä¸ªé¡¹ç›®,æ·»åŠ ç›¸åº”åº“:npm i mobx mobx-react --save å¼•å…¥Mbox npm i babel-plugin-transform-decorators-legacy babel-preset-react-native-stage-0 --save-dev èƒ½å¤Ÿä½¿ç”¨@æ ‡ç­¾ npm i react-navigation --save å¼•å…¥å¯¼èˆªåº“ç„¶åä¿®æ”¹ä¸€ä¸‹å·¥ç¨‹é‡Œé¢çš„.babelrc: 1234&#123; &quot;presets&quot;: [&quot;react-native&quot;], &quot;plugins&quot;: [&quot;transform-decorators-legacy&quot;]&#125; OK,åŸºæœ¬çš„æ¶å­å·²ç»æ­å¥½.ç„¶åæ–°å»ºä¸€ä¸ªsrcç›®å½•.è¿™é‡Œå­˜æ”¾åŸºæœ¬ä»£ç å’ŒåŸºæœ¬å›¾ç‰‡ä¹‹ç±»çš„. ç„¶å,åœ¨å…¥å£æ–‡ä»¶App.jsä¸­,å…ˆæ­å»ºtabBarå’Œå¯¼èˆªæ¡.ä½¿ç”¨react-navigationè¿™é‡Œ,æˆ‘ä½¿ç”¨å…¨å±€æ³¨å†Œå¹¶æ³¨å…¥mobxï¼Œå…¶ä»–åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨store.import {Provider} from &#39;mobx-react&#39;;ç„¶ååœ¨src-&gt;Mobxè¿™é‡Œæ–°å»ºä¸€ä¸ªæ ¹storeçš„Store.jsæ–‡ä»¶.Store.js 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import &#123; observable, computed, action &#125; from &apos;mobx&apos;import oneInfo from &apos;./OneInfo&apos;import twoInfo from &apos;./TwoInfo&apos;/** * æ ¹store * OneInfo OneInfoæ•°æ® * TwoInfo TwoInfoæ•°æ®*/class RootStore &#123; constructor() &#123; this.OneInfo = new OneInfo(oneInfo,this) this.TwoInfo = new TwoInfo(twoInfo,this) &#125;&#125;// Oneclass OneInfo &#123; @observable allDatas = [] constructor(data,rootStore) &#123; this.allDatas = data this.rootStore = rootStore &#125; //åŠ  @action add(num) &#123; this.allDatas.oneNum = num + 1 this.rootStore.TwoInfo.allDatas.twoColor = &apos;red&apos; &#125; //å‡ @action sub(num) &#123; this.allDatas.oneNum = num - 1 this.rootStore.TwoInfo.allDatas.twoColor = &apos;blue&apos; &#125;&#125;// Twoclass TwoInfo &#123; @observable allDatas = &#123;&#125; constructor(data,rootStore) &#123; this.allDatas = data this.rootStore = rootStore &#125;&#125;export default new RootStore() å¦å¤–:OneInfo.js 123456789const OneInfo = &#123; &quot;data&quot;: [ ], &quot;isOne&quot; : true, &quot;oneNum&quot; : 0&#125;export default OneInfo; TwoInfo.js 123456789const TwoInfo = &#123; &quot;data&quot;: [ ], &quot;isTwo&quot; : false, &quot;twoColor&quot;:&apos;white&apos;&#125;export default TwoInfo; ok,å›åˆ°App.jsä¸­: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105import React, &#123;Component&#125; from &apos;react&apos;;import &#123;Platform, StyleSheet, Text, View, Image&#125; from &apos;react-native&apos;;import &#123;StackNavigator, TabNavigator, TabBarBottom&#125; from &apos;react-navigation&apos;;// å…¨å±€æ³¨å†Œå¹¶æ³¨å…¥mobxï¼Œå…¶ä»–åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨storeimport &#123;Provider&#125; from &apos;mobx-react&apos;;// è·å–storeå®ä¾‹import store from &apos;./src/Mobx/Store&apos;;import One from &apos;./src/One/One&apos;;import Two from &apos;./src/Two/Two&apos;;export default class TwoDetails extends Component&lt;Props&gt; &#123; render () &#123; return ( &lt;Provider rootStore=&#123;store&#125;&gt; &lt;Navigator onNavigationStateChange=&#123;(prevState, currentState) =&gt; &#123; // åªè¦åˆ‡æ¢tab,push,pop,è¿™é‡Œä¸€å®šèµ° console.log (prevState); console.log (currentState); &#125;&#125; /&gt; &lt;/Provider&gt; ); &#125; componentDidMount = () =&gt; &#123; console.disableYellowBox = true; //å»é™¤é»„è‰²å¼¹æ¡†è­¦å‘Š &#125;;&#125;const Tab = TabNavigator ( &#123; One: &#123; screen: One, navigationOptions: (&#123;navigation&#125;) =&gt; (&#123; tabBarLabel: &apos;ç”·å­©&apos;, tabBarIcon: (&#123;focused, tintColor&#125;) =&gt; ( &lt;Image source=&#123; focused ? require (&apos;./src/Image/boy_active.png&apos;) : require (&apos;./src/Image/boy.png&apos;) &#125; style=&#123;&#123;width: 25, height: 25&#125;&#125; /&gt; ), &#125;), &#125;, Two: &#123; screen: Two, navigationOptions: (&#123;navigation&#125;) =&gt; (&#123; tabBarLabel: &apos;å¥³å­©&apos;, tabBarIcon: (&#123;focused, tintColor&#125;) =&gt; ( &lt;Image source=&#123; focused ? require (&apos;./src/Image/girl_active.png&apos;) : require (&apos;./src/Image/girl.png&apos;) &#125; style=&#123;&#123;width: 25, height: 25&#125;&#125; /&gt; ), &#125;), &#125;, &#125;, &#123; tabBarComponent: TabBarBottom, tabBarPosition: &apos;bottom&apos;, swipeEnabled: true, animationEnabled: true, lazy: true, tabBarOptions: &#123; activeTintColor: &apos;#979797&apos;, inactiveTintColor: &apos;#979797&apos;, style: &#123;backgroundColor: &apos;#ffffff&apos;&#125;, &#125;, &#125;);const Navigator = StackNavigator (&#123; Tab: &#123; screen: Tab, &#125;,&#125;);const styles = StyleSheet.create (&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;); ç„¶åå°±æ˜¯åŸºæœ¬çš„UIç•Œé¢äº†:One.js 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &apos;react&apos;;import &#123; Platform, StyleSheet, Text, View&#125; from &apos;react-native&apos;;import &#123; observer, inject &#125; from &apos;mobx-react&apos;import &#123; action, autorun, computed &#125; from &apos;mobx&apos;@inject(&apos;rootStore&apos;)@observerexport default class One extends Component&lt;Props&gt; &#123; // æ„é€  constructor(props) &#123; super(props); // åˆå§‹çŠ¶æ€ this.state = &#123;&#125;; &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text onPress=&#123;()=&gt;this.add()&#125;&gt; + çº¢ &lt;/Text&gt; &lt;Text&gt; One &#123;this.dataSource&#125; &lt;/Text&gt; &lt;Text onPress=&#123;()=&gt;this.sub()&#125;&gt; - è“ &lt;/Text&gt; &lt;/View&gt; ); &#125; @computed get dataSource() &#123; return this.props.rootStore.OneInfo.allDatas.oneNum; &#125; /** * + * */ @action add() &#123; this.props.rootStore.OneInfo.add(this.dataSource) &#125; /** * - * */ @action sub() &#123; this.props.rootStore.OneInfo.sub(this.dataSource) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;); Two.js 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &apos;react&apos;;import &#123; Platform, StyleSheet, Text, View&#125; from &apos;react-native&apos;;import &#123; observer, inject &#125; from &apos;mobx-react&apos;import &#123; action, autorun, computed &#125; from &apos;mobx&apos;@inject(&apos;rootStore&apos;)@observerexport default class Two extends Component&lt;Props&gt; &#123; render() &#123; return ( &lt;View style=&#123;[styles.container,&#123;backgroundColor:this.bgColor&#125;]&#125;&gt; &lt;Text&gt; TWO &lt;/Text&gt; &lt;/View&gt; ); &#125; @computed get bgColor() &#123; return this.props.rootStore.TwoInfo.allDatas.twoColor; &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;); ok,ä»¥ä¸Šå°±æ˜¯Mbox+react-navigationçš„Demoçš„åŸºæœ¬ä»£ç äº†.æ•ˆæœå›¾: æºç  å¦å¤–:redux+react-navigationå¦å¤–:dva+react-navigation","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"å‰ç«¯ç²¾çµå›¾å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ /ç²¾çµå›¾å­¦ä¹ ","date":"2018-03-18T08:18:48.245Z","updated":"2018-05-17T13:54:44.185Z","comments":true,"path":"2018/03/18/å‰ç«¯å­¦ä¹ /ç²¾çµå›¾å­¦ä¹ /","link":"","permalink":"https://pheromone.github.io/2018/03/18/å‰ç«¯å­¦ä¹ /ç²¾çµå›¾å­¦ä¹ /","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹å‰ç«¯ä¸­çš„ ç²¾çµå›¾.ä¸ºä½•å¼•å…¥ç²¾çµå›¾: ç½‘é¡µä¸Šé¢çš„æ¯å¼ å›¾ç‰‡éƒ½è¦ç»å†ä¸€æ¬¡è¯·æ±‚æ‰èƒ½å±•ç¤ºç»™ç”¨æˆ·ï¼Œå°çš„å›¾æ ‡é¢‘ç¹çš„è¯·æ±‚æœåŠ¡å™¨ï¼Œé™ä½é¡µé¢çš„åŠ è½½é€Ÿåº¦ï¼Œä¸ºäº†æœ‰æ•ˆåœ°å‡å°‘æœåŠ¡å™¨æ¥æ”¶å’Œå‘é€è¯·æ±‚çš„æ¬¡æ•°ï¼Œæé«˜é¡µé¢çš„åŠ è½½é€Ÿåº¦ï¼Œå› æ­¤ï¼Œäº§ç”Ÿäº†cssç²¾çµæŠ€æœ¯ã€‚","text":"ä»Šå¤©å­¦ä¹ ä¸‹å‰ç«¯ä¸­çš„ ç²¾çµå›¾.ä¸ºä½•å¼•å…¥ç²¾çµå›¾: ç½‘é¡µä¸Šé¢çš„æ¯å¼ å›¾ç‰‡éƒ½è¦ç»å†ä¸€æ¬¡è¯·æ±‚æ‰èƒ½å±•ç¤ºç»™ç”¨æˆ·ï¼Œå°çš„å›¾æ ‡é¢‘ç¹çš„è¯·æ±‚æœåŠ¡å™¨ï¼Œé™ä½é¡µé¢çš„åŠ è½½é€Ÿåº¦ï¼Œä¸ºäº†æœ‰æ•ˆåœ°å‡å°‘æœåŠ¡å™¨æ¥æ”¶å’Œå‘é€è¯·æ±‚çš„æ¬¡æ•°ï¼Œæé«˜é¡µé¢çš„åŠ è½½é€Ÿåº¦ï¼Œå› æ­¤ï¼Œäº§ç”Ÿäº†cssç²¾çµæŠ€æœ¯ã€‚ä»¥æœ¬åœ°å›¾ç‰‡ä¸ºä¾‹:ç²¾çµå›¾ä½¿ç”¨å…¶å®å°±æ˜¯å¯¹background-position:x yå¯¹å›¾ç‰‡è¿›è¡Œåç§»æ˜¾ç¤ºè€Œå·².ä¸‹é¢æ˜¯ä»£ç :12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;html&gt; &lt;head&gt; &lt;style&gt; *&#123; margin:0; padding:0; &#125; .div0&#123; margin:10px; &#125; .demo1,.demo2,.demo3,.demo4,.demo5,.demo6&#123; display:inline-block; width:17px; height:17px; background-color:transparent; background-image:url(img/ç²¾çµå›¾.png); background-repeat:no-repeat; &#125; .demo1&#123; background-position:-38px -37px;&#125; .demo2&#123; background-position:-62px -37px;&#125; .demo3&#123; background-position:-86px -37px;&#125; .demo4&#123; background-position:-110px -37px;&#125; .demo5&#123; background-position:-134px -37px;&#125; .demo6&#123; background-position:-159px -37px;&#125; ul&#123; list-style:none; &#125; ul li &#123; margin:10px; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=&quot;div0&quot;&gt; &lt;ul&gt; &lt;li&gt;&lt;div class=&quot;demo1&quot;&gt;&lt;/div&gt; å›¾æ ‡1&lt;/li&gt; &lt;li&gt;&lt;div class=&quot;demo2&quot;&gt;&lt;/div&gt; å›¾æ ‡2&lt;/li&gt; &lt;li&gt;&lt;div class=&quot;demo3&quot;&gt;&lt;/div&gt; å›¾æ ‡3&lt;/li&gt; &lt;li&gt;&lt;div class=&quot;demo4&quot;&gt;&lt;/div&gt; å›¾æ ‡4&lt;/li&gt; &lt;li&gt;&lt;div class=&quot;demo5&quot;&gt;&lt;/div&gt; å›¾æ ‡5&lt;/li&gt; &lt;li&gt;&lt;div class=&quot;demo6&quot;&gt;&lt;/div&gt; å›¾æ ‡6&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/body&gt;&lt;/html&gt; æ•ˆæœå›¾: æºç ","categories":[{"name":"å‰ç«¯å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/å‰ç«¯å­¦ä¹ /"}],"tags":[{"name":"å‰ç«¯å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/å‰ç«¯å­¦ä¹ /"}]},{"title":"å…¶ä»–å­¦ä¹ ","slug":"å…¶ä»–å­¦ä¹ /å…¶ä»–å­¦ä¹ ","date":"2018-03-18T08:18:48.245Z","updated":"2018-05-16T05:25:38.036Z","comments":true,"path":"2018/03/18/å…¶ä»–å­¦ä¹ /å…¶ä»–å­¦ä¹ /","link":"","permalink":"https://pheromone.github.io/2018/03/18/å…¶ä»–å­¦ä¹ /å…¶ä»–å­¦ä¹ /","excerpt":"åŠ ç´§æ–½å·¥ä¸­â€¦","text":"åŠ ç´§æ–½å·¥ä¸­â€¦","categories":[{"name":"å…¶ä»–å­¦ä¹ ","slug":"å…¶ä»–å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/å…¶ä»–å­¦ä¹ /"}],"tags":[{"name":"å…¶ä»–å­¦ä¹ ","slug":"å…¶ä»–å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/å…¶ä»–å­¦ä¹ /"}]},{"title":"å‰ç«¯é©¬èµ›å…‹å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ /é©¬èµ›å…‹å­¦ä¹ ","date":"2018-03-18T08:18:48.245Z","updated":"2018-05-17T13:45:31.367Z","comments":true,"path":"2018/03/18/å‰ç«¯å­¦ä¹ /é©¬èµ›å…‹å­¦ä¹ /","link":"","permalink":"https://pheromone.github.io/2018/03/18/å‰ç«¯å­¦ä¹ /é©¬èµ›å…‹å­¦ä¹ /","excerpt":"ä¸Šå‘¨å»èœå¸‚åœºä¹°èœ,çœ‹åˆ°è·¯è¾¹ä¸€ä¸ªäºŒç»´ç ,äºæ˜¯æƒ³èµ·é˜¿é‡Œå·´å·´,æ¥ç€æƒ³èµ·ä¹‹å‰ä¸Šç­éƒ½ä¼šè·¯è¿‡é˜¿é‡Œå·´å·´,æ¥ç€æƒ³èµ·é©¬äº‘,ç„¶åæƒ³åˆ°é©¬èµ›å…‹!!!äºæ˜¯æˆ‘å›å®¶äº†,æƒ³å­¦ä¹ ä¸‹å‰ç«¯ä¸­çš„é©¬èµ›å…‹.","text":"ä¸Šå‘¨å»èœå¸‚åœºä¹°èœ,çœ‹åˆ°è·¯è¾¹ä¸€ä¸ªäºŒç»´ç ,äºæ˜¯æƒ³èµ·é˜¿é‡Œå·´å·´,æ¥ç€æƒ³èµ·ä¹‹å‰ä¸Šç­éƒ½ä¼šè·¯è¿‡é˜¿é‡Œå·´å·´,æ¥ç€æƒ³èµ·é©¬äº‘,ç„¶åæƒ³åˆ°é©¬èµ›å…‹!!!äºæ˜¯æˆ‘å›å®¶äº†,æƒ³å­¦ä¹ ä¸‹å‰ç«¯ä¸­çš„é©¬èµ›å…‹.å®Œæˆçš„åŠŸèƒ½ é€‰æ‹©å½“åœ°ä¸€å¼ å›¾ç‰‡ ç‚¹å‡»ç»˜åˆ¶é©¬èµ›å…‹ æ‹–åŠ¨ç»˜åˆ¶é©¬èµ›å…‹ ä¸ºäº†æ–¹ä¾¿,ç›¸å…³jsä»£ç ç›´æ¥å†™åœ¨äº†index.htmlä¸­,å¤§è‡´åˆ†ä¸ºåŠ è½½å›¾ç‰‡,æ·»åŠ ç›‘å¬,æ–¹æ³•è§¦å‘,ç»˜åˆ¶å°æ–¹å—(é©¬èµ›å…‹),è®¡ç®—é¢œè‰²,æ•°ç»„å‡ç»´è¿™å‡ ä¸ªæ–¹æ³•,UIéƒ¨åˆ†é€šè¿‡canvas æ ‡ç­¾å’Œinput æ ‡ç­¾ç»˜åˆ¶.ä¸‹é¢æ˜¯å®Œæ•´çš„index.htmlä»£ç  &lt;!doctype html&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;&lt;/title&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;meta name=&quot;Keywords&quot; content=&quot;é©¬èµ›å…‹ canvas&quot;&gt; &lt;meta name=&quot;Description&quot; content=&quot;å­¦ä¹ å‰ç«¯é©¬èµ›å…‹&quot;&gt; &lt;/head&gt; &lt;style&gt; canvas { border: 1px black solid; } &lt;/style&gt; &lt;body&gt; &lt;div id=&quot;mask&quot;&gt; &lt;canvas width=&quot;600&quot; height=&quot;600&quot;&gt; &lt;/canvas&gt; &lt;input type=&quot;file&quot; class=&apos;input&apos;&gt; &lt;/div&gt; &lt;script&gt; var canvas = document.querySelector(&apos;canvas&apos;); var input = document.querySelector(&apos;#mask .input&apos;); var ctx = canvas.getContext(&apos;2d&apos;); var mousedown = false; var t = 15; input.onchange = function () { loadimg(); } /** *åŠ è½½å›¾ç‰‡ */ function loadimg() { var img = new Image(); img.src = window.URL.createObjectURL(input.files[0]); img.onload = function () { ctx.drawImage(img, 0, 0, 600, 600); } register(); } /** *æ·»åŠ ç›‘å¬ */ function register() { canvas.addEventListener(&apos;mousedown&apos;, action) canvas.addEventListener(&apos;mousemove&apos;, action) canvas.addEventListener(&apos;mouseup&apos;, action) } /** *æ–¹æ³•è§¦å‘ */ function action(e) { var dx = parseInt(((e.offsetX - t / 2) / t) * t) var dy = parseInt(((e.offsetY - t / 2) / t) * t) if (e.type == &quot;mousedown&quot;) { mousedown = true; computeColor(dx, dy); } if (mousedown &amp;&amp; e.type == &quot;mousemove&quot;) { computeColor(dx, dy); } if (e.type == &quot;mouseup&quot;) { mousedown = false; } } /* * ç”»å°æ–¹å— */ function rect(x, y, c) { ctx.beginPath(); ctx.fillStyle = c; var dx = parseInt(x / t)*t,dy = parseInt(y / t)*t ctx.rect(dx, dy, t, t); ctx.fill(); } /** è®¡ç®—é¢œè‰² */ function computeColor(x, y) { var arrList = restore(ctx.getImageData(x,y,t,t).data,4); //ä¸€ç»´æ•°ç»„ var vr = 0, vg = 0, vb = 0,al = arrList.length; for(var i = 0; i &lt; al; i++){ vr += arrList[i][0]; vg += arrList[i][1]; vb += arrList[i][2]; var color = &apos;rgb(&apos; + Math.floor(vr/al) + &apos;,&apos; + Math.floor(vg/al) + &apos;,&apos; + Math.floor(vb/al) + &apos;)&apos;; rect(x,y,color); } } /** *æ•°ç»„å‡ç»´ [1,2,3,4] =&gt; [[1,2],[3,4]] */ function restore(arr, step) { var list = []; var index = 0; var n = Math.floor(arr.length/step); for(var i = 0; i &lt; n ;i++){ list.push(arr.slice(index,index+step)); index += step; } return list; } &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; æ•ˆæœå›¾: æ˜¯ä¸æ˜¯ç‰¹åˆ«æ£’,å†ä¹Ÿä¸ä¸ºå¥³æœ‹å‹ç…§ç‰‡çš„éšç§çŠ¯æ„äº†.ps:ç°åœ¨å°±å·®ä¸ªå¥³æœ‹å‹äº† æºç ","categories":[{"name":"å‰ç«¯å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/å‰ç«¯å­¦ä¹ /"}],"tags":[{"name":"å‰ç«¯å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/å‰ç«¯å­¦ä¹ /"}]},{"title":"Androidå’ŒReact-Nativeçš„ç®€å•äº¤äº’","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Androidå’ŒReact-Nativeçš„ç®€å•äº¤äº’","date":"2018-03-18T08:18:48.245Z","updated":"2019-04-22T07:53:06.104Z","comments":true,"path":"2018/03/18/ç§»åŠ¨ç«¯å­¦ä¹ /Androidå’ŒReact-Nativeçš„ç®€å•äº¤äº’/","link":"","permalink":"https://pheromone.github.io/2018/03/18/ç§»åŠ¨ç«¯å­¦ä¹ /Androidå’ŒReact-Nativeçš„ç®€å•äº¤äº’/","excerpt":"é¦–å…ˆåœ¨AndroidåŸç”Ÿä¸­.æ–°å»ºclassæ–‡ä»¶TransMissonMoudle:","text":"é¦–å…ˆåœ¨AndroidåŸç”Ÿä¸­.æ–°å»ºclassæ–‡ä»¶TransMissonMoudle: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108/** * Created by shaotingzhou on 2018/3/7. */package com.androidrn.RN;import com.facebook.react.bridge.Callback;import com.facebook.react.bridge.Promise;import com.facebook.react.bridge.ReactApplicationContext;import com.facebook.react.bridge.ReactContext;import com.facebook.react.bridge.ReactContextBaseJavaModule;import com.facebook.react.bridge.ReactMethod;import com.facebook.react.bridge.WritableMap;import com.facebook.react.bridge.WritableNativeMap;import com.facebook.react.modules.core.DeviceEventManagerModule;import java.text.SimpleDateFormat;import java.util.Date;import javax.annotation.Nullable;public class TransMissonMoudle extends ReactContextBaseJavaModule &#123; private static final String REACT_CLASS = &quot;TransMissonMoudle&quot;; private ReactContext mReactContext; public TransMissonMoudle(ReactApplicationContext reactContext) &#123; super(reactContext); this.mReactContext = reactContext; &#125; @Override public String getName() &#123; return REACT_CLASS; &#125; //å»¶è¿Ÿ0.1ç§’è·å–æ—¶é—´ã€‚ @ReactMethod public void getTime() &#123; new Thread(new Runnable() &#123; @Override public void run() &#123; try &#123; Thread.sleep(100); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; String time = getTimeMillis(); WritableMap writableMap = new WritableNativeMap(); writableMap.putString(&quot;key&quot;, time); sendTransMisson(mReactContext, &quot;EventName&quot;, writableMap); &#125; &#125;).start(); &#125; private String getTimeMillis() &#123; SimpleDateFormat formatDate = new SimpleDateFormat(&quot;yyyyå¹´MMæœˆddæ—¥ HH:mm:ss&quot;); Date date = new Date(System.currentTimeMillis()); String time = formatDate.format(date); return time; &#125; /** * RCTDeviceEventEmitteræ–¹å¼ * * @param reactContext * @param eventName äº‹ä»¶å * @param params ä¼ æƒ¨ */ public void sendTransMisson(ReactContext reactContext, String eventName, @Nullable WritableMap params) &#123; reactContext .getJSModule(DeviceEventManagerModule.RCTDeviceEventEmitter.class) .emit(eventName, params); &#125; /** * CallBackæ–¹å¼ * * @param name * @param callback */ @ReactMethod public void callBackTime(String name, Callback callback) &#123; callback.invoke(getTimeMillis()); &#125; /** * Promiseæ–¹å¼ * @param name * @param promise */ @ReactMethod public void sendPromiseTime(String name, Promise promise) &#123; WritableMap writableMap=new WritableNativeMap(); writableMap.putString(&quot;age&quot;,&quot;20&quot;); writableMap.putString(&quot;time&quot;,getTimeMillis()); promise.resolve(writableMap); &#125;&#125; å†å»ºclassæ–‡ä»¶TransMissonPackage: 1234567891011121314151617181920212223242526272829303132333435363738package com.androidrn.RN;import com.facebook.react.ReactPackage;import com.facebook.react.bridge.JavaScriptModule;import com.facebook.react.bridge.NativeModule;import com.facebook.react.bridge.ReactApplicationContext;import com.facebook.react.uimanager.ViewManager;import java.util.ArrayList;import java.util.Collections;import java.util.List;/** * Created by shaotingzhou on 2018/3/7. */public class TransMissonPackage implements ReactPackage &#123; @Override public List&lt;NativeModule&gt; createNativeModules(ReactApplicationContext reactContext) &#123; List&lt;NativeModule&gt; modules = new ArrayList&lt;&gt;(); modules.add(new TransMissonMoudle(reactContext));//æ‘‡ä¸€æ‘‡ return modules; &#125;// @Override// public List&lt;Class&lt;? extends JavaScriptModule&gt;&gt; createJSModules() &#123;// return Collections.emptyList();// &#125; @Override public List&lt;ViewManager&gt; createViewManagers(ReactApplicationContext reactContext) &#123; List&lt;ViewManager&gt; viewManagerList=new ArrayList&lt;&gt;();// viewManagerList.add(new PTRRefreshManager()); return viewManagerList; &#125;&#125; æ¥ç€åœ¨MainApplicationé‡Œå¼•å…¥TransMissonPackage,åŠ å…¥åŒ….å¦‚ import com.androidrn.RN.TransMissonPackage; new TransMissonPackage()123456789101112131415161718192021222324252627282930313233343536373839404142434445464748package com.androidrn;import android.app.Application;import com.androidrn.RN.TransMissonPackage;import com.facebook.react.ReactApplication;import com.facebook.react.ReactNativeHost;import com.facebook.react.ReactPackage;import com.facebook.react.shell.MainReactPackage;import com.facebook.soloader.SoLoader;import java.util.Arrays;import java.util.List;public class MainApplication extends Application implements ReactApplication &#123; private final ReactNativeHost mReactNativeHost = new ReactNativeHost(this) &#123; @Override public boolean getUseDeveloperSupport() &#123; return BuildConfig.DEBUG; &#125; @Override protected List&lt;ReactPackage&gt; getPackages() &#123; return Arrays.&lt;ReactPackage&gt;asList( new MainReactPackage(), new TransMissonPackage() ); &#125; @Override protected String getJSMainModuleName() &#123; return &quot;index&quot;; &#125; &#125;; @Override public ReactNativeHost getReactNativeHost() &#123; return mReactNativeHost; &#125; @Override public void onCreate() &#123; super.onCreate(); SoLoader.init(this, /* native exopackage */ false); &#125;&#125; æˆ‘çš„æ–‡ä»¶æ”¾ç½®æƒ…å†µå¦‚å›¾: ç„¶ååªéœ€è¦åœ¨RNè¿™è¾¹:123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123;Component&#125; from &apos;react&apos;;import &#123; AppRegistry, StyleSheet, Text, View, DeviceEventEmitter, NativeModules, ToastAndroid, Platform&#125; from &apos;react-native&apos;;const instructions = Platform.select(&#123; ios: &apos;Press Cmd+R to reload,\\n&apos; + &apos;Cmd+D or shake for dev menu&apos;, android: &apos;Double tap R on your keyboard to reload,\\n&apos; + &apos;Shake or press menu button for dev menu&apos;,&#125;);type Props = &#123;&#125;;export default class App extends Component&lt;Props&gt; &#123; componentWillMount() &#123; DeviceEventEmitter.addListener(&apos;EventName&apos;, function (msg) &#123; console.log(&apos;DeviceEventEmitteræ”¶åˆ°æ¶ˆæ¯&apos;+msg); alert(&apos;DeviceEventEmitteræ”¶åˆ°æ¶ˆæ¯&apos;+ msg.key) &#125;); &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text style=&#123;styles.welcome&#125; onPress=&#123;this.getDeviceEventEmitterTime.bind(this)&#125; &gt; RCTDeviceEventEmitterè·å–æ—¶é—´ &lt;/Text&gt; &lt;Text style=&#123;styles.welcome&#125; onPress=&#123;this.getCallBackTime.bind(this)&#125; &gt; CallBackè·å–æ—¶é—´ &lt;/Text&gt; &lt;Text style=&#123;styles.welcome&#125; onPress=&#123;this.getPromiseTime.bind(this)&#125; &gt; Promiseè·å–æ—¶é—´ &lt;/Text&gt; &lt;/View&gt; ); &#125; getDeviceEventEmitterTime() &#123; NativeModules.TransMissonMoudle.getTime(); &#125; getCallBackTime() &#123; NativeModules.TransMissonMoudle.callBackTime(&quot;Allure&quot;, (msg) =&gt; &#123; console.log(&apos;callBack:---&apos; + msg); alert(&apos;callBack:---&apos;+msg) &#125; ); &#125; getPromiseTime() &#123; NativeModules.TransMissonMoudle.sendPromiseTime(&quot;Allure&quot;).then(msg=&gt; &#123; console.log(&quot;å¹´é¾„:&quot; + msg.age + &quot;/n&quot; + &quot;æ—¶é—´:&quot; + msg.time); alert(&quot;å¹´é¾„&quot; + msg.age + &quot;æ—¶é—´&quot; + msg.time) this.setState(&#123; age: msg.age, time: msg.time, &#125;) &#125;).catch(error=&gt; &#123; console.log(&apos;é”™è¯¯&apos; + error); &#125;); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;); æºç  æ•ˆæœå›¾:","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"åç«¯å­¦ä¹ ","slug":"åç«¯å­¦ä¹ /åç«¯å­¦ä¹ ","date":"2018-03-18T08:18:48.245Z","updated":"2018-05-16T05:31:45.728Z","comments":true,"path":"2018/03/18/åç«¯å­¦ä¹ /åç«¯å­¦ä¹ /","link":"","permalink":"https://pheromone.github.io/2018/03/18/åç«¯å­¦ä¹ /åç«¯å­¦ä¹ /","excerpt":"åŠ ç´§æ–½å·¥ä¸­â€¦","text":"åŠ ç´§æ–½å·¥ä¸­â€¦","categories":[{"name":"åç«¯å­¦ä¹ ","slug":"åç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/åç«¯å­¦ä¹ /"}],"tags":[{"name":"åç«¯å­¦ä¹ ","slug":"åç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/åç«¯å­¦ä¹ /"}]},{"title":"reduxå’Œreact-navigationçš„ç»“åˆä½¿ç”¨","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /reduxå’Œreact-navigationçš„ç»“åˆä½¿ç”¨","date":"2018-03-18T08:16:47.866Z","updated":"2018-07-29T10:36:14.785Z","comments":true,"path":"2018/03/18/ç§»åŠ¨ç«¯å­¦ä¹ /reduxå’Œreact-navigationçš„ç»“åˆä½¿ç”¨/","link":"","permalink":"https://pheromone.github.io/2018/03/18/ç§»åŠ¨ç«¯å­¦ä¹ /reduxå’Œreact-navigationçš„ç»“åˆä½¿ç”¨/","excerpt":"react-navigation å’Œ redux çš„ä½¿ç”¨,è¿™ä¸ªç½‘ä¸Šå¾ˆå¤š.è¿™é‡Œä»‹ç»ä¸‹ä¸¤è€…çš„ç»“åˆä½¿ç”¨.","text":"react-navigation å’Œ redux çš„ä½¿ç”¨,è¿™ä¸ªç½‘ä¸Šå¾ˆå¤š.è¿™é‡Œä»‹ç»ä¸‹ä¸¤è€…çš„ç»“åˆä½¿ç”¨.æˆ‘ä»£ç çš„ç›®å½•ç»“æ„æ˜¯: ä½¿ç”¨çš„ä¸‰æ–¹åº“æ˜¯:1234567891011121314151617181920212223242526272829&#123; &quot;name&quot;: &quot;RN_nav&quot;, &quot;version&quot;: &quot;0.0.1&quot;, &quot;private&quot;: true, &quot;scripts&quot;: &#123; &quot;start&quot;: &quot;node node_modules/react-native/local-cli/cli.js start&quot;, &quot;test&quot;: &quot;jest&quot; &#125;, &quot;dependencies&quot;: &#123; &quot;react&quot;: &quot;16.3.0-alpha.1&quot;, &quot;react-native&quot;: &quot;0.54.0&quot;, &quot;react-navigation&quot;: &quot;^1.5.1&quot;, &quot;react-navigation-redux-helpers&quot;: &quot;^1.0.3&quot;, &quot;react-redux&quot;: &quot;^5.0.7&quot;, &quot;redux&quot;: &quot;^3.7.2&quot;, &quot;redux-actions&quot;: &quot;^2.3.0&quot;, &quot;redux-logger&quot;: &quot;^3.0.6&quot;, &quot;redux-thunk&quot;: &quot;^2.2.0&quot; &#125;, &quot;devDependencies&quot;: &#123; &quot;babel-jest&quot;: &quot;22.4.1&quot;, &quot;babel-preset-react-native&quot;: &quot;4.0.0&quot;, &quot;jest&quot;: &quot;22.4.2&quot;, &quot;react-test-renderer&quot;: &quot;16.3.0-alpha.1&quot; &#125;, &quot;jest&quot;: &#123; &quot;preset&quot;: &quot;react-native&quot; &#125;&#125; ä¸‹é¢æ˜¯å„æ–‡ä»¶çš„æºç .App.js1234567891011121314151617181920/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React,&#123; Component &#125; from &apos;react&apos;;import &#123;Provider&#125; from &apos;react-redux&apos;;import store from &apos;./src/store&apos;;import NavigatorPages from &apos;./src/AllPages/TabNavigatorPage&apos;;type Props = &#123;&#125;;export default class App extends Component&lt;Props&gt; &#123; render() &#123; return ( &lt;Provider store=&#123;store&#125;&gt; &lt;NavigatorPages/&gt; &lt;/Provider&gt; ); &#125;&#125; Allreducerstore.js123456789101112131415161718192021import &#123;createStore,applyMiddleware&#125; from &apos;redux&apos;;//ä¸­é—´ä»¶import logger from &apos;redux-logger&apos;;import thunk from &apos;redux-thunk&apos;;import &#123; createReduxBoundAddListener, createReactNavigationReduxMiddleware,&#125; from &apos;react-navigation-redux-helpers&apos;;//reducersimport reducers from &apos;./Allreducer/index&apos;;//å¼•ç”¨react-navigation-redux-helpersç»„ä»¶æ‰‹åŠ¨åˆ›å»ºä¸­é—´ä»¶,æ¥å—stateå¹¶è¿”å›æ–°çš„state,è®©è·¯ç”±åˆ·æ–°// Note: createReactNavigationReduxMiddleware must be run before createReduxBoundAddListenerconst middleware = createReactNavigationReduxMiddleware( &quot;App&quot;, state =&gt; state.nav,);export const addListener = createReduxBoundAddListener(&quot;App&quot;);const middleWares = [middleware,thunk,logger];export default applyMiddleware(...middleWares)(createStore)(reducers); FirstPageReducer.js1234567891011121314151617181920212223import &#123;handleActions&#125; from &apos;redux-actions&apos;;const initialState = &#123; zglNum:0&#125;;export default handleActions(&#123; ADD:(state,action)=&gt;&#123; // alert(state.zglNum) return &#123; ...state, zglNum:state.zglNum + 1, secondState:&apos;iOS&apos; &#125; &#125;, SUB:(state,action)=&gt;&#123; return &#123; ...state, zglNum:state.zglNum - 1, secondState:&apos;Android&apos; &#125; &#125;&#125;,initialState); SecondPageReducer.js12345678910111213141516/** * Created by shaotingzhou on 2018/3/6. */import &#123;handleActions&#125; from &apos;redux-actions&apos;;const initialState = &#123; xxx:0&#125;;export default handleActions(&#123; SECOND:(state,action)=&gt;&#123; return &#123; ...state, xxx:2 &#125; &#125;,&#125;,initialState); index.js12345678910import &#123; combineReducers &#125; from &apos;redux&apos;;import TabNavigatorReducer from &apos;./TabNavigatorReducer&apos;;import FirstPageReducer from &apos;./FirstPageReducer&apos;;import SecondPageReducer from &apos;./SecondPageReducer&apos;;const reducers = combineReducers(&#123; TabNavigatorReducer, FirstPageReducer, SecondPageReducer,&#125;);export default reducers; AllPagesFirstPage.js12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485import React, &#123; PureComponent &#125; from &apos;react&apos;;import &#123; StyleSheet, Text, View, TouchableOpacity, Image&#125; from &apos;react-native&apos;;import &#123;connect&#125; from &apos;react-redux&apos;;import &#123;ADD,SUB&#125; from &apos;../Actions/FirstPageActions&apos;;class FirstPage extends PureComponent &#123; static navigationOptions = &#123; title:&apos;é¦–é¡µ&apos;, &#125;; // componentWillUpdate()&#123; // alert(this.props.status); // // &#125; // componentDidUpdate()&#123; // alert(this.props.status); // &#125; // ES6 props // static defaultProps=&#123; // zglNum:0, // &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;TouchableOpacity onPress=&#123;()=&gt;&#123; this.props.dispatch(ADD()); &#125;&#125; &gt; &lt;Text style=&#123;styles.welcome&#125;&gt; + &lt;/Text&gt; &lt;/TouchableOpacity&gt; &lt;Text style=&#123;styles.welcome&#125;&gt; &#123;this.props.zglNum&#125; &lt;/Text&gt; &lt;TouchableOpacity onPress=&#123;()=&gt;&#123; this.props.dispatch(SUB()); &#125;&#125; &gt; &lt;Text style=&#123;styles.welcome&#125;&gt; - &lt;/Text&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; ); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, textView: &#123; fontSize: 16, textAlign: &apos;center&apos;, margin: 10, color:&apos;red&apos; &#125;,&#125;);const mapStateToProps = (store)=&gt;(&#123; zglNum: store.FirstPageReducer.zglNum //æ•°å­—&#125;);export default connect(mapStateToProps)(FirstPage); SecondPage.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960import React, &#123; PureComponent &#125; from &apos;react&apos;;import &#123; StyleSheet, Text, View, TouchableOpacity, Image&#125; from &apos;react-native&apos;;import &#123;connect&#125; from &apos;react-redux&apos;;import &#123;SECOND&#125; from &apos;../Actions/SecondPageActions&apos;;class SecondPage extends PureComponent &#123; static navigationOptions = &#123; title:&apos;ç¬¬äºŒ&apos; &#125;; // ES6 props static defaultProps=&#123; secondState:&apos;é»˜è®¤&apos;, &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125; &gt; &lt;Text onPress=&#123;()=&gt;this.onClick()&#125;&gt;&#123;this.props.secondState&#125;&lt;/Text&gt; &lt;/View&gt; ); &#125; onClick =() =&gt;&#123; this.props.navigation.navigate(&apos;Snnn&apos;) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, textView: &#123; fontSize: 16, textAlign: &apos;center&apos;, margin: 10, color:&apos;red&apos; &#125;,&#125;);const mapStateToProps = (store)=&gt;(&#123; secondState:store.FirstPageReducer.secondState&#125;);export default connect(mapStateToProps)(SecondPage); NavigatorPage.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105import React, &#123; Component &#125; from &apos;react&apos;;import &#123; StyleSheet, Text, View, TouchableOpacity, Image&#125; from &apos;react-native&apos;;import FirstPage from &apos;./FirstPage&apos;;import SecondPage from &apos;./SecondPage&apos;;import &#123;connect&#125; from &apos;react-redux&apos;;import Snnn from &apos;./Snnn&apos;import &#123; StackNavigator, addNavigationHelpers, TabNavigator,&#125; from &apos;react-navigation&apos;;import &#123;addListener&#125; from &apos;../store&apos;;class NavigatorPages extends Component&#123; constructor(props)&#123; super(props); &#125; render()&#123; return( &lt;SimpleAppNavigator navigation=&#123;addNavigationHelpers(&#123; dispatch: this.props.dispatch, state: this.props.nav, addListener &#125;)&#125; /&gt; ) &#125;&#125;const Tab = TabNavigator(&#123; page1: &#123; screen: FirstPage, navigationOptions: (&#123; navigation &#125;) =&gt; (&#123; tabBarLabel: &apos;è‹¹æœ233&apos;, tabBarIcon: (&#123; focused, tintColor &#125;) =&gt; ( &lt;Image source=&#123;focused ? require(&apos;../../image/one_selected.png&apos;) : require(&apos;../../image/one.png&apos;)&#125; style=&#123;&#123; width: 25, height: 25 &#125;&#125; /&gt; ) &#125;), &#125;, page2: &#123; screen: SecondPage, navigationOptions: (&#123; navigation &#125;) =&gt; (&#123; tabBarLabel: &apos;å®‰å“&apos;, tabBarIcon: (&#123; focused, tintColor &#125;) =&gt; ( &lt;Image source=&#123;focused ? require(&apos;../../image/two_selected.png&apos;) : require(&apos;../../image/two.png&apos;) &#125; style=&#123;&#123; width: 25, height: 25 &#125;&#125; /&gt; ) &#125;), &#125;,&#125;,&#123; initialRouteName: &apos;page1&apos;, swipeEnabled: true, animationEnabled: true, tabBarPosition:&apos;bottom&apos;, lazy: false, tabBarOptions: &#123; showIcon: true, activeTintColor: &apos;#979797&apos;, inactiveTintColor: &apos;#979797&apos;, style: &#123; backgroundColor: &apos;#ffffff&apos; &#125;, &#125;&#125;);export const SimpleAppNavigator = StackNavigator(&#123; Tab: &#123; screen: Tab, &#125;, page1 : &#123; screen: FirstPage, &#125;, page2 : &#123; screen: SecondPage &#125;, Snnn : &#123; screen: Snnn &#125;&#125;);const mapStateToProps = (store)=&gt;(&#123; nav : store.TabNavigatorReducer,&#125;);export default connect(mapStateToProps)(NavigatorPages); ActionsActionsTypes.js12345//Tab1export const ADD = &apos;ADD&apos;;export const SUB = &apos;SUB&apos;;//Tab2 FirstPageActions.js1234import &#123;createAction&#125; from &apos;redux-actions&apos;;import * as TYPES from &apos;./ActionTypes&apos;;export const ADD = createAction(TYPES.ADD);export const SUB = createAction(TYPES.SUB); SccondPageActions.js12345/** * Created by shaotingzhou on 2018/3/6. */import &#123;createAction&#125; from &apos;redux-actions&apos;;import * as TYPES from &apos;./ActionTypes&apos;; æºç æ•ˆæœå›¾: å¦å¤–:dva+react-navigationå¦å¤–:Mbox+react-navigation","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"react-native-router-fluxåˆæ­¥è®¤è¯†","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /react-native-router-fluxåˆæ­¥è®¤è¯†","date":"2018-03-18T08:16:47.866Z","updated":"2019-04-22T07:56:58.513Z","comments":true,"path":"2018/03/18/ç§»åŠ¨ç«¯å­¦ä¹ /react-native-router-fluxåˆæ­¥è®¤è¯†/","link":"","permalink":"https://pheromone.github.io/2018/03/18/ç§»åŠ¨ç«¯å­¦ä¹ /react-native-router-fluxåˆæ­¥è®¤è¯†/","excerpt":"ä»Šå¤©åˆæ­¥äº†è§£ä¸‹ react-native-router-flux è¿™ä¸ªä¸‰æ–¹å¯¼èˆªåº“,åŸºäºreact-native0.55.4,react-native-router-flux^4.0.0-beta.31","text":"ä»Šå¤©åˆæ­¥äº†è§£ä¸‹ react-native-router-flux è¿™ä¸ªä¸‰æ–¹å¯¼èˆªåº“,åŸºäºreact-native0.55.4,react-native-router-flux^4.0.0-beta.31æ•ˆæœå›¾:ä½¿ç”¨æ–¹æ³•è¯·å‚è€ƒ:å‚è€ƒ1å‚è€ƒ2æˆ‘è¿™é‡Œä¸è¯¦ç»†è¯´æ˜äº†,è´´å‡ºå…³é”®ä»£ç ä¸€çœ‹ä¾¿çŸ¥.ä»£ç åŸºæœ¬ç»“æ„å¦‚ä¸‹: App.js: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123;Component&#125; from &apos;react&apos;;import &#123; Platform, StyleSheet, Text, View, Image&#125; from &apos;react-native&apos;;import &#123; Navigation, Scene, Router, Modal&#125; from &apos;react-native-router-flux&apos;;import IOS from &apos;./src/ios&apos;;import Android from &apos;./src/android&apos;import Web from &apos;./src/web&apos;import TabIcon from &apos;./src/TabIcon&apos;type Props = &#123;&#125;;export default class App extends Component&lt;Props&gt; &#123; render() &#123; return ( &lt;Router&gt; &lt;Modal&gt; &lt;Scene key=&quot;root&quot; tabBarPosition=&quot;bottom&quot; tabs&gt; &lt;Scene hideBackImage key=&quot;IOS&quot; title=&quot;è‹¹æœ&quot; component=&#123;IOS&#125; icon=&#123;TabIcon&#125; Image=&#123;require(&apos;./src/image/ios.png&apos;)&#125; selectedImage=&#123;require(&apos;./src/image/ios_active.png&apos;)&#125; /&gt; &lt;Scene hideBackImage key=&quot;Web&quot; component=&#123;Web&#125; title=&quot;web&quot; icon=&#123;TabIcon&#125; Image=&#123;require(&apos;./src/image/web.png&apos;)&#125; showLabel = &#123;false&#125; selectedImage=&#123;require(&apos;./src/image/web_active.png&apos;)&#125; /&gt; &lt;Scene hideBackImage key=&quot;Android&quot; component=&#123;Android&#125; title=&quot;å®‰å“&quot; icon=&#123;TabIcon&#125; Image=&#123;require(&apos;./src/image/android.png&apos;)&#125; hideNavBar=&#123;true&#125; //éšè—å¯¼èˆªæ  selectedImage=&#123;require(&apos;./src/image/android_active.png&apos;)&#125; /&gt; &lt;/Scene&gt; &lt;/Modal&gt; &lt;/Router&gt; ); &#125;&#125;const styles = StyleSheet.create(&#123; tabbarContainer: &#123; flex: 1, backgroundColor: &quot;#f6f6f6&quot;, overflow: &apos;visible&apos; &#125;, tabIconItem: &#123; flex: 1, height: 56, flexDirection: &apos;column&apos;, alignItems: &apos;center&apos;, justifyContent: &apos;center&apos;, paddingLeft: 8, paddingRight: 8, backgroundColor: &apos;transparent&apos;, overflow: &apos;visible&apos; &#125;, tabIconImage: &#123; width: 60, height: 60, overflow: &apos;visible&apos; &#125;,&#125;); TabIcon.js 12345678910111213141516171819202122232425262728293031323334353637383940414243import React, &#123;PropTypes, Component&#125; from &apos;react&apos;import &#123;Text, View, Image, StyleSheet&#125; from &apos;react-native&apos;const tabIconStyles = StyleSheet.create(&#123; tabIconItem: &#123; flex: 1, height: 56, flexDirection: &apos;column&apos;, alignItems: &apos;center&apos;, justifyContent: &apos;center&apos;, paddingLeft: 8, paddingRight: 8, backgroundColor: &apos;transparent&apos;, &#125;, tabIconImage: &#123; width: 24, height: 24 &#125;, titleText: &#123; marginTop: 5, textAlign: &apos;center&apos;, fontSize: 11 &#125;, titleTextDefaultColor: &#123; color: &apos;black&apos; &#125;, titleTextSelectColor: &#123; color: &apos;red&apos; &#125;, tabItemRow: &#123; flexDirection: &apos;row&apos; &#125;,&#125;);export default TabIcon=(props)=&gt;&#123; return ( &lt;View style=&#123;tabIconStyles.tabIconItem&#125;&gt; &lt;Image style=&#123;tabIconStyles.tabIconImage&#125; source=&#123;props.focused ? props.selectedImage : props.Image&#125;/&gt; &lt;Text&gt;&#123;props.tabTitle&#125;&lt;/Text&gt; &lt;/View&gt; );&#125;; è€Œè‡³äºios.js,web.js,android.jsåªæ˜¯åŸºæœ¬çš„æ¨¡æ¿ç•Œé¢ 1234567891011121314151617181920212223242526272829303132333435363738394041424344/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &apos;react&apos;;import &#123; Platform, StyleSheet, Text, View&#125; from &apos;react-native&apos;;type Props = &#123;&#125;;export default class IOS extends Component&lt;Props&gt; &#123; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text style=&#123;styles.welcome&#125;&gt; é¦–é¡µ &lt;/Text&gt; &lt;/View&gt; ); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;); æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]},{"title":"react-navigationçš„åŸºæœ¬ä½¿ç”¨","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /react-navigationçš„åŸºæœ¬ä½¿ç”¨","date":"2018-03-18T06:50:06.825Z","updated":"2018-05-15T18:41:51.541Z","comments":true,"path":"2018/03/18/ç§»åŠ¨ç«¯å­¦ä¹ /react-navigationçš„åŸºæœ¬ä½¿ç”¨/","link":"","permalink":"https://pheromone.github.io/2018/03/18/ç§»åŠ¨ç«¯å­¦ä¹ /react-navigationçš„åŸºæœ¬ä½¿ç”¨/","excerpt":"æœ¬æ–‡åŸºäºnpm 5.6.6 react-native-li 2.0.1 react-native 0.54.0 react-navigation ^1.4.0æ‰€å†™.","text":"æœ¬æ–‡åŸºäºnpm 5.6.6 react-native-li 2.0.1 react-native 0.54.0 react-navigation ^1.4.0æ‰€å†™.å®ç°çš„åŸºæœ¬åŠŸèƒ½ tabBar å¯¼èˆªæ  åœ¨staticä¸­ä½¿ç”¨this å›è°ƒ è·³å¤šçº§ç•Œé¢ é˜²æ­¢è¿ç»­ç‚¹å‡»å¤šæ¬¡è·³è½¬ç•Œé¢å¹¶ä¸”ä¸Šé¢è¿™äº›æ–¹æ³•å‡æœªä¿®æ”¹ä¸‰æ–¹åº“çš„æºç ,åŸå…ˆéœ€è¦ä¿®æ”¹æºç å®ç°:åŸç‰ˆå¯¹äºreact-navigationçš„ä½¿ç”¨çœ‹å®˜æ–¹æ–‡æ¡£å³å¯.é˜²æ­¢è¿ç»­ç‚¹å‡»å¤šæ¬¡è·³è½¬ç•Œé¢ é€šè¿‡stateåˆ¤æ–­:å…ˆå®šä¹‰ä¸ªstate waiting ä¸º false ,å†å®šä¹‰ç‚¹å‡»äº‹ä»¶çš„ disabled={this.state.waiting} ,åœ¨å“åº”æ–¹æ³•é‡Œé¢å…ˆè¡Œä¿®æ”¹statewaiting ä¸º true,ç„¶åè·³è½¬ç•Œé¢,æœ€ååœ¨ä¸‹æ–¹å®šä¸€ä¸ªè®¡æ—¶å™¨,2ç§’åå†æ¬¡ä¿®æ”¹state ä¸ºfalse å³å¯.å®Œæ•´ä»£ç : 123456789101112131415161718192021222324252627282930313233343536373839404142434445import React, &#123; Component &#125; from &apos;react&apos;;import &#123; Platform, StyleSheet, Text, View, Image, TouchableOpacity&#125; from &apos;react-native&apos;;type Props = &#123;&#125;;export default class OneDetails extends Component&lt;Props&gt; &#123; // æ„é€  constructor(props) &#123; super(props); // åˆå§‹çŠ¶æ€ this.state = &#123; waiting:false//é˜²æ­¢å¤šæ¬¡é‡å¤ç‚¹å‡» &#125;; &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;TouchableOpacity onPress=&#123;()=&gt;this.onclickBtn()&#125; disabled=&#123;this.state.waiting&#125;&gt; &lt;Text&gt;ç‚¹å‡»è·³è½¬&lt;/Text&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; ); &#125; onclickBtn =() =&gt;&#123; this.setState(&#123;waiting: true&#125;); this.props.navigation.navigate(&apos;OneDetailsFlat&apos;) setTimeout(()=&gt; &#123; this.setState(&#123;waiting: false&#125;) &#125;, 2000);//2ç§’åé‡ç½®stateä¸­çš„waitingçŠ¶æ€ &#125;&#125; åœ¨staticä¸­ä½¿ç”¨this å…ˆåœ¨componentDidMounté‡Œ123456//è®¾ç½®åœ¨staticä¸­ä½¿ç”¨this componentDidMount()&#123; this.props.navigation.setParams(&#123; navigatePress:this.navigatePress &#125;) &#125; ç„¶åå°±å¯ä»¥:123456789static navigationOptions = (&#123; navigation, screenProps &#125;) =&gt; (&#123; title: &apos;ListView&apos;, headerStyle:&#123;backgroundColor:&apos;red&apos;&#125;, headerRight:( &lt;Text onPress=&#123;()=&gt;navigation.state.params.navigatePress()&#125;&gt; ç‚¹å‡» &lt;/Text&gt; ) &#125;); ä½¿ç”¨:1234//å¯¼èˆªæ¡æŒ‰é’®ç‚¹å‡» navigatePress = () =&gt; &#123; alert(this.state.text) &#125; å›è°ƒ åœ¨A push åˆ° Bçš„æ—¶å€™å…ˆè¡Œå®šä¹‰ä¸ªæ–¹æ³•,ç„¶ååœ¨B pop å›Aè°ƒç”¨å³å¯.A -&gt; B1234567891011//å¯¼èˆªæ¡æŒ‰é’®ç‚¹å‡»navigatePress = () =&gt; &#123; this.props.navigation.navigate(&apos;OneDetailsFlatDetails&apos;,&#123; // è·³è½¬çš„æ—¶å€™æºå¸¦ä¸€ä¸ªå‚æ•°å»ä¸‹ä¸ªé¡µé¢ callback: (data)=&gt;&#123; alert(data) &#125; &#125;);&#125; B -&gt; A1234popTwo =() =&gt;&#123; this.props.navigation.state.params.callback(&apos;å›è°ƒå‚æ•°&apos;); this.props.navigation.goBack() &#125; å›åˆ°é¦–é¡µ this.props.navigation.popToTop()å›åˆ°ç›¸åº”é¡µ this.props.navigation.pop(2)æ•ˆæœå›¾: æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/categories/ç§»åŠ¨ç«¯å­¦ä¹ /"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://pheromone.github.io/tags/ç§»åŠ¨ç«¯å­¦ä¹ /"}]}]}