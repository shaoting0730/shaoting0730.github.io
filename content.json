{"meta":{"title":"å°‘åœ","subtitle":null,"description":"æ„¿å¤©å ‚æ²¡æœ‰bug","author":null,"url":"https://zhoushaoting.com"},"pages":[{"title":"","date":"2021-03-21T14:36:51.570Z","updated":"2019-02-18T13:58:34.000Z","comments":true,"path":"README.html","permalink":"https://zhoushaoting.com/README.html","excerpt":"","text":"ç°åœ¨çš„åšå®¢ æ—§åšå®¢"},{"title":"å…³äºæˆ‘","date":"2021-08-28T13:32:45.546Z","updated":"2021-08-28T13:32:45.546Z","comments":true,"path":"about/index.html","permalink":"https://zhoushaoting.com/about/index.html","excerpt":"","text":""},{"title":"categories","date":"2021-03-21T14:36:51.570Z","updated":"2018-03-18T03:30:29.000Z","comments":true,"path":"categories/index.html","permalink":"https://zhoushaoting.com/categories/index.html","excerpt":"","text":""},{"title":"ç•™è¨€æ¿","date":"2021-03-21T14:36:51.570Z","updated":"2018-07-09T05:40:53.000Z","comments":true,"path":"message/index.html","permalink":"https://zhoushaoting.com/message/index.html","excerpt":"","text":""},{"title":"search","date":"2018-04-07T08:31:05.000Z","updated":"2018-04-07T08:31:05.000Z","comments":true,"path":"search/index.html","permalink":"https://zhoushaoting.com/search/index.html","excerpt":"","text":""},{"title":"tags","date":"2021-03-21T14:36:51.570Z","updated":"2018-03-18T03:30:47.000Z","comments":true,"path":"tags/index.html","permalink":"https://zhoushaoting.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"Reactå­¦ä¹ :React_Hookså­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ /Reactå­¦ä¹ ~React-Hookså­¦ä¹ ","date":"2021-08-21T16:00:00.000Z","updated":"2021-08-27T08:45:06.759Z","comments":true,"path":"2021/08/22/å‰ç«¯å­¦ä¹ /Reactå­¦ä¹ ~React-Hookså­¦ä¹ /","link":"","permalink":"https://zhoushaoting.com/2021/08/22/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/React%E5%AD%A6%E4%B9%A0~React-Hooks%E5%AD%A6%E4%B9%A0/","excerpt":"ä»Šå¤©å°è¯•ä¸‹React Hooksçš„å­¦ä¹ .","text":"ä»Šå¤©å°è¯•ä¸‹React Hooksçš„å­¦ä¹ . ä»€ä¹ˆæ˜¯React Hooks?React Hookså’Œä¼ ç»Ÿçš„å¼€å‘æ¨¡å¼æœ‰ä½•ä¸åŒ?ä½¿ç”¨React Hooksæœ‰å“ªäº›å¥½å¤„? ä»€ä¹ˆæ˜¯React Hooks? å®˜æ–¹è§£é‡Š:Hook æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§,å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§,å¦‚:ä¿å­˜çŠ¶æ€ã€ä¿å­˜ä¸Šä¸‹æ–‡ã€ä¿å­˜å¼•ç”¨ç­‰.Hook æœ¬è´¨å°±æ˜¯ JavaScript å‡½æ•°.è¯´ç™½äº†å°±æ˜¯å¯¹äºå‡½æ•°ç»„ä»¶çš„åŠ å¼ºï¼Œå¢åŠ äº†å¯¹äºå‡½æ•°ç»„ä»¶çš„ä¸€äº›ç‰¹æ€§ï¼Œåƒclassç»„ä»¶é‚£æ ·ä½¿ç”¨,æ˜¯ä¸€å¥—å…¨æ–°çš„APIæˆ–è€…è®¾è®¡æ€æƒ³. å®ƒå’Œä¼ ç»Ÿå¼€å‘æ¨¡å¼æœ‰ä½•å¼‚åŒ? &emsp; &emsp; å®˜æ–¹æ¨èä½¿ç”¨é’©å­ï¼ˆå‡½æ•°ï¼‰ï¼Œè€Œä¸æ˜¯ç±»ã€‚å› ä¸ºé’©å­æ›´ç®€æ´ï¼Œä»£ç é‡å°‘ï¼Œç”¨èµ·æ¥æ¯”è¾ƒ\"è½»\"ï¼Œè€Œç±»æ¯”è¾ƒ\"é‡\"ã€‚è€Œä¸”ï¼Œé’©å­æ˜¯å‡½æ•°ï¼Œæ›´ç¬¦åˆ React å‡½æ•°å¼çš„æœ¬è´¨ã€‚ ç±»ï¼ˆclassï¼‰æ˜¯æ•°æ®å’Œé€»è¾‘çš„å°è£…ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œç»„ä»¶çš„çŠ¶æ€å’Œæ“ä½œæ–¹æ³•æ˜¯å°è£…åœ¨ä¸€èµ·çš„ã€‚å¦‚æœé€‰æ‹©äº†ç±»çš„å†™æ³•ï¼Œå°±åº”è¯¥æŠŠç›¸å…³çš„æ•°æ®å’Œæ“ä½œï¼Œéƒ½å†™åœ¨åŒä¸€ä¸ª class é‡Œé¢ã€‚ &emsp; &emsp; Hook è¿™ä¸ªå•è¯çš„æ„æ€æ˜¯\"é’©å­\"ã€‚React Hooks çš„æ„æ€æ˜¯ï¼Œç»„ä»¶å°½é‡å†™æˆçº¯å‡½æ•°ï¼Œå¦‚æœéœ€è¦å¤–éƒ¨åŠŸèƒ½å’Œå‰¯ä½œç”¨ï¼Œå°±ç”¨é’©å­æŠŠå¤–éƒ¨ä»£ç \"é’©\"è¿›æ¥ã€‚ React Hooks å°±æ˜¯é‚£äº›é’©å­ã€‚ä½ éœ€è¦ä»€ä¹ˆåŠŸèƒ½ï¼Œå°±ä½¿ç”¨ä»€ä¹ˆé’©å­ã€‚React é»˜è®¤æä¾›äº†ä¸€äº›å¸¸ç”¨é’©å­ï¼Œä½ ä¹Ÿå¯ä»¥å°è£…è‡ªå·±çš„é’©å­ã€‚æ‰€æœ‰çš„é’©å­éƒ½æ˜¯ä¸ºå‡½æ•°å¼•å…¥å¤–éƒ¨åŠŸèƒ½ï¼Œæ‰€ä»¥ React çº¦å®šï¼Œé’©å­ä¸€å¾‹ä½¿ç”¨useå‰ç¼€å‘½åï¼Œä¾¿äºè¯†åˆ«ã€‚ä½ è¦ä½¿ç”¨ xxx åŠŸèƒ½ï¼Œé’©å­å°±å‘½åä¸º usexxxã€‚ &emsp; &emsp; Redux çš„ä½œè€… Dan Abramov æ€»ç»“äº†ç»„ä»¶ç±»çš„å‡ ä¸ªç¼ºç‚¹ã€‚ 12345å¤§å‹ç»„ä»¶å¾ˆéš¾æ‹†åˆ†å’Œé‡æ„ï¼Œä¹Ÿå¾ˆéš¾æµ‹è¯•ã€‚ä¸šåŠ¡é€»è¾‘åˆ†æ•£åœ¨ç»„ä»¶çš„å„ä¸ªæ–¹æ³•ä¹‹ä¸­ï¼Œå¯¼è‡´é‡å¤é€»è¾‘æˆ–å…³è”é€»è¾‘ã€‚ç»„ä»¶ç±»å¼•å…¥äº†å¤æ‚çš„ç¼–ç¨‹æ¨¡å¼ï¼Œæ¯”å¦‚ render props å’Œé«˜é˜¶ç»„ä»¶ã€‚ &emsp; &emsp; å¹å¾—éƒ½ä¸Šå¤©äº†,å…¶å® å¾¡å§å°èè‰,å„æœ‰æ‰€çˆ±,å„æœ‰æ‰€é•¿.æ®å®˜æ–¹èµ„æ–™æ¥è¯´: 1234567å®Œå…¨å¯é€‰çš„ã€‚ ä½ æ— éœ€é‡å†™ä»»ä½•å·²æœ‰ä»£ç å°±å¯ä»¥åœ¨ä¸€äº›ç»„ä»¶ä¸­å°è¯• Hookã€‚ä½†æ˜¯å¦‚æœä½ ä¸æƒ³ï¼Œä½ ä¸å¿…ç°åœ¨å°±å»å­¦ä¹ æˆ–ä½¿ç”¨ Hookã€‚100% å‘åå…¼å®¹çš„ã€‚ Hook ä¸åŒ…å«ä»»ä½•ç ´åæ€§æ”¹åŠ¨ã€‚ç°åœ¨å¯ç”¨ã€‚ Hook å·²å‘å¸ƒäº v16.8.0ã€‚æ²¡æœ‰è®¡åˆ’ä» React ä¸­ç§»é™¤ classã€‚Hook ä¸ä¼šå½±å“ä½ å¯¹ React æ¦‚å¿µçš„ç†è§£ã€‚ æ°æ°ç›¸åï¼ŒHook ä¸ºå·²çŸ¥çš„ React æ¦‚å¿µæä¾›äº†æ›´ç›´æ¥çš„ APIï¼špropsï¼Œ stateï¼Œcontextï¼Œrefs ä»¥åŠç”Ÿå‘½å‘¨æœŸã€‚ å®æ“ä¸€æŠŠ å‡†å¤‡å·¥ä½œ: 1ã€reactç‰ˆæœ¬éœ€ 16.8.0ä»¥ä¸Š. 2ã€ä½¿ç”¨ create-react-appæˆ– npm æˆ–yarnç­‰æ–¹å¼æ–°å»ºä¸€ä¸ªæœ€åŸºæœ¬çš„é¡¹ç›®å³å¯,å¦‚:npx create-react-app my-app ä¼ ç»Ÿæ¨¡å¼--&gt;Example-class.js: 123456789101112131415161718192021222324import React,&#123;Component&#125; from &#x27;react&#x27;// classçš„åŸºæœ¬æ¼”ç¤ºclass ExampleClass extends Component &#123; constructor(props)&#123; super(props); this.state = &#123;count:0&#125; &#125; // ç»„ä»¶ç¬¬ä¸€æ¬¡æ‰§è¡Œ componentDidMount()&#123; console.log(&#x27;ExampleClassæ‰§è¡Œäº†&#x27;) &#125; render()&#123; return ( &lt;div&gt; &lt;p&gt;classç®€å•ä½¿ç”¨&lt;/p&gt; &lt;p&gt;&#123;this.state.count&#125;&lt;/p&gt; &lt;button onClick=&#123;()=&gt; &#123;this.setState(&#123;count:this.state.count+1&#125;)&#125;&#125;&gt;+1&lt;/button&gt; &lt;button onClick=&#123;()=&gt; &#123;this.setState(&#123;count:this.state.count-1&#125;)&#125;&#125;&gt;-1&lt;/button&gt; &lt;/div&gt; ) &#125;&#125;export default ExampleClass; useStateäº‹ä¾‹: 12345678910111213141516171819202122import React, &#123; useState,useEffect &#125; from &#x27;react&#x27;// useState ç®€å•ä½¿ç”¨function Example1() &#123; const [count, setCount] = useState(0); // æ­¤å¤„çš„useEffectç›¸å½“äºcomponentDidMount å’Œ componentDidUpdate useEffect(()=&gt;&#123; console.log(&#x27;Example1ä¸‹ useEffectæ‰§è¡Œäº†&#x27;); &#125;) return &lt;div&gt; &lt;p&gt;useStateçš„ç®€å•ä½¿ç”¨&lt;/p&gt; &lt;p&gt; &#123;count&#125;&lt;/p&gt; &lt;button onClick=&#123;() =&gt; &#123; setCount(count + 1) &#125;&#125;&gt;+1&lt;/button&gt; &lt;button onClick=&#123;() =&gt; &#123; setCount(count - 1) &#125;&#125;&gt;-1&lt;/button&gt; &lt;/div&gt;&#125;export default Example1; useEffect: 123456789101112131415161718192021222324252627282930313233343536import React, &#123; useState ,useEffect&#125; from &#x27;react&#x27;function Example2() &#123; const [count, setCount] = useState(0); const [color, setColor] = useState(&#x27;red&#x27;); // æ­¤å¤„çš„useEffectç›¸å½“äºcomponentDidMount å’Œ colorçš„componentDidUpdate useEffect(()=&gt;&#123; console.log(&#x27;------åˆ‡æ¢color--------&#x27;); &#125;,[color]) // æ­¤å¤„çš„useEffectç›¸å½“äºcomponentDidMount å’Œ countçš„componentDidUpdate useEffect(()=&gt;&#123; console.log(&#x27;ç‚¹å‡»count&#x27;); &#125;,[count]) function changeColor()&#123; if(color === &#x27;yellow&#x27;)&#123; setColor(&#x27;red&#x27;); &#125;else&#123; setColor(&#x27;yellow&#x27;); &#125; &#125; return &lt;div style=&#123;&#123;background:color&#125;&#125;&gt; &lt;p&gt;useEffectç®€å•ä½¿ç”¨&lt;/p&gt; &lt;p&gt; &#123;count&#125;&lt;/p&gt; &lt;button onClick=&#123;() =&gt; &#123; setCount(count + 1) &#125;&#125;&gt;+1&lt;/button&gt; &lt;button onClick=&#123;() =&gt; &#123; setCount(count - 1) &#125;&#125;&gt;-1&lt;/button&gt; &lt;button onClick=&#123;() =&gt; changeColor()&#125;&gt;åˆ‡æ¢é¢œè‰²&lt;/button&gt; &lt;/div&gt; &#125;export default Example2; useEffectä»£æ›¿componentWillUnmountä½¿ç”¨(éœ€è¦å®‰è£…react-router-dom): 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647import React, &#123; useEffect &#125; from &#x27;react&#x27;import &#123; BrowserRouter as Router, Route, Link &#125; from &#x27;react-router-dom&#x27;;function Index1() &#123; useEffect(() =&gt; &#123; console.log(&#x27;ç»„ä»¶1componentDidMount &#x27;); return () =&gt; &#123; console.log(&#x27;ç»„ä»¶1componentWillUnmount&#x27;); &#125; &#125;) return &lt;div&gt; &lt;h2&gt;ç»„ä»¶1&lt;/h2&gt; &lt;/div&gt;&#125;function Index2() &#123; useEffect(() =&gt; &#123; console.log(&#x27;ç»„ä»¶2componentDidMount &#x27;); return () =&gt; &#123; console.log(&#x27;ç»„ä»¶2componentWillUnmount&#x27;); &#125; &#125;) return &lt;div&gt; &lt;h2&gt;ç»„ä»¶2&lt;/h2&gt; &lt;/div&gt;&#125;function Example3() &#123; return &lt;div&gt; &lt;p&gt;useEffectä»£æ›¿componentWillUnmountä½¿ç”¨&lt;/p&gt; &lt;Router&gt; &lt;ul&gt; &lt;li&gt;&lt;Link to=&quot;/&quot;&gt;ç»„ä»¶1&lt;/Link&gt;&lt;/li&gt; &lt;li&gt;&lt;Link to=&quot;/two/&quot;&gt;ç»„ä»¶2&lt;/Link&gt;&lt;/li&gt; &lt;/ul&gt; &lt;Route path=&quot;/&quot; exact component=&#123;Index1&#125; /&gt; &lt;Route path=&quot;/two/&quot; component=&#123;Index2&#125; /&gt; &lt;/Router&gt; &lt;/div&gt;&#125;export default Example3; useContextçš„ç®€å•ä½¿ç”¨:çˆ¶å­ä¹‹é—´ä¼ é€’æ•°æ®: 12345678910111213141516171819202122232425262728import React, &#123; useState,createContext,useContext &#125; from &#x27;react&#x27;// useState ç®€å•ä½¿ç”¨function Example4() &#123; const [count, setCount] = useState(0); const CountContext = createContext(); function Child()&#123; let count = useContext(CountContext); return ( &lt;h1&gt;æˆ‘æ˜¯å­ç»„ä»¶&#123;count&#125;&lt;/h1&gt; ) &#125; return &lt;div&gt; &lt;p&gt;useContextçš„ç®€å•ä½¿ç”¨:çˆ¶å­ä¹‹é—´ä¼ é€’æ•°æ®&lt;/p&gt; &lt;p&gt;æˆ‘æ˜¯çˆ¶ç»„ä»¶: &#123;count&#125;&lt;/p&gt; &lt;button onClick=&#123;() =&gt; &#123; setCount(count + 1) &#125;&#125;&gt;+1&lt;/button&gt; &lt;button onClick=&#123;() =&gt; &#123; setCount(count - 1) &#125;&#125;&gt;-1&lt;/button&gt; &lt;CountContext.Provider value=&#123;count&#125;&gt; &lt;Child /&gt; &lt;/CountContext.Provider&gt; &lt;/div&gt;&#125;export default Example4; useRefä½¿ç”¨: 12345678910111213141516171819import React, &#123; useState,useRef &#125; from &#x27;react&#x27;// useRef ç®€å•ä½¿ç”¨function Example5() &#123; const [inputVal,setInputVal] = useState(&#x27;&#x27;) const ref = useRef(); function inputAction ()&#123; console.log(ref.current.value); setInputVal(ref.current.value); &#125; return &lt;div&gt; &lt;p&gt;useRefä½¿ç”¨:&#123;inputVal&#125;&lt;/p&gt; &lt;input onChange=&#123;inputAction&#125; ref=&#123;ref&#125; /&gt; &lt;/div&gt;&#125;export default Example5; useReducerçš„ç®€å•ä½¿ç”¨: 12345678910111213141516171819202122232425262728import React, &#123; useReducer &#125; from &#x27;react&#x27;; const initialState = 0;const reducer = (state, action) =&gt; &#123; switch (action) &#123; case &#x27;increment&#x27;: return state + 1; case &#x27;decrement&#x27;: return state - 1; case &#x27;reset&#x27;: return 0; default: throw new Error(&#x27;Unexpected action&#x27;); &#125;&#125;; const Example6 = () =&gt; &#123; const [count, dispatch] = useReducer(reducer, initialState); return ( &lt;div&gt; &lt;p&gt;useReducerçš„ç®€å•ä½¿ç”¨&lt;/p&gt; &#123;count&#125; &lt;button onClick=&#123;() =&gt; dispatch(&#x27;increment&#x27;)&#125;&gt;+1&lt;/button&gt; &lt;button onClick=&#123;() =&gt; dispatch(&#x27;decrement&#x27;)&#125;&gt;-1&lt;/button&gt; &lt;button onClick=&#123;() =&gt; dispatch(&#x27;reset&#x27;)&#125;&gt;reset&lt;/button&gt; &lt;/div&gt; );&#125;; export default Example6; useMemoæå‡æ€§èƒ½: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849import React, &#123; useState, useMemo &#125; from &#x27;react&#x27;// useState ç®€å•ä½¿ç”¨function Example7() &#123; const [name, setName] = useState(&#x27;name&#x27;); const [content, setContent] = useState(&#x27;content&#x27;); return ( &lt;div&gt; &lt;div&gt;useMemoæå‡æ€§èƒ½&lt;/div&gt; &lt;button onClick=&#123;() =&gt; setName(new Date().getTime())&#125;&gt;&#123;name&#125;&lt;/button&gt; &lt;button onClick=&#123;() =&gt; setContent(new Date().getTime())&#125;&gt;&#123;content&#125;&lt;/button&gt; &lt;Child name=&#123;name&#125;&gt;&#123;content&#125;&lt;/Child&gt; &lt;/div&gt; )&#125;// ä¸ä½¿ç”¨useMemo,ä¼šé€ æˆä¸å¿…è¦çš„æ€§èƒ½å¼€é”€// function Child(&#123;name,children&#125;)&#123;// function changeName(name)&#123;// console.log(&#x27;childæ‰§è¡Œäº†&#x27;);// return name + &#x27;æ”¹å˜&#x27;;// &#125;// const otherName = changeName(name);// return (// &lt;div&gt;// &lt;div&gt;&#123;otherName&#125;&lt;/div&gt;// &lt;div&gt;&#123;children&#125;&lt;/div&gt; // &lt;/div&gt;// )// &#125; // ä½¿ç”¨useMemo function Child(&#123; name, children &#125;) &#123; function changeName(name) &#123; console.log(&#x27;childæ‰§è¡Œäº†&#x27;); return name + &#x27;æ”¹å˜&#x27;; &#125; const otherName = useMemo(() =&gt; changeName(name),[name]) return ( &lt;div&gt; &lt;div&gt;&#123;otherName&#125;&lt;/div&gt; &lt;div&gt;&#123;children&#125;&lt;/div&gt; &lt;/div&gt; ) &#125;export default Example7; è‡ªå®šä¹‰Hookå‡½æ•°: 1234567891011121314151617181920212223242526272829303132333435import React, &#123; useState,useEffect,useCallback &#125; from &#x27;react&#x27;function useWinSize()&#123; const [size,setSize] = useState(&#123; width:document.documentElement.clientWidth, height:document.documentElement.clientHeight, &#125;) const onResize = useCallback(()=&gt;&#123; setSize(&#123; width:document.documentElement.clientWidth, height:document.documentElement.clientHeight, &#125;) &#125;,[]) useEffect(()=&gt;&#123; window.addEventListener(&#x27;resize&#x27;,onResize); return ()=&gt;&#123; window.removeEventListener(&#x27;resize&#x27;,onResize); &#125; &#125;) return size;&#125;function Example8() &#123; const size = useWinSize(); return &lt;div&gt; &lt;p&gt;è‡ªå®šä¹‰Hookå‡½æ•°&lt;/p&gt; &lt;p&gt;é¡µé¢size:&#123;size.width&#125; + &#123;size.height&#125;&lt;/p&gt; &lt;/div&gt; &#125; export default Example8; ps:å…¥å£æ–‡ä»¶å°±åªæ˜¯å¼•å…¥è€Œå·².index.js 123456789101112131415161718192021222324252627282930313233343536import React from &#x27;react&#x27;;import ReactDOM from &#x27;react-dom&#x27;;import &#x27;./index.css&#x27;;import Example1 from &#x27;./Example1&#x27;;import Example2 from &#x27;./Example2&#x27;;import Example3 from &#x27;./Example3&#x27;;import Example4 from &#x27;./Example4&#x27;;import Example5 from &#x27;./Example5&#x27;;import Example6 from &#x27;./Example6&#x27;;import Example7 from &#x27;./Example7&#x27;; import Example8 from &#x27;./Example8&#x27;; import ExampleClass from &#x27;./Example-class&#x27;;ReactDOM.render( &lt;div&gt; &#123;/* &lt;ExampleClass /&gt; */&#125; &lt;Example1 /&gt; &lt;hr/&gt; &lt;Example2 /&gt; &lt;hr/&gt; &lt;Example3/&gt; &lt;hr/&gt; &lt;Example4/&gt; &lt;hr/&gt; &lt;Example5/&gt; &lt;hr/&gt; &lt;Example6/&gt; &lt;hr/&gt; &lt;Example7/&gt; &lt;hr/&gt; &lt;Example8/&gt; &lt;/div&gt;, document.getElementById(&#x27;root&#x27;)); React Hooks çš„ä¼˜ç‚¹ 12345678é€šè¿‡ Hooks æˆ‘ä»¬å¯ä»¥å¯¹ state é€»è¾‘è¿›è¡Œè‰¯å¥½çš„å°è£…ï¼Œè½»æ¾åšåˆ°éš”ç¦»å’Œå¤ç”¨ï¼Œä¼˜ç‚¹ä¸»è¦ä½“ç°åœ¨ï¼šå¤ç”¨ä»£ç æ›´å®¹æ˜“ï¼šhooks æ˜¯æ™®é€šçš„ JavaScript å‡½æ•°ï¼Œæ‰€ä»¥å¼€å‘è€…å¯ä»¥å°†å†…ç½®çš„ hooks ç»„åˆåˆ°å¤„ç† state é€»è¾‘çš„è‡ªå®šä¹‰ hooksä¸­ï¼Œè¿™æ ·å¤æ‚çš„é—®é¢˜å¯ä»¥è½¬åŒ–ä¸€ä¸ªå•ä¸€èŒè´£çš„å‡½æ•°ï¼Œå¹¶å¯ä»¥è¢«æ•´ä¸ªåº”ç”¨æˆ–è€… React ç¤¾åŒºæ‰€ä½¿ç”¨ï¼›ä½¿ç”¨ç»„åˆæ–¹å¼æ›´ä¼˜é›…ï¼šä¸åŒäº render props æˆ–é«˜é˜¶ç»„ä»¶ç­‰çš„æ¨¡å¼ï¼Œhooks ä¸ä¼šåœ¨ç»„ä»¶æ ‘ä¸­å¼•å…¥ä¸å¿…è¦çš„åµŒå¥—ï¼Œä¹Ÿä¸ä¼šå—åˆ° mixins çš„è´Ÿé¢å½±å“ï¼›æ›´å°‘çš„ä»£ç é‡ï¼šä¸€ä¸ª useEffect æ‰§è¡Œå•ä¸€èŒè´£ï¼Œå¯ä»¥å¹²æ‰ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­çš„é‡å¤ä»£ç ã€‚é¿å…å°†åŒä¸€èŒè´£ä»£ç åˆ†æ‹†åœ¨å‡ ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­ï¼Œæ›´å¥½çš„å¤ç”¨èƒ½åŠ›å¯ä»¥å¸®åŠ©ä¼˜ç§€çš„å¼€å‘è€…æœ€å¤§é™åº¦é™ä½ä»£ç é‡ï¼›ä»£ç é€»è¾‘æ›´æ¸…æ™°ï¼šhooks å¸®åŠ©å¼€å‘è€…å°†ç»„ä»¶æ‹†åˆ†ä¸ºåŠŸèƒ½ç‹¬ç«‹çš„å‡½æ•°å•å…ƒï¼Œè½»æ¾åšåˆ°â€œåˆ†ç¦»å…³æ³¨ç‚¹â€ï¼Œä»£ç é€»è¾‘æ›´åŠ æ¸…æ™°æ˜“æ‡‚ï¼›å•å…ƒæµ‹è¯•ï¼šå¤„ç† state é€»è¾‘çš„è‡ªå®šä¹‰ hooks å¯ä»¥è¢«ç‹¬ç«‹è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œæ›´åŠ å¯é ï¼› æ•´ç†è‡ª: React Hookså®Œå…¨ä¸Šæ‰‹æŒ‡å—-èš‚èš RichLab å‰ç«¯å›¢é˜Ÿ React Hooks å…¥é—¨æ•™ç¨‹-é˜®ä¸€å³° è½»æ¾å­¦ä¼š React é’©å­ï¼šä»¥ useEffect() ä¸ºä¾‹-é˜®ä¸€å³° bilibili æœ¬æ–‡æºç ","categories":[{"name":"å‰ç«¯å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"å‰ç«¯å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutter~getxåº“å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~getxå­¦ä¹ ","date":"2021-03-12T16:00:00.000Z","updated":"2021-08-30T02:31:53.191Z","comments":true,"path":"2021/03/13/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~getxå­¦ä¹ /","link":"","permalink":"https://zhoushaoting.com/2021/03/13/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter~getx%E5%AD%A6%E4%B9%A0/","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹getx.å…¶ä¸­,get: 3.26.0","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹getx.å…¶ä¸­,get: 3.26.0 å®˜æ–¹æ–‡æ¡£ ä¾‹å­å±•ç¤ºtabbarã€stateç®¡ç†ã€å›½é™…åŒ–ã€è·³è½¬.æ•ˆæœå¦‚å›¾ å„æ–‡ä»¶å¦‚ä¸‹main.dart12345678910111213141516171819202122232425import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:get/get.dart&#x27;;import &#x27;./languages.dart&#x27;;import &#x27;routes/app_pages.dart&#x27;;import &#x27;routes/app_routes.dart&#x27;;void main() &#123; runApp(MyApp());&#125;class MyApp extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return GetMaterialApp( translations: Languages(), // ä½ çš„ç¿»è¯‘ locale: Locale(&#x27;zh&#x27;, &#x27;CN&#x27;), // å°†ä¼šæŒ‰ç…§æ­¤å¤„æŒ‡å®šçš„è¯­è¨€ç¿»è¯‘ fallbackLocale: Locale(&#x27;en&#x27;, &#x27;US&#x27;), // æ·»åŠ ä¸€ä¸ªå›è°ƒè¯­è¨€é€‰é¡¹ï¼Œä»¥å¤‡ä¸Šé¢æŒ‡å®šçš„è¯­è¨€ç¿»è¯‘ä¸å­˜åœ¨ initialRoute: AppRoutes.DASHBOARD, getPages: AppPages.list, debugShowCheckedModeBanner: false, themeMode: ThemeMode.system, ); &#125;&#125; main.dartæ˜¯å…¥å£æ–‡ä»¶. languages.dart123456789101112131415161718import &#x27;package:get/get.dart&#x27;;class Languages extends Translations &#123; @override Map&lt;String, Map&lt;String, String&gt;&gt; get keys =&gt; &#123; &#x27;zh_CN&#x27;: &#123; &#x27;hello&#x27;: &#x27;ä½ å¥½ ä¸–ç•Œ&#x27;, &#x27;one&#x27;: &#x27;é¦–é¡µ&#x27;, &#x27;two&#x27;: &#x27;æˆ‘çš„&#x27;, &#125;, &#x27;en_US&#x27;: &#123; &#x27;hello&#x27;: &#x27;Hello World&#x27;, &#x27;one&#x27;: &#x27;Home&#x27;, &#x27;two&#x27;: &#x27;Mine&#x27;, &#125; &#125;;&#125; languages.dartæ–‡ä»¶æ˜¯å›½é™…åŒ–çš„é…ç½®æ–‡ä»¶. routesæ–‡ä»¶å¤¹ä¸‹: routes -&gt; app_pages.dart12345678910111213141516import &#x27;package:get/get.dart&#x27;;import &#x27;package:getx_demo/pages/dashboard/dashboard_binding.dart&#x27;;import &#x27;package:getx_demo/pages/dashboard/dashboard_page.dart&#x27;;import &#x27;app_routes.dart&#x27;;class AppPages &#123; static var list = [ GetPage( name: AppRoutes.DASHBOARD, page: () =&gt; DashboardPage(), binding: DashboardBinding(), ), ];&#125; routes -&gt; app_routes.dart1234class AppRoutes &#123; static const String DASHBOARD = &#x27;/&#x27;;&#125; pagesæ–‡ä»¶å¤¹å¦‚ä¸‹:å…ˆæ˜¯tabbar dashboard -&gt; dashboard_binding.dart1234567891011121314import &#x27;package:get/get.dart&#x27;;import &#x27;package:getx_demo/pages/account/account_controller.dart&#x27;;import &#x27;package:getx_demo/pages/home/home_controller.dart&#x27;;import &#x27;dashboard_controller.dart&#x27;;class DashboardBinding extends Bindings &#123; @override void dependencies() &#123; Get.lazyPut&lt;DashboardController&gt;(() =&gt; DashboardController()); Get.lazyPut&lt;HomeController&gt;(() =&gt; HomeController()); Get.lazyPut&lt;AccountController&gt;(() =&gt; AccountController()); &#125;&#125; dashboard -&gt; dashboard_controller.dart12345678910import &#x27;package:get/get.dart&#x27;;class DashboardController extends GetxController &#123; var tabIndex = 0; void changeTabIndex(int index) &#123; tabIndex = index; update(); &#125;&#125; dashboard -&gt; dashboard_page.dart12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152import &#x27;package:flutter/cupertino.dart&#x27;;import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:get/get.dart&#x27;;import &#x27;package:getx_demo/pages/account/account_page.dart&#x27;;import &#x27;package:getx_demo/pages/home/home_page.dart&#x27;;import &#x27;dashboard_controller.dart&#x27;;class DashboardPage extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return GetBuilder&lt;DashboardController&gt;( builder: (controller) &#123; return Scaffold( body: IndexedStack( index: controller.tabIndex, children: [ HomePage(), AccountPage(), ], ), bottomNavigationBar: BottomNavigationBar( unselectedItemColor: Colors.black, selectedItemColor: Colors.redAccent, onTap: controller.changeTabIndex, currentIndex: controller.tabIndex, // showSelectedLabels: false, // showUnselectedLabels: false, // type: BottomNavigationBarType.fixed, backgroundColor: Colors.white, elevation: 0, items: [ _bottomNavigationBarItem( icon: CupertinoIcons.home, title: Text(&#x27;one&#x27;.tr), ), _bottomNavigationBarItem( icon: CupertinoIcons.person, title: Text(&#x27;two&#x27;.tr), ), ], ), ); &#125;, ); &#125; _bottomNavigationBarItem(&#123;IconData icon, Widget title&#125;) &#123; return BottomNavigationBarItem(icon: Icon(icon), title: title); &#125;&#125; ç¬¬ä¸€ä¸ªTab:home home -&gt; home_controller.dart12345678910import &#x27;package:get/get.dart&#x27;;class HomeController extends GetxController &#123; final String title = &#x27;Home Title&#x27;; var lgroupValue = &#x27;ä¸­æ–‡&#x27;.obs; void changeValue(value) &#123; lgroupValue.value = value; &#125;&#125; home -&gt; home_page.dart123456789101112131415161718192021222324252627282930313233343536373839404142import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:get/get.dart&#x27;;import &#x27;home_controller.dart&#x27;;class HomePage extends GetView&lt;HomeController&gt; &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar( title: Text(&#x27;é¦–é¡µ&#x27;), ), body: ListView( children: [ Text( &#x27;hello&#x27;.tr, style: TextStyle(fontSize: 20), ), RadioListTile( value: &#x27;ä¸­æ–‡&#x27;, groupValue: controller.lgroupValue.toString(), title: Text(&#x27;ä¸­æ–‡&#x27;), onChanged: (type) &#123; var locale = Locale(&#x27;zh&#x27;, &#x27;CN&#x27;); Get.updateLocale(locale); controller.changeValue(&#x27;ä¸­æ–‡&#x27;); &#125;, ), RadioListTile( value: &#x27;è‹±æ–‡&#x27;, groupValue: controller.lgroupValue.toString(), title: Text(&#x27;è‹±æ–‡&#x27;), onChanged: (type) &#123; var locale = Locale(&#x27;en&#x27;, &#x27;US&#x27;); Get.updateLocale(locale); controller.changeValue(&#x27;è‹±æ–‡&#x27;); &#125;, ) ], ), ); &#125;&#125; å†æ˜¯ç¬¬äºŒä¸ªTab:account account -&gt; account_controller.dart1234567891011import &#x27;package:get/get.dart&#x27;;class AccountController extends GetxController &#123; var counter = 0.obs; String name = &#x27;åå­—&#x27;; int age = 18; void increaseCounter() &#123; counter.value += 1; &#125;&#125; account -&gt; account_page.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:get/get.dart&#x27;;import &#x27;package:getx_demo/pages/account/second/second_page.dart&#x27;;import &#x27;account_controller.dart&#x27;;class AccountPage extends GetView&lt;AccountController&gt; &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar( title: Text(&#x27;ä¸ªäºº&#x27;), ), body: Container( child: Center( child: Column( mainAxisAlignment: MainAxisAlignment.center, crossAxisAlignment: CrossAxisAlignment.center, children: [ Obx( () =&gt; Text(&quot;ç»“æœ $&#123;controller.counter.value&#125;&quot;), ), InkWell( onTap: () =&gt; controller.increaseCounter(), child: Text( &#x27;åŠ 1&#x27;, style: TextStyle(color: Colors.red, fontSize: 20), ), ), InkWell( onTap: () &#123; Get.to( () =&gt; SecondPage( name: controller.name, age: controller.age, ), ); &#125;, child: Text(&#x27;è·³è½¬äºŒçº§&#x27;), ), ], ), ), ), ); &#125;&#125; æ¥ä¸‹æ¥,æ˜¯accountä¸‹çš„äºŒçº§ç•Œé¢:second account -&gt; second_page.dart123456789101112131415161718192021222324252627282930313233343536373839404142import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:get/get.dart&#x27;;import &#x27;../account_controller.dart&#x27;;class SecondPage extends GetView&lt;AccountController&gt; &#123; final String name; final int age; SecondPage(&#123;Key key, @required this.name, this.age&#125;); @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar( title: Text(&#x27;äºŒçº§&#x27;), ), body: Container( child: Center( child: Column( mainAxisAlignment: MainAxisAlignment.center, crossAxisAlignment: CrossAxisAlignment.center, children: [ Text( &#x27;å‚æ•°--&#x27; + this.name + this.age.toString(), ), Obx( () =&gt; Text(&quot;ç»“æœ $&#123;controller.counter.value&#125;&quot;), ), InkWell( onTap: () =&gt; controller.increaseCounter(), child: Text( &#x27;åŠ 1&#x27;, style: TextStyle(color: Colors.red, fontSize: 20), ), ), ], ), ), ), ); &#125;&#125; æºç  å¦å¤–:å…¶ä»–ç®¡ç†åº“å­¦ä¹  å¦å¤–:Flutterå­¦ä¹ demo","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutter~providerå­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~providerå­¦ä¹ ","date":"2021-01-05T16:00:00.000Z","updated":"2021-01-06T07:21:50.754Z","comments":true,"path":"2021/01/06/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~providerå­¦ä¹ /","link":"","permalink":"https://zhoushaoting.com/2021/01/06/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter~provider%E5%AD%A6%E4%B9%A0/","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹providerçš„4.xæ–°ç‰ˆæœ¬.å…¶ä¸­,provider: 4.3.2+2, 3.1.0æ—§ç‰ˆæœ¬åœ¨æ–‡ç« æœ«å°¾ã€‚","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹providerçš„4.xæ–°ç‰ˆæœ¬.å…¶ä¸­,provider: 4.3.2+2, 3.1.0æ—§ç‰ˆæœ¬åœ¨æ–‡ç« æœ«å°¾ã€‚ ä»£ç ç»“æ„å¦‚å›¾æ‰€ç¤º: ä¸‹é¢æ˜¯å„æ–‡ä»¶çš„æºç .main.dart12345678910111213141516171819202122232425262728293031323334353637383940import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:provider/provider.dart&#x27;;import &#x27;package:provider_demo1/tabbar.dart&#x27;;import &#x27;package:provider_demo1/provider/color_provider.dart&#x27;;import &#x27;package:provider_demo1/provider/counter_provider.dart&#x27;;void main() &#123; var colorProvider = ColorProvider(); var counterProvider = CounterProvider(); Provider.debugCheckInvalidValueType = null; runApp(MultiProvider( providers: [ ChangeNotifierProvider.value(value: colorProvider), ChangeNotifierProvider.value(value: counterProvider), ], child: MyApp(), ));&#125;class MyApp extends StatelessWidget &#123; // This widget is the root of your application. @override Widget build(BuildContext context) &#123; return Consumer&lt;CounterProvider&gt;( builder: (context, model, child) &#123; return MaterialApp( title: &#x27;Flutter Demo&#x27;, theme: ThemeData( primarySwatch: Colors.blue, visualDensity: VisualDensity.adaptivePlatformDensity, ), home: Tabbar(), ); &#125;, ); &#125;&#125; tabbar.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:provider_demo1/pages/one_pege.dart&#x27;;import &#x27;package:provider_demo1/pages/two_page.dart&#x27;;class Tabbar extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return new MaterialApp( debugShowCheckedModeBanner: false, home: new MainPageWidget()); &#125;&#125;class MainPageWidget extends StatefulWidget &#123; @override State&lt;StatefulWidget&gt; createState() &#123; return new MainPageState(); &#125;&#125;class MainPageState extends State&lt;MainPageWidget&gt; &#123; int _tabIndex = 0; var tabImages; var appBarTitles = [&#x27;One&#x27;, &#x27;Two&#x27;]; /* * å­˜æ”¾äºŒä¸ªé¡µé¢ï¼Œè·ŸfragmentListä¸€æ · */ var _pageList; /* * æ ¹æ®é€‰æ‹©è·å¾—å¯¹åº”çš„normalæˆ–æ˜¯pressçš„icon */ Image getTabIcon(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return tabImages[curIndex][1]; &#125; return tabImages[curIndex][0]; &#125; /* * è·å–bottomTabçš„é¢œè‰²å’Œæ–‡å­— */ String getTabTitle(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return appBarTitles[curIndex]; &#125; else &#123; return appBarTitles[curIndex]; &#125; &#125; /* * æ ¹æ®imageè·¯å¾„è·å–å›¾ç‰‡ */ Image getTabImage(path) &#123; return new Image.asset(path, width: 24.0, height: 24.0); &#125; void initData() &#123; /* * åˆå§‹åŒ–é€‰ä¸­å’Œæœªé€‰ä¸­çš„icon */ tabImages = [ [ getTabImage(&#x27;images/tab/home.png&#x27;), getTabImage(&#x27;images/tab/home_select.png&#x27;) ], [ getTabImage(&#x27;images/tab/show.png&#x27;), getTabImage(&#x27;images/tab/show_select.png&#x27;) ], ]; /* * å­ç•Œé¢ */ _pageList = [ new OnePage(), new TwoPage(), ]; &#125; @override Widget build(BuildContext context) &#123; //åˆå§‹åŒ–æ•°æ® initData(); return Scaffold( body: _pageList[_tabIndex], bottomNavigationBar: new BottomNavigationBar( items: &lt;BottomNavigationBarItem&gt;[ new BottomNavigationBarItem( icon: getTabIcon(0), label: getTabTitle(0)), new BottomNavigationBarItem( icon: getTabIcon(1), label: getTabTitle(1)), ], type: BottomNavigationBarType.fixed, //é»˜è®¤é€‰ä¸­é¦–é¡µ currentIndex: _tabIndex, iconSize: 24.0, //ç‚¹å‡»äº‹ä»¶ onTap: (index) &#123; setState(() &#123; _tabIndex = index; &#125;); &#125;, )); &#125;&#125; color_provider.dart12345678910111213import &#x27;package:flutter/material.dart&#x27;;class ColorProvider with ChangeNotifier &#123; Color _color = Colors.red; Color get color =&gt; _color; changeColor() &#123; _color = _color == Colors.red ? Colors.blue : Colors.red; notifyListeners(); &#125;&#125; counter_provider.dart12345678910111213141516171819import &#x27;package:flutter/material.dart&#x27;;class CounterProvider with ChangeNotifier &#123; int _count = 0; int get count =&gt; _count; addCounter() &#123; _count++; notifyListeners(); &#125; subCounter() &#123; _count--; notifyListeners(); &#125;&#125; one_page.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:provider/provider.dart&#x27;;import &#x27;package:provider_demo1/provider/color_provider.dart&#x27;;import &#x27;package:provider_demo1/provider/counter_provider.dart&#x27;;class OnePage extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar( title: Text(&#x27;One&#x27;), ), body: Consumer&lt;CounterProvider&gt;( builder: (context, model, child) &#123; return ListView( children: [ IconButton( icon: Icon(Icons.add), onPressed: () &#123; model.addCounter(); &#125;, ), Chip( backgroundColor: Provider.of&lt;ColorProvider&gt;(context).color, padding: EdgeInsets.all(12.0), label: Text( model.count.toString(), style: TextStyle(fontSize: 30.0), ), ), IconButton( icon: Icon(Icons.remove), onPressed: () &#123; model.subCounter(); &#125;, ), ], ); &#125;, ), ); &#125;&#125; two_page.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:provider/provider.dart&#x27;;import &#x27;package:provider_demo1/provider/color_provider.dart&#x27;;import &#x27;package:provider_demo1/provider/counter_provider.dart&#x27;;class TwoPage extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar( title: Text(&#x27;Two&#x27;), ), body: Consumer&lt;CounterProvider&gt;( builder: (context, model, child) &#123; return ListView( children: [ IconButton( icon: Icon(Icons.add), onPressed: () &#123; model.addCounter(); &#125;, ), Chip( backgroundColor: Provider.of&lt;ColorProvider&gt;(context).color, padding: EdgeInsets.all(12.0), label: Text( model.count.toString(), style: TextStyle(fontSize: 30.0), ), ), IconButton( icon: Icon(Icons.remove), onPressed: () &#123; model.subCounter(); &#125;, ), ], ); &#125;, ), floatingActionButton: FloatingActionButton( onPressed: () &#123; Provider.of&lt;ColorProvider&gt;(context, listen: false).changeColor(); &#125;, child: Icon( Icons.build, color: Colors.white, ), ), ); &#125;&#125; æ•ˆæœå›¾: æ–‡ç« æºç  3.1.0ç‰ˆæœ¬æºç  å¦å¤–:å…¶ä»–ç®¡ç†åº“å­¦ä¹  å¦å¤–:Flutterå­¦ä¹ demo","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutter~fish_reduxå­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~fish_reduxå­¦ä¹ ","date":"2020-04-10T16:00:00.000Z","updated":"2020-04-11T10:31:21.011Z","comments":true,"path":"2020/04/11/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~fish_reduxå­¦ä¹ /","link":"","permalink":"https://zhoushaoting.com/2020/04/11/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter~fish_redux%E5%AD%A6%E4%B9%A0/","excerpt":"ä»Šå¤©ï¼Œå­¦ä¹ ä¸‹é˜¿é‡Œå‡ºå“çš„æ•°æ®ç®¡ç†åº“ï¼šfish_reduxã€‚","text":"ä»Šå¤©ï¼Œå­¦ä¹ ä¸‹é˜¿é‡Œå‡ºå“çš„æ•°æ®ç®¡ç†åº“ï¼šfish_reduxã€‚ &ensp;&ensp; &ensp;&ensp;åœ¨æˆå“demoä¸­ï¼Œä½¿ç”¨äº†fish_reduxã€ç½‘ç»œè¯·æ±‚dioã€tabbarã€æ•°æ®æ¨¡å‹modelã€åŸºæœ¬ä¼ å€¼ã€componentã€globalStroreã€adapterã€‚å·²ç»å®Œæˆäº†ä¸€ä¸ªåŸºæœ¬é¡¹ç›®çš„æ¶å­ã€‚å…ˆçœ‹ä¸‹å®Œæˆä¹‹åçš„æ•ˆæœå›¾ï¼šğŸ’¡ï¼šç®€ä»‹åœ¨ä¸€å¼€å§‹ï¼Œéœ€è¦å…ˆè¡Œäº†è§£ä¸‹fish_reduxä¸ºä½•ç‰©ï¼Ÿä½•ç”¨ï¼Ÿä½¿ç”¨åœºæ™¯ï¼Ÿä½•ç‰©?&ensp;&ensp; Fish Reduxæ˜¯ä¸€ä¸ªåŸºäº Redux æ•°æ®ç®¡ç†çš„ç»„è£…å¼ flutter åº”ç”¨æ¡†æ¶ï¼Œ ç‰¹åˆ«é€‚ç”¨äºæ„å»ºä¸­å¤§å‹çš„å¤æ‚åº”ç”¨ï¼Œå®ƒæœ€æ˜¾è‘—çš„ç‰¹å¾æ˜¯ å‡½æ•°å¼çš„ç¼–ç¨‹æ¨¡å‹ã€å¯é¢„æµ‹çš„çŠ¶æ€ç®¡ç†ã€å¯æ’æ‹”çš„ç»„ä»¶ä½“ç³»ã€æœ€ä½³çš„æ€§èƒ½è¡¨ç°ã€‚ä½•ç”¨?&ensp;&ensp; ç®¡ç†é¡¹ç›®çš„æ•°æ®æµã€åœ¨reduxçš„ä¸­å¿ƒæ€æƒ³å‰æä¸‹ï¼Œ\b\bé™ä½è€¦åˆåº¦å’Œæé«˜å¯æ‰©å±•æ€§ï¼Œè§£å†³äº†ã€é›†ä¸­ã€‘å’Œã€åˆ†æ²»ã€‘ä¹‹é—´çš„çŸ›ç›¾ï¼ŒåŒæ—¶å¯¹ Reducer çš„æ‰‹åŠ¨å±‚å±‚ Combine å˜æˆç”±æ¡†æ¶è‡ªåŠ¨å®Œæˆï¼Œå¤§å¤§ç®€åŒ–äº†ä½¿ç”¨ Redux çš„å›°éš¾ã€‚ä½¿ç”¨åœºæ™¯ï¼Ÿ&ensp;&ensp; ä¸­å¤§å‹çš„å¤æ‚åº”ç”¨ã€‚é²è¿…è¯´è¿‡å¤§é¡¹ç›®è¶Šä½¿ç”¨è¶Šæ–¹ä¾¿ï¼Œå°é¡¹ç›®è¶Šä½¿ç”¨è¶Šæ¶å¿ƒã€‚å‚è€ƒèµ„æ–™ï¼š fish redux pdf é˜¿é‡Œfish reduxè§†é¢‘ é˜¿é‡Œfish reduxåˆè¯† é˜¿é‡Œfish reduxä¸­æ–‡ä»‹ç» ğŸ’¡ï¼šåˆ†å±‚æ¶æ„å›¾fish_reduxç”±reduxæ”¹è‰¯è€Œæ¥ï¼šReduxRedux æ˜¯æ¥è‡ªå‰ç«¯ç¤¾åŒºçš„ä¸€ä¸ªæ•°æ®ç®¡ç†æ¡†æ¶ï¼Œå¯¹ Nativeå¼€å‘åŒå­¦æ¥è¯´å¯èƒ½ä¼šæœ‰ä¸€ç‚¹é™Œç”Ÿï¼Œæˆ‘ä»¬åšä¸€ä¸ªç®€å•çš„ä»‹ç»ã€‚Redux æ˜¯åšä»€ä¹ˆçš„ï¼ŸRedux æ˜¯ä¸€ä¸ªç”¨æ¥åš[å¯é¢„æµ‹][é›†ä¸­å¼][æ˜“è°ƒè¯•][çµæ´»æ€§]çš„æ•°æ®ç®¡ç†çš„æ¡†æ¶ã€‚æ‰€æœ‰å¯¹æ•°æ®çš„å¢åˆ æ”¹æŸ¥ç­‰æ“ä½œéƒ½ç”± Redux æ¥é›†ä¸­è´Ÿè´£ã€‚Redux æ˜¯æ€ä¹ˆè®¾è®¡å’Œå®ç°çš„ï¼ŸRedux æ˜¯ä¸€ä¸ªå‡½æ•°å¼çš„æ•°æ®ç®¡ç†çš„æ¡†æ¶ã€‚ä¼ ç»Ÿ OOP åšæ•°æ®ç®¡ç†ï¼Œå¾€å¾€æ˜¯å®šä¹‰ä¸€äº› Beanï¼Œæ¯ä¸€ä¸ª Bean å¯¹å¤–æš´éœ²ä¸€äº› Public-API ç”¨æ¥æ“ä½œå†…éƒ¨æ•°æ®ï¼ˆå……è¡€æ¨¡å‹ï¼‰ã€‚å‡½æ•°å¼çš„åšæ³•æ˜¯æ›´ä¸Šä¸€ä¸ªæŠ½è±¡çš„çº¬åº¦ï¼Œå¯¹æ•°æ®çš„å®šä¹‰æ˜¯ä¸€äº› Structï¼ˆè´«è¡€æ¨¡å‹ï¼‰ï¼Œè€Œæ“ä½œæ•°æ®çš„æ–¹æ³•éƒ½ç»Ÿä¸€åˆ°å…·æœ‰ç›¸åŒå‡½æ•°ç­¾å (T, Action) =&gt; T çš„ Reducer ä¸­ã€‚FP:Structï¼ˆè´«è¡€æ¨¡å‹ï¼‰ + Reducer = OOP:Beanï¼ˆå……è¡€æ¨¡å‹ï¼‰åŒæ—¶ Redux åŠ ä¸Šäº† FP ä¸­å¸¸ç”¨çš„ Middlewareï¼ˆAOPï¼‰ æ¨¡å¼å’Œ Subscribe æœºåˆ¶ï¼Œç»™æ¡†æ¶å¸¦äº†æé«˜çš„çµæ´»æ€§å’Œæ‰©å±•æ€§ã€‚è´«è¡€æ¨¡å‹ã€å……è¡€æ¨¡å‹è¯·å‚è€ƒï¼šhttps://en.wikipedia.org/wiki/Plain_old_Java_objectRedux çš„ç¼ºç‚¹Redux æ ¸å¿ƒä»…ä»…å…³å¿ƒæ•°æ®ç®¡ç†ï¼Œä¸å…³å¿ƒå…·ä½“ä»€ä¹ˆåœºæ™¯æ¥ä½¿ç”¨å®ƒï¼Œè¿™æ˜¯å®ƒçš„ä¼˜ç‚¹åŒæ—¶ä¹Ÿæ˜¯å®ƒçš„ç¼ºç‚¹ã€‚åœ¨æˆ‘ä»¬å®é™…ä½¿ç”¨ Redux ä¸­é¢ä¸´ä¸¤ä¸ªå…·ä½“é—®é¢˜ï¼šâ€¢ Redux çš„é›†ä¸­å’Œ Component çš„åˆ†æ²»ä¹‹é—´çš„çŸ›ç›¾ï¼›â€¢ Redux çš„ Reducer éœ€è¦ä¸€å±‚å±‚æ‰‹åŠ¨ç»„è£…ï¼Œå¸¦æ¥çš„ç¹çæ€§å’Œæ˜“é”™æ€§ã€‚Fish Redux çš„æ”¹è‰¯Fish Redux é€šè¿‡ Redux åšé›†ä¸­åŒ–çš„å¯è§‚å¯Ÿçš„æ•°æ®ç®¡ç†ã€‚ç„¶ä¸ä»…äºæ­¤ï¼Œå¯¹äºä¼ ç»Ÿ Redux åœ¨ä½¿ç”¨å±‚é¢ä¸Šçš„ç¼ºç‚¹ï¼Œåœ¨é¢å‘ç«¯ä¾§ flutter é¡µé¢çº¬åº¦å¼€å‘çš„åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æ›´å¥½æ›´é«˜çš„æŠ½è±¡ï¼Œåšäº†æ”¹è‰¯ã€‚ä¸€ä¸ªç»„ä»¶éœ€è¦å®šä¹‰ä¸€ä¸ªæ•°æ®ï¼ˆStructï¼‰å’Œä¸€ä¸ª Reducerã€‚åŒæ—¶ç»„ä»¶ä¹‹é—´å­˜åœ¨ç€çˆ¶ä¾èµ–å­çš„å…³ç³»ã€‚é€šè¿‡è¿™å±‚ä¾èµ–å…³ç³»ï¼Œæˆ‘ä»¬è§£å†³äº†ã€é›†ä¸­ã€‘å’Œã€åˆ†æ²»ã€‘ä¹‹é—´çš„çŸ›ç›¾ï¼ŒåŒæ—¶å¯¹ Reducer çš„æ‰‹åŠ¨å±‚å±‚ Combine å˜æˆç”±æ¡†æ¶è‡ªåŠ¨å®Œæˆï¼Œå¤§å¤§ç®€åŒ–äº†ä½¿ç”¨ Redux çš„å›°éš¾ã€‚æˆ‘ä»¬å¾—åˆ°äº†ç†æƒ³çš„é›†ä¸­çš„æ•ˆæœå’Œåˆ†æ²»çš„ä»£ç ã€‚ğŸ’¡ï¼šæ„æˆ &ensp;1ã€æ•°æ® æ ¸å¿ƒéƒ¨åˆ†ã€‚\bå®šä¹‰äº†ç»„ä»¶éœ€è¦ç”¨åˆ°çš„æ•°æ®ï¼Œä¹Ÿæ˜¯ç»„ä»¶çš„é‡è¦ç»„æˆï¼Œå…¶åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šâ€¢ å‚ä¸è§†å›¾å·¥ä½œçš„ Reduxâ€¢ ä¸å‚ä¸è§†å›¾å·¥ä½œçš„ LocalProps &ensp;2ã€è§†å›¾æœ€åŸºæœ¬çš„ï¼Œä¹Ÿå°±æ˜¯æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œæ¯ä¸€ä¸ªç»„ä»¶éƒ½åº”è¯¥æ˜¯å¯è§†çš„ã€‚æ‰€ä»¥åœ¨ç»„ä»¶æ„å»ºæ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ä¸ºç»„ä»¶æä¾›ä¸€ä¸ªç”¨äºæ„å»ºè§†å›¾çš„å‡½æ•°ã€‚ &ensp;3ã€ä¾èµ– æè¿°äº†ç»„ä»¶ä¸ç»„ä»¶ä¹‹é—´çš„å…³ç³»ï¼Œä¹Ÿæ˜¯å¯æ’æ‹”çš„ç»„ä»¶å¼å¼€å‘çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ã€‚å…¶åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š\bâ€¢ ä¸ºåˆ—è¡¨è€Œä¼˜åŒ–çš„ Adapterâ€¢ ç»„ä»¶æ•´ä½“çš„ç»„æˆéƒ¨åˆ† slot\bComponentç»„ä»¶æ˜¯å¯¹å±€éƒ¨çš„å±•ç¤ºå’ŒåŠŸèƒ½çš„å°è£…ã€‚ åŸºäº Redux çš„åŸåˆ™ï¼Œæˆ‘ä»¬å¯¹åŠŸèƒ½ç»†åˆ†ä¸ºä¿®æ”¹æ•°æ®çš„åŠŸèƒ½(Reducer)å’Œéä¿®æ”¹æ•°æ®çš„åŠŸèƒ½(å‰¯ä½œç”¨ Effect)ã€‚äºæ˜¯æˆ‘ä»¬å¾—åˆ°äº†ï¼ŒViewã€ Effectã€Reducer ä¸‰éƒ¨åˆ†ï¼Œç§°ä¹‹ä¸ºç»„ä»¶çš„ä¸‰è¦ç´ ï¼Œåˆ†åˆ«è´Ÿè´£äº†ç»„ä»¶çš„å±•ç¤ºã€éä¿®æ”¹æ•°æ®çš„è¡Œä¸ºã€ä¿®æ”¹æ•°æ®çš„è¡Œä¸ºã€‚è¿™æ˜¯ä¸€ç§é¢å‘å½“ä¸‹ï¼Œä¹Ÿé¢å‘æœªæ¥çš„æ‹†åˆ†ã€‚åœ¨é¢å‘å½“ä¸‹çš„ Redux çœ‹æ¥ï¼Œæ˜¯æ•°æ®ç®¡ç†å’Œå…¶ä»–ã€‚åœ¨é¢å‘æœªæ¥çš„ UI-Automation çœ‹æ¥æ˜¯ UI è¡¨è¾¾å’Œå…¶ä»–ã€‚UI çš„è¡¨è¾¾å¯¹ç¨‹åºå‘˜è€Œè¨€å³å°†è¿›å…¥é»‘ç›’æ—¶ä»£ï¼Œç ”å‘å·¥ç¨‹å¸ˆä»¬ä¼šæŠŠæ›´å¤šçš„ç²¾åŠ›æ”¾åœ¨éä¿®æ”¹æ•°æ®çš„è¡Œä¸ºã€ä¿®æ”¹æ•°æ®çš„è¡Œä¸ºä¸Šã€‚ç»„ä»¶æ˜¯å¯¹è§†å›¾çš„åˆ†æ²»ï¼Œä¹Ÿæ˜¯å¯¹æ•°æ®çš„åˆ†æ²»ã€‚é€šè¿‡é€å±‚åˆ†æ²»ï¼Œæˆ‘ä»¬å°†å¤æ‚çš„é¡µé¢å’Œæ•°æ®åˆ‡åˆ†ä¸ºç›¸äº’ç‹¬ç«‹çš„å°æ¨¡å—ã€‚è¿™å°†åˆ©äºå›¢é˜Ÿå†…çš„åä½œå¼€å‘ã€‚å…³äº ViewView ä»…ä»…æ˜¯ä¸€ä¸ªå‡½æ•°ç­¾å: (T,Dispatch,ViewService) =&gt; Widgetå®ƒä¸»è¦åŒ…å«ä¸‰æ–¹é¢çš„ä¿¡æ¯â€¢ è§†å›¾æ˜¯å®Œå…¨ç”±æ•°æ®é©±åŠ¨ã€‚â€¢ è§†å›¾äº§ç”Ÿçš„äº‹ä»¶ï¼å›è°ƒï¼Œé€šè¿‡ Dispatch å‘å‡ºâ€œæ„å›¾â€ï¼Œä¸åšå…·ä½“çš„å®ç°ã€‚â€¢ éœ€è¦ç”¨åˆ°çš„ç»„ä»¶ä¾èµ–ç­‰ï¼Œé€šè¿‡ ViewService æ ‡å‡†åŒ–è°ƒç”¨ã€‚æ¯”å¦‚ä¸€ä¸ªå…¸å‹çš„ç¬¦åˆ View ç­¾åçš„å‡½æ•°ã€‚å…³äº EffectEffect æ˜¯å¯¹éä¿®æ”¹æ•°æ®è¡Œä¸ºçš„æ ‡å‡†å®šä¹‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ç­¾å: (Context, Action) =&gt; Objectå®ƒä¸»è¦åŒ…å«å››æ–¹é¢çš„ä¿¡æ¯â€¢ æ¥æ”¶æ¥è‡ª View çš„â€œæ„å›¾â€ï¼Œä¹ŸåŒ…æ‹¬å¯¹åº”çš„ç”Ÿå‘½å‘¨æœŸçš„å›è°ƒï¼Œç„¶ååšå‡ºå…·ä½“çš„æ‰§è¡Œã€‚â€¢ å®ƒçš„å¤„ç†å¯èƒ½æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œæ•°æ®å¯èƒ½åœ¨è¿‡ç¨‹ä¸­è¢«ä¿®æ”¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å´‡å°šæŒæœ‰æ•°æ®ï¼Œè€Œé€šè¿‡ä¸Šä¸‹æ–‡æ¥è·å–æœ€æ–°æ•°æ®ã€‚â€¢ å®ƒä¸ä¿®æ”¹æ•°æ®ï¼Œ å¦‚æœä¿®è¦ï¼Œåº”è¯¥å‘ä¸€ä¸ª Action åˆ° Reducer é‡Œå»å¤„ç†ã€‚â€¢ å®ƒçš„è¿”å›å€¼ä»…é™äº bool or Futureï¼Œ å¯¹åº”æ”¯æŒåŒæ­¥å‡½æ•°å’Œåç¨‹çš„å¤„ç†æµç¨‹ã€‚ReducerReducer æ˜¯ä¸€ä¸ªå®Œå…¨ç¬¦åˆ Redux è§„èŒƒçš„å‡½æ•°ç­¾å,å³ä¸€ä¸ªçº¯å‡½æ•°ã€‚Stateä¸€ä¸ªå¯å˜çš„ State éœ€è¦å®ç° Cloneable ç±»ã€‚å…¶æ ¸å¿ƒåœ¨äº clone å‡½æ•°ï¼Œå®ƒæ€»æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼ŒAction åœ¨ Redux ä¸­ï¼Œä¿®æ”¹ State æ˜¯é€šè¿‡è°ƒç”¨ dispatch å‡½æ•°å»è§¦å‘ Action æ¥è¿›è¡Œçš„ï¼Œ ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒAction ä»…ä»…æ˜¯è¡¨è¾¾äº†ä¿®æ”¹ State çš„æ„å›¾ã€‚â€¢ Action çš„æ„é€ å™¨æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šâ€¢ Object type - å¿…è¦å‚æ•°ï¼ŒAction å®ä¾‹çš„ç±»å‹dyanmic payload - å¯é€‰å‚æ•°ï¼ŒAction å®ä¾‹æºå¸¦çš„å‚æ•°ä¸ºäº†æ›´å¥½çš„åä½œå¼€å‘å’Œå‡å°‘ä½çº§é”™è¯¯ï¼Œå»ºè®®å£°æ˜ä¸€ä¸ª Action ç±»å‹çš„æšä¸¾ç±»ï¼Œä»¥åŠå®šä¹‰ä¸€ä¸ªé›†åˆè¿”å› Action çš„å‡½æ•°çš„ç±»ï¼Œè¿™æ ·å¯ä»¥çº¦æŸåˆ° payload çš„ç±»å‹Adapterhttps://github.com/alibaba/fish-redux/blob/master/doc/concept/adapter-cn.mdhttps://github.com/alibaba/fish-redux/blob/master/doc/concept/what&#39;s-adapter.mdåœ¨åŸºæœ¬äº†è§£fish_reduxçš„æ¦‚å¿µä¹‹åï¼Œç…§é»‘çŒ«ç”»ç™½ç‹—ï¼Œå†™å†™ä»£ç ç†Ÿæ‚‰ä¸‹ã€‚ åœ¨æ­£å¼ä½¿ç”¨ä¹‹å‰ï¼Œæœ€å¥½é‡‡ç”¨ä¸‹IDEæ’ä»¶ï¼Œå¿«æ·ç”ŸæˆåŸºæœ¬çš„æ–‡ä»¶å’Œä»£ç ã€‚ fish_reduxæ¨¡ç‰ˆå·¥å…·FishReduxTemplateForAS-Android Studio fish_reduxæ¨¡ç‰ˆå·¥å…·fish-redux-template-VScode è¿™é‡Œï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯Android Studioï¼Œé¦–å…ˆï¼Œæ–°å»ºä¸€ä¸ªåˆå§‹é¡¹ç›®ï¼Œç„¶åå…ˆåŠ å…¥fish_reduxåº“ï¼š ç„¶åPackages getã€‚ ç„¶åæˆ‘ä»¬æ–°å»ºè‹¥å¹²æ–‡ä»¶å¤¹åˆ†åˆ†ç±»ï¼š components:å­˜æ”¾å­ç•Œé¢ modelï¼šæ•°æ®è½¬æ¨¡å‹ one_tab: å­˜æ”¾ç¬¬ä¸€ä¸ªTab service_api:ç½‘ç»œè¯·æ±‚ç­‰ storeï¼šæ ¹store tabbar: Tabbaræ  two_tab:å­˜æ”¾ç¬¬äºŒä¸ªTab app.dart: PageRouteså’ŒMaterialAppçš„å¼€å§‹ main.dart: èµ·å§‹æ–‡ä»¶å…ˆé€‰ä¸­one_tabï¼Œç„¶åFile-&gt;New-&gt;FishReduxTemplateï¼Œé€‰æ‹©pageï¼ŒSelect Filesé€‰ä¸­æ‰€æœ‰æ–‡ä»¶ï¼ŒModule Nameæˆ‘ä»¬å¯ä»¥å†™Oneï¼Œç„¶åOKï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€äº›æ–‡ä»¶ã€‚ä»¥æ­¤ç±»æ¨ï¼Œæˆ‘ä»¬å†åœ¨two_tabä¸‹æ–°å»ºTwo,tabbaræ–°å»ºTabbarã€‚ åŸºæœ¬æ–‡ä»¶æ–°å»ºå®Œæ¯•ï¼Œå¼€å§‹å†™Tabbarï¼štabbar--state.dart 12345678910111213141516import &#x27;package:fish_redux/fish_redux.dart&#x27;;class TabbarState implements Cloneable&lt;TabbarState&gt; &#123; var index = 0; @override TabbarState clone() &#123; TabbarState newState = TabbarState()..index = index; return newState; &#125;&#125;TabbarState initState(Map&lt;String, dynamic&gt; args) &#123; return TabbarState()..index = 0;&#125; å¦‚ä¸Šæ‰€ç¤ºï¼Œå…ˆå®šä¹‰ä¸€ä¸ªç”¨äºæ§åˆ¶å½“å‰indexçš„å€¼ï¼Œé»˜è®¤ç»™0ä½ã€‚ tabbar--view.dart 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081import &#x27;package:fish_redux/fish_redux.dart&#x27;;import &#x27;package:fishreduxdemo/tabbar/action.dart&#x27;;import &#x27;package:flutter/material.dart&#x27;;import &#x27;state.dart&#x27;;import &#x27;../one_tab/page.dart&#x27;;import &#x27;../two_tab/page.dart&#x27;;Widget buildView( TabbarState state, Dispatch dispatch, ViewService viewService) &#123; var tabImages; var appBarTitles = [&#x27;é¦–é¡µ&#x27;, &#x27;æˆ‘çš„&#x27;]; /* * æ ¹æ®é€‰æ‹©è·å¾—å¯¹åº”çš„normalæˆ–æ˜¯pressçš„icon */ Image getTabIcon(int curIndex) &#123; if (curIndex == state.index) &#123; return tabImages[curIndex][1]; &#125; return tabImages[curIndex][0]; &#125; /* * è·å–bottomTabçš„é¢œè‰²å’Œæ–‡å­— */ Text getTabTitle(int curIndex) &#123; if (curIndex == state.index) &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: Colors.red)); &#125; else &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: Colors.black)); &#125; &#125; /* * æ ¹æ®imageè·¯å¾„è·å–å›¾ç‰‡ */ Image getTabImage(path) &#123; return new Image.asset(path, width: 24.0, height: 24.0); &#125; /* * åˆå§‹åŒ–é€‰ä¸­å’Œæœªé€‰ä¸­çš„icon */ tabImages = [ [ getTabImage(&#x27;images/tab/home.png&#x27;), getTabImage(&#x27;images/tab//home_select.png&#x27;) ], [ getTabImage(&#x27;images/tab/mine.png&#x27;), getTabImage(&#x27;images/tab//mine_select.png&#x27;) ] ]; return Scaffold( body: IndexedStack( children: &lt;Widget&gt;[ OnePage().buildPage(null), TwoPage().buildPage(null), ], index: state.index, ), bottomNavigationBar: new BottomNavigationBar( items: &lt;BottomNavigationBarItem&gt;[ new BottomNavigationBarItem(icon: getTabIcon(0), title: getTabTitle(0)), new BottomNavigationBarItem(icon: getTabIcon(1), title: getTabTitle(1)), ], type: BottomNavigationBarType.fixed, //é»˜è®¤é€‰ä¸­é¦–é¡µ currentIndex: state.index, iconSize: 24.0, //ç‚¹å‡»äº‹ä»¶ onTap: (index) &#123; dispatch(TabbarActionCreator.switchIndex(index)); &#125;, ), );&#125; å¦‚ä¸Šæ‰€ç¤ºï¼Œå…ˆå¼•å…¥å¿…é¡»çš„æ–‡ä»¶ï¼Œåˆ‡æ¢æ–¹æ³•æ”¹ä¸ºfish_reduxçš„è§¦å‘action-&gt;reducerä¿®æ”¹state-&gt;ç•Œé¢ä¿®æ”¹tabbar--action.dart 12345678910111213141516import &#x27;package:fish_redux/fish_redux.dart&#x27;;//TODO replace with your own actionenum TabbarAction &#123; action, switchIndex &#125;class TabbarActionCreator &#123; static Action onAction() &#123; return Action(TabbarAction.action); &#125; // åˆ‡æ¢tab static Action switchIndex(int index) &#123; return Action(TabbarAction.switchIndex, payload: index); &#125;&#125; å®šä¹‰ä¸€ä¸ªåˆ‡æ¢indexçš„action ** switchIndex **tabbar-reducer.dart 1234567891011121314151617181920212223242526272829import &#x27;package:fish_redux/fish_redux.dart&#x27;;import &#x27;action.dart&#x27;;import &#x27;state.dart&#x27;;Reducer&lt;TabbarState&gt; buildReducer() &#123; return asReducer( &lt;Object, Reducer&lt;TabbarState&gt;&gt;&#123; TabbarAction.action: _onAction, TabbarAction.switchIndex: _switchIndex, &#125;, );&#125;TabbarState _onAction(TabbarState state, Action action) &#123; final TabbarState newState = state.clone(); return newState;&#125;/** åˆ‡æ¢tabç‚¹å‡»* */TabbarState _switchIndex(TabbarState state, Action action) &#123; var index = action.payload; final TabbarState newState = state.clone()..index = index; return newState;&#125; reduceré‡Œé¢å¤„ç†åˆ‡æ¢æ–¹æ³•ã€‚ effect ä¸å˜tabbar-effect.dart 123456789101112import &#x27;package:fish_redux/fish_redux.dart&#x27;;import &#x27;action.dart&#x27;;import &#x27;state.dart&#x27;;Effect&lt;TabbarState&gt; buildEffect() &#123; return combineEffects(&lt;Object, Effect&lt;TabbarState&gt;&gt;&#123; TabbarAction.action: _onAction, &#125;);&#125;void _onAction(Action action, Context&lt;TabbarState&gt; ctx) &#123;&#125; tabbar-page.dartä¸å˜ 1234567891011121314151617181920212223import &#x27;package:fish_redux/fish_redux.dart&#x27;;import &#x27;effect.dart&#x27;;import &#x27;reducer.dart&#x27;;import &#x27;state.dart&#x27;;import &#x27;view.dart&#x27;;class TabbarPage extends Page&lt;TabbarState, Map&lt;String, dynamic&gt;&gt; &#123; TabbarPage() : super( initState: initState, effect: buildEffect(), reducer: buildReducer(), view: buildView, dependencies: Dependencies&lt;TabbarState&gt;( adapter: null, slots: &lt;String, Dependent&lt;TabbarState&gt;&gt;&#123; &#125;), middleware: &lt;Middleware&lt;TabbarState&gt;&gt;[ ],);&#125; one_tabå’Œtwo_tabæš‚æ—¶ä¸å˜ã€‚main.dart 123import &#x27;package:flutter/material.dart&#x27;;import &#x27;./app.dart&#x27;;void main() =&gt; runApp(createApp()); app.dart 123456789101112131415161718192021222324252627282930import &#x27;package:fish_redux/fish_redux.dart&#x27;;import &#x27;package:flutter/material.dart&#x27; hide Action;import &#x27;package:flutter/widgets.dart&#x27; hide Action;import &#x27;./tabbar/page.dart&#x27;;import &#x27;./one_tab/page.dart&#x27;;import &#x27;./two_tab/page.dart&#x27;;Widget createApp() &#123; final AbstractRoutes routes = PageRoutes(pages: &lt;String, Page&lt;Object, dynamic&gt;&gt;&#123; &#x27;tabbar&#x27;: TabbarPage(), &#x27;one&#x27;: OnePage(), //åœ¨è¿™é‡Œæ·»åŠ é¡µé¢ &#x27;two&#x27;: TwoPage(), &#125;); return MaterialApp( title: &#x27;FishDemo&#x27;, theme: ThemeData( primarySwatch: Colors.blue, ), home: routes.buildPage(&#x27;tabbar&#x27;, null), //æŠŠä»–ä½œä¸ºé»˜è®¤é¡µé¢ onGenerateRoute: (RouteSettings settings) &#123; return MaterialPageRoute&lt;Object&gt;(builder: (BuildContext context) &#123; return routes.buildPage(settings.name, settings.arguments); &#125;); &#125;, );&#125; è¿™é‡Œéœ€è¦é…ç½®è·¯ç”±ã€‚OKã€‚åŸºæœ¬ç•Œé¢å·²ç»å®Œæˆã€‚ ç„¶åæˆ‘ä»¬è¯•è¯•ä½¿ç”¨globalStoreé…ç½®å…¨å±€stateã€‚ä¿®æ”¹å…¨å±€çš„é¢œè‰²åœ¨storeæ–‡ä»¶å¤¹ä¸‹æ–°å»ºæ–‡ä»¶action.dart reducer.dart state.dart store.dart update.dart store--action.dart 123456789import &#x27;package:fish_redux/fish_redux.dart&#x27;;enum GlobalAction &#123; changeThemeColor &#125;class GlobalActionCreator&#123; static Action onChangeThemeColor()&#123; return const Action(GlobalAction.changeThemeColor); &#125;&#125; å®šä¹‰ä¸€ä¸ªactionï¼šchangeThemeColorstore--reducer 1234567891011121314151617181920import &#x27;package:fish_redux/fish_redux.dart&#x27;;import &#x27;dart:ui&#x27;;import &#x27;package:flutter/material.dart&#x27; hide Action;import &#x27;action.dart&#x27;;import &#x27;state.dart&#x27;;Reducer&lt;GlobalState&gt; buildReducer() &#123; return asReducer( &lt;Object, Reducer&lt;GlobalState&gt;&gt;&#123; GlobalAction.changeThemeColor: _onChangeThemeColor, &#125;, );&#125;GlobalState _onChangeThemeColor(GlobalState state, Action action) &#123; final Color color = state.themeColor == Colors.green ? Colors.blue : Colors.green; return state.clone()..themeColor = color;&#125; åˆ‡æ¢æ–¹æ³•ä¸º state.themeColor == Colors.green ? Colors.blue : Colors.green;state.dart 1234567891011121314151617import &#x27;dart:ui&#x27;;import &#x27;package:fish_redux/fish_redux.dart&#x27;;abstract class GlobalBaseState&#123; Color get themeColor; set themeColor(Color color);&#125;class GlobalState implements GlobalBaseState, Cloneable&lt;GlobalState&gt;&#123; @override Color themeColor; @override GlobalState clone() &#123; return GlobalState(); &#125;&#125; implements Cloneable ç„¶åé‡å†™themeColorstore-store.dart 12345678910import &#x27;package:fish_redux/fish_redux.dart&#x27;;import &#x27;state.dart&#x27;;import &#x27;reducer.dart&#x27;;class GlobalStore&#123; static Store&lt;GlobalState&gt; _globalStore; static Store&lt;GlobalState&gt; get store =&gt; _globalStore ??= createStore&lt;GlobalState&gt;(GlobalState(), buildReducer());&#125; å®šä¹‰ä¸€ä¸ªStorestore--update.dart 12345678910111213141516171819202122232425import &#x27;package:fish_redux/fish_redux.dart&#x27;;import &#x27;state.dart&#x27;;/// å…¨å±€åˆ·æ–°çŠ¶æ€/// é¡µé¢çŠ¶æ€åˆ·æ–°ï¼Œåœ¨ [createApp()] visitor ä¸­æ³¨å†Œ/// å¦‚æœæ˜¯ `PageView` ä¸­çš„é¡µé¢åšåˆ·æ–°ï¼Œåœ¨ `Page` æ„é€ å‡½æ•°ä¸­æ³¨å†Œ/// å‚è€ƒ [HomeArticlePage]globalUpdate() =&gt; (Object pageState, GlobalState appState) &#123; final GlobalBaseState p = pageState; if (pageState is Cloneable) &#123; final Object copy = pageState.clone(); final GlobalBaseState newState = copy; if (p.themeColor != appState.themeColor) &#123; newState.themeColor = appState.themeColor; &#125; return newState; &#125; return pageState; &#125;; storeä¹¦å†™å®Œæ¯•ã€‚æ¥ä¸‹é‡Œä¿®æ”¹ä¸‹app.dart 123456789101112131415161718192021222324252627282930Â·Â·Â·import &#x27;./store/state.dart&#x27;;import &#x27;./store/store.dart&#x27;;Â·Â·Â· final AbstractRoutes routes = PageRoutes( pages: &lt;String, Page&lt;Object, dynamic&gt;&gt;&#123; &#x27;tabbar&#x27;: TabbarPage(), &#x27;one&#x27;: OnePage(), //åœ¨è¿™é‡Œæ·»åŠ é¡µé¢ &#x27;adapter_page&#x27;: AdapterTestPage(), &#x27;two&#x27;: TwoPage(), &#125;, visitor: (String path, Page&lt;Object, dynamic&gt; page) &#123; if (page.isTypeof&lt;GlobalBaseState&gt;()) &#123; page.connectExtraStore&lt;GlobalState&gt;(GlobalStore.store, (Object pageState, GlobalState appState) &#123; final GlobalBaseState p = pageState; if (p.themeColor != appState.themeColor) &#123; if (pageState is Cloneable) &#123; final Object copy = pageState.clone(); final GlobalBaseState newState = copy; newState.themeColor = appState.themeColor; return newState; &#125; &#125; return pageState; &#125;); &#125; &#125;, );Â·Â·Â· å¾€å…¶ä¸­åŠ å…¥visitor å³å¯ã€‚ç„¶ååœ¨ç•Œé¢ä¸­å†™å…¥è¯¥themeColorï¼š 1234567891011121314151617181920212223Â·Â·Â·import &#x27;package:fish_redux/fish_redux.dart&#x27;;import &#x27;dart:ui&#x27;;import &#x27;../components/child_view/state.dart&#x27;;import &#x27;../components/achild_view/state.dart&#x27;;import &#x27;../store/state.dart&#x27;;class OneState implements Cloneable&lt;OneState&gt;, GlobalBaseState &#123; ChildViewState childState; AchildViewState aChildState; @override Color themeColor; @override OneState clone() &#123; return OneState() ..childState = childState ..aChildState = aChildState ..themeColor = themeColor; &#125;&#125;Â·Â·Â· 1234567Â·Â·Â·return Scaffold( appBar: AppBar( backgroundColor: state.themeColor, title: Text(&#x27;one&#x27;), ),Â·Â·Â· ä¿®æ”¹ï¼š 123456Â·Â·Â· GlobalStore.store.dispatch(GlobalActionCreator.onChangeThemeColor());Â·Â·Â· å…¶ä¸­åˆ«å¿˜äº†è¿æ¥ connectExtraStore(GlobalStore.store, globalUpdate()); è¯¦ç»†çš„å¯ä»¥çœ‹æ–‡æœ«GitHubé“¾æ¥ã€‚ OKï¼Œæˆ‘ä»¬å†å°è¯•ä¸‹componentã€‚åœ¨componentsæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªchild_viewæ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨å…¶æ–‡ä»¶å¤¹ä¸‹æ–°å»ºcomponentï¼Œé€‰æ‹©File-&gt;New-&gt;FishReduxTemplateï¼Œé€‰æ‹©Componentï¼Œè¾“å…¥ä¸€ä¸ªModule Nameã€‚ç‚¹å‡»OKè¿™ä¸ªæ—¶å€™ï¼Œä¼šç”Ÿæˆaction.dart component.dart effect.dart reducer.dart state.dart view.dart:ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨ä¸»pageé‡Œé¢ä½¿ç”¨è¿™ä¸ªcomponentï¼šone_tab--state.dart 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253import &#x27;package:fish_redux/fish_redux.dart&#x27;;import &#x27;dart:ui&#x27;;import &#x27;../components/child_view/state.dart&#x27;;import &#x27;../components/achild_view/state.dart&#x27;;import &#x27;../store/state.dart&#x27;;class OneState implements Cloneable&lt;OneState&gt;, GlobalBaseState &#123; ChildViewState childState; AchildViewState aChildState; @override Color themeColor; @override OneState clone() &#123; return OneState() ..childState = childState ..aChildState = aChildState ..themeColor = themeColor; &#125;&#125;OneState initState(Map&lt;String, dynamic&gt; args) &#123; OneState state = OneState(); state.childState = ChildViewState(); state.aChildState = AchildViewState(); return state;&#125;class ChildViewConnector extends ConnOp&lt;OneState, ChildViewState&gt; &#123; @override ChildViewState get(OneState state) &#123; return state.childState; &#125; @override void set(OneState state, ChildViewState subState) &#123; state.childState = subState; &#125;&#125;class AchildViewConnector extends ConnOp&lt;OneState, AchildViewState&gt; &#123; @override AchildViewState get(OneState state) &#123; return state.aChildState; &#125; @override void set(OneState state, AchildViewState subState) &#123; state.aChildState = subState; &#125;&#125; å¦‚ä¸Šæ‰€ç¤ºï¼šå…ˆå¼•å…¥ child_viewä¸‹çš„stateæ–‡ä»¶ã€‚åˆå§‹åŒ–ã€æ–°å»ºChildViewConnectorã€‚ç„¶ååœ¨one_tab-page.dartä¸‹ä¿®æ”¹ï¼šone_tab-page.dart 12345678910111213141516171819202122232425262728293031323334import &#x27;package:fish_redux/fish_redux.dart&#x27;;import &#x27;effect.dart&#x27;;import &#x27;reducer.dart&#x27;;import &#x27;state.dart&#x27;;import &#x27;view.dart&#x27;;import &#x27;../components/child_view/component.dart&#x27;;import &#x27;../components/achild_view/component.dart&#x27;;import &#x27;../store/store.dart&#x27;;import &#x27;../store/update.dart&#x27;;class OnePage extends Page&lt;OneState, Map&lt;String, dynamic&gt;&gt; &#123; OnePage() : super( initState: initState, effect: buildEffect(), reducer: buildReducer(), view: buildView, dependencies: Dependencies&lt;OneState&gt;( adapter: null, slots: &lt;String, Dependent&lt;OneState&gt;&gt;&#123; &#x27;ChildViewComponent&#x27;: ChildViewConnector() + ChildViewComponent(), &#x27;AchildViewComponent&#x27;: AchildViewConnector() + AchildViewComponent(), &#125;), middleware: &lt;Middleware&lt;OneState&gt;&gt;[], ) &#123; connectExtraStore(GlobalStore.store, globalUpdate()); &#125;&#125; slotsä¸‹å¼•å…¥è¯¥componentã€‚ç„¶åå°±å¯ä»¥åœ¨viewä¸­æ˜¾ç¤ºäº†ï¼šone_tab--view.dart 12345678910111213141516171819202122232425262728import &#x27;package:fish_redux/fish_redux.dart&#x27;;import &#x27;package:flutter/material.dart&#x27;;import &#x27;state.dart&#x27;;Widget buildView(OneState state, Dispatch dispatch, ViewService viewService) &#123; return Scaffold( appBar: AppBar( backgroundColor: state.themeColor, title: Text(&#x27;one&#x27;), ), body: ListView( children: &lt;Widget&gt;[ _childView(state, viewService), _achildView(state, viewService), ], ), );&#125;Align _childView(OneState state, ViewService viewService) &#123; return Align(child: viewService.buildComponent(&#x27;ChildViewComponent&#x27;));&#125;Align _achildView(OneState state, ViewService viewService) &#123; return Align(child: viewService.buildComponent(&#x27;AchildViewComponent&#x27;));&#125; å…¶ä»–çš„ï¼Œå¦‚ç½‘ç»œè¯·æ±‚åªéœ€è¦åœ¨ Lifecycle.initState: _init,æ‰§è¡Œå³å¯ã€‚å¦‚ï¼štwo_bar-effect 123456789101112131415161718192021222324import &#x27;dart:convert&#x27;;import &#x27;package:fish_redux/fish_redux.dart&#x27;;import &#x27;action.dart&#x27;;import &#x27;state.dart&#x27;;import &#x27;../service_api/ServiceApi.dart&#x27;;import &#x27;../model/twoModel.dart&#x27;;Effect&lt;TwoState&gt; buildEffect() &#123; return combineEffects(&lt;Object, Effect&lt;TwoState&gt;&gt;&#123; Lifecycle.initState: _init, TwoAction.action: _onAction, &#125;);&#125;void _onAction(Action action, Context&lt;TwoState&gt; ctx) &#123;&#125;void _init(Action action, Context&lt;TwoState&gt; ctx) &#123; ServiceApi().twoGetData().then((value) &#123; ctx.dispatch(TwoActionCreator.onloadData(value)); &#125;);&#125; ServiceApi.dart 1234567891011121314151617181920import &#x27;package:dio/dio.dart&#x27;;import &#x27;dart:async&#x27;;import &#x27;../model/twoModel.dart&#x27;;class ServiceApi &#123; Future twoGetData() async &#123; try &#123; Response response; Dio dio = new Dio(); response = await dio.get(&#x27;https://gank.io/api/v2/banners&#x27;); TwoModel model = TwoModel.fromJson(response.data); return model; &#125; catch (e) &#123; print(&#x27;å‘é€é”™è¯¯&#x27;); print(e); &#125; &#125;&#125; å…¶ä¸­modelè½¬æ¢é‡‡ç”¨æœ€ä¸ºç›´æ¥çš„https://javiercbk.github.io/json_to_dart/å…¶modeléœ€è¦åœ¨stateä¸­è¿›è¡Œèµ‹å€¼ã€‚ å…¶ä»–çš„å¦‚è·³è½¬ã€ä¼ å‚ã€adapterå¯ä»¥åœ¨ä¸‹é¢çš„GitHubé“¾æ¥ä¸­æ‰¾åˆ°ã€‚ ä»¥ä¸Šå°±æ˜¯ç®€å•ç‰ˆçš„fish_reduxå­¦ä¹ äº†.å¦‚æœä¸æ˜ç™½çš„ä¸‹é¢æœ‰æºç åœ°å€,å¯ä»¥å»é‚£é‡Œçœ‹çœ‹. æœ¬æ–‡æºç åœ°å€ æœ€ç®€å•çš„demoåœ°å€ flutterå­¦ä¹ å†ç¨‹ ps:å‰å‡ å¤©é¢è¯•ï¼Œé¢è¯•å®˜æœ‰ä¸ªéœ€æ±‚ï¼Œå°±æ˜¯ä¸åŒè§’è‰²ç™»å½•éœ€è¦å±•ç¤ºä¸åŒçš„tabbarï¼Œä¸åŒçš„ç•Œé¢ï¼Œéœ€è¦å„è‡ªä¸€ä¸ªstoreï¼Œä½†åªèƒ½æ˜¯åœ¨ä¸€ä¸ªappä¸­å®ç°ã€‚åæ¥çš„è·¯ä¸Šæƒ³äº†ä¸‹ï¼Œç®€å•æ­äº†ä¸ªæ¶å­ã€‚ [æºç åœ°å€](https://github.com/pheromone/Flutter_learn_demo/tree/master/%E5%85%B6%E4%BB%96/%E6%A1%88%E4%BE%8B/diffrent_user_tab)","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutter~è‡ªå®šä¹‰tabbaræ¨¡å—","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~è‡ªå®šä¹‰tabbaræ¨¡å—","date":"2020-01-22T16:00:00.000Z","updated":"2021-09-15T12:38:38.421Z","comments":true,"path":"2020/01/23/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~è‡ªå®šä¹‰tabbaræ¨¡å—/","link":"","permalink":"https://zhoushaoting.com/2020/01/23/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter~%E8%87%AA%E5%AE%9A%E4%B9%89tabbar%E6%A8%A1%E5%9D%97/","excerpt":"é¡¹ç›®ä¸­,é‡åˆ°ä¸€ä¸ªéœ€æ±‚,éœ€è¦è‡ªå®šä¹‰tabbarçš„é«˜åº¦,ä½†æ˜¯è‡ªå¸¦çš„tabbarç»„ä»¶éƒ½ä¸æ”¯æŒä¿®æ”¹é«˜åº¦.","text":"é¡¹ç›®ä¸­,é‡åˆ°ä¸€ä¸ªéœ€æ±‚,éœ€è¦è‡ªå®šä¹‰tabbarçš„é«˜åº¦,ä½†æ˜¯è‡ªå¸¦çš„tabbarç»„ä»¶éƒ½ä¸æ”¯æŒä¿®æ”¹é«˜åº¦. æ‰€å¹¸flutterçš„ä¸‡ç‰©çš†ç»„ä»¶çš„æ¦‚å¿µ,æ‰€ä»¥æˆ‘ä»¬è‡ªå·±å†™ä¸€ä¸ªtabbarå³å¯.éœ€æ±‚:éœ€è¦ä¸€ä¸ªå¯ä»¥è‡ªè¡Œæ§åˆ¶é«˜åº¦çš„tabbar. å¤§è‡´æ•ˆæœå¦‚ä¸‹: å…¶ä¸­,è‡ªå®šä¹‰Tabbarç»„ä»¶å¦‚ä¸‹ bottom_bar.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129/** è‡ªå®šä¹‰tabbar* */import &#x27;package:flutter/material.dart&#x27;;class BottomBarItem &#123; BottomBarItem(&#123;this.imageIcon, this.imageSelectedIcon, this.text&#125;); Image imageIcon; Image imageSelectedIcon; String text;&#125;class BottomBar extends StatefulWidget &#123; BottomBar(&#123; this.items, this.centerItemText, this.height: 60.0, this.iconSize: 24.0, this.backgroundColor, this.color, this.selectedColor, this.notchedShape, this.onTabSelected, &#125;) &#123; assert(this.items.length == 2 || this.items.length == 4); &#125; final List&lt;BottomBarItem&gt; items; final String centerItemText; final double height; final double iconSize; final Color backgroundColor; final Color color; final Color selectedColor; final NotchedShape notchedShape; final ValueChanged&lt;int&gt; onTabSelected; @override State&lt;StatefulWidget&gt; createState() =&gt; BottomBarState();&#125;class BottomBarState extends State&lt;BottomBar&gt; &#123; int _selectedIndex = 0; _updateIndex(int index) &#123; widget.onTabSelected(index); setState(() &#123; _selectedIndex = index; &#125;); &#125; @override Widget build(BuildContext context) &#123; List&lt;Widget&gt; items = List.generate(widget.items.length, (int index) &#123; return _buildTabItem( item: widget.items[index], index: index, onPressed: _updateIndex, ); &#125;); items.insert(items.length &gt;&gt; 1, _buildMiddleTabItem()); return BottomAppBar( shape: widget.notchedShape, child: Row( mainAxisSize: MainAxisSize.max, mainAxisAlignment: MainAxisAlignment.spaceEvenly, children: items, ), color: widget.backgroundColor, ); &#125; Widget _buildMiddleTabItem() &#123; return Expanded( child: SizedBox( height: widget.height, child: Column( mainAxisSize: MainAxisSize.min, mainAxisAlignment: MainAxisAlignment.end, children: &lt;Widget&gt;[ SizedBox(height: widget.iconSize), Text( widget.centerItemText ?? &#x27;&#x27;, style: TextStyle(color: widget.color), ), ], ), ), ); &#125; Widget _buildTabItem(&#123; BottomBarItem item, int index, ValueChanged&lt;int&gt; onPressed, &#125;) &#123; Image icon = _selectedIndex == index ? item.imageSelectedIcon : item.imageIcon; Color resultColor = _selectedIndex == index ? widget.selectedColor : widget.color; return Expanded( child: SizedBox( height: widget.height, child: Material( type: MaterialType.transparency, child: InkWell( onTap: () =&gt; onPressed(index), child: Column( mainAxisSize: MainAxisSize.min, mainAxisAlignment: MainAxisAlignment.center, children: &lt;Widget&gt;[ icon, Text( item.text, style: TextStyle(color: resultColor), ) ], ), ), ), ), ); &#125;&#125; ä»¥ä¸Šå°±æ˜¯è‡ªå®šä¹‰çš„tabbarç»„ä»¶.å…¶ä¸­å­—æ®µè§£é‡Šå¦‚ä¸‹:. items tabsæ•°ç»„,BottomBarItemç±»å‹. centerItemText ä¸­é—´TabæŒ‰é’®æ–‡å­—. height tabçš„é«˜åº¦. backgroundColor æ•´ä½“èƒŒæ™¯è‰². color iconé»˜è®¤è‰². selectedColor é€‰ä¸­iconè‰². notchedShape iconçš„å¤§å°. onTabSelected é€‰ä¸­tabäº‹ä»¶,åšçš„ä¸»è¦å°±æ˜¯åˆ‡æ¢å½“å‰page. notchedShape è®¾ç½®notchedShape,å’Œç³»ç»Ÿçš„NotchedShapeä¸€è‡´ å…¶ä»–éœ€è¦çš„å±æ€§,å¯ä»¥è‡ªè¡Œæ·»åŠ . åˆ›å»ºå¥½è‡ªå®šä¹‰tabbarä¹‹å,ä½¿ç”¨å³å¯. main.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104import &#x27;package:flutter/material.dart&#x27;;import &#x27;./bottom_bar.dart&#x27;;import &#x27;./pages/one.dart&#x27;;import &#x27;./pages/two.dart&#x27;;void main() =&gt; runApp(MyApp());class MyApp extends StatelessWidget &#123; // This widget is the root of your application. @override Widget build(BuildContext context) &#123; return MaterialApp( title: &#x27;Flutter Demo&#x27;, theme: ThemeData( primarySwatch: Colors.blue, ), home: STTabBar(), ); &#125;&#125;class STTabBar extends StatefulWidget &#123; @override _STTabBarState createState() =&gt; _STTabBarState();&#125;class _STTabBarState extends State&lt;STTabBar&gt; &#123; int _tabIndex = 0; double _tab_H = 70.0; // tag é«˜åº¦ @override Widget build(BuildContext context) &#123; return Scaffold( body: IndexedStack( index: _tabIndex, children: &lt;Widget&gt;[ One( // æ»‘å— changeTabOne: (e) &#123; setState(() &#123; _tab_H = e; &#125;); &#125;, // é«˜åº¦ä¸º0 changeTabTwo: () &#123; setState(() &#123; _tab_H = 0; &#125;); &#125;, // é«˜åº¦ä¸º70 changeTabThree: () &#123; setState(() &#123; _tab_H = 70; &#125;); &#125;, ), Two(), ], ), bottomNavigationBar: BottomBar( height: _tab_H, color: Color(0xFF999999), selectedColor: Color.fromRGBO(255, 175, 76, 1),// backgroundColor: Colors.red, items: [ BottomBarItem( imageIcon: Image.asset( &#x27;assets/one.png&#x27;, width: 40, height: 40, ), imageSelectedIcon: Image.asset( &#x27;assets/one_select.png&#x27;, width: 40, height: 40, ), text: &#x27;é¦–é¡µ&#x27;, ), BottomBarItem( imageIcon: Image.asset( &#x27;assets/two.png&#x27;, width: 40, height: 40, ), imageSelectedIcon: Image.asset( &#x27;assets/two_select.png&#x27;, width: 40, height: 40, ), text: &#x27;æˆ‘çš„&#x27;, ) ], onTabSelected: (index) &#123; setState(() &#123; _tabIndex = index; &#125;); &#125;, ), ); &#125;&#125; ä¸Šé¢çš„BottomBar()è¿™ä¸ªå°±æ˜¯ä¹‹å‰è‡ªå®šä¹‰çš„tabbar,é…ç½®å¥½å‚æ•°å³å¯. å®Œæ•´æºç  å¦ï¼šä»¥ä¸ŠåŠŸèƒ½ä¹Ÿå¯ä»¥é‡‡ç”¨PreferredSize åˆ¶ä½œï¼Œå¦‚ PreferredSize ç¤ºä¾‹ ps:æ–°å¹´å‰æœ€åä¸€å¤©,è‡ªå·±ä¸€ä¸ªäººåœ¨å‡ºç§Ÿå±‹é‡Œå†™ç€åšå®¢,å¤–é¢ä¸‹ç€é›¨,è·¯ä¸Šæ²¡ä»€ä¹ˆäºº,å¥½å¥½çš„å¹´è¢«ç€è¯¥è¯¥æ­»çš„è‚ºç‚ç»™æ…å’Œäº†,ä¹Ÿä¸çŸ¥é“è‡ªå·±èƒ½ä¸èƒ½åº¦è¿‡è¿™ä¸ªç¾éš¾â€¦..","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutter~è‡ªå®šä¹‰Dialog(åŸºæœ¬çš„ç»„ä»¶å°è£…)","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~è‡ªå®šä¹‰Dialog(åŸºæœ¬çš„ç»„ä»¶å°è£…)","date":"2019-11-10T16:00:00.000Z","updated":"2019-11-14T13:05:40.000Z","comments":true,"path":"2019/11/11/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~è‡ªå®šä¹‰Dialog(åŸºæœ¬çš„ç»„ä»¶å°è£…)/","link":"","permalink":"https://zhoushaoting.com/2019/11/11/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter~%E8%87%AA%E5%AE%9A%E4%B9%89Dialog(%E5%9F%BA%E6%9C%AC%E7%9A%84%E7%BB%84%E4%BB%B6%E5%B0%81%E8%A3%85)/","excerpt":"å…‰æ£èŠ‚å°±å¾—å†™ä¸ªbugåº†ç¥ä¸‹!!!","text":"å…‰æ£èŠ‚å°±å¾—å†™ä¸ªbugåº†ç¥ä¸‹!!! å†™ä¸ªè‡ªå®šä¹‰çš„Dialog,å¯ä»¥éšæ„æ§åˆ¶UI,åŒæ—¶å°è£…ä¸€ä¸‹,ä¼ å€¼æ§åˆ¶UI,å¼€ä¸ªæ–¹æ³•å›è°ƒ,æ§åˆ¶äº¤äº’. å…ˆä¸Šæ•ˆæœå›¾!!! å†ä¸Šä»£ç CustomDialog.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160/** è¾“å…¥æ¡†* */import &#x27;package:flutter/material.dart&#x27;;class CustomDialog extends StatefulWidget &#123; Function dismissCallback; // å–æ¶ˆå›è°ƒ Function okCallback; // ç¡®è®¤å›è°ƒ bool isNeedTag; // å¤–éƒ¨ä¼ å…¥çš„å‚æ•°,æ§åˆ¶æ˜¾ç¤ºslideè¿˜æ˜¯input CustomDialog(&#123; Key key, this.dismissCallback, this.okCallback, this.isNeedTag, &#125;) : super(key: key); @override _CustomDialogState createState() =&gt; _CustomDialogState();&#125;class _CustomDialogState extends State&lt;CustomDialog&gt; &#123; String commitStr; double slideValue = 0.0; /* * å–æ¶ˆæŒ‰é’®ç‚¹å‡»äº‹ä»¶ * */ _dismissDialog() &#123; if (widget.dismissCallback != null) &#123; widget.dismissCallback(); &#125; Navigator.of(context).pop(); &#125; /* * ç¡®å®šæŒ‰é’®ç‚¹å‡»äº‹ä»¶ * */ _okCallback(String txt) &#123; if (widget.okCallback != null) &#123; widget.okCallback(txt); &#125; Navigator.of(context).pop(); &#125; @override Widget build(BuildContext context) &#123; return Material( type: MaterialType.transparency, child: Center( child: SizedBox( width: 240, height: 240, child: Container( decoration: BoxDecoration( color: Colors.cyanAccent, borderRadius: BorderRadius.vertical( top: Radius.circular(120.0), ), ), child: Column( children: &lt;Widget&gt;[ widget.isNeedTag == true ? _topWidget() : _topWidget1(), Spacer(), _bottomWidget(), ], ), ), ), ), ); &#125; /* * ä¸Šæ–¹è¾“å…¥UI * */ Widget _topWidget() &#123; return Container( margin: EdgeInsets.only(top: 100), child: Container( child: TextField( onSubmitted: (e) &#123; setState(() &#123; commitStr = e; &#125;); &#125;, decoration: InputDecoration( border: InputBorder.none, hintText: &quot;è¯·è¾“å…¥å­—ç¬¦&quot;, ), ), ), ); &#125; /* * ä¸Šæ–¹è¾“å…¥UI-1 * */ Widget _topWidget1() &#123; return Container( margin: EdgeInsets.only(top: 100), child: Slider( value: slideValue, max: 100.0, min: 0.0, activeColor: Colors.blue, onChanged: (double val) &#123; setState(() &#123; slideValue = val; commitStr = val.toString(); &#125;); &#125;, ), ); &#125; /* * åº•éƒ¨é€‰æ‹©widget * */ Widget _bottomWidget() &#123; return Row( mainAxisAlignment: MainAxisAlignment.spaceAround, children: &lt;Widget&gt;[ InkWell( onTap: () &#123; _okCallback(commitStr); &#125;, child: Container( height: 50, width: 120, color: Colors.yellow[800], child: Center( child: Text( &#x27;ç¡®å®š&#x27;, style: TextStyle(color: Colors.white), ), ), ), ), InkWell( onTap: () &#123; _dismissDialog(); &#125;, child: Container( height: 50, width: 120, color: Colors.red[800], child: Center( child: Text( &#x27;å–æ¶ˆ&#x27;, style: TextStyle(color: Colors.white), ), ), ), ), ], ); &#125;&#125; ä½¿ç”¨å¦‚ä¸‹ main.dart1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677import &#x27;package:flutter/material.dart&#x27;;import &#x27;./custom_dialog.dart&#x27;;void main() =&gt; runApp(MyApp());class MyApp extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return MaterialApp( title: &#x27;Flutter Demo&#x27;, theme: ThemeData( primarySwatch: Colors.blue, ), home: MyHomePage(), ); &#125;&#125;class MyHomePage extends StatefulWidget &#123; @override _MyHomePageState createState() =&gt; _MyHomePageState();&#125;class _MyHomePageState extends State&lt;MyHomePage&gt; &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar( title: Text(&#x27;è‡ªå®šä¹‰dialog&#x27;), ), body: ListView( children: &lt;Widget&gt;[ InkWell( onTap: () &#123; showDialog( context: context, builder: (BuildContext context) &#123; return CustomDialog( isNeedTag: true, okCallback: (text) &#123; print(text); &#125;, dismissCallback: () &#123; print(&quot;input å–æ¶ˆäº†&quot;); &#125;, ); &#125;, ); &#125;, child: Text(&#x27;ç¬¬ä¸€ä¸ª&#x27;), ), SizedBox(height: 20), InkWell( onTap: () &#123; showDialog( context: context, builder: (BuildContext context) &#123; return CustomDialog( isNeedTag: false, okCallback: (text) &#123; print(text); &#125;, dismissCallback: () &#123; print(&quot;slide å–æ¶ˆäº†&quot;); &#125;, ); &#125;, ); &#125;, child: Text(&#x27;ç¬¬äºŒä¸ª&#x27;), ) ], ), ); &#125;&#125; æœ€åå†è®²ç‚¹åºŸè¯:isNeedTag å°±æ˜¯ç”¨æ¥ç»™å¤–éƒ¨ç”¨æ¥æ§åˆ¶å†…éƒ¨UIçš„å€¼,è¿™ä¸ªç®€å•æ§åˆ¶ä¸‹å†…éƒ¨æ˜¯æ˜¾ç¤ºè¾“å…¥æ¡†è¿˜æ˜¯æ»‘å— Function dismissCallback å’Œ Function okCallback æ˜¯Dialogå†…éƒ¨è¡Œä¸ºä¼ ç»™å¤–éƒ¨çš„æ–¹æ³•,æ§åˆ¶äº¤äº’. ok.å…‰æ£èŠ‚åº†ç¥å®Œæ¯•.ä¸‹ç­~~~ æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutter~FlareåŠ¨ç”»å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~FlareåŠ¨ç”»å­¦ä¹ ","date":"2019-09-06T16:00:00.000Z","updated":"2020-01-22T04:53:53.523Z","comments":true,"path":"2019/09/07/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~FlareåŠ¨ç”»å­¦ä¹ /","link":"","permalink":"https://zhoushaoting.com/2019/09/07/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter~Flare%E5%8A%A8%E7%94%BB%E5%AD%A6%E4%B9%A0/","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹FlutteråŠ¨ç”»ä¹‹ Flare.","text":"ä»Šå¤©å­¦ä¹ ä¸‹FlutteråŠ¨ç”»ä¹‹ Flare. Flareçš„å®˜ç½‘.Flare å¯ä»¥ä¸º App/æ¸¸æˆ/ç½‘é¡µç­‰åˆ¶ä½œé…·ç‚«çš„çŸ¢é‡åŠ¨ç”»æ¨¡å‹ï¼›Flare åŠ¨ç”»çš„ä¼˜åŠ¿æ˜¯æœ‰æ•ˆå‡å°‘æ–‡ä»¶ä½“ç§¯ä¸”è·å–æå¥½çš„åŠ¨ç”»æ•ˆæœï¼Œé€‚ç”¨äºä¸åœºæ™¯äº¤äº’ä¸å¤§çš„åœºæ™¯.åœ¨Flareå®˜ç½‘ä¸Š,å¯ä»¥è®¿é—®ä¸¤ç§æ–‡ä»¶ï¼ŒNimaæ–‡ä»¶å’ŒFlareæ–‡ä»¶: Nima ä¸ºè¾ƒæ—§æ ¼å¼ï¼Œä»…æ”¯æŒå…‰æ …å›¾ï¼›ä¸»è¦æ˜¯ä¸ºæ¸¸æˆå¼•æ“å’Œåº”ç”¨æ„å»º 2D åŠ¨ç”» â€“ XXX.nima Flare ä¸ºè¾ƒæ–°æ ¼å¼ï¼Œæ”¯æŒçŸ¢é‡å›¾ä¸å…‰æ …å›¾ï¼›ä¸»è¦ä¸º App å’Œ Web æ„å»ºé«˜æ•ˆåŠ¨ç”»ï¼Œä¹Ÿå¯ç”¨äºæ¸¸æˆè®¾è®¡ â€“ XXX.flrè¿™ä¸¤ç§æ ¼å¼æ–‡ä»¶ä½¿ç”¨å„è‡ªçš„åº“. nima flare_flutter. è‡³äºåŠ¨ç”»åˆ¶ä½œä¸ç”¨é‡‡ç”¨ä»£ç ç¼–å†™,è€Œæ˜¯é‡‡ç”¨ç±»ä¼¼PSçš„æ–¹å¼è®¾è®¡.æˆ‘è¿™é‡Œå°±ä¸ä»‹ç»å¦‚ä½•è®¾è®¡åŠ¨ç”»,åªä»‹ç»ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨å³å¯.è®¾è®¡æ–¹æ³•å¯ä»¥å‚è€ƒç½‘å‹çš„æ•™ç¨‹:ç½‘å‹1.ç½‘å‹2.ç½‘å‹3. å¼•å…¥åº“12345678nima: ^1.0.5flare_flutter: ^1.5.4å’Œå¼•å…¥æ–‡ä»¶: assets: - assets/Hop.nima - assets/Hop.png - assets/Teddy.flr one.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:nima/nima_actor.dart&#x27;;class One extends StatefulWidget &#123; @override _OneState createState() =&gt; _OneState();&#125;class _OneState extends State&lt;One&gt; &#123; String _animationName = &quot;idle&quot;; @override Widget build(BuildContext context) &#123; return Scaffold( backgroundColor: Colors.grey, body: Stack( children: &lt;Widget&gt;[ Positioned.fill( child: NimaActor( &quot;assets/Hop.nima&quot;, alignment: Alignment.center, fit: BoxFit.contain, animation: _animationName, mixSeconds: 0.5, completed: (String animationName) &#123; setState( () &#123; // Return to idle. _animationName = &quot;idle&quot;; &#125;, ); &#125;, ), ), Positioned.fill( child: Row( crossAxisAlignment: CrossAxisAlignment.end, mainAxisAlignment: MainAxisAlignment.center, children: &lt;Widget&gt;[ Container( margin: const EdgeInsets.all(5.0), child: FlatButton( child: Text(&quot;Jump&quot;), textColor: Colors.white, color: Colors.blue, onPressed: () &#123; setState( () &#123; _animationName = &quot;jump&quot;; &#125;, ); &#125;, ), ), Container( margin: const EdgeInsets.all(5.0), child: FlatButton( child: Text(&quot;Attack&quot;), textColor: Colors.white, color: Colors.blue, onPressed: () &#123; setState( () &#123; _animationName = &quot;attack&quot;; &#125;, ); &#125;, ), ), ], ), ) ], ), ); &#125;&#125; æ•ˆæœå›¾: two.dart12345678910111213141516171819202122import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:flare_flutter/flare_actor.dart&#x27;;class Two extends StatefulWidget &#123; @override _TwoState createState() =&gt; _TwoState();&#125;class _TwoState extends State&lt;Two&gt; &#123; @override Widget build(BuildContext context) &#123; return Scaffold( body: FlareActor( &quot;assets/Teddy.flr&quot;, alignment: Alignment.center, fit: BoxFit.contain, animation: &quot;idle&quot;, ), ); &#125;&#125; æ•ˆæœå›¾: æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutter~mobxåº“å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~mobxåº“å­¦ä¹ ","date":"2019-08-07T16:00:00.000Z","updated":"2019-09-11T09:56:14.000Z","comments":true,"path":"2019/08/08/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~mobxåº“å­¦ä¹ /","link":"","permalink":"https://zhoushaoting.com/2019/08/08/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter~mobx%E5%BA%93%E5%AD%A6%E4%B9%A0/","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹mobx .å…¶ä¸­,mobx: ^0.1.4 flutter_mobx: ^0.1.3,å½“ä¸­,è¿˜éœ€è¦å…¶ä»–çš„ä¸¤ä¸ªåº“çš„æ”¯æŒ,mobx_codegen: ^0.1.3,build_runner: ^1.4.0","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹mobx .å…¶ä¸­,mobx: ^0.1.4 flutter_mobx: ^0.1.3,å½“ä¸­,è¿˜éœ€è¦å…¶ä»–çš„ä¸¤ä¸ªåº“çš„æ”¯æŒ,mobx_codegen: ^0.1.3,build_runner: ^1.4.0 ä»£ç ç»“æ„å¦‚å›¾æ‰€ç¤º: é¦–å…ˆ,å…ˆåœ¨pubspec.yamlé‡Œæ·»åŠ 123456789101112131415161718192021version: 1.0.0+1environment: sdk: &quot;&gt;=2.1.0 &lt;3.0.0&quot;dependencies: flutter: sdk: flutter # The following adds the Cupertino Icons font to your application. # Use with the CupertinoIcons class for iOS style icons. cupertino_icons: ^0.1.2 mobx: ^0.1.4 flutter_mobx: ^0.1.3dev_dependencies: flutter_test: sdk: flutter mobx_codegen: ^0.1.3 build_runner: ^1.4.0 flutter packages get ä¹‹å,æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„ç»“æ„.å…¶ä¸­åŒ…å«ä¸¤ä¸ªTabé¡µé¢:one_page.dartå’Œtwo_page.dart,tabBarçš„tabbar.dart,mobxçš„counter.dart ,counter.g.dart.é¦–å…ˆ,å…ˆåœ¨counter.dartä¸­å†™åŸºæœ¬ä»£ç ,å…¶ä¸­countæ˜¯ä¸ªçŠ¶æ€åŒ–çš„æ•°å­—.ç„¶å,ç»ˆç«¯cd åˆ°æ›´ç›®å½•ä¹‹ä¸‹.æ‰§è¡Œ flutter packages pub run build_runner build,å¦‚æœæ­£å¸¸çš„è¯,ä¼šè‡ªåŠ¨ç”Ÿæˆ count.g.dartæ–‡ä»¶. counter.dart1234567891011121314151617181920212223242526272829import &#x27;package:mobx/mobx.dart&#x27;;part &#x27;counter.g.dart&#x27;;class Counter = CounterBase with _$Counter;final Counter counter = Counter();abstract class CounterBase implements Store &#123; @observable int value = 0; @action void increment() &#123; value++; &#125; @action void decrement() &#123; value--; &#125; @action void set(int value) &#123; this.value = value; &#125;&#125; counter.g.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960// GENERATED CODE - DO NOT MODIFY BY HANDpart of &#x27;counter.dart&#x27;;// **************************************************************************// StoreGenerator// **************************************************************************// ignore_for_file: non_constant_identifier_names, unnecessary_lambdas, prefer_expression_function_bodies, lines_longer_than_80_charsmixin _$Counter on CounterBase, Store &#123; final _$valueAtom = Atom(name: &#x27;CounterBase.value&#x27;); @override int get value &#123; _$valueAtom.reportObserved(); return super.value; &#125; @override set value(int value) &#123; _$valueAtom.context.checkIfStateModificationsAreAllowed(_$valueAtom); super.value = value; _$valueAtom.reportChanged(); &#125; final _$CounterBaseActionController = ActionController(name: &#x27;CounterBase&#x27;); @override void increment() &#123; final _$actionInfo = _$CounterBaseActionController.startAction(); try &#123; return super.increment(); &#125; finally &#123; _$CounterBaseActionController.endAction(_$actionInfo); &#125; &#125; @override void decrement() &#123; final _$actionInfo = _$CounterBaseActionController.startAction(); try &#123; return super.decrement(); &#125; finally &#123; _$CounterBaseActionController.endAction(_$actionInfo); &#125; &#125; @override void set(int value) &#123; final _$actionInfo = _$CounterBaseActionController.startAction(); try &#123; return super.set(value); &#125; finally &#123; _$CounterBaseActionController.endAction(_$actionInfo); &#125; &#125;&#125; ok,åœ¨ä½¿ç”¨çš„æ—¶å€™,ä½¿ç”¨counter.valueå³å¯ä½¿ç”¨mobxä¸­çš„å€¼,ä½¿ç”¨counter.incrementå³å¯æ”¹å˜å€¼.å¦‚: one_page.dart1234567891011121314151617181920212223242526272829303132333435363738import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:flutter_mobx/flutter_mobx.dart&#x27;;import &#x27;../mobx/counter.dart&#x27;;class OnePage extends StatefulWidget &#123; @override _OnePageState createState() =&gt; _OnePageState();&#125;class _OnePageState extends State&lt;OnePage&gt; &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar( title: Text(&#x27;111111&#x27;), ), body: ListView( children: &lt;Widget&gt;[ Observer( builder: (_) =&gt; Text( &#x27;$&#123;counter.value&#125;&#x27;, style: Theme.of(context).textTheme.display1, ), ), RaisedButton( child: Text(&#x27;åŠ &#x27;), onPressed: counter.increment, ), RaisedButton( child: Text(&#x27;å‡&#x27;), onPressed: counter.decrement, ), ], ), ); &#125;&#125; two_page.dart12345678910111213141516171819202122232425262728293031323334353637import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:flutter_mobx/flutter_mobx.dart&#x27;;import &#x27;../mobx/counter.dart&#x27;;class TwoPage extends StatefulWidget &#123; @override _TwoPageState createState() =&gt; _TwoPageState();&#125;class _TwoPageState extends State&lt;TwoPage&gt; &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar( title: Text(&#x27;222222&#x27;), ), body: ListView( children: &lt;Widget&gt;[ Observer( builder: (_) =&gt; Text( &#x27;$&#123;counter.value&#125;&#x27;, style: Theme.of(context).textTheme.display1, ), ), RaisedButton( child: Text(&#x27;åŠ &#x27;), onPressed: counter.increment, ), RaisedButton( child: Text(&#x27;å‡&#x27;), onPressed: counter.decrement, ), ], ), ); &#125;&#125; å…¶ä»–æ–‡ä»¶: main.dart12345678910111213141516171819202122232425262728import &#x27;package:flutter/material.dart&#x27;;import &#x27;./tabbar.dart&#x27;;void main() =&gt; runApp(MyApp());class MyApp extends StatelessWidget &#123; // This widget is the root of your application. @override Widget build(BuildContext context) &#123; return MaterialApp( title: &#x27;Flutter Demo&#x27;, theme: ThemeData( // This is the theme of your application. // // Try running your application with &quot;flutter run&quot;. You&#x27;ll see the // application has a blue toolbar. Then, without quitting the app, try // changing the primarySwatch below to Colors.green and then invoke // &quot;hot reload&quot; (press &quot;r&quot; in the console where you ran &quot;flutter run&quot;, // or simply save your changes to &quot;hot reload&quot; in a Flutter IDE). // Notice that the counter didn&#x27;t reset back to zero; the application // is not restarted. primarySwatch: Colors.blue, ), home: Tabbar(), ); &#125;&#125; tabbar.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108import &#x27;package:flutter/material.dart&#x27;;import &#x27;./pages/one_page.dart&#x27;;import &#x27;./pages/two_page.dart&#x27;;class Tabbar extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return new MaterialApp( debugShowCheckedModeBanner: false, home: new MainPageWidget()); &#125;&#125;class MainPageWidget extends StatefulWidget &#123; @override State&lt;StatefulWidget&gt; createState() &#123; return new MainPageState(); &#125;&#125;class MainPageState extends State&lt;MainPageWidget&gt; &#123; int _tabIndex = 0; var tabImages; var appBarTitles = [&#x27;ä¸€&#x27;, &#x27;äºŒ&#x27;]; /* * å­˜æ”¾ä¸¤ä¸ªé¡µé¢ï¼Œè·ŸfragmentListä¸€æ · */ var _pageList; /* * æ ¹æ®é€‰æ‹©è·å¾—å¯¹åº”çš„normalæˆ–æ˜¯pressçš„icon */ Image getTabIcon(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return tabImages[curIndex][1]; &#125; return tabImages[curIndex][0]; &#125; /* * è·å–bottomTabçš„é¢œè‰²å’Œæ–‡å­— */ Text getTabTitle(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff1296db))); &#125; else &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff515151))); &#125; &#125; /* * æ ¹æ®imageè·¯å¾„è·å–å›¾ç‰‡ */ Image getTabImage(path) &#123; return new Image.asset(path, width: 24.0, height: 24.0); &#125; void initData() &#123; /* * åˆå§‹åŒ–é€‰ä¸­å’Œæœªé€‰ä¸­çš„icon */ tabImages = [ [ getTabImage(&#x27;images/tab/home.png&#x27;), getTabImage(&#x27;images/tab//home_select.png&#x27;) ], [ getTabImage(&#x27;images/tab/show.png&#x27;), getTabImage(&#x27;images/tab//show_select.png&#x27;) ] ]; /* * ä¸‰ä¸ªå­ç•Œé¢ */ _pageList = [ new OnePage(), new TwoPage(), ]; &#125; @override Widget build(BuildContext context) &#123; //åˆå§‹åŒ–æ•°æ® initData(); return Scaffold( body: _pageList[_tabIndex], bottomNavigationBar: new BottomNavigationBar( items: &lt;BottomNavigationBarItem&gt;[ new BottomNavigationBarItem( icon: getTabIcon(0), title: getTabTitle(0)), new BottomNavigationBarItem( icon: getTabIcon(1), title: getTabTitle(1)), ], type: BottomNavigationBarType.fixed, //é»˜è®¤é€‰ä¸­é¦–é¡µ currentIndex: _tabIndex, iconSize: 24.0, //ç‚¹å‡»äº‹ä»¶ onTap: (index) &#123; setState(() &#123; _tabIndex = index; &#125;); &#125;, )); &#125;&#125; æ•ˆæœå›¾: æºç  å¦å¤–:å…¶ä»–ç®¡ç†åº“å­¦ä¹  å¦å¤–:Flutterå­¦ä¹ demo","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"MACä¸‹çš„cocos2d-xç¯å¢ƒæ­å»º","slug":"å…¶ä»–å­¦ä¹ /MACä¸‹çš„cocos2d-xç¯å¢ƒæ­å»º","date":"2019-06-22T16:00:00.000Z","updated":"2019-06-23T10:14:44.000Z","comments":true,"path":"2019/06/23/å…¶ä»–å­¦ä¹ /MACä¸‹çš„cocos2d-xç¯å¢ƒæ­å»º/","link":"","permalink":"https://zhoushaoting.com/2019/06/23/%E5%85%B6%E4%BB%96%E5%AD%A6%E4%B9%A0/MAC%E4%B8%8B%E7%9A%84cocos2d-x%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","excerpt":"å¾ˆä¹…ä»¥å‰,æœ‹å‹å»ºè®®åŸ¹å…»ä¸‹ä¸šä½™çˆ±å¥½,æ€æ¥æƒ³å»,å†³å®šå­¦ä¹ ä¸‹æ¸¸æˆå¼€å‘.çŒ¿çš„ä¸‹ç­ç”Ÿæ´»å¦‚æœè¿˜æ˜¯å’Œä»£ç ç›¸å…³çš„è¯,é‚£ä¹ˆå®ƒçœŸçš„æ— è¯å¯æ•‘äº†.å“â€¦.","text":"å¾ˆä¹…ä»¥å‰,æœ‹å‹å»ºè®®åŸ¹å…»ä¸‹ä¸šä½™çˆ±å¥½,æ€æ¥æƒ³å»,å†³å®šå­¦ä¹ ä¸‹æ¸¸æˆå¼€å‘.çŒ¿çš„ä¸‹ç­ç”Ÿæ´»å¦‚æœè¿˜æ˜¯å’Œä»£ç ç›¸å…³çš„è¯,é‚£ä¹ˆå®ƒçœŸçš„æ— è¯å¯æ•‘äº†.å“â€¦. ä»Šå¤©,å­¦ä¹ ä¸‹Macç³»ç»Ÿä¸‹çš„cocos2d-xçš„ç¯å¢ƒæ­å»º. å…ˆè¿›å…¥å®˜ç½‘: https://cocos2d-x.org/ä¸‹è½½æœ€æ–°çš„SDK.å¦‚å›¾æ‰€ç¤º ä¸‹è½½ä¹‹å,è§£å‹æ‰¾ä¸ªåœ°æ–¹æ”¾ç½®ä¸‹,å¦‚: æ‰“å¼€ç»ˆç«¯,cdåˆ°SDKç›®å½•.ç„¶åæ‰§è¡Œ python setup.py .ç»ˆç«¯è¿è¡Œä¹‹å,ä¼šæ˜¾ç¤º 1-&gt;Please enter the path of NDK_ROOT (or press Enter to skip): ç›´æ¥å›è½¦å³å¯.æ˜¾ç¤º: 1Please execute command: &quot;source /Users/shaotingzhou/.bash_profile&quot; to make added system variables take effect å¤åˆ¶å…¶ä¸­â€â€çš„æ‰§è¡Œä¸€ä¸‹å³å¯. ç¯å¢ƒå®‰è£…å¥½äº†.å¯ä»¥æ‰§è¡Œ cocos -v çœ‹ä¸‹ç‰ˆæœ¬ä¿¡æ¯. ç„¶åæˆ‘ä»¬æ–°å»ºä¸€ä¸ªå·¥ç¨‹,ä½¿ç”¨Xcodeè¿è¡Œä¸€ä¸‹çœ‹çœ‹.ç»ˆç«¯æ‰§è¡Œ 12cocos new -p com.duan.test -l cpp -d /Users/shaotingzhou/Desktop//workspace helloworld ç„¶åå°±ä¼šåœ¨æ¡Œé¢ä¸Šçœ‹åˆ°ä¸€ä¸ªworkspaceæ–‡ä»¶å¤¹,é‡Œé¢å°±æœ‰helloworldå·¥ç¨‹,åœ¨ proj.ios_mac ä¸‹ä½¿ç”¨Xcodeæ‰“å¼€ç¼–è¯‘è¿è¡Œå³å¯.å¦‚å›¾:","categories":[{"name":"å…¶ä»–å­¦ä¹ ","slug":"å…¶ä»–å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E5%85%B6%E4%BB%96%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"å…¶ä»–å­¦ä¹ ","slug":"å…¶ä»–å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E5%85%B6%E4%BB%96%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutter~å›½é™…åŒ–æ•™ç¨‹æ–¹æ¡ˆ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~å›½é™…åŒ–æ•™ç¨‹æ–¹æ¡ˆ","date":"2019-06-10T16:00:00.000Z","updated":"2019-07-07T10:27:57.000Z","comments":true,"path":"2019/06/11/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~å›½é™…åŒ–æ•™ç¨‹æ–¹æ¡ˆ/","link":"","permalink":"https://zhoushaoting.com/2019/06/11/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter~%E5%9B%BD%E9%99%85%E5%8C%96%E6%95%99%E7%A8%8B%E6%96%B9%E6%A1%88/","excerpt":"ä»Šå¤©,å­¦ä¹ ä¸‹Flutterä¸­çš„å›½é™…åŒ–å¤šè¯­è¨€é…ç½®æ–¹æ¡ˆ.","text":"ä»Šå¤©,å­¦ä¹ ä¸‹Flutterä¸­çš„å›½é™…åŒ–å¤šè¯­è¨€é…ç½®æ–¹æ¡ˆ. åŸæ•™ç¨‹åœ°å€,æœ¬çŒ¿æŒ‰ç…§è¯¥å¤§ç¥çš„æ–¹æ¡ˆæˆåŠŸå®ç°äº†éœ€æ±‚,åœ¨æ­¤è®°å½•ä¸€ä¸‹.æœ¬æ¥åœ¨ç½‘ä¸Šæœç´¢äº†å¾ˆå¤šæ•™ç¨‹åšå®¢,è¦ä¹ˆä¸€å †æˆªå›¾ä¸‹æ¥,æœ€åä¸¤ä¸ªå­—æˆåŠŸ,è¦ä¹ˆä¸€ç‰‡ç‰‡çš„ä»£ç ç‰‡æ®µ,æœ€åä¸¤ä¸ªå­—æˆåŠŸ,æˆ‘å‡è¯•äº†ä¸‹,å…¨æ˜¯å–å€¼ä¸ºç©ºçš„é”™è¯¯.å¯èƒ½æœ¬çŒ¿å°‘äº†å“ªå‡ æ­¥æ“ä½œå§.æ‰€å¹¸åœ¨æœ‹å‹çš„å¸®åŠ©ä¸‹,å®ç°äº†è¯¥æ–¹æ¡ˆ,ä¹Ÿæ‰¾åˆ°äº†è¯¥æ–¹æ¡ˆçš„åŸå¤§ä½¬.å…ˆè¡Œä¸Šå›¾: æ•ˆæœå›¾: æ­¤æ–¹æ¡ˆä½¿ç”¨åˆ°äº†ä¸‹é¢çš„ä¸¤ä¸ªåº“,ä¸€ä¸ªå›½é™…åŒ–åº“,ä¸€ä¸ªæœ¬åœ°å­˜å‚¨åº“(åšæŒä¹…åŒ–è¯­è¨€æ“ä½œ). Flutterçš„ä½¿ç”¨ç‰ˆæœ¬å’Œä»£ç ç»“æ„å¦‚å›¾: ä¸‹é¢æ˜¯å„æ–‡ä»¶çš„è¯¦ç»†ä»£ç : é¦–å…ˆæˆ‘ä»¬æ–°å»ºä¸¤ä¸ªè¯­è¨€jsonæ–‡ä»¶,é‡Œé¢é…ç½®å„è‡ªå¹³å°éœ€è¦çš„æ–‡å­—,å¦‚ä¸‹æ‰€ç¤º. i18n_en.json 1234567 &#123; &quot;register&quot;: &quot;register&quot;, &quot;mine&quot;: &quot;mine&quot;, &quot;home&quot;: &quot;home&quot;, &quot;zh&quot;: &quot;zh&quot;, &quot;en&quot;: &quot;en&quot;&#125; i18n_zh.json 123456 &#123; &quot;mine&quot;:&quot;æˆ‘çš„&quot;, &quot;home&quot;:&quot;é¦–é¡µ&quot;, &quot;zh&quot;:&quot;ä¸­æ–‡&quot;, &quot;en&quot;: &quot;è‹±æ–‡&quot;&#125; ç„¶åæ–°å»ºæœ€é‡è¦çš„é…ç½®æ–‡ä»¶trahslations.dart trahslations.dart 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105 import &#x27;dart:async&#x27;;import &#x27;dart:convert&#x27;;import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:flutter/services.dart&#x27; show rootBundle;import &#x27;package:shared_preferences/shared_preferences.dart&#x27;;/// è‡ªå®šä¹‰çš„Translationsç±»class Translations &#123; Translations(Locale locale) &#123; this.locale = locale; _localizedValues = null; &#125; Locale locale; static Map&lt;dynamic, dynamic&gt; _localizedValues; static Translations of(BuildContext context)&#123; return Localizations.of&lt;Translations&gt;(context, Translations); &#125; String text(String key) &#123; if(_localizedValues==null) &#123; return &quot;no locale&quot;; &#125; return _localizedValues[key] ?? &#x27;** $key not found&#x27;; &#125; static Future&lt;Translations&gt; load(Locale locale) async &#123; SharedPreferences sp = await SharedPreferences.getInstance(); String lang = sp.get(&quot;lang&quot;); if(lang==null) &#123; lang = &quot;zh&quot;; &#125; print(&#x27;zh:$lang&#x27;); Translations translations = new Translations(locale); String jsonContent = await rootBundle.loadString(&quot;locale/i18n_$lang.json&quot;); _localizedValues = json.decode(jsonContent); applic.shouldReload = false; return translations; &#125; get currentLanguage =&gt; locale.languageCode;&#125;/// è‡ªå®šä¹‰çš„localizationä»£è¡¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯åœ¨éªŒè¯æ”¯æŒçš„è¯­è¨€å‰ï¼Œåˆå§‹åŒ–æˆ‘ä»¬çš„è‡ªå®šä¹‰Translationsç±»class TranslationsDelegate extends LocalizationsDelegate&lt;Translations&gt; &#123; const TranslationsDelegate(); /// æ”¹è¿™é‡Œæ˜¯ä¸ºäº†ä¸ç¡¬ç¼–ç æ”¯æŒçš„è¯­è¨€ @override bool isSupported(Locale locale) =&gt; applic.supportedLanguages.contains(locale.languageCode); @override Future&lt;Translations&gt; load(Locale locale)=&gt; Translations.load(locale); @override bool shouldReload(TranslationsDelegate old) =&gt; false;&#125;/// Delegateç±»çš„å®ç°ï¼Œæ¯æ¬¡é€‰æ‹©ä¸€ç§æ–°çš„è¯­è¨€æ—¶ï¼Œå¼ºåˆ¶åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„Translationsç±»class SpecificLocalizationDelegate extends LocalizationsDelegate&lt;Translations&gt; &#123; final Locale overriddenLocale; const SpecificLocalizationDelegate(this.overriddenLocale); @override bool isSupported(Locale locale) =&gt; overriddenLocale != null; @override Future&lt;Translations&gt; load(Locale locale) =&gt; Translations.load(overriddenLocale); @override bool shouldReload(LocalizationsDelegate&lt;Translations&gt; old) &#123; return applic.shouldReload??false; &#125;&#125;typedef void LocaleChangeCallback(Locale locale);class APPLIC &#123; // æ”¯æŒçš„è¯­è¨€åˆ—è¡¨ final List&lt;String&gt; supportedLanguages = [&#x27;en&#x27;,&#x27;zh&#x27;]; // æ”¯æŒçš„Localesåˆ—è¡¨ Iterable&lt;Locale&gt; supportedLocales() =&gt; supportedLanguages.map&lt;Locale&gt;((lang) =&gt; new Locale(lang, &#x27;&#x27;)); // å½“è¯­è¨€æ”¹å˜æ—¶è°ƒç”¨çš„æ–¹æ³• LocaleChangeCallback onLocaleChanged; bool shouldReload; /// /// Internals /// static final APPLIC _applic = new APPLIC._internal(); factory APPLIC()&#123; return _applic; &#125; APPLIC._internal();&#125;APPLIC applic = new APPLIC(); åœ¨é‡Œé¢,æˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªTranslationsç±»,é‡Œé¢ä½¿ç”¨ Localeåˆå§‹åŒ–è¯­è¨€é…ç½®,ä¸”é»˜è®¤ç»™çš„æ±‰è¯­zh,å¯ä»¥æ·»åŠ è‡ªå·±æ”¯æŒçš„Localesåˆ—è¡¨,æ–°å»ºå¯¹åº”çš„jsonæ–‡ä»¶å³å¯. æ¥ä¸‹æ¥éœ€è¦åœ¨å…¥å£é…ç½®Delegateçš„ç›¸å…³ä»£ç : main.dart 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:shared_preferences/shared_preferences.dart&#x27;;import &#x27;package:flutter_localizations/flutter_localizations.dart&#x27;;import &#x27;./utils/trahslations.dart&#x27;;import &#x27;./tabbar.dart&#x27;;void main() =&gt; runApp(MyApp());class MyApp extends StatefulWidget &#123; MyApp(&#123;Key key&#125;) : super(key: key); _MyAppState createState() =&gt; _MyAppState();&#125;class _MyAppState extends State&lt;MyApp&gt; &#123; SpecificLocalizationDelegate _localeOverrideDelegate; onLocaleChange(Locale locale) async &#123; print(&#x27;onLocaleChange--&#x27;); SharedPreferences sp = await SharedPreferences.getInstance(); await sp.setString(&quot;lang&quot;, locale.languageCode); setState(() &#123; _localeOverrideDelegate = new SpecificLocalizationDelegate(locale); &#125;); &#125; @override void initState() &#123; super.initState(); _localeOverrideDelegate = new SpecificLocalizationDelegate(null); applic.onLocaleChanged = onLocaleChange; &#125; @override Widget build(BuildContext context) &#123; return MaterialApp( debugShowCheckedModeBanner: false, title: &#x27;box chain&#x27;, theme: new ThemeData( backgroundColor: Color.fromRGBO(240, 240, 240, 1.0), ), home: MainPageWidget(), localizationsDelegates: [ _localeOverrideDelegate, const TranslationsDelegate(), GlobalMaterialLocalizations.delegate, GlobalWidgetsLocalizations.delegate, ], supportedLocales: applic.supportedLocales(), localeResolutionCallback: (deviceLocale, supportedLocales) &#123; if(deviceLocale.toString() == &#x27;en_CN&#x27;||deviceLocale.toString() == &#x27;zh_CN&#x27;)&#123; applic.shouldReload = true; applic.onLocaleChanged(new Locale(&#x27;zh&#x27;,&#x27;&#x27;)); &#125; else &#123; applic.shouldReload = true; applic.onLocaleChanged(new Locale(&#x27;en&#x27;,&#x27;&#x27;)); &#125; &#125; ); &#125;&#125; è¿™é‡Œ,æˆ‘ä»¬å…ˆå¼•å…¥æœ¬åœ°åŒ–åº“,å›½é™…åŒ–åº“å’Œåˆšæ‰æ–°å»ºçš„trahslations.dart,ç„¶ååœ¨åˆå§‹åŒ–æ–¹æ³•é‡Œé¢åˆå§‹åŒ–é…ç½®,åœ¨MaterialAppé‡Œé¢è®¾ç½®localizationsDelegateså’ŒsupportedLocales,ç„¶åæ–°å»ºä¸€ä¸ªæ–¹æ³•ç”¨äºä¿®æ”¹æœ¬åœ°çš„Locale. å¦‚ä¸Šé¢ä»£ç ä¸­çš„onLocaleChangeæ–¹æ³•. ä¸‹é¢å°±æ˜¯ä½¿ç”¨æ–¹æ³•äº†: ä½¿ç”¨è¯­è¨€ 123456String _lang(String key) &#123; return Translations.of(context).text(key);&#125;_lang(&quot;zh&quot;) ä¿®æ”¹è¯­è¨€ 123applic.shouldReload = true; applic.onLocaleChanged(new Locale(&#x27;zh&#x27;, &#x27;&#x27;)); å®Œæ•´ä»£ç : one_page.dart 1234567891011121314151617181920212223242526272829303132333435363738394041 import &#x27;package:flutter/material.dart&#x27;;import &#x27;../../utils/trahslations.dart&#x27;;class OnePage extends StatefulWidget &#123; @override _OnePageState createState() =&gt; _OnePageState();&#125;class _OnePageState extends State&lt;OnePage&gt; &#123; String _lang(String key) &#123; return Translations.of(context).text(key); &#125; Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar( title: Text(_lang(&quot;home&quot;)), ), body: Center( child: Column( children: &lt;Widget&gt;[ RaisedButton( child: Text(_lang(&quot;zh&quot;)), onPressed: () &#123; applic.shouldReload = true; applic.onLocaleChanged(new Locale(&#x27;zh&#x27;, &#x27;&#x27;)); &#125;, ), RaisedButton( child: Text(_lang(&quot;en&quot;)), onPressed: () &#123; applic.shouldReload = true; applic.onLocaleChanged(new Locale(&#x27;en&#x27;, &#x27;&#x27;)); &#125;, ), ], ), ), ); &#125;&#125; two_page.dart 123456789101112131415161718192021222324 import &#x27;package:flutter/material.dart&#x27;;import &#x27;../../utils/trahslations.dart&#x27;;class TwoPage extends StatefulWidget &#123; @override _TwoPageState createState() =&gt; _TwoPageState();&#125;class _TwoPageState extends State&lt;TwoPage&gt; &#123; String _lang(String key) &#123; return Translations.of(context).text(key); &#125; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar(title: Text(_lang(&quot;mine&quot;))), body: Center( child: Text(&#x27;........&#x27;), ), ); &#125;&#125; å…¶ä¸­tabbarçš„ä»£ç ä¸­,å¼•å…¥ç±»trahslations.dart,ä½¿ç”¨å¦‚ä¸‹: 1234567891011import &#x27;./utils/trahslations.dart&#x27;; Text getTabTitle(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return new Text(Translations.of(context).text(appBarTitles[curIndex]), style: new TextStyle(fontSize: 14.0, color: const Color(0xff1296db))); &#125; else &#123; return new Text( Translations.of(context).text( appBarTitles[curIndex]), style: new TextStyle(fontSize: 14.0, color: const Color(0xff515151))); &#125; &#125; å®Œæ•´ä»£ç : tabbar.dart 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102 import &#x27;package:flutter/material.dart&#x27;;import &#x27;./utils/trahslations.dart&#x27;;import &#x27;./pages/one/one_page.dart&#x27;;import &#x27;./pages/two/two_page.dart&#x27;;class MainPageWidget extends StatefulWidget &#123; @override State&lt;StatefulWidget&gt; createState() &#123; return new MainPageState(); &#125;&#125;class MainPageState extends State&lt;MainPageWidget&gt; &#123; int _tabIndex = 0; var tabImages; var appBarTitles = [&#x27;home&#x27;, &#x27;mine&#x27;]; /* * å­˜æ”¾äºŒä¸ªé¡µé¢ï¼Œè·ŸfragmentListä¸€æ · */ var _pageList; /* * æ ¹æ®é€‰æ‹©è·å¾—å¯¹åº”çš„normalæˆ–æ˜¯pressçš„icon */ Image getTabIcon(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return tabImages[curIndex][1]; &#125; return tabImages[curIndex][0]; &#125; /* * è·å–bottomTabçš„é¢œè‰²å’Œæ–‡å­— */ Text getTabTitle(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return new Text(Translations.of(context).text(appBarTitles[curIndex]), style: new TextStyle(fontSize: 14.0, color: const Color(0xff1296db))); &#125; else &#123; return new Text( Translations.of(context).text( appBarTitles[curIndex]), style: new TextStyle(fontSize: 14.0, color: const Color(0xff515151))); &#125; &#125; /* * æ ¹æ®imageè·¯å¾„è·å–å›¾ç‰‡ */ Image getTabImage(path) &#123; return new Image.asset(path, width: 24.0, height: 24.0); &#125; void initData() &#123; /* * åˆå§‹åŒ–é€‰ä¸­å’Œæœªé€‰ä¸­çš„icon */ tabImages = [ [ getTabImage(&#x27;images/tab/home.png&#x27;), getTabImage(&#x27;images/tab/home_active.png&#x27;) ], [ getTabImage(&#x27;images/tab/mine.png&#x27;), getTabImage(&#x27;images/tab/mine_active.png&#x27;) ], ]; /* * å­ç•Œé¢ */ _pageList = [ new OnePage(), new TwoPage(), ]; &#125; @override Widget build(BuildContext context) &#123; //åˆå§‹åŒ–æ•°æ® initData(); return Scaffold( body: _pageList[_tabIndex], bottomNavigationBar: new BottomNavigationBar( items: &lt;BottomNavigationBarItem&gt;[ new BottomNavigationBarItem( icon: getTabIcon(0), title: getTabTitle(0)), new BottomNavigationBarItem( icon: getTabIcon(1), title: getTabTitle(1)), ], type: BottomNavigationBarType.fixed, //é»˜è®¤é€‰ä¸­é¦–é¡µ currentIndex: _tabIndex, iconSize: 24.0, //ç‚¹å‡»äº‹ä»¶ onTap: (index) &#123; setState(() &#123; _tabIndex = index; &#125;); &#125;, ), ); &#125;&#125; å…¶ä¸­,Xcodeçš„å¤šè¯­è¨€ä¹Ÿæœ€å¥½è·Ÿç€é…ç½®ä¸‹æ–‡ä»¶,å¦‚å›¾: ä»¥ä¸Šå°±æ˜¯å…¨éƒ¨ä»£ç äº†.å¦‚æœä¸æ˜ç™½çš„ä¸‹é¢æœ‰æºç åœ°å€,å¯ä»¥å»é‚£é‡Œçœ‹çœ‹. æºç åœ°å€","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutter~AndroidåŸç”Ÿå·¥ç¨‹ä¸­æ·»åŠ Flutteræ¨¡å—","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~AndroidåŸç”Ÿå·¥ç¨‹ä¸­æ·»åŠ Flutteræ¨¡å—","date":"2019-05-30T16:00:00.000Z","updated":"2019-05-31T10:44:57.000Z","comments":true,"path":"2019/05/31/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~AndroidåŸç”Ÿå·¥ç¨‹ä¸­æ·»åŠ Flutteræ¨¡å—/","link":"","permalink":"https://zhoushaoting.com/2019/05/31/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter~Android%E5%8E%9F%E7%94%9F%E5%B7%A5%E7%A8%8B%E4%B8%AD%E6%B7%BB%E5%8A%A0Flutter%E6%A8%A1%E5%9D%97/","excerpt":"ä»Šå¤©,å­¦ä¹ ä¸‹,å¦‚ä½•åœ¨AndroidåŸç”Ÿå·¥ç¨‹ä¸­é›†æˆFlutteræ¨¡å—","text":"ä»Šå¤©,å­¦ä¹ ä¸‹,å¦‚ä½•åœ¨AndroidåŸç”Ÿå·¥ç¨‹ä¸­é›†æˆFlutteræ¨¡å— ok,é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨Android Studioæ–°å»ºä¸€ä¸ªAndroidåŸç”Ÿå·¥ç¨‹,å…ˆæ”¾ç€.ç„¶åé€šè¿‡flutter create -t module flutter_moduleæ–°å»ºä¸€ä¸ªflutterçš„æ¨¡å—,è¿™é‡Œåå­—éšæ„.ä»¥flutter_moduleä¸ºä¾‹. ä½¿ç”¨Android Studioæ‰“å¼€AndroidåŸç”Ÿå·¥ç¨‹,åœ¨settings.gradleä¸­æ·»åŠ å¦‚ä¸‹ä»£ç : 123456 setBinding(new Binding([gradle: this])) // newevaluate(new File( // new settingsDir.parentFile, // new &#x27;flutter_module/.android/include_flutter.groovy&#x27; // new)) æ³¨æ„è·¯å¾„çš„æ­£ç¡®æ€§.å…¶ä¸­è¿™ä¸ªBindingä¼šæŠ¥çº¢,å¯ä»¥æ— è§†,ä¸å½±å“è¿è¡Œ.å¦‚å›¾æ‰€ç¤º: åœ¨é¡¹ç›®ä¸‹çš„build.gradeä¸­çš„dependenciesä¸­æ·»åŠ flutteræ¨¡å—çš„å¼•å…¥: 12implementation project(&#x27;:flutter&#x27;) å¦‚å›¾æ‰€ç¤º: buildä¸‹å·¥ç¨‹,å¦‚æœå‡ºç°æŠ¥é”™ä¿¡æ¯:Error:Invoke-customs are only supported starting with Android 0 (--min-api 26) çš„è¯,éœ€è¦æ·»åŠ : 12345compileOptions &#123; sourceCompatibility JavaVersion.VERSION_1_8 targetCompatibility JavaVersion.VERSION_1_8 &#125; å¦‚å›¾æ‰€ç¤º: OK.AndroidåŸç”Ÿå·¥ç¨‹é›†æˆflutterå®Œæ¯•.æ¥ä¸‹æ¥å°±æ˜¯æ¼”ç¤ºä»£ç äº†. é¦–å…ˆåœ¨activity_mian.xmlä¸­æ·»åŠ  1234567&lt;Button android:id=&quot;@+id/jump&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:text=&quot;Go to&quot; /&gt; ç„¶ååœ¨MainActivity.javaä¸­æ·»åŠ è°ƒç”¨ä»£ç .æ–‡ä»¶ä»£ç å¦‚ä¸‹: 123456789101112131415161718192021222324252627282930313233 package com.example.androidaddflutter;import android.os.Bundle;import android.support.v7.app.AppCompatActivity;import android.view.View;import android.widget.FrameLayout;import io.flutter.facade.Flutter;public class MainActivity extends AppCompatActivity &#123; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); findViewById(R.id.jump).setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View view) &#123; View flutterView = Flutter.createView( MainActivity.this, getLifecycle(), &quot;android ä¼ ç»™Flutterçš„å€¼&quot; ); FrameLayout.LayoutParams layout = new FrameLayout.LayoutParams(FrameLayout.LayoutParams.MATCH_PARENT, FrameLayout.LayoutParams.MATCH_PARENT); layout.leftMargin = 0; layout.topMargin = 200; addContentView(flutterView, layout); &#125; &#125;); &#125;&#125; å…¶ä¸­,å¯ä»¥å‘flutterä¼ ä¸€ä¸ªå‚æ•°è¿‡å».åœ¨flutter_moduleæ¨¡å—ä¸­,é€šè¿‡window.defaultRouteNameçš„æ–¹å¼å³å¯è·å–åˆ°AndroidåŸç”Ÿä¼ è¿‡å»çš„å€¼.å…¶ä¸­éœ€è¦å¼•å…¥ import &#39;dart:ui&#39;; æºç  æ•ˆæœå›¾:","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutter~iOSåŸç”Ÿå·¥ç¨‹ä¸­æ·»åŠ Flutteræ¨¡å—","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~iOSåŸç”Ÿå·¥ç¨‹ä¸­æ·»åŠ Flutteræ¨¡å—","date":"2019-05-28T16:00:00.000Z","updated":"2019-05-29T07:48:47.000Z","comments":true,"path":"2019/05/29/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~iOSåŸç”Ÿå·¥ç¨‹ä¸­æ·»åŠ Flutteræ¨¡å—/","link":"","permalink":"https://zhoushaoting.com/2019/05/29/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter~iOS%E5%8E%9F%E7%94%9F%E5%B7%A5%E7%A8%8B%E4%B8%AD%E6%B7%BB%E5%8A%A0Flutter%E6%A8%A1%E5%9D%97/","excerpt":"ä»Šå¤©,å­¦ä¹ ä¸‹,å¦‚ä½•åœ¨iOSåŸç”Ÿå·¥ç¨‹ä¸­é›†æˆFlutteræ¨¡å—","text":"ä»Šå¤©,å­¦ä¹ ä¸‹,å¦‚ä½•åœ¨iOSåŸç”Ÿå·¥ç¨‹ä¸­é›†æˆFlutteræ¨¡å— ok,é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨Xcodeæ–°å»ºä¸€ä¸ªiOSåŸç”Ÿå·¥ç¨‹,å…ˆæ”¾ç€.ç„¶åé€šè¿‡flutter create -t module flutter_moduleæ–°å»ºä¸€ä¸ªflutterçš„æ¨¡å—,è¿™é‡Œåå­—éšæ„.ä»¥flutter_moduleä¸ºä¾‹. ç„¶ååœ¨iOSåŸç”Ÿå·¥ç¨‹ä¸­,ä½¿ç”¨podå¯¼å…¥flutter:é¦–å…ˆ,ç»ˆç«¯ä¸Šå…ˆé€šè¿‡pod initä¸ºåŸç”Ÿå·¥ç¨‹åˆ›å»ºPodfileæ–‡ä»¶. ç„¶ååœ¨è¯¥Podfileæ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹: 123 flutter_application_path = &#x27;../flutter_module/&#x27;eval(File.read(File.join(flutter_application_path, &#x27;.ios&#x27;, &#x27;Flutter&#x27;, &#x27;podhelper.rb&#x27;)), binding) æ³¨æ„è·¯å¾„æ­£ç¡®. ç»ˆç«¯ cdåˆ°iOSåŸç”Ÿé¡¹ç›®æ ¹ç›®å½•ä¸‹. æ‰§è¡Œpod install é€šè¿‡ç‚¹å‡»XXXX.xcworkspaceæ–‡ä»¶æ‰“å¼€Xcode.æ‰¾åˆ°â€TAGGETSâ€-&gt;â€Build Settingsâ€-&gt;â€Enable Bitcodeâ€é¦–å…ˆæŠŠé¡¹ç›®bitcodeå…³é—­. æ‰¾åˆ°â€TAGGETSâ€-&gt;â€Build Settingsâ€-&gt;â€Enable Phasesâ€.ç‚¹å‡»+å·,æ–°å»ºä¸€ä¸ªâ€New Run Script Phaseâ€.å…¶ä¸­åŠ å…¥: 123 &quot;$FLUTTER_ROOT/packages/flutter_tools/bin/xcode_backend.sh&quot; build&quot;$FLUTTER_ROOT/packages/flutter_tools/bin/xcode_backend.sh&quot; embed ç„¶å,æŠŠå®ƒç§»åŠ¨Target Dependenciedä¸‹é¢. ok.Xcode buildä¸‹,æ­£ç¡®æƒ…å†µä¸‹æ˜¯å·¥ç¨‹å¥½çš„.é›†æˆæ­¥éª¤å®Œæ¯•. ç„¶åæˆ‘ä»¬åœ¨ ViewController.mä¸­é€šè¿‡presentViewControllerçš„æ–¹å¼è·³è‡³flutteræ¨¡å—å³å¯.é¦–å…ˆ,å¼•å…¥ 123#import &lt;Flutter/Flutter.h&gt;#import &lt;FlutterPluginRegistrant/GeneratedPluginRegistrant.h&gt; å…¶ä¸­,å¯ä»¥ä¸ºflutteræ¨¡å—ä¼ ä¸ªå‚æ•°,é€šè¿‡setInitialRoute.è¯¥æ–‡ä»¶å®Œæ•´ä»£ç å¦‚ä¸‹: 1234567891011121314151617181920212223242526272829303132333435363738394041424344//// ViewController.m// iOSAddFlutter//// Created by Shaoting Zhou on 2019/5/29.// Copyright Â© 2019 Shaoting Zhou. All rights reserved.//#import &quot;ViewController.h&quot;#import &lt;Flutter/Flutter.h&gt;#import &lt;FlutterPluginRegistrant/GeneratedPluginRegistrant.h&gt;@interface ViewController ()@end@implementation ViewController- (void)viewDidLoad &#123; [super viewDidLoad]; UIButton *button = [[UIButton alloc]init]; [button setTitle:@&quot;è·³è‡³Flutteræ¨¡å—&quot; forState:UIControlStateNormal]; button.backgroundColor=[UIColor redColor]; button.frame = CGRectMake(50, 50, 200, 100); [button setTitleColor:[UIColor redColor] forState:UIControlStateHighlighted]; [button addTarget:self action:@selector(buttonPrint) forControlEvents:UIControlEventTouchUpInside]; [self.view addSubview:button]; // Do any additional setup after loading the view.&#125;- (void)buttonPrint&#123; FlutterViewController * flutterVC = [[FlutterViewController alloc]init]; [flutterVC setInitialRoute:@&quot;æˆ‘æ˜¯Nativeä¼ ç»™FLutteræ¨¡å—çš„&quot;]; [self presentViewController:flutterVC animated:true completion:nil];&#125;@end åœ¨flutter_moduleæ¨¡å—ä¸­,é€šè¿‡window.defaultRouteNameçš„æ–¹å¼å³å¯è·å–åˆ°iOSåŸç”Ÿä¼ è¿‡å»çš„å€¼.å…¶ä¸­éœ€è¦å¼•å…¥ import &#39;dart:ui&#39;; æºç  æ•ˆæœå›¾:","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"React-Nativeä½¿ç”¨è‡ªå®šä¹‰å­—ä½“","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeä½¿ç”¨è‡ªå®šä¹‰å­—ä½“","date":"2019-05-13T16:00:00.000Z","updated":"2019-05-14T11:17:33.000Z","comments":true,"path":"2019/05/14/ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeä½¿ç”¨è‡ªå®šä¹‰å­—ä½“/","link":"","permalink":"https://zhoushaoting.com/2019/05/14/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/React-Native%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%97%E4%BD%93/","excerpt":"ä»Šå¤©,å­¦ä¹ ä¸€ä¸‹åœ¨React-Nativeä¸­ä½¿ç”¨è‡ªå®šä¹‰å­—ä½“.ä½¿ç”¨ç‰ˆæœ¬æ˜¯ &quot;react-native&quot;: &quot;0.59.8&quot;","text":"ä»Šå¤©,å­¦ä¹ ä¸€ä¸‹åœ¨React-Nativeä¸­ä½¿ç”¨è‡ªå®šä¹‰å­—ä½“.ä½¿ç”¨ç‰ˆæœ¬æ˜¯ &quot;react-native&quot;: &quot;0.59.8&quot; é¦–å…ˆå…ˆåœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ç”¨æ¥å­˜æ”¾XXXX.ttfå­—ä½“æ–‡ä»¶,æˆ‘ä¸€èˆ¬å–œæ¬¢åœ¨æœ€å¤–é¢åŠ ä¸€ä¸ªassetsæ–‡ä»¶å¤¹,é‡Œé¢å†åŠ ä¸€ä¸ªfontsæ–‡ä»¶å¤¹,ä¹‹åå†æ”¾ç½®å­—ä½“æ–‡ä»¶XXX.ttf.ç„¶å,åœ¨package.jsonä¸­åŠ å…¥è¯¥æ–‡ä»¶è·¯å¾„.å¦‚ 12345678910&#123; .... &quot;rnpm&quot;: &#123; &quot;assets&quot;: [ &quot;./assets/fonts&quot; ] &#125; &#125; å¦‚å›¾:ä¹‹å,ç»ˆç«¯cd åˆ°é¡¹ç›®æ ¹ç›®å½•,ç„¶åè¿è¡Œreact-native link.å®Œæˆä¹‹åæ‰“å¼€Xcodeå¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†Resourcesæ–‡ä»¶å¤¹ä¸‹çš„xxx.ttfå­—ä½“æ–‡ä»¶,åŒæ—¶åœ¨é¡¹ç›®çš„info.plistä¸­å¤šäº†Fonts provided by applicationè¿™ä¸ªæ•°ç»„,å…¶ä¸­å°±æœ‰å‰é¢çš„xxx.ttfæ–‡ä»¶.å¦‚å›¾: OK.å­—ä½“æ–‡ä»¶å·²ç»é…ç½®å®Œæ¯•,æ¥ä¸‹æ¥ä½¿ç”¨å³å¯.åœ¨iOSå¹³å°ä¸Šä¸èƒ½ç›´æ¥ä½¿ç”¨å­—ä½“æ–‡ä»¶å,éœ€è¦ä½¿ç”¨familyNames æ‰å¯ä»¥.æˆ‘ä»¬å…ˆè·å–ä¸€ä¸‹è¯¥å­—ä½“æ–‡ä»¶çš„çš„familyNames .åœ¨AppDelegate.mä¸­,ä½¿ç”¨ 123456789for(NSString *fontfamilyname in [UIFont familyNames]) &#123; NSLog(@&quot;family:&#x27;%@&#x27;&quot;,fontfamilyname); for(NSString *fontName in [UIFont fontNamesForFamilyName:fontfamilyname]) &#123; NSLog(@&quot;\\tfont:&#x27;%@&#x27;&quot;,fontName); &#125; NSLog(@&quot;-------------&quot;);&#125; å…¶ä¸­ 1NSLog(@&quot;family:&#x27;%@&#x27;&quot;,fontfamilyname); æ‰“å°çš„å°±æ˜¯familyNames .androidç›´æ¥ä½¿ç”¨å­—ä½“æ–‡ä»¶åxxxå³å¯.å¦‚å›¾:æ•ˆæœå¦‚å›¾(éƒ¨åˆ†å­—ä½“åªèƒ½ä½¿ç”¨çœŸæœºæ‰èƒ½çœ‹å‡ºæ¥): æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"react-native-router-fluxåˆæ­¥è®¤è¯†","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /react-native-router-fluxåˆæ­¥è®¤è¯†","date":"2019-04-22T07:56:58.000Z","updated":"2019-04-22T07:56:58.000Z","comments":true,"path":"2019/04/22/ç§»åŠ¨ç«¯å­¦ä¹ /react-native-router-fluxåˆæ­¥è®¤è¯†/","link":"","permalink":"https://zhoushaoting.com/2019/04/22/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/react-native-router-flux%E5%88%9D%E6%AD%A5%E8%AE%A4%E8%AF%86/","excerpt":"ä»Šå¤©åˆæ­¥äº†è§£ä¸‹ react-native-router-flux è¿™ä¸ªä¸‰æ–¹å¯¼èˆªåº“,åŸºäºreact-native0.55.4,react-native-router-flux^4.0.0-beta.31","text":"ä»Šå¤©åˆæ­¥äº†è§£ä¸‹ react-native-router-flux è¿™ä¸ªä¸‰æ–¹å¯¼èˆªåº“,åŸºäºreact-native0.55.4,react-native-router-flux^4.0.0-beta.31 æ•ˆæœå›¾:ä½¿ç”¨æ–¹æ³•è¯·å‚è€ƒ:å‚è€ƒ1å‚è€ƒ2æˆ‘è¿™é‡Œä¸è¯¦ç»†è¯´æ˜äº†,è´´å‡ºå…³é”®ä»£ç ä¸€çœ‹ä¾¿çŸ¥.ä»£ç åŸºæœ¬ç»“æ„å¦‚ä¸‹: App.js: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123;Component&#125; from &#x27;react&#x27;;import &#123; Platform, StyleSheet, Text, View, Image&#125; from &#x27;react-native&#x27;;import &#123; Navigation, Scene, Router, Modal&#125; from &#x27;react-native-router-flux&#x27;;import IOS from &#x27;./src/ios&#x27;;import Android from &#x27;./src/android&#x27;import Web from &#x27;./src/web&#x27;import TabIcon from &#x27;./src/TabIcon&#x27;type Props = &#123;&#125;;export default class App extends Component&lt;Props&gt; &#123; render() &#123; return ( &lt;Router&gt; &lt;Modal&gt; &lt;Scene key=&quot;root&quot; tabBarPosition=&quot;bottom&quot; tabs&gt; &lt;Scene hideBackImage key=&quot;IOS&quot; title=&quot;è‹¹æœ&quot; component=&#123;IOS&#125; icon=&#123;TabIcon&#125; Image=&#123;require(&#x27;./src/image/ios.png&#x27;)&#125; selectedImage=&#123;require(&#x27;./src/image/ios_active.png&#x27;)&#125; /&gt; &lt;Scene hideBackImage key=&quot;Web&quot; component=&#123;Web&#125; title=&quot;web&quot; icon=&#123;TabIcon&#125; Image=&#123;require(&#x27;./src/image/web.png&#x27;)&#125; showLabel = &#123;false&#125; selectedImage=&#123;require(&#x27;./src/image/web_active.png&#x27;)&#125; /&gt; &lt;Scene hideBackImage key=&quot;Android&quot; component=&#123;Android&#125; title=&quot;å®‰å“&quot; icon=&#123;TabIcon&#125; Image=&#123;require(&#x27;./src/image/android.png&#x27;)&#125; hideNavBar=&#123;true&#125; //éšè—å¯¼èˆªæ  selectedImage=&#123;require(&#x27;./src/image/android_active.png&#x27;)&#125; /&gt; &lt;/Scene&gt; &lt;/Modal&gt; &lt;/Router&gt; ); &#125;&#125;const styles = StyleSheet.create(&#123; tabbarContainer: &#123; flex: 1, backgroundColor: &quot;#f6f6f6&quot;, overflow: &#x27;visible&#x27; &#125;, tabIconItem: &#123; flex: 1, height: 56, flexDirection: &#x27;column&#x27;, alignItems: &#x27;center&#x27;, justifyContent: &#x27;center&#x27;, paddingLeft: 8, paddingRight: 8, backgroundColor: &#x27;transparent&#x27;, overflow: &#x27;visible&#x27; &#125;, tabIconImage: &#123; width: 60, height: 60, overflow: &#x27;visible&#x27; &#125;,&#125;); TabIcon.js 1234567891011121314151617181920212223242526272829303132333435363738394041424344import React, &#123;PropTypes, Component&#125; from &#x27;react&#x27;import &#123;Text, View, Image, StyleSheet&#125; from &#x27;react-native&#x27;const tabIconStyles = StyleSheet.create(&#123; tabIconItem: &#123; flex: 1, height: 56, flexDirection: &#x27;column&#x27;, alignItems: &#x27;center&#x27;, justifyContent: &#x27;center&#x27;, paddingLeft: 8, paddingRight: 8, backgroundColor: &#x27;transparent&#x27;, &#125;, tabIconImage: &#123; width: 24, height: 24 &#125;, titleText: &#123; marginTop: 5, textAlign: &#x27;center&#x27;, fontSize: 11 &#125;, titleTextDefaultColor: &#123; color: &#x27;black&#x27; &#125;, titleTextSelectColor: &#123; color: &#x27;red&#x27; &#125;, tabItemRow: &#123; flexDirection: &#x27;row&#x27; &#125;,&#125;);export default TabIcon=(props)=&gt;&#123; return ( &lt;View style=&#123;tabIconStyles.tabIconItem&#125;&gt; &lt;Image style=&#123;tabIconStyles.tabIconImage&#125; source=&#123;props.focused ? props.selectedImage : props.Image&#125;/&gt; &lt;Text&gt;&#123;props.tabTitle&#125;&lt;/Text&gt; &lt;/View&gt; );&#125;; è€Œè‡³äºios.js,web.js,android.jsåªæ˜¯åŸºæœ¬çš„æ¨¡æ¿ç•Œé¢ 123456789101112131415161718192021222324252627282930313233343536373839404142434445/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &#x27;react&#x27;;import &#123; Platform, StyleSheet, Text, View&#125; from &#x27;react-native&#x27;;type Props = &#123;&#125;;export default class IOS extends Component&lt;Props&gt; &#123; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text style=&#123;styles.welcome&#125;&gt; é¦–é¡µ &lt;/Text&gt; &lt;/View&gt; ); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &#x27;center&#x27;, alignItems: &#x27;center&#x27;, backgroundColor: &#x27;#F5FCFF&#x27;, &#125;, welcome: &#123; fontSize: 20, textAlign: &#x27;center&#x27;, margin: 10, &#125;, instructions: &#123; textAlign: &#x27;center&#x27;, color: &#x27;#333333&#x27;, marginBottom: 5, &#125;,&#125;); æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Androidå’ŒReact-Nativeçš„ç®€å•äº¤äº’","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Androidå’ŒReact-Nativeçš„ç®€å•äº¤äº’","date":"2019-04-22T07:53:06.000Z","updated":"2019-04-22T07:53:06.000Z","comments":true,"path":"2019/04/22/ç§»åŠ¨ç«¯å­¦ä¹ /Androidå’ŒReact-Nativeçš„ç®€å•äº¤äº’/","link":"","permalink":"https://zhoushaoting.com/2019/04/22/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Android%E5%92%8CReact-Native%E7%9A%84%E7%AE%80%E5%8D%95%E4%BA%A4%E4%BA%92/","excerpt":"é¦–å…ˆåœ¨AndroidåŸç”Ÿä¸­.æ–°å»ºclassæ–‡ä»¶TransMissonMoudle:","text":"é¦–å…ˆåœ¨AndroidåŸç”Ÿä¸­.æ–°å»ºclassæ–‡ä»¶TransMissonMoudle: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109/** * Created by shaotingzhou on 2018/3/7. */package com.androidrn.RN;import com.facebook.react.bridge.Callback;import com.facebook.react.bridge.Promise;import com.facebook.react.bridge.ReactApplicationContext;import com.facebook.react.bridge.ReactContext;import com.facebook.react.bridge.ReactContextBaseJavaModule;import com.facebook.react.bridge.ReactMethod;import com.facebook.react.bridge.WritableMap;import com.facebook.react.bridge.WritableNativeMap;import com.facebook.react.modules.core.DeviceEventManagerModule;import java.text.SimpleDateFormat;import java.util.Date;import javax.annotation.Nullable;public class TransMissonMoudle extends ReactContextBaseJavaModule &#123; private static final String REACT_CLASS = &quot;TransMissonMoudle&quot;; private ReactContext mReactContext; public TransMissonMoudle(ReactApplicationContext reactContext) &#123; super(reactContext); this.mReactContext = reactContext; &#125; @Override public String getName() &#123; return REACT_CLASS; &#125; //å»¶è¿Ÿ0.1ç§’è·å–æ—¶é—´ã€‚ @ReactMethod public void getTime() &#123; new Thread(new Runnable() &#123; @Override public void run() &#123; try &#123; Thread.sleep(100); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; String time = getTimeMillis(); WritableMap writableMap = new WritableNativeMap(); writableMap.putString(&quot;key&quot;, time); sendTransMisson(mReactContext, &quot;EventName&quot;, writableMap); &#125; &#125;).start(); &#125; private String getTimeMillis() &#123; SimpleDateFormat formatDate = new SimpleDateFormat(&quot;yyyyå¹´MMæœˆddæ—¥ HH:mm:ss&quot;); Date date = new Date(System.currentTimeMillis()); String time = formatDate.format(date); return time; &#125; /** * RCTDeviceEventEmitteræ–¹å¼ * * @param reactContext * @param eventName äº‹ä»¶å * @param params ä¼ æƒ¨ */ public void sendTransMisson(ReactContext reactContext, String eventName, @Nullable WritableMap params) &#123; reactContext .getJSModule(DeviceEventManagerModule.RCTDeviceEventEmitter.class) .emit(eventName, params); &#125; /** * CallBackæ–¹å¼ * * @param name * @param callback */ @ReactMethod public void callBackTime(String name, Callback callback) &#123; callback.invoke(getTimeMillis()); &#125; /** * Promiseæ–¹å¼ * @param name * @param promise */ @ReactMethod public void sendPromiseTime(String name, Promise promise) &#123; WritableMap writableMap=new WritableNativeMap(); writableMap.putString(&quot;age&quot;,&quot;20&quot;); writableMap.putString(&quot;time&quot;,getTimeMillis()); promise.resolve(writableMap); &#125;&#125; å†å»ºclassæ–‡ä»¶TransMissonPackage: 123456789101112131415161718192021222324252627282930313233343536373839package com.androidrn.RN;import com.facebook.react.ReactPackage;import com.facebook.react.bridge.JavaScriptModule;import com.facebook.react.bridge.NativeModule;import com.facebook.react.bridge.ReactApplicationContext;import com.facebook.react.uimanager.ViewManager;import java.util.ArrayList;import java.util.Collections;import java.util.List;/** * Created by shaotingzhou on 2018/3/7. */public class TransMissonPackage implements ReactPackage &#123; @Override public List&lt;NativeModule&gt; createNativeModules(ReactApplicationContext reactContext) &#123; List&lt;NativeModule&gt; modules = new ArrayList&lt;&gt;(); modules.add(new TransMissonMoudle(reactContext));//æ‘‡ä¸€æ‘‡ return modules; &#125;// @Override// public List&lt;Class&lt;? extends JavaScriptModule&gt;&gt; createJSModules() &#123;// return Collections.emptyList();// &#125; @Override public List&lt;ViewManager&gt; createViewManagers(ReactApplicationContext reactContext) &#123; List&lt;ViewManager&gt; viewManagerList=new ArrayList&lt;&gt;();// viewManagerList.add(new PTRRefreshManager()); return viewManagerList; &#125;&#125; æ¥ç€åœ¨MainApplicationé‡Œå¼•å…¥TransMissonPackage,åŠ å…¥åŒ….å¦‚ import com.androidrn.RN.TransMissonPackage; new TransMissonPackage() 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849package com.androidrn;import android.app.Application;import com.androidrn.RN.TransMissonPackage;import com.facebook.react.ReactApplication;import com.facebook.react.ReactNativeHost;import com.facebook.react.ReactPackage;import com.facebook.react.shell.MainReactPackage;import com.facebook.soloader.SoLoader;import java.util.Arrays;import java.util.List;public class MainApplication extends Application implements ReactApplication &#123; private final ReactNativeHost mReactNativeHost = new ReactNativeHost(this) &#123; @Override public boolean getUseDeveloperSupport() &#123; return BuildConfig.DEBUG; &#125; @Override protected List&lt;ReactPackage&gt; getPackages() &#123; return Arrays.&lt;ReactPackage&gt;asList( new MainReactPackage(), new TransMissonPackage() ); &#125; @Override protected String getJSMainModuleName() &#123; return &quot;index&quot;; &#125; &#125;; @Override public ReactNativeHost getReactNativeHost() &#123; return mReactNativeHost; &#125; @Override public void onCreate() &#123; super.onCreate(); SoLoader.init(this, /* native exopackage */ false); &#125;&#125; æˆ‘çš„æ–‡ä»¶æ”¾ç½®æƒ…å†µå¦‚å›¾: ç„¶ååªéœ€è¦åœ¨RNè¿™è¾¹: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123;Component&#125; from &#x27;react&#x27;;import &#123; AppRegistry, StyleSheet, Text, View, DeviceEventEmitter, NativeModules, ToastAndroid, Platform&#125; from &#x27;react-native&#x27;;const instructions = Platform.select(&#123; ios: &#x27;Press Cmd+R to reload,\\n&#x27; + &#x27;Cmd+D or shake for dev menu&#x27;, android: &#x27;Double tap R on your keyboard to reload,\\n&#x27; + &#x27;Shake or press menu button for dev menu&#x27;,&#125;);type Props = &#123;&#125;;export default class App extends Component&lt;Props&gt; &#123; componentWillMount() &#123; DeviceEventEmitter.addListener(&#x27;EventName&#x27;, function (msg) &#123; console.log(&#x27;DeviceEventEmitteræ”¶åˆ°æ¶ˆæ¯&#x27;+msg); alert(&#x27;DeviceEventEmitteræ”¶åˆ°æ¶ˆæ¯&#x27;+ msg.key) &#125;); &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text style=&#123;styles.welcome&#125; onPress=&#123;this.getDeviceEventEmitterTime.bind(this)&#125; &gt; RCTDeviceEventEmitterè·å–æ—¶é—´ &lt;/Text&gt; &lt;Text style=&#123;styles.welcome&#125; onPress=&#123;this.getCallBackTime.bind(this)&#125; &gt; CallBackè·å–æ—¶é—´ &lt;/Text&gt; &lt;Text style=&#123;styles.welcome&#125; onPress=&#123;this.getPromiseTime.bind(this)&#125; &gt; Promiseè·å–æ—¶é—´ &lt;/Text&gt; &lt;/View&gt; ); &#125; getDeviceEventEmitterTime() &#123; NativeModules.TransMissonMoudle.getTime(); &#125; getCallBackTime() &#123; NativeModules.TransMissonMoudle.callBackTime(&quot;Allure&quot;, (msg) =&gt; &#123; console.log(&#x27;callBack:---&#x27; + msg); alert(&#x27;callBack:---&#x27;+msg) &#125; ); &#125; getPromiseTime() &#123; NativeModules.TransMissonMoudle.sendPromiseTime(&quot;Allure&quot;).then(msg=&gt; &#123; console.log(&quot;å¹´é¾„:&quot; + msg.age + &quot;/n&quot; + &quot;æ—¶é—´:&quot; + msg.time); alert(&quot;å¹´é¾„&quot; + msg.age + &quot;æ—¶é—´&quot; + msg.time) this.setState(&#123; age: msg.age, time: msg.time, &#125;) &#125;).catch(error=&gt; &#123; console.log(&#x27;é”™è¯¯&#x27; + error); &#125;); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &#x27;center&#x27;, alignItems: &#x27;center&#x27;, backgroundColor: &#x27;#F5FCFF&#x27;, &#125;, welcome: &#123; fontSize: 20, textAlign: &#x27;center&#x27;, margin: 10, &#125;, instructions: &#123; textAlign: &#x27;center&#x27;, color: &#x27;#333333&#x27;, marginBottom: 5, &#125;,&#125;); æºç  æ•ˆæœå›¾:","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"React-Nativeä¸Webçš„åŸºæœ¬äº¤äº’","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeä¸Webçš„åŸºæœ¬äº¤äº’","date":"2019-04-21T16:00:00.000Z","updated":"2019-04-22T07:57:55.000Z","comments":true,"path":"2019/04/22/ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeä¸Webçš„åŸºæœ¬äº¤äº’/","link":"","permalink":"https://zhoushaoting.com/2019/04/22/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/React-Native%E4%B8%8EWeb%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BA%A4%E4%BA%92/","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹React Nativeä¸Webç«¯çš„åŸºæœ¬äº¤äº’,æš‚æ—¶æ¶‰åŠåˆ°RNå‘Webç«¯ä¼ å€¼,Webå‘RNç«¯ä¼ å€¼,å› ä¸ºç°åœ¨è½¬ä¸ºFlutterå¼€å‘,æ‰€ä»¥è¿™ä¸€å—æš‚æ—¶åªèƒ½æ¶‰åŠåˆ°è¿™é‡Œ.å…¶ä¸­çš„Webç«¯é‡‡ç”¨æœ¬åœ°htmlé¡µé¢.","text":"ä»Šå¤©å­¦ä¹ ä¸‹React Nativeä¸Webç«¯çš„åŸºæœ¬äº¤äº’,æš‚æ—¶æ¶‰åŠåˆ°RNå‘Webç«¯ä¼ å€¼,Webå‘RNç«¯ä¼ å€¼,å› ä¸ºç°åœ¨è½¬ä¸ºFlutterå¼€å‘,æ‰€ä»¥è¿™ä¸€å—æš‚æ—¶åªèƒ½æ¶‰åŠåˆ°è¿™é‡Œ.å…¶ä¸­çš„Webç«¯é‡‡ç”¨æœ¬åœ°htmlé¡µé¢. æœ¬æ–‡è®¾è®¡çš„äº¤äº’ä¸»è¦é webViewçš„onMessageå’ŒpostMessage.åœ¨RNç«¯å‘é€æ•°æ®ç»™Web,ä¸»è¦ä¾é è°ƒç”¨webViewçš„potsMessageæ–¹æ³•å®ç°,å¦‚: 1this.refs.webview.postMessage(this.data); æ¥æ”¶Webç«¯çš„æ•°æ®é çš„æ˜¯WebViewçš„onMessageæ–¹æ³• 123onMessage=&#123;(e) =&gt; &#123; this.handleMessage(e) &#125;&#125; ä¸‹é¢æ˜¯å®Œæ•´ä»£ç : App.js12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273import React from &#x27;react&#x27;;import &#123; View, Text, StyleSheet, WebView&#125; from &#x27;react-native&#x27;;export default class Web extends React.Component &#123; constructor(props) &#123; super(props); this.state = &#123; webViewData: &#x27;&#x27; &#125; this.data = &#x27;æˆ‘æ˜¯RNä¼ ç»™webç«¯çš„å‚æ•°&#x27;; &#125; sendMessage() &#123; this.refs.webview.postMessage(this.data); &#125; handleMessage(e) &#123; this.setState(&#123;webViewData: e.nativeEvent.data&#125;); &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &#123;/*web*/&#125; &lt;View style=&#123;&#123;width: 375, height: 220&#125;&#125;&gt; &lt;WebView ref=&#123;&#x27;webview&#x27;&#125; source=&#123;require(&#x27;./test.html&#x27;)&#125; style=&#123;&#123;width: 375, height: 220&#125;&#125; onMessage=&#123;(e) =&gt; &#123; this.handleMessage(e) &#125;&#125; /&gt; &lt;/View&gt; &#123;/*RN*/&#125; &lt;Text&gt;æ¥è‡ªwebviewçš„æ•°æ® : &#123;this.state.webViewData&#125;&lt;/Text&gt; &lt;Text onPress=&#123;() =&gt; &#123; this.sendMessage() &#125;&#125;&gt; å‘é€æ•°æ®åˆ°WebView &lt;/Text&gt; &lt;/View&gt; ) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, marginTop: 22, backgroundColor: &#x27;#F5FCFF&#x27;, &#125;,&#125;); è€Œåœ¨htmlé‡Œé¢,éœ€è¦ç›‘å¬æ•°æ®,é€šè¿‡: 123document.addEventListener(&#x27;message&#x27;, function (e) &#123; document.getElementById(&#x27;data&#x27;).textContent = e.data; &#125;); å‘é€æ•°æ®é€šè¿‡: 12window.postMessage(data); å®Œæ•´ä»£ç å¦‚ä¸‹: test.html1234567891011121314151617181920212223242526272829303132333435363738&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;title&gt;&lt;/title&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;&lt;/head&gt;&lt;body&gt;&lt;p style=&quot;text-align: center&quot;&gt; &lt;button id=&quot;button&quot;&gt;å‘é€æ•°æ®åˆ°react native&lt;/button&gt;&lt;p style=&quot;text-align: center&quot;&gt;æ”¶åˆ°react nativeå‘é€çš„æ•°æ®: &lt;span id=&quot;data&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;/p&gt;&lt;script&gt; var data = 0; function sendData(data) &#123; if (window.originalPostMessage) &#123; window.postMessage(data); &#125; else &#123; throw Error(&#x27;postMessageæ¥å£è¿˜æœªæ³¨å…¥&#x27;); &#125; &#125; window.onload = function () &#123; document.addEventListener(&#x27;message&#x27;, function (e) &#123; document.getElementById(&#x27;data&#x27;).textContent = e.data; &#125;); document.getElementById(&#x27;button&#x27;).onclick = function () &#123; data += 11; sendData(data); &#125; &#125;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; æ•ˆæœå›¾: æºç  å¦å¤–:åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­,å¯èƒ½ä¼šç§»é™¤è‡ªå¸¦çš„webView,æ”¹ç”¨åœ¨å¤–éƒ¨åº“é‡Œå¼•ç”¨çš„æ–¹å¼.åŒæ—¶,åœ¨ä¸‰æ–¹åº“ä¸­,ä¹Ÿæœ‰webView-bridgeåº“ä½¿ç”¨,cookieåº“ä½¿ç”¨.react-native-webviewwebView-bridgecookie","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutterè·¯ç”±ç®¡ç†åº“fluroå­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutterè·¯ç”±ç®¡ç†åº“fluroå­¦ä¹ ","date":"2019-03-29T16:00:00.000Z","updated":"2019-04-22T07:56:11.000Z","comments":true,"path":"2019/03/30/ç§»åŠ¨ç«¯å­¦ä¹ /Flutterè·¯ç”±ç®¡ç†åº“fluroå­¦ä¹ /","link":"","permalink":"https://zhoushaoting.com/2019/03/30/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter%E8%B7%AF%E7%94%B1%E7%AE%A1%E7%90%86%E5%BA%93fluro%E5%AD%A6%E4%B9%A0/","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­è·¯ç”±ç®¡ç†åº“ fluroä½¿ç”¨ç‰ˆæœ¬æ˜¯: fluro: &quot;^1.4.0&quot;.","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­è·¯ç”±ç®¡ç†åº“ fluroä½¿ç”¨ç‰ˆæœ¬æ˜¯: fluro: &quot;^1.4.0&quot;. fluro ä»£ç ç»“æ„:é¦–å…ˆ,æ–°å»ºæ–‡ä»¶å¤¹å­˜æ”¾fluroçš„å…³é”®ä»£ç : application.dartapplication.dart,è¯¥æ–‡ä»¶ä¸»è¦æ˜¯ç”Ÿæˆä¸€ä¸ªé™æ€æ–‡ä»¶,æ–¹ä¾¿åé¢ç›´æ¥è°ƒç”¨åˆå§‹åŒ–çš„Routerå¯¹è±¡ 12345import &#x27;package:fluro/fluro.dart&#x27;;class Application &#123; static Router router;&#125; router_handler.dartrouter_handler.dartæ–‡ä»¶,ä¸»è¦è´Ÿè´£è·¯ç”±è·³è½¬,ä»ä»£ç å¯ä»¥çœ‹å‡º,æœ‰ä¸¤ä¸ªhandler,å…¶ä¸­ä¸€ä¸ªéœ€è¦å¸¦ä¸€ä¸ªå‚æ•°paramsId 12345678910111213141516import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:fluro/fluro.dart&#x27;;import &#x27;../pages/detailspage.dart&#x27;;import &#x27;../pages/otherpaage.dart&#x27;;Handler detailsHandle = Handler( handlerFunc: (BuildContext context, Map&lt;String, List&lt;String&gt;&gt; params) &#123; String paramsId = params[&#x27;id&#x27;].first; return DetailsPage(paramsId);&#125;);Handler otherHandle = Handler( handlerFunc: (BuildContext context, Map&lt;String, List&lt;String&gt;&gt; params) &#123; return OtherPage();&#125;); routers.dartrouters.dartè´Ÿè´£å°†ä¸Šé¢åˆ›å»ºå¥½çš„handleæ³¨å†Œè¿›fluro. 12345678910111213141516171819import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:fluro/fluro.dart&#x27;;import &#x27;./router_handler.dart&#x27;;class Routers&#123; static String root = &#x27;/&#x27;; static String detailsPage = &#x27;./detail&#x27;; static String otherPage = &#x27;./other&#x27;; static void configureRouters(Router router)&#123; router.notFoundHandler = new Handler( handlerFunc: (BuildContext context,Map&lt;String,List&lt;String&gt;&gt; params)&#123; print(&#x27;é”™è¯¯è·¯ç”±&#x27;); &#125; ); router.define(detailsPage,handler: detailsHandle); router.define(otherPage,handler: otherHandle); &#125;&#125; ç„¶åéœ€è¦åœ¨é¡¹ç›®å…¥å£å¤„,é…ç½®è‡ªå®šä¹‰è·¯ç”±onGenerateRoute main.dart1234567891011121314151617181920212223242526import &#x27;package:flutter/material.dart&#x27;;import &#x27;tabbar.dart&#x27;;import &#x27;package:fluro/fluro.dart&#x27;;import &#x27;./routers/application.dart&#x27;;import &#x27;./routers/routers.dart&#x27;;void main() =&gt; runApp(MyApp());class MyApp extends StatelessWidget &#123; // This widget is the root of your application. @override Widget build(BuildContext context) &#123; final router =Router(); Routers.configureRouters(router); Application.router = router; return MaterialApp( title: &#x27;Flutter Demo&#x27;, onGenerateRoute: Application.router.generator, theme: ThemeData( primarySwatch: Colors.blue, ), home: Tabbar(), ); &#125;&#125; é…ç½®å¥½åå¯ä»¥åœ¨éœ€è¦è·³è½¬çš„æ–¹æ³•è·³è½¬,åŒæ—¶å¯ä»¥é…ç½®pushæ–¹å‘ç­‰.å¦‚: 12Application.router.navigateTo(context, &quot;./detail?id=$&#123;dataList[index]&#125;&quot;, transition: TransitionType.inFromLeft); ä¸‹é¢æ˜¯é¡µé¢ä¸­çš„æ‰€æœ‰ä»£ç : homepage.dart12345678910111213141516171819202122232425262728293031323334353637383940414243444546import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:fluro/fluro.dart&#x27;;import &#x27;../routers/application.dart&#x27;;class Homepage extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar(title: Text(&#x27;HomePage&#x27;)), body: HomeContainer(), ); &#125;&#125;class HomeContainer extends StatefulWidget &#123; @override _HomeContainerState createState() =&gt; _HomeContainerState();&#125;class _HomeContainerState extends State&lt;HomeContainer&gt; &#123; List&lt;String&gt; dataList = []; @override void initState() &#123; super.initState(); for (var i = 0; i &lt; 100; i++) &#123; dataList.add(i.toString()); &#125; &#125; @override Widget build(BuildContext context) &#123; return ListView.builder( itemCount: dataList.length, itemBuilder: (context, index) &#123; return ListTile( onTap: ()&#123; Application.router.navigateTo(context, &quot;./detail?id=$&#123;dataList[index]&#125;&quot;, transition: TransitionType.inFromLeft); &#125;, title: Text(dataList[index] + &#x27;ğŸ‘Œ&#x27;), ); &#125;, ); &#125;&#125; Showpage.dart12345678910111213141516171819202122import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:fluro/fluro.dart&#x27;;import &#x27;../routers/application.dart&#x27;;class Showpage extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar(title: Text(&#x27;SHOW&#x27;)), body: Center( child: RaisedButton( onPressed: ()&#123; Application.router.navigateTo(context, &quot;./other&quot;, transition: TransitionType.nativeModal); &#125;, child: Text(&#x27;è·³è½¬&#x27;), ), ), ); &#125;&#125; minepage.dart1234567891011121314import &#x27;package:flutter/material.dart&#x27;;class Minepage extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar(title: Text(&#x27;Minepage&#x27;)), body: Center( child: Text(&#x27;Minepage&#x27;), ), ); &#125;&#125; æ•ˆæœå¦‚å›¾: æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutter~flutter_blocåº“å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~flutter_blocåº“å­¦ä¹ ","date":"2019-03-06T16:00:00.000Z","updated":"2019-09-11T09:55:44.000Z","comments":true,"path":"2019/03/07/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~flutter_blocåº“å­¦ä¹ /","link":"","permalink":"https://zhoushaoting.com/2019/03/07/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter~flutter_bloc%E5%BA%93%E5%AD%A6%E4%B9%A0/","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†åº“ blocä¸‹çš„flutter_blocä½¿ç”¨ç‰ˆæœ¬æ˜¯:flutter_bloc 0.7.0.","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†åº“ blocä¸‹çš„flutter_blocä½¿ç”¨ç‰ˆæœ¬æ˜¯:flutter_bloc 0.7.0. blocflutter_bloc ä»£ç ç»“æ„: main.dart123456789101112131415161718192021222324252627import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:flutter_bloc_demo/top_screen.dart&#x27;;void main() =&gt; runApp(MyApp());class MyApp extends StatelessWidget &#123; // This widget is the root of your application. @override Widget build(BuildContext context) &#123; return MaterialApp( title: &#x27;Flutter Demo&#x27;, theme: ThemeData( // This is the theme of your application. // // Try running your application with &quot;flutter run&quot;. You&#x27;ll see the // application has a blue toolbar. Then, without quitting the app, try // changing the primarySwatch below to Colors.green and then invoke // &quot;hot reload&quot; (press &quot;r&quot; in the console where you ran &quot;flutter run&quot;, // or simply save your changes to &quot;hot reload&quot; in a Flutter IDE). // Notice that the counter didn&#x27;t reset back to zero; the application // is not restarted. primarySwatch: Colors.blue, ), home: TopScreen() ); &#125;&#125; top_screen.dart12345678910111213141516171819202122232425import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:flutter_bloc_demo/bloc/counter_bloc.dart&#x27;;import &#x27;package:flutter_bloc/flutter_bloc.dart&#x27;;import &#x27;tabbar.dart&#x27;;class TopScreen extends StatefulWidget &#123; @override _TopScreenState createState() =&gt; _TopScreenState();&#125;class _TopScreenState extends State&lt;TopScreen&gt; &#123; final CounterBloc _counterBloc = CounterBloc(); @override Widget build(BuildContext context) &#123; return MaterialApp( title: &#x27;Flutter Demo&#x27;, home: BlocProvider&lt;CounterBloc&gt;( bloc: _counterBloc, child: Tabbar(), ), ); &#125;&#125; tabbar.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:flutter_bloc_demo/pages/one.dart&#x27;;import &#x27;package:flutter_bloc_demo/pages/Two.dart&#x27;; class Tabbar extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return new MaterialApp( debugShowCheckedModeBanner: false, home: new MainPageWidget()); &#125;&#125; class MainPageWidget extends StatefulWidget &#123; @override State&lt;StatefulWidget&gt; createState() &#123; return new MainPageState(); &#125;&#125; class MainPageState extends State&lt;MainPageWidget&gt; &#123; int _tabIndex = 0; var tabImages; var appBarTitles = [&#x27;å£¹&#x27;, &#x27;è´°&#x27;,]; /* * å­˜æ”¾è€Œä¸ªé¡µé¢ï¼Œè·ŸfragmentListä¸€æ · */ var _pageList; /* * æ ¹æ®é€‰æ‹©è·å¾—å¯¹åº”çš„normalæˆ–æ˜¯pressçš„icon */ Image getTabIcon(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return tabImages[curIndex][1]; &#125; return tabImages[curIndex][0]; &#125; /* * è·å–bottomTabçš„é¢œè‰²å’Œæ–‡å­— */ Text getTabTitle(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff1296db))); &#125; else &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff515151))); &#125; &#125; /* * æ ¹æ®imageè·¯å¾„è·å–å›¾ç‰‡ */ Image getTabImage(path) &#123; return new Image.asset(path, width: 24.0, height: 24.0); &#125; void initData() &#123; /* * åˆå§‹åŒ–é€‰ä¸­å’Œæœªé€‰ä¸­çš„icon */ tabImages = [ [getTabImage(&#x27;images/tab/one.png&#x27;), getTabImage(&#x27;images/tab/one_active.png&#x27;)], [getTabImage(&#x27;images/tab/two.png&#x27;), getTabImage(&#x27;images/tab/two_active.png&#x27;)], ]; /* * 2ä¸ªå­ç•Œé¢ */ _pageList = [ new One(), new Two(), ]; &#125; @override Widget build(BuildContext context) &#123; //åˆå§‹åŒ–æ•°æ® initData(); return Scaffold( body: _pageList[_tabIndex], bottomNavigationBar: new BottomNavigationBar( items: &lt;BottomNavigationBarItem&gt;[ new BottomNavigationBarItem( icon: getTabIcon(0), title: getTabTitle(0)), new BottomNavigationBarItem( icon: getTabIcon(1), title: getTabTitle(1)), ], type: BottomNavigationBarType.fixed, //é»˜è®¤é€‰ä¸­é¦–é¡µ currentIndex: _tabIndex, iconSize: 24.0, //ç‚¹å‡»äº‹ä»¶ onTap: (index) &#123; setState(() &#123; _tabIndex = index; &#125;); &#125;, )); &#125;&#125; one.dart12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:flutter_bloc_demo/bloc/counter_bloc.dart&#x27;;import &#x27;package:flutter_bloc/flutter_bloc.dart&#x27;;class One extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; final CounterBloc _counterBloc = BlocProvider.of&lt;CounterBloc&gt;(context); return Scaffold( appBar: AppBar(title: Text(&#x27;One&#x27;)), body: BlocBuilder&lt;CounterEvent, int&gt;( bloc: _counterBloc, builder: (BuildContext context, int count) &#123; return Center( child: Text( &#x27;$count&#x27;, style: TextStyle(fontSize: 24.0), ), ); &#125;, ), floatingActionButton: Column( crossAxisAlignment: CrossAxisAlignment.end, mainAxisAlignment: MainAxisAlignment.end, children: &lt;Widget&gt;[ Padding( padding: EdgeInsets.symmetric(vertical: 5.0), child: FloatingActionButton( child: Icon(Icons.add), onPressed: () &#123; _counterBloc.dispatch(CounterEvent.increment); &#125;, ), ), Padding( padding: EdgeInsets.symmetric(vertical: 5.0), child: FloatingActionButton( child: Icon(Icons.remove), onPressed: () &#123; _counterBloc.dispatch(CounterEvent.decrement); &#125;, ), ), ], ), ); &#125;&#125; two.dart12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:flutter_bloc_demo/bloc/counter_bloc.dart&#x27;;import &#x27;package:flutter_bloc/flutter_bloc.dart&#x27;;class Two extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; final CounterBloc _counterBloc = BlocProvider.of&lt;CounterBloc&gt;(context); return Scaffold( appBar: AppBar(title: Text(&#x27;Two&#x27;)), body: BlocBuilder&lt;CounterEvent, int&gt;( bloc: _counterBloc, builder: (BuildContext context, int count) &#123; return Center( child: Text( &#x27;$count&#x27;, style: TextStyle(fontSize: 24.0), ), ); &#125;, ), floatingActionButton: Column( crossAxisAlignment: CrossAxisAlignment.end, mainAxisAlignment: MainAxisAlignment.end, children: &lt;Widget&gt;[ Padding( padding: EdgeInsets.symmetric(vertical: 5.0), child: FloatingActionButton( child: Icon(Icons.remove), onPressed: () &#123; _counterBloc.dispatch(CounterEvent.decrement); &#125;, ), ), Padding( padding: EdgeInsets.symmetric(vertical: 5.0), child: FloatingActionButton( child: Icon(Icons.add), onPressed: () &#123; _counterBloc.dispatch(CounterEvent.increment); &#125;, ), ), ], ), ); &#125;&#125; counter_bloc.dart123456789101112131415161718192021import &#x27;package:bloc/bloc.dart&#x27;;enum CounterEvent &#123; increment, decrement &#125;class CounterBloc extends Bloc&lt;CounterEvent, int&gt; &#123; @override int get initialState =&gt; 0; @override Stream&lt;int&gt; mapEventToState(int currentState, CounterEvent event) async* &#123; switch (event) &#123; case CounterEvent.decrement: yield currentState - 1; break; case CounterEvent.increment: yield currentState + 1; break; &#125; &#125;&#125; æ•ˆæœå¦‚å›¾: æºç  å¦å¤–:å…¶ä»–ç®¡ç†åº“å­¦ä¹  å¦å¤–:Flutterå­¦ä¹ demo","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutter~json_serializableåº“å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~json_serializableåº“å­¦ä¹ ","date":"2019-03-05T16:00:00.000Z","updated":"2019-04-22T07:55:30.000Z","comments":true,"path":"2019/03/06/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~json_serializableåº“å­¦ä¹ /","link":"","permalink":"https://zhoushaoting.com/2019/03/06/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter~json_serializable%E5%BA%93%E5%AD%A6%E4%B9%A0/","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­å®ä½“ç±»ä¸‰æ–¹åº“json_serializable.å…¶ä¸­,json_serializable: ^2.0.0,json_annotation: ^2.0.0,build_runner: ^1.0.0","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­å®ä½“ç±»ä¸‰æ–¹åº“json_serializable.å…¶ä¸­,json_serializable: ^2.0.0,json_annotation: ^2.0.0,build_runner: ^1.0.0 1ã€é¦–å…ˆ,æ–°å»ºä¸€ä¸ªFlutteré¡¹ç›®,å¼•å…¥dioç½‘ç»œè¯·æ±‚åº“,æŒ‰ç…§json_serializableçš„è¯´æ˜,åˆ†åˆ«åœ¨dependenciesä¸‹å¼•å…¥json_annotation,åœ¨dev_dependenciesä¸‹å¼•å…¥json_serializableå’Œbuild_runner(build_runneræ˜¯dartå›¢é˜Ÿæä¾›çš„ä¸€ä¸ªç”Ÿæˆdartä»£ç æ–‡ä»¶çš„å¤–éƒ¨åŒ…).2ã€åœ¨main.darté‡Œé¢å†™ä¸€ä¸ªç½‘ç»œè¯·æ±‚. main.dart1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:dio/dio.dart&#x27;;import &#x27;dart:async&#x27;;import &#x27;package:json_demo/Data.dart&#x27;;// flutter packages pub run build_runner buildvoid main() =&gt; runApp(MyApp());class MyApp extends StatelessWidget &#123; // This widget is the root of your application. @override Widget build(BuildContext context) &#123; return MaterialApp( title: &#x27;Flutter Demo&#x27;, theme: ThemeData( primarySwatch: Colors.blue, ), home: DataToModel(), ); &#125;&#125;class DataToModel extends StatefulWidget &#123; final Widget child; DataToModel(&#123;Key key, this.child&#125;) : super(key: key); _DataToModelState createState() =&gt; _DataToModelState();&#125;class _DataToModelState extends State&lt;DataToModel&gt; &#123; Future getHomePageContent() async &#123; try &#123; print(&#x27;å¼€å§‹è·å–é¦–é¡µæ•°æ®&#x27;); Response response; Dio dio = new Dio(); response = await dio.get(&#x27;http://gank.io/api/data/%E7%A6%8F%E5%88%A9/10/1&#x27;); if (response.statusCode == 200) &#123; return response.data; &#125; else &#123; throw Exception(&#x27;åç«¯æ¥å£å‡ºç°å¼‚å¸¸&#x27;); &#125; &#125; catch (e) &#123; print(&#x27;ERROR å‘ç”Ÿé”™è¯¯ğŸ‘‡&#x27;); return print(e); &#125;&#125; @override void initState() &#123; super.initState(); getHomePageContent().then((val) &#123; Data dd = Data.fromJson(val); print(dd.error); // æ•°ç»„ print(dd.results); // æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ :map print(dd.results[0].createdAt); print(dd.results[0].desc); print(dd.results[0].publishedAt); print(dd.results[0].source); print(dd.results[0].type); print(dd.results[0].url); print(dd.results[0].used); print(dd.results[0].who); &#125;); &#125; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar(title: Text(&#x27;json_serializable&#x27;)), body: Text(&#x27;json_serializable&#x27;), ); &#125;&#125; è¿™é‡Œçš„æ¥å£,ç½‘ä¸Šéšæ„æ‰¾ä¸€ä¸ª: http://gank.io/api/data/%E7%A6%8F%E5%88%A9/10/1å¤§è‡´ç»“æ„å¦‚å›¾:3ã€ç„¶åæ ¹æ®è¿”å›æ•°æ®,ä¹¦å†™ä¸¤ä¸ªdartæ–‡ä»¶,Data.dartæ˜¯å¤–éƒ¨map,Dic.dartæ˜¯å†…éƒ¨çš„List. Data.dart123456789101112131415import &#x27;package:json_annotation/json_annotation.dart&#x27;;import &#x27;package:json_demo/Dic.dart&#x27;;part &#x27;Data.g.dart&#x27;;@JsonSerializable()class Data&#123; bool error; List&lt;Dic&gt; results; Data(this.error,this.results); //ååºåˆ—åŒ– factory Data.fromJson(Map&lt;String, dynamic&gt; json) =&gt; _$DataFromJson(json); //åºåˆ—åŒ– Map&lt;String, dynamic&gt; toJson() =&gt; _$DataToJson(this); &#125; Dic.dart12345678910111213141516171819202122import &#x27;package:json_annotation/json_annotation.dart&#x27;;part &#x27;Dic.g.dart&#x27;;@JsonSerializable()class Dic&#123; final String createdAt; final String desc; final String publishedAt; final String source; final String type; final String url; final bool used; final String who; Dic(&#123;this.createdAt, this.desc, this.publishedAt, this.source, this.type, this.url, this.used, this.who&#125;); //ååºåˆ—åŒ– factory Dic.fromJson(Map&lt;String, dynamic&gt; json) =&gt; _$DicFromJson(json); //åºåˆ—åŒ– Map&lt;String, dynamic&gt; toJson() =&gt; _$DicToJson(this); &#125; ç„¶å,ideä¼šæŠ¥å‡ ä¸ªé”™è¯¯,è¿™ä¸ªä¸ç”¨ç®¡,é‚£æ˜¯å°šæœªç”Ÿæˆè§£ææ–‡ä»¶çš„åŸå› . 4ã€ç„¶å,ç»ˆç«¯ cd åˆ°é¡¹ç›®æ ¹ç›®å½•,å›è½¦,æ‰§è¡Œå‘½ä»¤flutter packages pub run build_runner build,ä¼šç”Ÿæˆå¯¹åº”çš„è§£ææ–‡ä»¶. 5ã€ok,æ’¸å¥½ä¹‹å,è¾“å‡ºçœ‹ä¸€ä¸‹ 1234567891011121314Data dd = Data.fromJson(val); print(dd.error); // æ•°ç»„ print(dd.results); // æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ :map print(dd.results[0].createdAt); print(dd.results[0].desc); print(dd.results[0].publishedAt); print(dd.results[0].source); print(dd.results[0].type); print(dd.results[0].url); print(dd.results[0].used); print(dd.results[0].who); æ€»ç»“:ä»¥ä¸Šå°±æ˜¯å¯¹flutterä¸­å®ä½“ç±»åº“json_serializableçš„ç®€å•å­¦ä¹ ,èº«è¾¹å¤§ä½¬æœ‰çš„è¯´å¾ˆæœ‰å¿…è¦,å› ä¸ºè§„èŒƒç‚¹,æ— è§„çŸ©ä¸æˆä¸‰è§’å½¢,æœ‰äº†å®ä½“ç±»æ–¹ä¾¿ç»´æŠ¤,æœ¬æ¥åŸç”Ÿå°±æ˜¯è¯¥æœ‰modelçš„,è¿™æ ·ä¸å®¹æ˜“å‡ºç°å–å€¼é”™è¯¯å’Œå…¶ä»–é—®é¢˜;æœ‰çš„å¤§ä½¬è¯´æ²¡å•¥å¿…è¦,æœ‰ç‚¹ç¹çäº†.æˆ‘ä¹Ÿä¸çŸ¥é“è°ç¼©çš„å¯¹,ä½†æ˜¯å­¦ä¸‹æ€»æ²¡é”™,å°±åƒé²è¿…è¯´çš„é‚£æ ·â€äººæ´»ç€ä»€ä¹ˆæœ€é‡è¦,è‚¯å®šæ˜¯å¼€å¿ƒè¾£â€. ç½‘ä¸Šè¿˜æœ‰å…¶ä»–çš„æ–¹æ¡ˆ:a. android studio å®‰è£…æ’ä»¶ dart_json_formatb. https://github.com/debuggerx01/JSONFormat4Flutterc. ä¸€ä¸ªåœ¨çº¿è½¬æ¢å·¥å…·: https://javiercbk.github.io/json_to_dart/ æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutterä¸­çš„sqfliteåº“å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutterä¸­çš„sqfliteåº“å­¦ä¹ ","date":"2019-03-03T16:00:00.000Z","updated":"2019-03-04T16:02:42.000Z","comments":true,"path":"2019/03/04/ç§»åŠ¨ç«¯å­¦ä¹ /Flutterä¸­çš„sqfliteåº“å­¦ä¹ /","link":"","permalink":"https://zhoushaoting.com/2019/03/04/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter%E4%B8%AD%E7%9A%84sqflite%E5%BA%93%E5%AD%A6%E4%B9%A0/","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­SQLiteæ•°æ®åº“ç¬¬ä¸‰æ–¹sqflite.å…¶ä¸­, sqflite: ^1.1.0","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­SQLiteæ•°æ®åº“ç¬¬ä¸‰æ–¹sqflite.å…¶ä¸­, sqflite: ^1.1.0 æ¶‰åŠ æ•°æ®åº“çš„åˆ›å»º è¡¨çš„åˆ›å»º å¢åˆ æ”¹æŸ¥æ“ä½œ å…³é—­æ•°æ®åº“ åˆ é™¤æ•°æ®åº“ main.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:sqflite/sqflite.dart&#x27;;import &#x27;package:path/path.dart&#x27;;void main() =&gt; runApp(MyApp());class MyApp extends StatelessWidget &#123; // This widget is the root of your application. @override Widget build(BuildContext context) &#123; return MaterialApp( title: &#x27;Flutter Demo&#x27;, theme: ThemeData( // This is the theme of your application. // // Try running your application with &quot;flutter run&quot;. You&#x27;ll see the // application has a blue toolbar. Then, without quitting the app, try // changing the primarySwatch below to Colors.green and then invoke // &quot;hot reload&quot; (press &quot;r&quot; in the console where you ran &quot;flutter run&quot;, // or simply save your changes to &quot;hot reload&quot; in a Flutter IDE). // Notice that the counter didn&#x27;t reset back to zero; the application // is not restarted. primarySwatch: Colors.blue, ), home: CRUD(), ); &#125;&#125;class CRUD extends StatefulWidget &#123; final Widget child; CRUD(&#123;Key key, this.child&#125;) : super(key: key); _CRUDState createState() =&gt; _CRUDState();&#125;class _CRUDState extends State&lt;CRUD&gt; &#123; Database db; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar(title: Text(&#x27;æ•°ç»„åº“-å¢åˆ æ”¹æŸ¥&#x27;)), body: SingleChildScrollView( child: Column( children: &lt;Widget&gt;[ OutlineButton(child: Text(&#x27;åˆ›å»ºæ•°æ®åº“å’Œä¸€å¼ è¡¨&#x27;), onPressed: _createTable), OutlineButton(child: Text(&#x27;æŸ¥è¯¢æ•°æ®&#x27;), onPressed: _queryData), OutlineButton(child: Text(&#x27;æ’å…¥æ•°æ®&#x27;), onPressed: _insertData), OutlineButton(child: Text(&#x27;æ›´æ–°æ•°æ®&#x27;), onPressed: _updateData), OutlineButton(child: Text(&#x27;åˆ é™¤æ•°æ®&#x27;), onPressed: _deleteData), OutlineButton(child: Text(&#x27;å…³é—­æ•°æ®åº“&#x27;), onPressed: _closeData), OutlineButton(child: Text(&#x27;åˆ é™¤æ•°æ®åº“&#x27;), onPressed: _deleteTable), ], ), ), ); &#125; // åˆ›å»ºæ•°æ®åº“ å’Œ è¡¨ void _createTable() async &#123; // è·å–æ•°æ®åº“æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ var databasesPath = await getDatabasesPath(); String path = join(databasesPath, &#x27;demo.db&#x27;); //æ ¹æ®æ•°æ®åº“æ–‡ä»¶è·¯å¾„å’Œæ•°æ®åº“ç‰ˆæœ¬å·åˆ›å»ºæ•°æ®åº“è¡¨ db = await openDatabase(path, version: 1, onCreate: (Database db, int version) async &#123; await db.execute( &#x27;CREATE TABLE Test (id INTEGER PRIMARY KEY, name TEXT, value INTEGER, num REAL)&#x27;); &#125;); print(&#x27;åˆ›å»ºæ•°æ®åº“ å’Œ è¡¨&#x27;); &#125; // å¢ void _insertData() async &#123; await db.transaction((txn) async &#123; await txn.rawInsert(&#x27;INSERT INTO Test(name, value, num) VALUES(?, ?, ?)&#x27;, [&#x27;flutter==&gt;&#x27;, 0101010101001, 1111111111111111111]); print(&#x27;æ’å…¥æ•°æ®&#x27;); &#125;); &#125; // åˆ  void _deleteData() async &#123; await db.rawDelete(&#x27;DELETE FROM Test WHERE name = ?&#x27;, [&#x27;updated name&#x27;]); print(&#x27;åˆ é™¤&#x27;); &#125; // æ”¹ void _updateData() async &#123; await db.rawUpdate( &#x27;UPDATE Test SET name = ?, VALUE = ?,num = ? &#x27;, [&#x27;updated name&#x27;, 0,1]); print(&#x27;ä¿®æ”¹&#x27;); &#125; // æŸ¥ void _queryData() async &#123; List&lt;Map&gt; maps = await db.query(&#x27;Test&#x27;); print(maps); &#125; // å…³é—­æ•°æ®åº“ void _closeData() async &#123; await db.close(); print(&#x27;å…³é—­æ•°æ®åº“&#x27;); &#125; // åˆ é™¤æ•°æ®åº“ void _deleteTable() async &#123; var databasesPath = await getDatabasesPath(); String path = join(databasesPath, &#x27;demo.db&#x27;); await deleteDatabase(path); print(&#x27;åˆ é™¤æ•°æ®åº“&#x27;); &#125;&#125; æ•ˆæœå›¾: æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutter~provideå­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~provideå­¦ä¹ ","date":"2019-03-02T16:00:00.000Z","updated":"2019-09-11T09:57:23.000Z","comments":true,"path":"2019/03/03/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~provideå­¦ä¹ /","link":"","permalink":"https://zhoushaoting.com/2019/03/03/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter~provide%E5%AD%A6%E4%B9%A0/","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹provide.å…¶ä¸­,provide: ^1.0.2","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹provide.å…¶ä¸­,provide: ^1.0.2 ä»£ç ç»“æ„å¦‚å›¾æ‰€ç¤º: ä¸‹é¢æ˜¯å„æ–‡ä»¶çš„æºç .main.dart1234567891011121314151617181920212223242526272829303132333435363738import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:provide_demo/tabbar.dart&#x27;;import &#x27;package:provide/provide.dart&#x27;;import &#x27;package:provide_demo/model/counter.dart&#x27;;void main() &#123; var counter = Counter(); var providers = Providers(); providers ..provide(Provider&lt;Counter&gt;.value(counter)); runApp(ProviderNode(child: MyApp(), providers: providers));&#125;class MyApp extends StatelessWidget &#123; // This widget is the root of your application. @override Widget build(BuildContext context) &#123; return MaterialApp( title: &#x27;Flutter Demo&#x27;, theme: ThemeData( // This is the theme of your application. // // Try running your application with &quot;flutter run&quot;. You&#x27;ll see the // application has a blue toolbar. Then, without quitting the app, try // changing the primarySwatch below to Colors.green and then invoke // &quot;hot reload&quot; (press &quot;r&quot; in the console where you ran &quot;flutter run&quot;, // or simply save your changes to &quot;hot reload&quot; in a Flutter IDE). // Notice that the counter didn&#x27;t reset back to zero; the application // is not restarted. primarySwatch: Colors.blue, ), home: Tabbar(), ); &#125;&#125; tabbar.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102import &#x27;package:flutter/material.dart&#x27;;import &#x27;One/one.dart&#x27;;import &#x27;Two/two.dart&#x27;; class Tabbar extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return new MaterialApp( debugShowCheckedModeBanner: false, home: new MainPageWidget()); &#125;&#125; class MainPageWidget extends StatefulWidget &#123; @override State&lt;StatefulWidget&gt; createState() &#123; return new MainPageState(); &#125;&#125; class MainPageState extends State&lt;MainPageWidget&gt; &#123; int _tabIndex = 0; var tabImages; var appBarTitles = [&#x27;One&#x27;, &#x27;Two&#x27;]; /* * å­˜æ”¾äºŒä¸ªé¡µé¢ï¼Œè·ŸfragmentListä¸€æ · */ var _pageList; /* * æ ¹æ®é€‰æ‹©è·å¾—å¯¹åº”çš„normalæˆ–æ˜¯pressçš„icon */ Image getTabIcon(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return tabImages[curIndex][1]; &#125; return tabImages[curIndex][0]; &#125; /* * è·å–bottomTabçš„é¢œè‰²å’Œæ–‡å­— */ Text getTabTitle(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff1296db))); &#125; else &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff515151))); &#125; &#125; /* * æ ¹æ®imageè·¯å¾„è·å–å›¾ç‰‡ */ Image getTabImage(path) &#123; return new Image.asset(path, width: 24.0, height: 24.0); &#125; void initData() &#123; /* * åˆå§‹åŒ–é€‰ä¸­å’Œæœªé€‰ä¸­çš„icon */ tabImages = [ [getTabImage(&#x27;images/tab/one.png&#x27;), getTabImage(&#x27;images/tab/one_active.png&#x27;)], [getTabImage(&#x27;images/tab/two.png&#x27;), getTabImage(&#x27;images/tab/two_active.png&#x27;)], ]; /* * å­ç•Œé¢ */ _pageList = [ new One(), new Two(), ]; &#125; @override Widget build(BuildContext context) &#123; //åˆå§‹åŒ–æ•°æ® initData(); return Scaffold( body: _pageList[_tabIndex], bottomNavigationBar: new BottomNavigationBar( items: &lt;BottomNavigationBarItem&gt;[ new BottomNavigationBarItem( icon: getTabIcon(0), title: getTabTitle(0)), new BottomNavigationBarItem( icon: getTabIcon(1), title: getTabTitle(1)), ], type: BottomNavigationBarType.fixed, //é»˜è®¤é€‰ä¸­é¦–é¡µ currentIndex: _tabIndex, iconSize: 24.0, //ç‚¹å‡»äº‹ä»¶ onTap: (index) &#123; setState(() &#123; _tabIndex = index; &#125;); &#125;, )); &#125;&#125; counter.dart12345678910import &#x27;package:flutter/material.dart&#x27;;class Counter with ChangeNotifier&#123; int value = 0; increment()&#123; value++; notifyListeners(); &#125;&#125; one.dart123456789101112131415161718192021222324252627282930313233import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:provide/provide.dart&#x27;;import &#x27;package:provide_demo/model/counter.dart&#x27;;class One extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar(title: Text(&#x27;One&#x27;)), body: Padding( padding: EdgeInsets.only(top: 400.0,left: 200.0), child: Column( children: &lt;Widget&gt;[ Provide&lt;Counter&gt;( builder: (context, child, counter) &#123; return Text( &#x27;$&#123;counter.value&#125;&#x27;, ); &#125;, ), IconButton( icon: Icon(Icons.add), onPressed: () &#123; Provide.value&lt;Counter&gt;(context).increment(); &#125;, ), ], ), ), ); &#125;&#125; two.dart12345678910111213141516171819202122import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:provide/provide.dart&#x27;;import &#x27;package:provide_demo/model/counter.dart&#x27;;class Two extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar(title: Text(&#x27;Two&#x27;)), body: Center( child: Provide&lt;Counter&gt;( builder: (context, child, counter) &#123; return Text( &#x27;$&#123;counter.value&#125;&#x27;, ); &#125;, ), ), ); &#125;&#125; æ•ˆæœå›¾: æºç  å¦å¤–:å…¶ä»–ç®¡ç†åº“å­¦ä¹  å¦å¤–:Flutterå­¦ä¹ demo","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutter~reduxå­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~reduxå­¦ä¹ ","date":"2019-02-16T16:00:00.000Z","updated":"2019-09-11T09:58:11.000Z","comments":true,"path":"2019/02/17/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~reduxå­¦ä¹ /","link":"","permalink":"https://zhoushaoting.com/2019/02/17/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter~redux%E5%AD%A6%E4%B9%A0/","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹redux.å…¶ä¸­,redux: 3.0.0 flutter_redux: 0.5.3","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹redux.å…¶ä¸­,redux: 3.0.0 flutter_redux: 0.5.3 ä»£ç ç»“æ„å¦‚å›¾æ‰€ç¤º: ä¸‹é¢æ˜¯å„æ–‡ä»¶çš„æºç .main.dart12345678910111213141516171819202122232425262728293031import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:flutter_redux/flutter_redux.dart&#x27;;import &#x27;package:redux/redux.dart&#x27;;import &#x27;package:redux_demo/model/count_state.dart&#x27;;import &#x27;package:redux_demo/top_screen.dart&#x27;;void main() &#123; final store = Store&lt;CountState&gt;(reducer, initialState: CountState.initState()); runApp(new MyApp(store));&#125;class MyApp extends StatelessWidget &#123; final Store&lt;CountState&gt; store; MyApp(this.store); @override Widget build(BuildContext context) &#123; return StoreProvider&lt;CountState&gt;( store: store, child: new MaterialApp( title: &#x27;Flutter Demo&#x27;, theme: new ThemeData( primarySwatch: Colors.blue, ), home: TopScreen(), ), ); &#125;&#125; tabbar.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:redux_demo/one/one.dart&#x27;;import &#x27;package:redux_demo/two/two.dart&#x27;;class Tabbar extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return new MaterialApp( debugShowCheckedModeBanner: false, home: new MainPageWidget()); &#125;&#125;class MainPageWidget extends StatefulWidget &#123; @override State&lt;StatefulWidget&gt; createState() &#123; return new MainPageState(); &#125;&#125;class MainPageState extends State&lt;MainPageWidget&gt; &#123; int _tabIndex = 0; var tabImages; var appBarTitles = [&#x27;One&#x27;, &#x27;Two&#x27;]; /* * å­˜æ”¾äºŒä¸ªé¡µé¢ï¼Œè·ŸfragmentListä¸€æ · */ var _pageList; /* * æ ¹æ®é€‰æ‹©è·å¾—å¯¹åº”çš„normalæˆ–æ˜¯pressçš„icon */ Image getTabIcon(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return tabImages[curIndex][1]; &#125; return tabImages[curIndex][0]; &#125; /* * è·å–bottomTabçš„é¢œè‰²å’Œæ–‡å­— */ Text getTabTitle(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff1296db))); &#125; else &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff515151))); &#125; &#125; /* * æ ¹æ®imageè·¯å¾„è·å–å›¾ç‰‡ */ Image getTabImage(path) &#123; return new Image.asset(path, width: 24.0, height: 24.0); &#125; void initData() &#123; /* * åˆå§‹åŒ–é€‰ä¸­å’Œæœªé€‰ä¸­çš„icon */ tabImages = [ [ getTabImage(&#x27;images/tab/one.png&#x27;), getTabImage(&#x27;images/tab/one_active.png&#x27;) ], [ getTabImage(&#x27;images/tab/two.png&#x27;), getTabImage(&#x27;images/tab/two_active.png&#x27;) ], ]; /* * å­ç•Œé¢ */ _pageList = [ new One(), new Two(), ]; &#125; @override Widget build(BuildContext context) &#123; //åˆå§‹åŒ–æ•°æ® initData(); return Scaffold( body: _pageList[_tabIndex], bottomNavigationBar: new BottomNavigationBar( items: &lt;BottomNavigationBarItem&gt;[ new BottomNavigationBarItem( icon: getTabIcon(0), title: getTabTitle(0)), new BottomNavigationBarItem( icon: getTabIcon(1), title: getTabTitle(1)), ], type: BottomNavigationBarType.fixed, //é»˜è®¤é€‰ä¸­é¦–é¡µ currentIndex: _tabIndex, iconSize: 24.0, //ç‚¹å‡»äº‹ä»¶ onTap: (index) &#123; setState( () &#123; _tabIndex = index; &#125;, ); &#125;, ), ); &#125;&#125; top_screen.dart123456789101112131415import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:redux_demo/tabbar.dart&#x27;;class TopScreen extends StatefulWidget &#123; @override _TopScreenState createState() =&gt; _TopScreenState();&#125;class _TopScreenState extends State&lt;TopScreen&gt; &#123; @override Widget build(BuildContext context) &#123; return Tabbar(); &#125;&#125; count_state.dart1234567891011121314151617181920212223242526272829303132import &#x27;package:meta/meta.dart&#x27;;/* * Stateä¸­æ‰€æœ‰å±æ€§éƒ½åº”è¯¥æ˜¯åªè¯»çš„ */@immutableclass CountState &#123; final int _count; get count =&gt; _count; CountState(this._count); CountState.initState() : _count = 0;&#125;/* * å®šä¹‰æ“ä½œè¯¥Stateçš„å…¨éƒ¨Action * è¿™é‡Œåªæœ‰å¢åŠ countä¸€ä¸ªåŠ¨ä½œ */enum Action &#123; increment &#125;/* * reducerä¼šæ ¹æ®ä¼ è¿›æ¥çš„actionç”Ÿæˆæ–°çš„CountState */CountState reducer(CountState state, action) &#123; //åŒ¹é…Action if (action == Action.increment) &#123; return CountState(state.count + 1); &#125; return state;&#125; one.dart12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:flutter_redux/flutter_redux.dart&#x27;;import &#x27;package:redux_demo/model/count_state.dart&#x27;;class One extends StatefulWidget &#123; @override _OneState createState() =&gt; _OneState();&#125;class _OneState extends State&lt;One&gt; &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar( title: Text(&#x27;one Screen&#x27;), ), body: Center( child: new Column( mainAxisAlignment: MainAxisAlignment.center, children: &lt;Widget&gt;[ new Text( &#x27;You have pushed the button this many times:&#x27;, ), StoreConnector&lt;CountState,int&gt;( converter: (store) =&gt; store.state.count, builder: (context, count) &#123; return Text( count.toString(), style: Theme.of(context).textTheme.display1, ); &#125;, ), ], ), ), floatingActionButton: StoreConnector&lt;CountState,VoidCallback&gt;( converter: (store) &#123; return () =&gt; store.dispatch(Action.increment); &#125;, builder: (context, callback) &#123; return FloatingActionButton( onPressed: callback, child: Icon(Icons.add), ); &#125;, ), ); &#125;&#125; two.dart12345678910111213141516171819202122232425262728293031import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:flutter_redux/flutter_redux.dart&#x27;;import &#x27;package:redux_demo/model/count_state.dart&#x27;;class Two extends StatefulWidget &#123; @override _TwoState createState() =&gt; _TwoState();&#125;class _TwoState extends State&lt;Two&gt; &#123; @override Widget build(BuildContext context) &#123; return Scaffold( appBar: AppBar( title: Text(&#x27;two Screen&#x27;), ), body: Center( child: StoreConnector&lt;CountState, int&gt;( converter: (store) =&gt; store.state.count, builder: (context, count) &#123; return Text( count.toString(), style: Theme.of(context).textTheme.display1, ); &#125;, ), ), ); &#125;&#125; æ•ˆæœå›¾: æºç  å¦å¤–:å…¶ä»–ç®¡ç†åº“å­¦ä¹  å¦å¤–:Flutterå­¦ä¹ demo","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Flutter~scoped_modelå­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~scoped_modelå­¦ä¹ ","date":"2019-02-15T16:00:00.000Z","updated":"2019-09-11T09:58:34.000Z","comments":true,"path":"2019/02/16/ç§»åŠ¨ç«¯å­¦ä¹ /Flutter~scoped_modelå­¦ä¹ /","link":"","permalink":"https://zhoushaoting.com/2019/02/16/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Flutter~scoped_model%E5%AD%A6%E4%B9%A0/","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹scoped_model.å…¶ä¸­,scoped_model: 1.0.1","text":"ä»Šå¤©å­¦ä¹ ä¸‹Flutterä¸­stateç®¡ç†çš„ç¬¬ä¸‰æ–¹scoped_model.å…¶ä¸­,scoped_model: 1.0.1 ä»£ç ç»“æ„å¦‚å›¾æ‰€ç¤º: ä¸‹é¢æ˜¯å„æ–‡ä»¶çš„æºç .main.dart123456789101112131415161718192021222324252627import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:scoped_model_demo/model/main_model.dart&#x27;;import &#x27;package:scoped_model/scoped_model.dart&#x27;;import &#x27;top_screen.dart&#x27;;void main() =&gt; runApp(MyApp());class MyApp extends StatelessWidget &#123; //åˆ›å»ºé¡¶å±‚çŠ¶æ€ MainModel countModel = MainModel(); // This widget is the root of your application. @override Widget build(BuildContext context) &#123; return ScopedModel&lt;MainModel&gt;( model: countModel, child: new MaterialApp( title: &#x27;Flutter Demo&#x27;, theme: new ThemeData( primarySwatch: Colors.blue, ), home: TopScreen(), ), ); &#125;&#125; tabbar.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100import &#x27;package:flutter/material.dart&#x27;;import &#x27;One/one.dart&#x27;;import &#x27;Two/two.dart&#x27;; class Tabbar extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return new MaterialApp( debugShowCheckedModeBanner: false, home: new MainPageWidget()); &#125;&#125; class MainPageWidget extends StatefulWidget &#123; @override State&lt;StatefulWidget&gt; createState() &#123; return new MainPageState(); &#125;&#125; class MainPageState extends State&lt;MainPageWidget&gt; &#123; int _tabIndex = 0; var tabImages; var appBarTitles = [&#x27;One&#x27;, &#x27;Two&#x27;]; /* * å­˜æ”¾äºŒä¸ªé¡µé¢ï¼Œè·ŸfragmentListä¸€æ · */ var _pageList; /* * æ ¹æ®é€‰æ‹©è·å¾—å¯¹åº”çš„normalæˆ–æ˜¯pressçš„icon */ Image getTabIcon(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return tabImages[curIndex][1]; &#125; return tabImages[curIndex][0]; &#125; /* * è·å–bottomTabçš„é¢œè‰²å’Œæ–‡å­— */ Text getTabTitle(int curIndex) &#123; if (curIndex == _tabIndex) &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff1296db))); &#125; else &#123; return new Text(appBarTitles[curIndex], style: new TextStyle(fontSize: 14.0, color: const Color(0xff515151))); &#125; &#125; /* * æ ¹æ®imageè·¯å¾„è·å–å›¾ç‰‡ */ Image getTabImage(path) &#123; return new Image.asset(path, width: 24.0, height: 24.0); &#125; void initData() &#123; /* * åˆå§‹åŒ–é€‰ä¸­å’Œæœªé€‰ä¸­çš„icon */ tabImages = [ [getTabImage(&#x27;images/tab/one.png&#x27;), getTabImage(&#x27;images/tab/one_active.png&#x27;)], [getTabImage(&#x27;images/tab/two.png&#x27;), getTabImage(&#x27;images/tab/two_active.png&#x27;)], ]; /* * å­ç•Œé¢ */ _pageList = [ new One(), new Two(), ]; &#125; @override Widget build(BuildContext context) &#123; //åˆå§‹åŒ–æ•°æ® initData(); return Scaffold( body: _pageList[_tabIndex], bottomNavigationBar: new BottomNavigationBar( items: &lt;BottomNavigationBarItem&gt;[ new BottomNavigationBarItem( icon: getTabIcon(0), title: getTabTitle(0)), new BottomNavigationBarItem( icon: getTabIcon(1), title: getTabTitle(1)), ], type: BottomNavigationBarType.fixed, //é»˜è®¤é€‰ä¸­é¦–é¡µ currentIndex: _tabIndex, iconSize: 24.0, //ç‚¹å‡»äº‹ä»¶ onTap: (index) &#123; setState(() &#123; _tabIndex = index; &#125;); &#125;, )); &#125;&#125; top_screen.dart12345678910111213141516171819202122232425262728293031323334import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:scoped_model_demo/model/main_model.dart&#x27;;import &#x27;package:scoped_model/scoped_model.dart&#x27;;import &#x27;tabbar.dart&#x27;;class TopScreen extends StatefulWidget &#123; @override _TopScreenState createState() =&gt; _TopScreenState();&#125;class _TopScreenState extends State&lt;TopScreen&gt; &#123; //é™æ€è·å–modelç”¨æ³•å®ä¾‹ Model getModel(BuildContext context) &#123; //ç›´æ¥ä½¿ç”¨of final countModel = ScopedModel.of&lt;MainModel&gt;(context); //ä½¿ç”¨CountModelä¸­é‡å†™çš„of final countModel2 = MainModel().of(context); countModel.increment(); countModel2.increment(); return countModel; // return countMode2; &#125; @override Widget build(BuildContext context) &#123; return ScopedModelDescendant&lt;MainModel&gt;( builder: (context,child,model)&#123; return Tabbar(); &#125;, ); &#125;&#125; main_model.dart123456789101112131415import &#x27;package:scoped_model/scoped_model.dart&#x27;;class MainModel extends Model&#123; int _count = 0; get count =&gt; _count; void increment()&#123; _count++; notifyListeners(); &#125; MainModel of(context) =&gt; ScopedModel.of&lt;MainModel&gt;(context);&#125; one.dart123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:scoped_model_demo/model/main_model.dart&#x27;;import &#x27;package:scoped_model/scoped_model.dart&#x27;;class One extends StatefulWidget &#123; @override _OneState createState() =&gt; _OneState();&#125;class _OneState extends State&lt;One&gt; &#123; //é™æ€è·å–modelç”¨æ³•å®ä¾‹ Model getModel(BuildContext context) &#123; //ç›´æ¥ä½¿ç”¨of final countModel = ScopedModel.of&lt;MainModel&gt;(context); //ä½¿ç”¨CountModelä¸­é‡å†™çš„of final countModel2 = MainModel().of(context); countModel.increment(); countModel2.increment(); return countModel; // return countMode2; &#125; @override Widget build(BuildContext context) &#123; return ScopedModelDescendant&lt;MainModel&gt;( builder: (context, child, model) &#123; return Scaffold( appBar: AppBar( title: Text(&#x27;One One&#x27;), ), body: Center( child: Column( children: &lt;Widget&gt;[ Text( model.count.toString(), style: TextStyle(fontSize: 22.0), ), RaisedButton( child: Text(&#x27;åŠ 1&#x27;), onPressed: () =&gt; model.increment(), ), ], ), ), ); &#125;, ); &#125;&#125; two.dart123456789101112131415161718192021222324252627282930313233343536373839404142import &#x27;package:flutter/material.dart&#x27;;import &#x27;package:scoped_model_demo/model/main_model.dart&#x27;;import &#x27;package:scoped_model/scoped_model.dart&#x27;;class Two extends StatefulWidget &#123; @override _TwoState createState() =&gt; _TwoState();&#125;class _TwoState extends State&lt;Two&gt; &#123; //é™æ€è·å–modelç”¨æ³•å®ä¾‹ Model getModel(BuildContext context)&#123; //ç›´æ¥ä½¿ç”¨of final countModel = ScopedModel.of&lt;MainModel&gt;(context); //ä½¿ç”¨CountModelä¸­é‡å†™çš„of final countModel2 = MainModel().of(context); countModel.increment(); countModel2.increment(); return countModel; // return countMode2; &#125; @override Widget build(BuildContext context) &#123; return ScopedModelDescendant&lt;MainModel&gt;( builder: (context,child,model)&#123; return Scaffold( appBar: AppBar( title: Text(&#x27;Two Screen&#x27;), ), body: Center( child: Text( model.count.toString(), style: TextStyle(fontSize: 48.0), ), ) ); &#125;, ); &#125;&#125; æ•ˆæœå›¾: æºç  å¦å¤–:å…¶ä»–ç®¡ç†åº“å­¦ä¹  å¦å¤–:Flutterå­¦ä¹ demo","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"React-Nativeæ¨é€é€šçŸ¥è‡³RNä¸”æ˜¾ç¤ºæ¨é€å†…å®¹","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeæ¨é€é€šçŸ¥è‡³RNä¸”æ˜¾ç¤ºæ¨é€å†…å®¹","date":"2018-09-07T16:00:00.000Z","updated":"2019-04-22T07:57:41.000Z","comments":true,"path":"2018/09/08/ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeæ¨é€é€šçŸ¥è‡³RNä¸”æ˜¾ç¤ºæ¨é€å†…å®¹/","link":"","permalink":"https://zhoushaoting.com/2018/09/08/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/React-Native%E6%8E%A8%E9%80%81%E9%80%9A%E7%9F%A5%E8%87%B3RN%E4%B8%94%E6%98%BE%E7%A4%BA%E6%8E%A8%E9%80%81%E5%86%85%E5%AE%B9/","excerpt":"APPæ¨é€æ˜¯åŸºæœ¬çš„è¦æ±‚,ä»Šå¤©è®°å½•ä¸€ä¸‹,å¤§è‡´æ˜¯iOSåŸç”Ÿæ”¶åˆ°æ¨é€åç›´æ¥å‘é€šçŸ¥ç»™RN,RNè¿™è¾¹ç›‘å¬ç€iOSåŸç”Ÿçš„è¿™ä¸ªé€šçŸ¥,ä»¥æ­¤è·å–åˆ°æ¨é€çš„æ¶ˆæ¯.","text":"APPæ¨é€æ˜¯åŸºæœ¬çš„è¦æ±‚,ä»Šå¤©è®°å½•ä¸€ä¸‹,å¤§è‡´æ˜¯iOSåŸç”Ÿæ”¶åˆ°æ¨é€åç›´æ¥å‘é€šçŸ¥ç»™RN,RNè¿™è¾¹ç›‘å¬ç€iOSåŸç”Ÿçš„è¿™ä¸ªé€šçŸ¥,ä»¥æ­¤è·å–åˆ°æ¨é€çš„æ¶ˆæ¯. æ•ˆæœå›¾: å®ç°æ€è·¯ ==&gt;è¿™æ¬¡é‡‡ç”¨çš„å‹ç›Ÿæ¨é€,è‡³äºé‡‡ç”¨ä»€ä¹ˆæ¨é€éƒ½æ˜¯ä¸€æ ·çš„.å‡†å¤‡å·¥ä½œ:iOS é›†æˆæ¨é€,ç¼–å†™ä¸­é—´ç±»,ç”¨äºä¼ å€¼ç»™RN. RN ç•Œé¢å®ç°ç›‘å¬iOSåŸç”Ÿçš„é€šçŸ¥,é€šè¿‡ä»¥ä¸Šè·å–åˆ°æ¨é€çš„å†…å®¹. iOSåŸç”Ÿå‡†å¤‡é›†æˆæ¨é€: â€¦iOSå†™ä¸€ä¸ªä¸­é—´ç±»ä¼ è¾“é€šçŸ¥ç»™RN:CheckInvoice.h 123456789101112131415161718//// CheckInvoice.h// aitepiao//// Created by tc on 2018/8/28.// Copyright Â© 2018å¹´ Facebook. All rights reserved.//#import &lt;Foundation/Foundation.h&gt;#import &lt;React/RCTBridgeModule.h&gt;#import &lt;React/RCTEventEmitter.h&gt;@interface CheckInvoice : RCTEventEmitter&lt;RCTBridgeModule&gt;@end CheckInvoice.m 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657//// CheckInvoice.m// aitepiao//// Created by tc on 2018/8/28.// Copyright Â© 2018å¹´ Facebook. All rights reserved.//#import &quot;CheckInvoice.h&quot;#import &lt;React/RCTEventDispatcher.h&gt;#import &lt;React/RCTBridge.h&gt;static CheckInvoice *_manager = nil;@implementation CheckInvoiceRCT_EXPORT_MODULE()-(instancetype)init&#123; if (self = [super init]) &#123; [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(messageDidReceived:) name:@&quot;didReceiveNotification&quot; object:nil]; &#125; return self;&#125;- (NSArray&lt;NSString *&gt; *)supportedEvents&#123; return @[@&quot;didReceiveNotification&quot;, ];//æœ‰å‡ ä¸ªå°±å†™å‡ ä¸ª&#125;-(void)messageDidReceived:(NSNotification *)notification&#123; NSDictionary *body = notification.object; [self sendEventWithName:@&quot;didReceiveNotification&quot; body:body];&#125;+ (BOOL)requiresMainQueueSetup &#123; return YES;&#125;- (dispatch_queue_t)methodQueue&#123; return dispatch_get_main_queue();&#125;@end ok.ä¼ è¾“ç±»å†™å®Œ.ç„¶ååœ¨AppDelegateé‡Œé¢ç›´æ¥é€šè¿‡é€šçŸ¥ä¼ å³å¯:å¦‚: 1234567891011121314151617181920212223242526272829303132333435363738394041// iOS 10ä»¥ä¸Š-(void)userNotificationCenter:(UNUserNotificationCenter *)center willPresentNotification:(UNNotification *)notification withCompletionHandler:(void (^)(UNNotificationPresentationOptions))completionHandler&#123; NSDictionary * userInfo = notification.request.content.userInfo; NSLog(@&quot;iOS 10ä»¥ä¸Š%@&quot;,userInfo); if([notification.request.trigger isKindOfClass:[UNPushNotificationTrigger class]]) &#123; //åº”ç”¨å¤„äºå‰å°æ—¶çš„è¿œç¨‹æ¨é€æ¥å— //å…³é—­U-Pushè‡ªå¸¦çš„å¼¹å‡ºæ¡† [UMessage setAutoAlert:NO]; //å¿…é¡»åŠ è¿™å¥ä»£ç  [UMessage didReceiveRemoteNotification:userInfo]; &#125;else&#123; //åº”ç”¨å¤„äºå‰å°æ—¶çš„æœ¬åœ°æ¨é€æ¥å— &#125; //å½“åº”ç”¨å¤„äºå‰å°æ—¶æç¤ºè®¾ç½®ï¼Œéœ€è¦å“ªä¸ªå¯ä»¥è®¾ç½®å“ªä¸€ä¸ª if (@available(iOS 10.0, *)) &#123; completionHandler(UNNotificationPresentationOptionSound|UNNotificationPresentationOptionBadge|UNNotificationPresentationOptionAlert); &#125; else &#123; // Fallback on earlier versions &#125; [[NSNotificationCenter defaultCenter] postNotificationName:@&quot;didReceiveNotification&quot; object:userInfo];&#125;// æ”¶åˆ°é€šçŸ¥-(void)userNotificationCenter:(UNUserNotificationCenter *)center didReceiveNotificationResponse:(UNNotificationResponse *)response withCompletionHandler:(void (^)(void))completionHandler&#123; NSDictionary * userInfo = response.notification.request.content.userInfo; NSLog(@&quot;iOSå¤–éƒ¨ %@&quot;,userInfo); [[NSNotificationCenter defaultCenter] postNotificationName:@&quot;didReceiveNotification&quot; object:userInfo];&#125;- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo&#123; NSLog(@&quot;iOS 10ä»¥ä¸‹%@&quot;,userInfo); [[NSNotificationCenter defaultCenter] postNotificationName:@&quot;didReceiveNotification&quot; object:userInfo];&#125;- (void)application:(UIApplication *)app didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken&#123; NSLog(@&quot;deviceToken==%@&quot;,[[[[deviceToken description] stringByReplacingOccurrencesOfString: @&quot;&lt;&quot; withString: @&quot;&quot;] stringByReplacingOccurrencesOfString: @&quot;&gt;&quot; withString: @&quot;&quot;] stringByReplacingOccurrencesOfString: @&quot; &quot; withString: @&quot;&quot;]); [UMessage registerDeviceToken:deviceToken];&#125; ok,iOSåŸç”Ÿè¿™è¾¹åŸºæœ¬å®Œæˆ.å‰©ä¸‹RNè¿™è¾¹:å¼•å…¥NativeModuleså’ŒNativeEventEmitterç»„ä»¶å¼•å…¥åŸç”Ÿä¸­é—´ç±» 123const &#123; CheckInvoice &#125; = NativeModules;const checkInvoiceEmitter = new NativeEventEmitter(CheckInvoice); ç„¶åç›´æ¥åœ¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•é‡Œé¢ç›‘å¬iOSé€šçŸ¥å³å¯. 1234567891011componentDidMount() &#123; // ç›‘å¬iOSåŸç”Ÿ UM push ç›‘å¬å¤–éƒ¨é€šçŸ¥ checkInvoiceEmitter.addListener( &#x27;didReceiveNotification&#x27;, (info) =&gt; &#123; alert(info.aps.alert.body) this.setState(&#123; info:info.aps.alert.body &#125;) &#125; )&#125; æºç :åªæœ‰iOSæ¨é€ Androidä¹Ÿå¦‚æ­¤,é›†æˆæ¨é€.ä¹¦å†™ä¸­é—´ç±»ä¼ é€šçŸ¥ç»™RN. è¿™é‡Œå°±è´´ä¸€ä¸‹æ¡¥æ¥ä»£ç äº†: CommModule.java 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152package com.eazytec.zqtong.gov.baseapp.RN;import android.content.Intent;import android.net.Uri;import android.util.Log;import com.facebook.react.bridge.Callback;import com.facebook.react.bridge.Promise;import com.facebook.react.bridge.ReactApplicationContext;import com.facebook.react.bridge.ReactContextBaseJavaModule;import com.facebook.react.bridge.ReactMethod;import com.facebook.react.modules.core.DeviceEventManagerModule;/** * é€šä¿¡Moduleç±» * Created by Song on 2017/2/17. */public class CommModule extends ReactContextBaseJavaModule &#123; private ReactApplicationContext mContext; public static final String MODULE_NAME = &quot;commModule&quot;; public static final String EVENT_NAME = &quot;EventName&quot;; /** * æ„é€ æ–¹æ³•å¿…é¡»å®ç° * @param reactContext */ public CommModule(ReactApplicationContext reactContext) &#123; super(reactContext); this.mContext = reactContext; &#125; /** * åœ¨rnä»£ç é‡Œé¢æ˜¯éœ€è¦è¿™ä¸ªåå­—æ¥è°ƒç”¨è¯¥ç±»çš„æ–¹æ³• * @return */ @Override public String getName() &#123; return MODULE_NAME; &#125; /** * Nativeè°ƒç”¨RN * @param msg */ public void nativeCallRn(String msg) &#123; mContext.getJSModule(DeviceEventManagerModule.RCTDeviceEventEmitter.class) .emit(EVENT_NAME,msg); &#125;&#125; CommPackage.java 123456789101112131415161718192021222324252627282930313233343536373839404142package com.eazytec.zqtong.gov.baseapp.RN;import com.facebook.react.ReactPackage;import com.facebook.react.bridge.JavaScriptModule;import com.facebook.react.bridge.NativeModule;import com.facebook.react.bridge.ReactApplicationContext;import com.facebook.react.uimanager.ViewManager;import java.util.ArrayList;import java.util.Collections;import java.util.List;/** * é€šä¿¡Moduleç±» * Created by Song on 2017/2/17. */public class CommPackage implements ReactPackage &#123; private static final CommPackage mCommPackage = new CommPackage(); public CommModule mModule; /** * åˆ›å»ºNative Module * @param reactContext * @return */ @Override public List&lt;NativeModule&gt; createNativeModules(ReactApplicationContext reactContext) &#123; List&lt;NativeModule&gt; modules = new ArrayList&lt;&gt;(); mModule = new CommModule(reactContext); modules.add(mModule); return modules; &#125; @Override public List&lt;ViewManager&gt; createViewManagers(ReactApplicationContext reactContext) &#123; return Collections.emptyList(); &#125;&#125; ok.ä¸Šé¢å°±æ˜¯æ¡¥æ¥æ–‡ä»¶.ç„¶ååªéœ€è¦åœ¨è¿”å›é€šçŸ¥ç±»ä¸­å‘é€é€šçŸ¥ç»™RNå³å¯.å¦‚: MainActivity.java 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186package com.eazytec.zqtong.gov.baseapp;import android.app.Application;import android.widget.Toast;import org.json.JSONObject;import com.eazytec.zqtong.gov.baseapp.RN.CommModule;import com.facebook.react.bridge.ReactContextBaseJavaModule;import com.google.gson.Gson;import android.content.Context;import android.util.Log;import com.eazytec.zqtong.gov.baseapp.BuildConfig;import com.learnium.RNDeviceInfo.RNDeviceInfo;import com.facebook.react.ReactApplication;import cn.reactnative.httpcache.HttpCachePackage;import com.facebook.react.ReactNativeHost;import com.facebook.react.ReactPackage;import com.facebook.react.shell.MainReactPackage;import com.facebook.soloader.SoLoader;import com.react.rnspinkit.RNSpinkitPackage;import java.util.Arrays;import java.util.List;import com.imagepicker.ImagePickerPackage;import com.umeng.message.PushAgent;import com.umeng.commonsdk.UMConfigure;import com.umeng.message.IUmengRegisterCallback;import com.umeng.message.MsgConstant;import com.umeng.message.PushAgent;import com.umeng.message.UTrack;import com.umeng.message.UmengMessageHandler;import com.umeng.message.UmengNotificationClickHandler;import com.umeng.message.entity.UMessage;import com.facebook.react.bridge.ReactApplicationContext;import android.provider.Settings;import android.support.annotation.Nullable;import com.facebook.react.bridge.Arguments;import com.facebook.react.bridge.ReactContext;import com.facebook.react.bridge.WritableMap;import com.facebook.react.modules.core.DeviceEventManagerModule;import com.eazytec.zqtong.gov.baseapp.RN.CommPackage;import java.util.List;import android.app.Activity;import android.app.ActivityManager;import android.app.ActivityManager.RunningAppProcessInfo;import android.content.Context;public class MainApplication extends Application implements ReactApplication &#123; //å®šä¹‰ä¸Šä¸‹æ–‡å¯¹è±¡ public static ReactContext myContext; private static final CommPackage mCommPackage = new CommPackage(); private final ReactNativeHost mReactNativeHost = new ReactNativeHost(this) &#123; @Override public boolean getUseDeveloperSupport() &#123; return BuildConfig.DEBUG; &#125; private ReactApplicationContext mContext; @Override protected List&lt;ReactPackage&gt; getPackages() &#123; return Arrays.&lt;ReactPackage&gt;asList( new MainReactPackage(), new HttpCachePackage(), new RNSpinkitPackage(), new RNDeviceInfo(), new ImagePickerPackage(), mCommPackage ); &#125; @Override protected String getJSMainModuleName() &#123; return &quot;index&quot;; &#125; &#125;; @Override public ReactNativeHost getReactNativeHost() &#123; return mReactNativeHost; &#125; //å®šä¹‰å‘é€äº‹ä»¶çš„å‡½æ•° public void sendEvent(ReactContext reactContext, String eventName, @Nullable WritableMap params) &#123; System.out.println(&quot;reactContext=&quot;+reactContext); reactContext .getJSModule(DeviceEventManagerModule.RCTDeviceEventEmitter.class) .emit(eventName,params); &#125; @Override public void onCreate() &#123; super.onCreate(); UMConfigure.setLogEnabled(true); SoLoader.init(this, /* native exopackage */ false); //å‹ç›Ÿ push PushAgent mPushAgent = PushAgent.getInstance(this); UmengMessageHandler messageHandler = new UmengMessageHandler() &#123; /** * é€šçŸ¥çš„å›è°ƒæ–¹æ³•ï¼ˆé€šçŸ¥é€è¾¾æ—¶ä¼šå›è°ƒï¼‰ */ @Override public void dealWithNotificationMessage(Context context, UMessage msg) &#123; //è°ƒç”¨superï¼Œä¼šå±•ç¤ºé€šçŸ¥ï¼Œä¸è°ƒç”¨superï¼Œåˆ™ä¸å±•ç¤ºé€šçŸ¥ã€‚ super.dealWithNotificationMessage(context, msg); Gson gson = new Gson(); // æ¨é€çš„å†…å®¹ Log.i(&quot;msgæ¥äº†å†…å®¹&quot;, msg.text); Log.i(&quot;msgæ¥äº†å¤´&quot;, msg.title); String jsonStr = gson.toJson(msg); Log.i(&quot;å®Œæ•´è¾“å‡º&quot;, jsonStr); mCommPackage.mModule.nativeCallRn(jsonStr); &#125; &#125;; mPushAgent.setMessageHandler(messageHandler); //æ³¨å†Œæ¨é€æœåŠ¡ï¼Œæ¯æ¬¡è°ƒç”¨registeræ–¹æ³•éƒ½ä¼šå›è°ƒè¯¥æ¥å£ mPushAgent.register(new IUmengRegisterCallback() &#123; @Override public void onSuccess(String deviceToken) &#123; //æ³¨å†ŒæˆåŠŸä¼šè¿”å›device token Log.i(deviceToken,&quot;deviceTokenæ¥äº†&quot;); Log.i(deviceToken,deviceToken); &#125; @Override public void onFailure(String s, String s1) &#123; Log.i(s,s); Log.i(s1,s1); &#125; /** * ç¨‹åºæ˜¯å¦åœ¨å‰å°è¿è¡Œ * * @return */ public boolean isAppOnForeground() &#123; // Returns a list of application processes that are running on the // device ActivityManager activityManager = (ActivityManager) getApplicationContext().getSystemService(Context.ACTIVITY_SERVICE); String packageName = getApplicationContext().getPackageName(); List&lt;RunningAppProcessInfo&gt; appProcesses = activityManager .getRunningAppProcesses(); if (appProcesses == null) return false; for (RunningAppProcessInfo appProcess : appProcesses) &#123; // The name of the process that this object is associated with. if (appProcess.processName.equals(packageName) &amp;&amp; appProcess.importance == RunningAppProcessInfo.IMPORTANCE_FOREGROUND) &#123; return true; &#125; &#125; return false; &#125; &#125;); &#125;&#125;","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"React-Nativeç±»ä¼¼æ”¯ä»˜å®çš„åº”ç”¨å¢åˆ æ¨¡å—çš„ç®€å•å®ç°","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeç±»ä¼¼æ”¯ä»˜å®çš„åº”ç”¨å¢åˆ æ¨¡å—çš„ç®€å•å®ç°","date":"2018-08-16T16:00:00.000Z","updated":"2019-04-22T07:57:24.000Z","comments":true,"path":"2018/08/17/ç§»åŠ¨ç«¯å­¦ä¹ /React-Nativeç±»ä¼¼æ”¯ä»˜å®çš„åº”ç”¨å¢åˆ æ¨¡å—çš„ç®€å•å®ç°/","link":"","permalink":"https://zhoushaoting.com/2018/08/17/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/React-Native%E7%B1%BB%E4%BC%BC%E6%94%AF%E4%BB%98%E5%AE%9D%E7%9A%84%E5%BA%94%E7%94%A8%E5%A2%9E%E5%88%A0%E6%A8%A1%E5%9D%97%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/","excerpt":"é¡¹ç›®ä¸­,æ¶‰åŠåˆ°ç±»ä¼¼æ”¯ä»˜å®çš„åº”ç”¨å¢åˆ æ¨¡å—,è¿™å‡ å¤©ç®€å•çš„å®ç°äº†ä¸‹.åŸºæœ¬é›å½¢å®ç°äº†.åé¢çš„ç»†èŠ‚ç¨åå†åšå¤„ç†.å†™ç¯‡åšå®¢è®°å½•ä¸‹.","text":"é¡¹ç›®ä¸­,æ¶‰åŠåˆ°ç±»ä¼¼æ”¯ä»˜å®çš„åº”ç”¨å¢åˆ æ¨¡å—,è¿™å‡ å¤©ç®€å•çš„å®ç°äº†ä¸‹.åŸºæœ¬é›å½¢å®ç°äº†.åé¢çš„ç»†èŠ‚ç¨åå†åšå¤„ç†.å†™ç¯‡åšå®¢è®°å½•ä¸‹. æ•ˆæœå›¾: å®ç°æ€è·¯ ==&gt;UI: ä¸€å¼€å§‹é‡‡ç”¨å¤–éƒ¨ScrollViewå†…éƒ¨FlatListå’ŒScrollViewå®ç°,åæ¥å‘ç°æœ‰ç‚¹è‡ƒè‚¿,äºæ˜¯é‡‡ç”¨å¤–éƒ¨FlatList,å†…éƒ¨ScrollViewå®ç°.ç„¶åå‘ç°å…¶å®ä»£ç å·®ä¸å¤ªå¤šâ€¦â€¦.æµªè´¹è¡¨æƒ…,å…¶ä¸­ä¾èµ–å‡ ä¸ªä¸‰æ–¹åº“:react-native-scrollable-tab-view,react-native-underline-tabbar.æœ¬æ¥æƒ³ä½¿ç”¨SectionListå®ç°çš„,ä½†æ˜¯æ„Ÿè§‰ä½¿ç”¨SectionListä¼šæ›´éº»çƒ¦.é€»è¾‘: é€šè¿‡æ•°æ®ä¸­ id å’Œ tagå®ç° åºŸè¯ä¸å¤šç¼©,é¦–å…ˆ,æ–°å»ºä¸€ä¸ªé¡¹ç›®,æ·»åŠ ç›¸åº”åº“:ç¬¬ä¸€ç§å®ç°: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578/** * UI é€šè¿‡ å¤–éƒ¨ScrollView å†…éƒ¨ FlatListæˆ–è€… ScrollView å®ç° (ä½¿ç”¨ä¸‰æ–¹åº“react-native-scrollable-tab-view&amp;&amp;react-native-underline-tabbar) * é€»è¾‘ é€šè¿‡ æ•°æ®ä¸­ id å’Œ tagå®ç° * */import React, &#123; Component &#125; from &#x27;react&#x27;import &#123; StyleSheet, View, Image, Text, Dimensions, TouchableOpacity, FlatList, Linking, ScrollView&#125; from &#x27;react-native&#x27;const &#123; width &#125; = Dimensions.get(&#x27;window&#x27;)import ScrollableTabView from &#x27;react-native-scrollable-tab-view&#x27;import TabBar from &#x27;react-native-underline-tabbar&#x27;export default class One extends Component &#123; // æ„é€  constructor(props) &#123; super(props) // åˆå§‹çŠ¶æ€ this.state = &#123; startEdit: false, // æ˜¯å¦ç‚¹å‡»äº†ç¼–è¾‘ é»˜è®¤æœªç‚¹å‡»false myApplyData: [], otherApplyData: [], applyData: [ &#123; title: &#x27;æˆ‘çš„åº”ç”¨&#x27;, sub: [ &#123; id: &#x27;10086&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqgy1fu39hosiwoj30j60qyq96.jpg&#x27;, name: &#x27;ä»·è´¹é€š10086&#x27;, &#125;, &#123; id: &#x27;10010&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&#x27;, name: &#x27;å±•ç¤ºä¸­å¿ƒ10010&#x27;, &#125; ], &#125;, &#123; title: &#x27;æ”¿åŠ¡æœåŠ¡&#x27;, sub: [ &#123; subTitle: &#x27;æ”¿ä¼&#x27;, sub: [ &#123; id: &#x27;10086&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqgy1fu39hosiwoj30j60qyq96.jpg&#x27;, name: &#x27;ä»·è´¹é€š10086&#x27;, tag: true, &#125;, &#123; id: &#x27;10010&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&#x27;, name: &#x27;å±•ç¤ºä¸­å¿ƒ10010&#x27;, tag: true, &#125;, &#123; id: &#x27;9&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&#x27;, name: &#x27;åŠäº‹å¹³å°&#x27;, tag: false, &#125;, &#123; id: &#x27;10&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqgy1ftwcw4f4a5j30sg10j1g9.jpg&#x27;, name: &#x27;å°‘å„¿å›¾ä¹¦é¦†&#x27;, tag: false, &#125;, ], &#125;, &#123; subTitle: &#x27;ç¬¬ä¸‰æ–¹æœåŠ¡&#x27;, sub: [ &#123; id: &#x27;11&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;12&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqgy1ftwcw4f4a5j30sg10j1g9.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;13&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;14&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqgy1ftwcw4f4a5j30sg10j1g9.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;15&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqgy1ftwcw4f4a5j30sg10j1g9.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;16&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftu6gl83ewj30k80tites.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;17&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftu6gl83ewj30k80tites.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;18&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftu6gl83ewj30k80tites.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, ], &#125;, ], &#125;, &#123; title: &#x27;æ”¿ä¼åº”ç”¨&#x27;, sub: [ &#123; subTitle: &#x27;æŒ‰ä¸»é¢˜&#x27;, sub: [ &#123; id: &#x27;19&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftdtot8zd3j30ju0pt137.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;20&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ft5q7ys128j30sg10gnk5.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, ], &#125;, &#123; subTitle: &#x27;æŒ‰éƒ¨é—¨&#x27;, sub: [ &#123; id: &#x27;21&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftdtot8zd3j30ju0pt137.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, ], &#125;, &#123; subTitle: &#x27;æŒ‰è¯ä»¶&#x27;, sub: [ &#123; id: &#x27;22&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ft5q7ys128j30sg10gnk5.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, ], &#125;, &#123; subTitle: &#x27;ä¸»ä½“å‘¨æœŸ&#x27;, sub: [ &#123; id: &#x27;23&#x27;, icon: &#x27;http://ww1.sinaimg.cn/large/0065oQSqly1fsoe3k2gkkj30g50niwla.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;24&#x27;, icon: &#x27;http://ww1.sinaimg.cn/large/0065oQSqly1fsoe3k2gkkj30g50niwla.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, ], &#125;, ], &#125;, ], &#125; &#125; componentDidMount() &#123; var data = this.state.applyData //èµ‹å€¼ æˆ‘çš„åº”ç”¨æ•°æ® this.setState(&#123; myApplyData: data[0].sub, &#125;) //èµ‹å€¼ å…¶ä»–åº”ç”¨æ•°æ® this.setState(&#123; otherApplyData: data.slice(1), &#125;) &#125; /** * ç‚¹å‡»ç¼–è¾‘ * */ editAction = () =&gt; &#123; this.setState(&#123; startEdit:!this.state.startEdit &#125;) &#125; /** * å»é™¤æˆ‘çš„åº”ç”¨ * */ subAction = item =&gt; &#123; var data = this.state.myApplyData // æˆ‘çš„åº”ç”¨æ•°æ® var otherData = this.state.otherApplyData //å…¶ä»–åº”ç”¨æ•°æ® var selectId = item.item.id // é€‰ä¸­çš„id //ä¿®æ”¹æˆ‘çš„åº”ç”¨æ•°æ®æº data.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; data.splice(index,1) &#125; &#125;) //ä¿®æ”¹å…¶ä»–åº”ç”¨æ•°æ®æº otherData.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; item.tag = false &#125; &#125;) &#125;) &#125;) // é‡æ–°èµ‹å€¼ this.setState(&#123; myApplyData:data, otherApplyData:otherData &#125;) &#125; /** * ç‚¹å‡»å…¶ä»–åº”ç”¨ * */ otherAction =(item) =&gt;&#123; var data = this.state.myApplyData // æˆ‘çš„åº”ç”¨æ•°æ® var otherData = this.state.otherApplyData //å…¶ä»–åº”ç”¨æ•°æ® var selectId = item.id //id console.log(item) //æ ¹æ®æ•°æ®ä¸­tagå€¼åˆ¤æ–­ if(item.tag == true)&#123; //åœ¨æˆ‘çš„åº”ç”¨å½“ä¸­,éœ€è¦å»é™¤ data.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; data.splice(index,1) &#125; &#125;) otherData.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; item.tag = false &#125; &#125;) &#125;) &#125;) &#125;else &#123; //ä¸åœ¨æˆ‘çš„åº”ç”¨å½“ä¸­,éœ€è¦æ·»åŠ  data.push(item) otherData.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; item.tag = true &#125; &#125;) &#125;) &#125;) &#125; // é‡æ–°èµ‹å€¼ this.setState(&#123; myApplyData:data, otherApplyData:otherData &#125;) &#125; /** * å»è¯¦æƒ…é¡µé¢ * */ goDetailsAction = item =&gt; &#123; alert(&#x27;å»è¯¦æƒ…&#x27;) &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &#123;/*æˆ‘çš„åº”ç”¨æ¡-ç¼–è¾‘*/&#125; &lt;MyApplyEdit applyEditData=&#123;this.state.myApplyData&#125; editAction=&#123;() =&gt; &#123; this.editAction() &#125;&#125; /&gt; &lt;ScrollView&gt; &#123;/*æˆ‘çš„åº”ç”¨*/&#125; &lt;View style=&#123;&#123; marginTop: 10, backgroundColor: &#x27;#ffffff&#x27; &#125;&#125;&gt; &lt;View style=&#123;&#123; flexDirection: &#x27;row&#x27;, alignItems: &#x27;center&#x27;, marginTop: 10, &#125;&#125; &gt; &lt;View style=&#123;&#123; marginLeft: 10, width: 8, height: 20, backgroundColor: &#x27;blue&#x27;, &#125;&#125; /&gt; &lt;Text style=&#123;&#123; marginLeft: 10, fontWeight: &#x27;700&#x27; &#125;&#125;&gt; æˆ‘çš„åº”ç”¨ &lt;/Text&gt; &lt;/View&gt; &lt;FlatList data=&#123;this.state.myApplyData&#125; style=&#123;&#123; marginBottom: 20 &#125;&#125; renderItem=&#123;item =&gt; this.renderMyApplyRow(item)&#125; keyExtractor=&#123;this.keyMyApplyExtractor&#125; numColumns=&#123;4&#125; /&gt; &lt;/View&gt; &#123;/*å…¶ä»–åº”ç”¨*/&#125; &#123;this.state.otherApplyData.map((item, index) =&gt; ( &lt;View key=&#123;index&#125;&gt; &#123;/*æ ‡é¢˜*/&#125; &lt;View style=&#123;&#123; paddingTop: 10, alignItems: &#x27;center&#x27;, backgroundColor: &#x27;white&#x27;, flexDirection: &#x27;row&#x27;, alignItems: &#x27;center&#x27;, marginTop: 10, &#125;&#125; &gt; &lt;View style=&#123;&#123; marginLeft: 10, width: 8, height: 20, backgroundColor: &#x27;blue&#x27;, &#125;&#125; /&gt; &lt;Text style=&#123;&#123; marginLeft: 10, fontWeight: &#x27;700&#x27; &#125;&#125;&gt; &#123;item.title&#125; &lt;/Text&gt; &lt;/View&gt; &#123;/*ä¸»ä½“å†…å®¹*/&#125; &lt;ScrollableTabView style=&#123;&#123; backgroundColor: &#x27;white&#x27; &#125;&#125; tabBarActiveTextColor=&quot;#118EE9&quot; renderTabBar=&#123;() =&gt; &lt;TabBar underlineColor=&quot;#118EE9&quot; /&gt;&#125; &gt; &#123;item.sub.map((item, index) =&gt; ( &lt;View key=&#123;index&#125; tabLabel=&#123;&#123; label: item.subTitle &#125;&#125;&gt; &lt;ScrollView&gt; &lt;View style=&#123;&#123; flexDirection: &#x27;row&#x27;, height: 250, flexWrap: &#x27;wrap&#x27;, &#125;&#125; &gt; &#123;item.sub.map((item, index) =&gt; ( &lt;TouchableOpacity key=&#123;index&#125; onPress=&#123;() =&gt; this.goDetailsAction(item)&#125; &gt; &lt;View style=&#123;&#123; marginTop: 25 &#125;&#125;&gt; &lt;Image style=&#123;&#123; width: 55, height: 55, marginLeft: (width - 55 * 4) / 8, marginRight: (width - 55 * 4) / 8, &#125;&#125; source=&#123;&#123; uri: item.icon &#125;&#125; /&gt; &lt;Text style=&#123;&#123; alignSelf: &#x27;center&#x27;, marginTop: 15, marginBottom: 10, &#125;&#125; &gt; &#123;item.name&#125; &lt;/Text&gt; &lt;TouchableOpacity style=&#123;&#123; position: &#x27;absolute&#x27;, top: -10, right: 10, &#125;&#125; onPress=&#123;() =&gt; this.otherAction(item)&#125; &gt; &lt;Image source=&#123; item.tag ? require(&#x27;./image/sub.png&#x27;) : require(&#x27;./image/add.png&#x27;) &#125; style=&#123;&#123; opacity: this.state.startEdit ? 1 : 0, width: 15, height: 15, &#125;&#125; /&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; &lt;/TouchableOpacity&gt; ))&#125; &lt;/View&gt; &lt;/ScrollView&gt; &lt;/View&gt; ))&#125; &lt;/ScrollableTabView&gt; &lt;/View&gt; ))&#125; &lt;/ScrollView&gt; &lt;/View&gt; ) &#125; //-------------------------------æˆ‘çš„åº”ç”¨start -------------------------------- /** * æˆ‘çš„åº”ç”¨render * */ renderMyApplyRow = item =&gt; ( &lt;TouchableOpacity onPress=&#123;() =&gt; this.goDetailsAction(item)&#125;&gt; &lt;View style=&#123;&#123; marginTop: 25 &#125;&#125;&gt; &lt;Image style=&#123;&#123; width: 55, height: 55, marginLeft: (width - 55 * 4) / 8, marginRight: (width - 55 * 4) / 8, &#125;&#125; source=&#123;&#123; uri: item.item.icon &#125;&#125; /&gt; &lt;Text style=&#123;&#123; alignSelf: &#x27;center&#x27;, marginTop: 15, marginBottom: 10 &#125;&#125;&gt; &#123;item.item.name&#125; &lt;/Text&gt; &lt;TouchableOpacity style=&#123;&#123; position: &#x27;absolute&#x27;, top: -10, right: 10 &#125;&#125; onPress=&#123;() =&gt; this.subAction(item)&#125; &gt; &lt;Image source=&#123;require(&#x27;./image/sub.png&#x27;)&#125; style=&#123;&#123; opacity: this.state.startEdit ? 1 : 0, width: 15, height: 15, &#125;&#125; /&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; &lt;/TouchableOpacity&gt; ) // ä½¿ç”¨jsonä¸­çš„keyåŠ¨æ€ç»‘å®škey keyMyApplyExtractor = item =&gt; item.id //-------------------------------æˆ‘çš„åº”ç”¨end --------------------------------&#125;// ä¸Šæ–¹çš„ç¼–è¾‘ æˆ‘çš„åº”ç”¨æ¡† UIclass MyApplyEdit extends React.Component &#123; render() &#123; const &#123; applyEditData &#125; = this.props return ( &lt;View style=&#123;&#123; paddingTop: 5, paddingBottom: 5, alignItems: &#x27;center&#x27;, flexDirection: &#x27;row&#x27;, backgroundColor: &#x27;#ffffff&#x27;, &#125;&#125; &gt; &lt;Text style=&#123;&#123; marginLeft: 10, fontWeight: &#x27;700&#x27; &#125;&#125;&gt;æˆ‘çš„åº”ç”¨&lt;/Text&gt; &lt;ScrollView showsHorizontalScrollIndicator=&#123;false&#125; showsVerticalScrollIndicator=&#123;false&#125; horizontal=&#123;true&#125; style=&#123;&#123; marginRight: 15 &#125;&#125; &gt; &#123;applyEditData.map((item, index) =&gt; ( &lt;Image key=&#123;index&#125; style=&#123;&#123; width: 30, height: 30, marginLeft: 10 &#125;&#125; source=&#123;&#123; uri: item.icon &#125;&#125; /&gt; ))&#125; &lt;/ScrollView&gt; &lt;TouchableOpacity onPress=&#123;() =&gt; this.props.editAction()&#125;&gt; &lt;View style=&#123;&#123; borderRadius: 4, marginRight: 10, paddingTop: 5, paddingBottom: 5, paddingLeft: 10, paddingRight: 10, borderWidth: 1, borderColor: &#x27;blue&#x27;, &#125;&#125; &gt; &lt;Text style=&#123;&#123; color: &#x27;blue&#x27; &#125;&#125;&gt;ç¼–è¾‘&lt;/Text&gt; &lt;/View&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; ) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, &#125;, icon: &#123; width: 22, height: 22, &#125;,&#125;) ç¬¬äºŒç§å®ç° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571/** * UI é€šè¿‡ å¤–éƒ¨FlatList å†…éƒ¨ ScrollView + view å®ç° (ä½¿ç”¨ä¸‰æ–¹åº“react-native-scrollable-tab-view&amp;&amp;react-native-underline-tabbar) * é€»è¾‘ é€šè¿‡ æ•°æ®ä¸­ id å’Œ tagå®ç° * */import React, &#123; Component &#125; from &#x27;react&#x27;import &#123; StyleSheet, View, Image, Text, Dimensions, TouchableOpacity, FlatList, Linking, ScrollView&#125; from &#x27;react-native&#x27;const &#123; width &#125; = Dimensions.get(&#x27;window&#x27;)import ScrollableTabView from &#x27;react-native-scrollable-tab-view&#x27;import TabBar from &#x27;react-native-underline-tabbar&#x27;export default class Two extends Component &#123; // æ„é€  constructor(props) &#123; super(props) // åˆå§‹çŠ¶æ€ this.state = &#123; startEdit: false, // æ˜¯å¦ç‚¹å‡»äº†ç¼–è¾‘ é»˜è®¤æœªç‚¹å‡»false myApplyData: [], otherApplyData: [], applyData: [ &#123; title: &#x27;æˆ‘çš„åº”ç”¨&#x27;, sub: [ &#123; id: &#x27;10086&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqgy1fu39hosiwoj30j60qyq96.jpg&#x27;, name: &#x27;ä»·è´¹é€š10086&#x27;, &#125;, &#123; id: &#x27;10010&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&#x27;, name: &#x27;å±•ç¤ºä¸­å¿ƒ10010&#x27;, &#125; ], &#125;, &#123; title: &#x27;æ”¿åŠ¡æœåŠ¡&#x27;, sub: [ &#123; subTitle: &#x27;æ”¿ä¼&#x27;, sub: [ &#123; id: &#x27;10086&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqgy1fu39hosiwoj30j60qyq96.jpg&#x27;, name: &#x27;ä»·è´¹é€š10086&#x27;, tag: true, &#125;, &#123; id: &#x27;10010&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&#x27;, name: &#x27;å±•ç¤ºä¸­å¿ƒ10010&#x27;, tag: true, &#125;, &#123; id: &#x27;9&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&#x27;, name: &#x27;åŠäº‹å¹³å°&#x27;, tag: false, &#125;, &#123; id: &#x27;10&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqgy1ftwcw4f4a5j30sg10j1g9.jpg&#x27;, name: &#x27;å°‘å„¿å›¾ä¹¦é¦†&#x27;, tag: false, &#125;, ], &#125;, &#123; subTitle: &#x27;ç¬¬ä¸‰æ–¹æœåŠ¡&#x27;, sub: [ &#123; id: &#x27;11&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;12&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqgy1ftwcw4f4a5j30sg10j1g9.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;13&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftzsj15hgvj30sg15hkbw.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;14&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqgy1ftwcw4f4a5j30sg10j1g9.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;15&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqgy1ftwcw4f4a5j30sg10j1g9.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;16&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftu6gl83ewj30k80tites.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;17&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftu6gl83ewj30k80tites.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;18&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftu6gl83ewj30k80tites.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, ], &#125;, ], &#125;, &#123; title: &#x27;æ”¿ä¼åº”ç”¨&#x27;, sub: [ &#123; subTitle: &#x27;æŒ‰ä¸»é¢˜&#x27;, sub: [ &#123; id: &#x27;19&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftdtot8zd3j30ju0pt137.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;20&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ft5q7ys128j30sg10gnk5.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, ], &#125;, &#123; subTitle: &#x27;æŒ‰éƒ¨é—¨&#x27;, sub: [ &#123; id: &#x27;21&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ftdtot8zd3j30ju0pt137.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, ], &#125;, &#123; subTitle: &#x27;æŒ‰è¯ä»¶&#x27;, sub: [ &#123; id: &#x27;22&#x27;, icon: &#x27;https://ww1.sinaimg.cn/large/0065oQSqly1ft5q7ys128j30sg10gnk5.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, ], &#125;, &#123; subTitle: &#x27;ä¸»ä½“å‘¨æœŸ&#x27;, sub: [ &#123; id: &#x27;23&#x27;, icon: &#x27;http://ww1.sinaimg.cn/large/0065oQSqly1fsoe3k2gkkj30g50niwla.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, &#123; id: &#x27;24&#x27;, icon: &#x27;http://ww1.sinaimg.cn/large/0065oQSqly1fsoe3k2gkkj30g50niwla.jpg&#x27;, name: &#x27;ä»·è´¹é€š&#x27;, tag: false, &#125;, ], &#125;, ], &#125;, ], &#125; &#125; componentDidMount() &#123; var data = this.state.applyData //èµ‹å€¼ æˆ‘çš„åº”ç”¨æ•°æ® this.setState(&#123; myApplyData: data[0].sub, &#125;) //èµ‹å€¼ å…¶ä»–åº”ç”¨æ•°æ® this.setState(&#123; otherApplyData: data.slice(1), &#125;) &#125; render() &#123; return ( &lt;View&gt; &#123;/*æˆ‘çš„åº”ç”¨æ¡-ç¼–è¾‘*/&#125; &lt;MyApplyEdit applyEditData=&#123;this.state.myApplyData&#125; editAction=&#123;() =&gt; &#123; this.editAction() &#125;&#125; /&gt; &#123;/*åº”ç”¨åˆ—è¡¨*/&#125; &lt;FlatList data=&#123;this.state.otherApplyData&#125; style=&#123;&#123; marginBottom: 20 &#125;&#125; ListHeaderComponent=&#123;this.ListHeaderComponent&#125; renderItem=&#123;item =&gt; this.renderItem(item)&#125; keyExtractor=&#123;this.keyExtractor&#125; /&gt; &lt;/View&gt; ) &#125; /** * å»è¯¦æƒ… * */ goDetailsAction =(item) =&gt;&#123; alert(&#x27;å»è¯¦æƒ…&#x27;) &#125; /** * å»é™¤æˆ‘çš„åº”ç”¨ * */ subAction = item =&gt; &#123; var data = this.state.myApplyData // æˆ‘çš„åº”ç”¨æ•°æ® var otherData = this.state.otherApplyData //å…¶ä»–åº”ç”¨æ•°æ® var selectId = item.id // é€‰ä¸­çš„id //ä¿®æ”¹æˆ‘çš„åº”ç”¨æ•°æ®æº data.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; data.splice(index,1) &#125; &#125;) //ä¿®æ”¹å…¶ä»–åº”ç”¨æ•°æ®æº otherData.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; item.tag = false &#125; &#125;) &#125;) &#125;) // é‡æ–°èµ‹å€¼ this.setState(&#123; myApplyData:data, otherApplyData:otherData &#125;) &#125; /** * ç‚¹å‡»å…¶ä»–åº”ç”¨ * */ otherAction =(item) =&gt;&#123; var data = this.state.myApplyData // æˆ‘çš„åº”ç”¨æ•°æ® var otherData = this.state.otherApplyData //å…¶ä»–åº”ç”¨æ•°æ® var selectId = item.id //id console.log(item) //æ ¹æ®æ•°æ®ä¸­tagå€¼åˆ¤æ–­ if(item.tag == true)&#123; //åœ¨æˆ‘çš„åº”ç”¨å½“ä¸­,éœ€è¦å»é™¤ data.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; data.splice(index,1) &#125; &#125;) otherData.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; item.tag = false &#125; &#125;) &#125;) &#125;) &#125;else &#123; //ä¸åœ¨æˆ‘çš„åº”ç”¨å½“ä¸­,éœ€è¦æ·»åŠ  data.push(item) otherData.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; item.sub.map((item,index) =&gt;&#123; if(item.id == selectId)&#123; item.tag = true &#125; &#125;) &#125;) &#125;) &#125; // é‡æ–°èµ‹å€¼ this.setState(&#123; myApplyData:data, otherApplyData:otherData &#125;) &#125; ListHeaderComponent =()=&gt;&#123; var data = this.state.myApplyData return( &lt;View style=&#123;&#123;marginTop:10&#125;&#125;&gt; &lt;HeaderView title=&#x27;æˆ‘çš„åº”ç”¨&#x27;/&gt; &lt;View style=&#123;&#123;flexDirection:&#x27;row&#x27;,backgroundColor:&#x27;#ffffff&#x27;&#125;&#125;&gt; &#123; data.map((item,index) =&gt;( &lt;TouchableOpacity key=&#123;index&#125; onPress=&#123;() =&gt; this.goDetailsAction(item)&#125;&gt; &lt;View style=&#123;&#123; marginTop: 25 &#125;&#125;&gt; &lt;Image style=&#123;&#123; width: 55, height: 55, marginLeft: (width - 55 * 4) / 8, marginRight: (width - 55 * 4) / 8, &#125;&#125; source=&#123;&#123; uri: item.icon &#125;&#125; /&gt; &lt;Text style=&#123;&#123; alignSelf: &#x27;center&#x27;, marginTop: 15, marginBottom: 10 &#125;&#125;&gt; &#123;item.name&#125; &lt;/Text&gt; &lt;TouchableOpacity style=&#123;&#123; position: &#x27;absolute&#x27;, top: -10, right: 10 &#125;&#125; onPress=&#123;() =&gt; this.subAction(item)&#125; &gt; &lt;Image source=&#123;require(&#x27;./image/sub.png&#x27;)&#125; style=&#123;&#123; opacity: this.state.startEdit ? 1 : 0, width: 15, height: 15, &#125;&#125; /&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; &lt;/TouchableOpacity&gt; )) &#125; &lt;/View&gt; &lt;/View&gt; ) &#125; renderItem =(item)=&gt;&#123; console.log(item) return( &lt;View style=&#123;&#123;marginTop:10&#125;&#125;&gt; &lt;HeaderView title=&#123;item.item.title&#125;/&gt; &lt;ScrollableTabView style=&#123;&#123; backgroundColor: &#x27;white&#x27; &#125;&#125; tabBarActiveTextColor=&quot;#118EE9&quot; renderTabBar=&#123;() =&gt; &lt;TabBar underlineColor=&quot;#118EE9&quot; /&gt;&#125; &gt; &#123;item.item.sub.map((item, index) =&gt; ( &lt;View key=&#123;index&#125; tabLabel=&#123;&#123; label: item.subTitle &#125;&#125;&gt; &lt;ScrollView&gt; &lt;View style=&#123;&#123; flexDirection: &#x27;row&#x27;, height: 250, flexWrap: &#x27;wrap&#x27;, &#125;&#125; &gt; &#123;item.sub.map((item, index) =&gt; ( &lt;TouchableOpacity key=&#123;index&#125; onPress=&#123;() =&gt; this.goDetailsAction(item)&#125; &gt; &lt;View style=&#123;&#123; marginTop: 25 &#125;&#125;&gt; &lt;Image style=&#123;&#123; width: 55, height: 55, marginLeft: (width - 55 * 4) / 8, marginRight: (width - 55 * 4) / 8, &#125;&#125; source=&#123;&#123; uri: item.icon &#125;&#125; /&gt; &lt;Text style=&#123;&#123; alignSelf: &#x27;center&#x27;, marginTop: 15, marginBottom: 10, &#125;&#125; &gt; &#123;item.name&#125; &lt;/Text&gt; &lt;TouchableOpacity style=&#123;&#123; position: &#x27;absolute&#x27;, top: -10, right: 10, &#125;&#125; onPress=&#123;() =&gt; this.otherAction(item)&#125; &gt; &lt;Image source=&#123; item.tag ? require(&#x27;./image/sub.png&#x27;) : require(&#x27;./image/add.png&#x27;) &#125; style=&#123;&#123; opacity: this.state.startEdit ? 1 : 0, width: 15, height: 15, &#125;&#125; /&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; &lt;/TouchableOpacity&gt; ))&#125; &lt;/View&gt; &lt;/ScrollView&gt; &lt;/View&gt; ))&#125; &lt;/ScrollableTabView&gt; &lt;/View&gt; ) &#125; keyExtractor = item =&gt; item.title /** * ç‚¹å‡»ç¼–è¾‘ * */ editAction = () =&gt; &#123; this.setState(&#123; startEdit:!this.state.startEdit &#125;) &#125;&#125;// ä¸Šæ–¹çš„ç¼–è¾‘ æˆ‘çš„åº”ç”¨æ¡† UIclass MyApplyEdit extends React.Component &#123; render() &#123; const &#123; applyEditData &#125; = this.props return ( &lt;View style=&#123;&#123; paddingTop: 5, paddingBottom: 5, alignItems: &#x27;center&#x27;, flexDirection: &#x27;row&#x27;, backgroundColor: &#x27;#ffffff&#x27;, &#125;&#125; &gt; &lt;Text style=&#123;&#123; marginLeft: 10, fontWeight: &#x27;700&#x27; &#125;&#125;&gt;æˆ‘çš„åº”ç”¨&lt;/Text&gt; &lt;ScrollView showsHorizontalScrollIndicator=&#123;false&#125; showsVerticalScrollIndicator=&#123;false&#125; horizontal=&#123;true&#125; style=&#123;&#123; marginRight: 15 &#125;&#125; &gt; &#123;applyEditData.map((item, index) =&gt; ( &lt;Image key=&#123;index&#125; style=&#123;&#123; width: 30, height: 30, marginLeft: 10 &#125;&#125; source=&#123;&#123; uri: item.icon &#125;&#125; /&gt; ))&#125; &lt;/ScrollView&gt; &lt;TouchableOpacity onPress=&#123;() =&gt; this.props.editAction()&#125;&gt; &lt;View style=&#123;&#123; borderRadius: 4, marginRight: 10, paddingTop: 5, paddingBottom: 5, paddingLeft: 10, paddingRight: 10, borderWidth: 1, borderColor: &#x27;blue&#x27;, &#125;&#125; &gt; &lt;Text style=&#123;&#123; color: &#x27;blue&#x27; &#125;&#125;&gt;ç¼–è¾‘&lt;/Text&gt; &lt;/View&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; ) &#125;&#125;// å¤´è§†å›¾class HeaderView extends React.Component &#123; render() &#123; const &#123; title &#125; = this.props return ( &lt;View style=&#123;&#123; backgroundColor:&#x27;#ffffff&#x27;, flexDirection: &#x27;row&#x27;, alignItems: &#x27;center&#x27;, paddingTop:10 &#125;&#125; &gt; &lt;View style=&#123;&#123; marginLeft: 10, width: 8, height: 20, backgroundColor: &#x27;blue&#x27;, &#125;&#125; /&gt; &lt;Text style=&#123;&#123; marginLeft: 10, fontWeight: &#x27;700&#x27; &#125;&#125;&gt; &#123;title&#125; &lt;/Text&gt; &lt;/View&gt; ) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, &#125;, icon: &#123; width: 22, height: 22, &#125;,&#125;) ä»¥åå°±æ˜¯ä¸¤ç§å®ç°,åŸºæœ¬çš„åŠŸèƒ½å®ç°äº†,è‡³äºç»†èŠ‚ä¼˜åŒ–ç‚¹ç­‰æ—¥åæ…¢æ…¢å†åšå§.æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"React-Native\"æ”¶èµ·-å±•å¼€\"åŠŸèƒ½å®ç°","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /React-Native<æ”¶èµ·-å±•å¼€>åŠŸèƒ½å®ç°","date":"2018-08-10T16:00:00.000Z","updated":"2019-04-22T07:57:09.000Z","comments":true,"path":"2018/08/11/ç§»åŠ¨ç«¯å­¦ä¹ /React-Native<æ”¶èµ·-å±•å¼€>åŠŸèƒ½å®ç°/","link":"","permalink":"https://zhoushaoting.com/2018/08/11/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/React-Native%3C%E6%94%B6%E8%B5%B7-%E5%B1%95%E5%BC%80%3E%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0/","excerpt":"è¿‘æ¥å…¬å¸çš„é¡¹ç›®é‡Œé¢æ¶‰åŠåˆ°ä¸€ä¸ªç±»ä¼¼â€æ”¶èµ·-å±•å¼€â€çš„UIåŠŸèƒ½æ¨¡å—,å…ˆæ˜¯åœ¨ç½‘ä¸ŠçŒ¥çä¸€ç•ªä¹‹å,å¹¶æœªå‘ç°ä»€ä¹ˆ.æ— å¥ˆä¹‹ä¸‹,åªèƒ½è‡ªå·±æ‰‹æ’¸ä¸€ä¸ªäº†.","text":"è¿‘æ¥å…¬å¸çš„é¡¹ç›®é‡Œé¢æ¶‰åŠåˆ°ä¸€ä¸ªç±»ä¼¼â€æ”¶èµ·-å±•å¼€â€çš„UIåŠŸèƒ½æ¨¡å—,å…ˆæ˜¯åœ¨ç½‘ä¸ŠçŒ¥çä¸€ç•ªä¹‹å,å¹¶æœªå‘ç°ä»€ä¹ˆ.æ— å¥ˆä¹‹ä¸‹,åªèƒ½è‡ªå·±æ‰‹æ’¸ä¸€ä¸ªäº†. ä¸€å¼€å§‹åšäº†ä¸ªâ€äº’æ–¥æ”¶èµ·-å±•å¼€â€,å…¬å¸å¯èƒ½ä¸å¤ªæ»¡æ„,è®©æˆ‘æŠ„å¦å¤–ä¸€ä¸ªAPPâ€éäº’æ–¥æ”¶èµ·-å±•å¼€â€,å“â€¦å…ˆä¸Šå›¾:éäº’æ–¥ç¼©ä¸€ç¼© äº’æ–¥ç¼©ä¸€ç¼© å®ç°åŸç†å¾ˆç®€å•:éäº’æ–¥ç¼©ä¸€ç¼©: å…ˆåœ¨jsonæ•°æ®é‡Œé¢å®šä¹‰typeæ ‡ç¤º,æ ‡ç¤ºä¸€çº§å±•å¼€|æ”¶èµ·çŠ¶æ€,åœ¨UIé‡Œé¢å°±æ ¹æ®è¿™ä¸ªæ ‡ç¤ºåˆ¤æ–­æ˜¯æ”¶èµ·è¿˜æ˜¯å±•å¼€,è€ŒäºŒçº§æ”¶èµ·|å±•å¼€éœ€è¦ä¸ºæ¯ç»„æ•°æ®å®šä¹‰ä¸€ä¸ªå”¯ä¸€æ ‡ç¤º.äº’æ–¥ç¼©ä¸€ç¼©:å…ˆå®šä¹‰ä¸€ä¸ªstate,æ ¹æ®è¯¥stateæ¥æ˜¾ç¤ºæ”¶èµ·UIè¿˜æ˜¯å±•å¼€,å› ä¸ºstateåªæœ‰ä¸€ä¸ª,ä¹Ÿå°±å½¢æˆäº†åªæœ‰ä¸€ç»„æ˜¯å±•å¼€.åŒæ—¶,åœ¨åˆ¤æ–­äºŒæ¬¡å±•å¼€|æ”¶èµ·è¿™é‡Œä¹Ÿéœ€è¦åœ¨jsoné‡Œé¢å®šä¹‰ä¸€ä¸ªå”¯ä¸€æ ‡ç¤º.è¿™äº›æ•°æ®æ ‡ç¤ºå¯ä»¥äº‹å…ˆå’Œåç«¯äººå‘˜å•†é‡å¥½,è®©åç«¯äººå‘˜å¸®ä½ å¼„å¥½,ä¹Ÿå¯ä»¥è‡ªå·±æ‹¿åˆ°æ•°æ®ä¹‹åå†æ’å…¥.åºŸè¯ä¸å¤šå°‘,æˆ´èµ·ç£¨ç ‚æ‰‹å¥—å¼€å§‹æ’¸!!!ç›´æ¥ä¸Šæºç :éäº’æ–¥ç¼©ä¸€ç¼© 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304/* eslint-disable */import React, &#123; Component &#125; from &#x27;react&#x27;import &#123; StyleSheet, View, Image, Text, Dimensions, TouchableOpacity, FlatList, Linking,&#125; from &#x27;react-native&#x27;const &#123; width &#125; = Dimensions.get(&#x27;window&#x27;)export default class One extends Component &#123; // æ„é€  constructor(props) &#123; super(props) // åˆå§‹çŠ¶æ€ this.row = null this.state = &#123; governmentData: [ &#123; id: &#x27;0&#x27;, name: &#x27;ç¤¾ä¼šä¿éšœå±€&#x27;, type: false, childs: [ &#123; index: &#x27;00&#x27;, name: &#x27;èµ„æ–™æ•™å®¤&#x27;, type: false, tel: &#x27;5233&#x27;, message: &#x27;æŸ¥è¯¢èµ„æ–™,æ³¨é”€æ¡£æ¡ˆ&#x27;, &#125;, &#123; name: &#x27;åå‹¤éƒ¨&#x27;, type: false, index: &#x27;01&#x27;, tel: &#x27;1645682&#x27;, message: &#x27;ä¸å¯¹å¤–æœåŠ¡&#x27;, &#125;, ], &#125;, &#123; id: &#x27;1&#x27;, name: &#x27;å«ç”Ÿå±€&#x27;, type: false, childs: [ &#123; name: &#x27;å¦‡äº§ç§‘&#x27;, type: false, index: &#x27;10&#x27;, tel: &#x27;112è½¬678&#x27;, message: &#x27;æ¥å¾…å­•å¦‡,å¾…äº§å­•å¦‡,å†›å«‚é¢„å…ˆ&#x27;, &#125;, &#123; name: &#x27;å„¿ç§‘&#x27;, type: false, index: &#x27;11&#x27;, tel: &#x27;112è½¬008&#x27;, message: &#x27;å°äº12å‘¨å²å„¿ç«¥å°±åŒ»&#x27;, &#125;, &#123; name: &#x27;å¤±æ‹ç§‘&#x27;, type: false, index: &#x27;12&#x27;, tel: &#x27;112è½¬å‡ºå»&#x27;, message: &#x27;å›å®¶ç©è›‹å»!!!&#x27;, &#125;, ], &#125;, &#123; id: &#x27;2&#x27;, name: &#x27;ç¥ç›¾å±€&#x27;, type: false, childs: [ &#123; name: &#x27;åŸç®¡å¤§é˜Ÿ&#x27;, type: false, index: &#x27;20&#x27;, tel: &#x27;110&#x27;, title: &#x27;æ‰“æ‰“æ‰“&#x27;, message: &#x27;é•‡å‹èµ·ä¹‰&#x27;, &#125;, ], &#125;, ], isRefresh: true, index: -1, //é»˜è®¤å±•å¼€è´Ÿä¸€è¡Œ indexIndex: -1, &#125; &#125; componentDidMount() &#123; this.flatlist = null this.setState(&#123; isRefresh: false, &#125;) &#125; /** * ä¸‹æ‹‰åˆ·æ–° * */ onRefresh = () =&gt; &#123; this.setState(&#123; isRefresh: false, &#125;) &#125; /** * ç‚¹å‡»ä¸€çº§ * */ itemOnclick = item =&gt; &#123; var data = this.state.governmentData data.map((itemm, i) =&gt; &#123; if (i == item.index) &#123; itemm.type = !itemm.type &#125; &#125;) this.setState(&#123; governmentData: data, &#125;) &#125; /** * ç‚¹å‡»äºŒçº§ * */ itemitemOnclick = e =&gt; &#123; var data = this.state.governmentData data.map((item, index) =&gt; &#123; item.childs.map((item, index) =&gt; &#123; if (item.index == e.index) &#123; item.type = !item.type &#125; &#125;) &#125;) this.setState(&#123; governmentData: data, &#125;) &#125; /** * æ‰“ç”µè¯ * */ tellPhone = item =&gt; &#123; Linking.openURL(`tel:$&#123;item.tel&#125;`) &#125; /** * FlatList render * */ renderRow = item =&gt; ( &lt;View ref=&#123;item.index&#125;&gt; &lt;View&gt; &lt;TouchableOpacity onPress=&#123;() =&gt; this.itemOnclick(item)&#125;&gt; &lt;View style=&#123;&#123; flexDirection: &#x27;row&#x27;, backgroundColor: &#x27;white&#x27;, height: 30, alignItems: &#x27;center&#x27;, &#125;&#125; &gt; &lt;View style=&#123;&#123; marginLeft: 5, width: 4, height: 10, paddingTop: 7, paddingBottom: 7, backgroundColor:&#x27;red&#x27; &#125;&#125; /&gt; &lt;Text style=&#123;&#123; color: &#x27;#333333&#x27;, marginLeft: 5, fontSize: 16 &#125;&#125;&gt; &#123;item.item.name&#125; &lt;/Text&gt; &#123;/* å³è¾¹ç®­å¤´ */&#125; &lt;Image source=&#123; item.item.type ? require(&#x27;./image/btnDown.png&#x27;) : require(&#x27;./image/right.png&#x27;) &#125; style=&#123;&#123; position: &#x27;absolute&#x27;, right: 15, width: 15, height: 15 &#125;&#125; /&gt; &lt;/View&gt; &lt;/TouchableOpacity&gt; &lt;View style=&#123;&#123; backgroundColor: &#x27;rgb(228,228,228)&#x27;, width: width, height: 1, &#125;&#125; /&gt; &lt;/View&gt; &#123;item.item.type ? item.item.childs.map((item, index) =&gt; ( &lt;View style=&#123;&#123; backgroundColor: &#x27;white&#x27; &#125;&#125; key=&#123;index&#125;&gt; &lt;View style=&#123;&#123; marginLeft: 7, marginTop: 10 &#125;&#125;&gt; &lt;View style=&#123;&#123; flexDirection: &#x27;row&#x27; &#125;&#125;&gt; &lt;Image source=&#123; item.type ? require(&#x27;./image/btnDownB.png&#x27;) : require(&#x27;./image/btnRightB.png&#x27;) &#125; style=&#123;&#123; width: 10, height: 10 &#125;&#125; /&gt; &lt;Text onPress=&#123;() =&gt; this.itemitemOnclick(item)&#125; style=&#123;&#123; marginLeft: 7 &#125;&#125; &gt; &#123;item.name&#125; &lt;/Text&gt; &lt;/View&gt; &lt;View style=&#123;&#123; backgroundColor: &#x27;rgb(228,228,228)&#x27;, width: width, height: 1, marginTop: 10, &#125;&#125; /&gt; &lt;/View&gt; &#123;item.type ? ( &lt;View&gt; &lt;View style=&#123;&#123; height: 40, alignItems: &#x27;center&#x27;, flexDirection: &#x27;row&#x27;, &#125;&#125; &gt; &lt;TouchableOpacity style=&#123;&#123; flexDirection: &#x27;row&#x27; &#125;&#125; onPress=&#123;() =&gt; this.tellPhone(item)&#125; &gt; &lt;Image source=&#123;require(&#x27;./image/phone.png&#x27;)&#125; style=&#123;&#123; marginLeft: 10, width: 15, height: 15 &#125;&#125; /&gt; &lt;Text style=&#123;&#123; marginLeft: 10 &#125;&#125;&gt;ç”µè¯ &#123;item.tel&#125;&lt;/Text&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; &lt;View style=&#123;&#123; backgroundColor: &#x27;rgb(228,228,228)&#x27;, width: width, height: 1, &#125;&#125; /&gt; &lt;View style=&#123;&#123; height: 40, alignItems: &#x27;center&#x27;, flexDirection: &#x27;row&#x27;, &#125;&#125; &gt; &lt;Image source=&#123;require(&#x27;./image/tlak.png&#x27;)&#125; style=&#123;&#123; marginLeft: 10, width: 15, height: 15 &#125;&#125; /&gt; &lt;Text style=&#123;&#123; marginLeft: 10 &#125;&#125;&gt;ç•™è¨€ &#123;item.message&#125;&lt;/Text&gt; &lt;/View&gt; &lt;View style=&#123;&#123; backgroundColor: &#x27;rgb(228,228,228)&#x27;, width: width, height: 1, &#125;&#125; /&gt; &lt;/View&gt; ) : null&#125; &lt;/View&gt; )) : null&#125; &lt;/View&gt; ) render() &#123; return ( &lt;FlatList data=&#123;this.state.governmentData&#125; renderItem=&#123;this.renderRow&#125; onRefresh=&#123;() =&gt; this.onRefresh()&#125; refreshing=&#123;this.state.isRefresh&#125; /&gt; ) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, &#125;, icon: &#123; width: 22, height: 22, &#125;,&#125;) äº’æ–¥ç¼©ä¸€ç¼© 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277/* eslint-disable */import React, &#123; Component &#125; from &#x27;react&#x27;import &#123; StyleSheet, View, Image, Text, Dimensions, TouchableOpacity, FlatList, Linking,&#125; from &#x27;react-native&#x27;const &#123; width &#125; = Dimensions.get(&#x27;window&#x27;)export default class Two extends Component &#123; // æ„é€  constructor(props) &#123; super(props) // åˆå§‹çŠ¶æ€ this.state = &#123; governmentData: [ &#123; name: &#x27;ç¤¾ä¼šä¿éšœå±€&#x27;, childs: [ &#123; index:0, name: &#x27;èµ„æ–™æ•™å®¤&#x27;, tel: &#x27;5233&#x27;, message: &#x27;æŸ¥è¯¢èµ„æ–™,æ³¨é”€æ¡£æ¡ˆ&#x27;, &#125;, &#123; index:1, name: &#x27;åå‹¤éƒ¨&#x27;, tel: &#x27;1645682&#x27;, message: &#x27;ä¸å¯¹å¤–æœåŠ¡&#x27;, &#125;, ], &#125;, &#123; name: &#x27;å«ç”Ÿå±€&#x27;, childs: [ &#123; index:0, name: &#x27;å¦‡äº§ç§‘&#x27;, tel: &#x27;112è½¬678&#x27;, message: &#x27;æ¥å¾…å­•å¦‡,å¾…äº§å­•å¦‡,å†›å«‚é¢„å…ˆ&#x27;, &#125;, &#123; index:1, name: &#x27;å„¿ç§‘&#x27;, tel: &#x27;112è½¬008&#x27;, message: &#x27;å°äº12å‘¨å²å„¿ç«¥å°±åŒ»&#x27;, &#125;, &#123; index:2, name: &#x27;å¤±æ‹ç§‘&#x27;, tel: &#x27;112è½¬å‡ºå»&#x27;, message: &#x27;å›å®¶ç©è›‹å»!!!&#x27;, &#125;, ], &#125;, &#123; name: &#x27;ç¥ç›¾å±€&#x27;, childs: [ &#123; index:0, name: &#x27;åŸç®¡å¤§é˜Ÿ&#x27;, tel: &#x27;110&#x27;, title: &#x27;æ‰“æ‰“æ‰“&#x27;, message: &#x27;é•‡å‹èµ·ä¹‰&#x27;, &#125;, ], &#125;, ], isRefresh: true, index: -1, //é»˜è®¤å±•å¼€è´Ÿä¸€è¡Œ indexIndex: -1, &#125; &#125; componentDidMount() &#123; this.setState(&#123; isRefresh: false, &#125;) &#125; /** * ä¸‹æ‹‰åˆ·æ–° * */ onRefresh = () =&gt; &#123; this.setState(&#123; isRefresh: false, &#125;) &#125; /** * ç‚¹å‡»ä¸€çº§ * */ itemOnclick = item =&gt; &#123; this.setState(&#123; index: item.index, indexIndex: -1 &#125;) &#125; /** * ç‚¹å‡»äºŒçº§ * */ itemitemOnclick = e =&gt; &#123; this.setState(&#123; indexIndex: e.index, &#125;) &#125; /** * æ‰“ç”µè¯ * */ tellPhone = item =&gt; &#123; Linking.openURL(`tel:$&#123;item.tel&#125;`) &#125; /** * FlatList render * */ renderRow = item =&gt; ( &lt;View ref=&#123;item.index&#125;&gt; &lt;View&gt; &lt;TouchableOpacity onPress=&#123;() =&gt; this.itemOnclick(item)&#125;&gt; &lt;View style=&#123;&#123; flexDirection: &#x27;row&#x27;, backgroundColor: &#x27;white&#x27;, height: 30, alignItems: &#x27;center&#x27;, &#125;&#125; &gt; &lt;View style=&#123;&#123; marginLeft: 5, width: 4, height: 10, paddingTop: 7, paddingBottom: 7, backgroundColor:&#x27;red&#x27; &#125;&#125; /&gt; &lt;Text style=&#123;&#123; color: &#x27;#333333&#x27;, marginLeft: 5, fontSize: 16 &#125;&#125;&gt; &#123;item.item.name&#125; &lt;/Text&gt; &#123;/* å³è¾¹ç®­å¤´ */&#125; &lt;Image source=&#123; item.index == this.state.index ? require(&#x27;./image/btnDown.png&#x27;) : require(&#x27;./image/right.png&#x27;) &#125; style=&#123;&#123; position: &#x27;absolute&#x27;, right: 15, width: 15, height: 15 &#125;&#125; /&gt; &lt;/View&gt; &lt;/TouchableOpacity&gt; &lt;View style=&#123;&#123; backgroundColor: &#x27;rgb(228,228,228)&#x27;, width: width, height: 1, &#125;&#125; /&gt; &lt;/View&gt; &#123;item.index == this.state.index ? item.item.childs.map((item, index) =&gt; ( &lt;View style=&#123;&#123; backgroundColor: &#x27;white&#x27; &#125;&#125; key=&#123;index&#125;&gt; &lt;View style=&#123;&#123; marginLeft: 7, marginTop: 10 &#125;&#125;&gt; &lt;View style=&#123;&#123; flexDirection: &#x27;row&#x27; &#125;&#125;&gt; &lt;Image source=&#123; index == this.state.indexIndex ? require(&#x27;./image/btnDownB.png&#x27;) : require(&#x27;./image/btnRightB.png&#x27;) &#125; style=&#123;&#123; width: 10, height: 10 &#125;&#125; /&gt; &lt;Text onPress=&#123;() =&gt; this.itemitemOnclick(item)&#125; style=&#123;&#123; marginLeft: 7 &#125;&#125; &gt; &#123;item.name&#125; &lt;/Text&gt; &lt;/View&gt; &lt;View style=&#123;&#123; backgroundColor: &#x27;rgb(228,228,228)&#x27;, width: width, height: 1, marginTop: 10, &#125;&#125; /&gt; &lt;/View&gt; &#123;item.index == this.state.indexIndex ? ( &lt;View&gt; &lt;View style=&#123;&#123; height: 40, alignItems: &#x27;center&#x27;, flexDirection: &#x27;row&#x27;, &#125;&#125; &gt; &lt;TouchableOpacity style=&#123;&#123; flexDirection: &#x27;row&#x27; &#125;&#125; onPress=&#123;() =&gt; this.tellPhone(item)&#125; &gt; &lt;Image source=&#123;require(&#x27;./image/phone.png&#x27;)&#125; style=&#123;&#123; marginLeft: 10, width: 15, height: 15 &#125;&#125; /&gt; &lt;Text style=&#123;&#123; marginLeft: 10 &#125;&#125;&gt;ç”µè¯ &#123;item.tel&#125;&lt;/Text&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; &lt;View style=&#123;&#123; backgroundColor: &#x27;rgb(228,228,228)&#x27;, width: width, height: 1, &#125;&#125; /&gt; &lt;View style=&#123;&#123; height: 40, alignItems: &#x27;center&#x27;, flexDirection: &#x27;row&#x27;, &#125;&#125; &gt; &lt;Image source=&#123;require(&#x27;./image/tlak.png&#x27;)&#125; style=&#123;&#123; marginLeft: 10, width: 15, height: 15 &#125;&#125; /&gt; &lt;Text style=&#123;&#123; marginLeft: 10 &#125;&#125;&gt;ç•™è¨€ &#123;item.message&#125;&lt;/Text&gt; &lt;/View&gt; &lt;View style=&#123;&#123; backgroundColor: &#x27;rgb(228,228,228)&#x27;, width: width, height: 1, &#125;&#125; /&gt; &lt;/View&gt; ) : null&#125; &lt;/View&gt; )) : null&#125; &lt;/View&gt; ) render() &#123; return ( &lt;FlatList data=&#123;this.state.governmentData&#125; renderItem=&#123;this.renderRow&#125; onRefresh=&#123;() =&gt; this.onRefresh()&#125; refreshing=&#123;this.state.isRefresh&#125; /&gt; ) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, &#125;, icon: &#123; width: 22, height: 22, &#125;,&#125;) æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"reduxå’Œreact-navigationçš„ç»“åˆä½¿ç”¨","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /reduxå’Œreact-navigationçš„ç»“åˆä½¿ç”¨","date":"2018-07-29T10:36:14.000Z","updated":"2018-07-29T10:36:14.000Z","comments":true,"path":"2018/07/29/ç§»åŠ¨ç«¯å­¦ä¹ /reduxå’Œreact-navigationçš„ç»“åˆä½¿ç”¨/","link":"","permalink":"https://zhoushaoting.com/2018/07/29/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/redux%E5%92%8Creact-navigation%E7%9A%84%E7%BB%93%E5%90%88%E4%BD%BF%E7%94%A8/","excerpt":"react-navigation å’Œ redux çš„ä½¿ç”¨,è¿™ä¸ªç½‘ä¸Šå¾ˆå¤š.è¿™é‡Œä»‹ç»ä¸‹ä¸¤è€…çš„ç»“åˆä½¿ç”¨.","text":"react-navigation å’Œ redux çš„ä½¿ç”¨,è¿™ä¸ªç½‘ä¸Šå¾ˆå¤š.è¿™é‡Œä»‹ç»ä¸‹ä¸¤è€…çš„ç»“åˆä½¿ç”¨. æˆ‘ä»£ç çš„ç›®å½•ç»“æ„æ˜¯: ä½¿ç”¨çš„ä¸‰æ–¹åº“æ˜¯: 1234567891011121314151617181920212223242526272829&#123; &quot;name&quot;: &quot;RN_nav&quot;, &quot;version&quot;: &quot;0.0.1&quot;, &quot;private&quot;: true, &quot;scripts&quot;: &#123; &quot;start&quot;: &quot;node node_modules/react-native/local-cli/cli.js start&quot;, &quot;test&quot;: &quot;jest&quot; &#125;, &quot;dependencies&quot;: &#123; &quot;react&quot;: &quot;16.3.0-alpha.1&quot;, &quot;react-native&quot;: &quot;0.54.0&quot;, &quot;react-navigation&quot;: &quot;^1.5.1&quot;, &quot;react-navigation-redux-helpers&quot;: &quot;^1.0.3&quot;, &quot;react-redux&quot;: &quot;^5.0.7&quot;, &quot;redux&quot;: &quot;^3.7.2&quot;, &quot;redux-actions&quot;: &quot;^2.3.0&quot;, &quot;redux-logger&quot;: &quot;^3.0.6&quot;, &quot;redux-thunk&quot;: &quot;^2.2.0&quot; &#125;, &quot;devDependencies&quot;: &#123; &quot;babel-jest&quot;: &quot;22.4.1&quot;, &quot;babel-preset-react-native&quot;: &quot;4.0.0&quot;, &quot;jest&quot;: &quot;22.4.2&quot;, &quot;react-test-renderer&quot;: &quot;16.3.0-alpha.1&quot; &#125;, &quot;jest&quot;: &#123; &quot;preset&quot;: &quot;react-native&quot; &#125;&#125; ä¸‹é¢æ˜¯å„æ–‡ä»¶çš„æºç .App.js1234567891011121314151617181920/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React,&#123; Component &#125; from &#x27;react&#x27;;import &#123;Provider&#125; from &#x27;react-redux&#x27;;import store from &#x27;./src/store&#x27;;import NavigatorPages from &#x27;./src/AllPages/TabNavigatorPage&#x27;;type Props = &#123;&#125;;export default class App extends Component&lt;Props&gt; &#123; render() &#123; return ( &lt;Provider store=&#123;store&#125;&gt; &lt;NavigatorPages/&gt; &lt;/Provider&gt; ); &#125;&#125; Allreducerstore.js123456789101112131415161718192021import &#123;createStore,applyMiddleware&#125; from &#x27;redux&#x27;;//ä¸­é—´ä»¶import logger from &#x27;redux-logger&#x27;;import thunk from &#x27;redux-thunk&#x27;;import &#123; createReduxBoundAddListener, createReactNavigationReduxMiddleware,&#125; from &#x27;react-navigation-redux-helpers&#x27;;//reducersimport reducers from &#x27;./Allreducer/index&#x27;;//å¼•ç”¨react-navigation-redux-helpersç»„ä»¶æ‰‹åŠ¨åˆ›å»ºä¸­é—´ä»¶,æ¥å—stateå¹¶è¿”å›æ–°çš„state,è®©è·¯ç”±åˆ·æ–°// Note: createReactNavigationReduxMiddleware must be run before createReduxBoundAddListenerconst middleware = createReactNavigationReduxMiddleware( &quot;App&quot;, state =&gt; state.nav,);export const addListener = createReduxBoundAddListener(&quot;App&quot;);const middleWares = [middleware,thunk,logger];export default applyMiddleware(...middleWares)(createStore)(reducers); FirstPageReducer.js1234567891011121314151617181920212223import &#123;handleActions&#125; from &#x27;redux-actions&#x27;;const initialState = &#123; zglNum:0&#125;;export default handleActions(&#123; ADD:(state,action)=&gt;&#123; // alert(state.zglNum) return &#123; ...state, zglNum:state.zglNum + 1, secondState:&#x27;iOS&#x27; &#125; &#125;, SUB:(state,action)=&gt;&#123; return &#123; ...state, zglNum:state.zglNum - 1, secondState:&#x27;Android&#x27; &#125; &#125;&#125;,initialState); SecondPageReducer.js12345678910111213141516/** * Created by shaotingzhou on 2018/3/6. */import &#123;handleActions&#125; from &#x27;redux-actions&#x27;;const initialState = &#123; xxx:0&#125;;export default handleActions(&#123; SECOND:(state,action)=&gt;&#123; return &#123; ...state, xxx:2 &#125; &#125;,&#125;,initialState); index.js12345678910import &#123; combineReducers &#125; from &#x27;redux&#x27;;import TabNavigatorReducer from &#x27;./TabNavigatorReducer&#x27;;import FirstPageReducer from &#x27;./FirstPageReducer&#x27;;import SecondPageReducer from &#x27;./SecondPageReducer&#x27;;const reducers = combineReducers(&#123; TabNavigatorReducer, FirstPageReducer, SecondPageReducer,&#125;);export default reducers; AllPagesFirstPage.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687import React, &#123; PureComponent &#125; from &#x27;react&#x27;;import &#123; StyleSheet, Text, View, TouchableOpacity, Image&#125; from &#x27;react-native&#x27;;import &#123;connect&#125; from &#x27;react-redux&#x27;;import &#123;ADD,SUB&#125; from &#x27;../Actions/FirstPageActions&#x27;;class FirstPage extends PureComponent &#123; static navigationOptions = &#123; title:&#x27;é¦–é¡µ&#x27;, &#125;; // componentWillUpdate()&#123; // alert(this.props.status); // // &#125; // componentDidUpdate()&#123; // alert(this.props.status); // &#125; // ES6 props // static defaultProps=&#123; // zglNum:0, // &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;TouchableOpacity onPress=&#123;()=&gt;&#123; this.props.dispatch(ADD()); &#125;&#125; &gt; &lt;Text style=&#123;styles.welcome&#125;&gt; + &lt;/Text&gt; &lt;/TouchableOpacity&gt; &lt;Text style=&#123;styles.welcome&#125;&gt; &#123;this.props.zglNum&#125; &lt;/Text&gt; &lt;TouchableOpacity onPress=&#123;()=&gt;&#123; this.props.dispatch(SUB()); &#125;&#125; &gt; &lt;Text style=&#123;styles.welcome&#125;&gt; - &lt;/Text&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; ); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &#x27;center&#x27;, alignItems: &#x27;center&#x27;, backgroundColor: &#x27;#F5FCFF&#x27;, &#125;, welcome: &#123; fontSize: 20, textAlign: &#x27;center&#x27;, margin: 10, &#125;, textView: &#123; fontSize: 16, textAlign: &#x27;center&#x27;, margin: 10, color:&#x27;red&#x27; &#125;,&#125;);const mapStateToProps = (store)=&gt;(&#123; zglNum: store.FirstPageReducer.zglNum //æ•°å­—&#125;);export default connect(mapStateToProps)(FirstPage); SecondPage.js12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061import React, &#123; PureComponent &#125; from &#x27;react&#x27;;import &#123; StyleSheet, Text, View, TouchableOpacity, Image&#125; from &#x27;react-native&#x27;;import &#123;connect&#125; from &#x27;react-redux&#x27;;import &#123;SECOND&#125; from &#x27;../Actions/SecondPageActions&#x27;;class SecondPage extends PureComponent &#123; static navigationOptions = &#123; title:&#x27;ç¬¬äºŒ&#x27; &#125;; // ES6 props static defaultProps=&#123; secondState:&#x27;é»˜è®¤&#x27;, &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125; &gt; &lt;Text onPress=&#123;()=&gt;this.onClick()&#125;&gt;&#123;this.props.secondState&#125;&lt;/Text&gt; &lt;/View&gt; ); &#125; onClick =() =&gt;&#123; this.props.navigation.navigate(&#x27;Snnn&#x27;) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &#x27;center&#x27;, alignItems: &#x27;center&#x27;, backgroundColor: &#x27;#F5FCFF&#x27;, &#125;, welcome: &#123; fontSize: 20, textAlign: &#x27;center&#x27;, margin: 10, &#125;, textView: &#123; fontSize: 16, textAlign: &#x27;center&#x27;, margin: 10, color:&#x27;red&#x27; &#125;,&#125;);const mapStateToProps = (store)=&gt;(&#123; secondState:store.FirstPageReducer.secondState&#125;);export default connect(mapStateToProps)(SecondPage); NavigatorPage.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105import React, &#123; Component &#125; from &#x27;react&#x27;;import &#123; StyleSheet, Text, View, TouchableOpacity, Image&#125; from &#x27;react-native&#x27;;import FirstPage from &#x27;./FirstPage&#x27;;import SecondPage from &#x27;./SecondPage&#x27;;import &#123;connect&#125; from &#x27;react-redux&#x27;;import Snnn from &#x27;./Snnn&#x27;import &#123; StackNavigator, addNavigationHelpers, TabNavigator,&#125; from &#x27;react-navigation&#x27;;import &#123;addListener&#125; from &#x27;../store&#x27;;class NavigatorPages extends Component&#123; constructor(props)&#123; super(props); &#125; render()&#123; return( &lt;SimpleAppNavigator navigation=&#123;addNavigationHelpers(&#123; dispatch: this.props.dispatch, state: this.props.nav, addListener &#125;)&#125; /&gt; ) &#125;&#125;const Tab = TabNavigator(&#123; page1: &#123; screen: FirstPage, navigationOptions: (&#123; navigation &#125;) =&gt; (&#123; tabBarLabel: &#x27;è‹¹æœ233&#x27;, tabBarIcon: (&#123; focused, tintColor &#125;) =&gt; ( &lt;Image source=&#123;focused ? require(&#x27;../../image/one_selected.png&#x27;) : require(&#x27;../../image/one.png&#x27;)&#125; style=&#123;&#123; width: 25, height: 25 &#125;&#125; /&gt; ) &#125;), &#125;, page2: &#123; screen: SecondPage, navigationOptions: (&#123; navigation &#125;) =&gt; (&#123; tabBarLabel: &#x27;å®‰å“&#x27;, tabBarIcon: (&#123; focused, tintColor &#125;) =&gt; ( &lt;Image source=&#123;focused ? require(&#x27;../../image/two_selected.png&#x27;) : require(&#x27;../../image/two.png&#x27;) &#125; style=&#123;&#123; width: 25, height: 25 &#125;&#125; /&gt; ) &#125;), &#125;,&#125;,&#123; initialRouteName: &#x27;page1&#x27;, swipeEnabled: true, animationEnabled: true, tabBarPosition:&#x27;bottom&#x27;, lazy: false, tabBarOptions: &#123; showIcon: true, activeTintColor: &#x27;#979797&#x27;, inactiveTintColor: &#x27;#979797&#x27;, style: &#123; backgroundColor: &#x27;#ffffff&#x27; &#125;, &#125;&#125;);export const SimpleAppNavigator = StackNavigator(&#123; Tab: &#123; screen: Tab, &#125;, page1 : &#123; screen: FirstPage, &#125;, page2 : &#123; screen: SecondPage &#125;, Snnn : &#123; screen: Snnn &#125;&#125;);const mapStateToProps = (store)=&gt;(&#123; nav : store.TabNavigatorReducer,&#125;);export default connect(mapStateToProps)(NavigatorPages); ActionsActionsTypes.js123456//Tab1export const ADD = &#x27;ADD&#x27;;export const SUB = &#x27;SUB&#x27;;//Tab2 FirstPageActions.js1234import &#123;createAction&#125; from &#x27;redux-actions&#x27;;import * as TYPES from &#x27;./ActionTypes&#x27;;export const ADD = createAction(TYPES.ADD);export const SUB = createAction(TYPES.SUB); SccondPageActions.js12345/** * Created by shaotingzhou on 2018/3/6. */import &#123;createAction&#125; from &#x27;redux-actions&#x27;;import * as TYPES from &#x27;./ActionTypes&#x27;; æºç æ•ˆæœå›¾: å¦å¤–:dva+react-navigationå¦å¤–:Mbox+react-navigation","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"dvaå’Œreact-navigationçš„ç»“åˆä½¿ç”¨","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /dvaå’Œreact-navigationçš„ç»“åˆä½¿ç”¨","date":"2018-07-28T16:00:00.000Z","updated":"2019-04-22T08:03:07.000Z","comments":true,"path":"2018/07/29/ç§»åŠ¨ç«¯å­¦ä¹ /dvaå’Œreact-navigationçš„ç»“åˆä½¿ç”¨/","link":"","permalink":"https://zhoushaoting.com/2018/07/29/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/dva%E5%92%8Creact-navigation%E7%9A%84%E7%BB%93%E5%90%88%E4%BD%BF%E7%94%A8/","excerpt":"ä»Šå¤©,å­¦ä¹ ä¸‹RNä¸­çš„å¦å¤–ä¸€ä¸ªå…¨å®¶æ¡¶å¥—é¤æ¶æ„:dva+React-Navigation,æœ¬æ–‡åŸºäºreact-native:0.55.4,dva-core:^1.3.0,react-navigation:^2.5.1,react-navigation-redux-helpers:^2.0.4,react-redux:0^5.0.7æ‰€æ’¸.","text":"ä»Šå¤©,å­¦ä¹ ä¸‹RNä¸­çš„å¦å¤–ä¸€ä¸ªå…¨å®¶æ¡¶å¥—é¤æ¶æ„:dva+React-Navigation,æœ¬æ–‡åŸºäºreact-native:0.55.4,dva-core:^1.3.0,react-navigation:^2.5.1,react-navigation-redux-helpers:^2.0.4,react-redux:0^5.0.7æ‰€æ’¸. react-nativeçš„å®˜æ–¹dva-demodvaå®˜æ–¹github åºŸè¯ä¸å¤šç¼©,é¦–å…ˆ,æ–°å»ºä¸€ä¸ªé¡¹ç›®,æ·»åŠ ä¸€å †ç›¸åº”åº“:npm install mobx dva-core --save å¼•å…¥dvanpm install mobx react-navigation-redux-helpers --save å¼•å…¥react-navigation-redux-helpersnpm install mobx react-redux --save å¼•å…¥react-reduxnpm install babel-plugin-transform-decorators-legacy babel-preset-react-native-stage-0 --save-dev èƒ½å¤Ÿä½¿ç”¨@æ ‡ç­¾npm install react-navigation --save å¼•å…¥å¯¼èˆªåº“ç„¶åä¿®æ”¹ä¸€ä¸‹å·¥ç¨‹é‡Œé¢çš„.babelrc: 12345&#123; &quot;presets&quot;: [&quot;react-native&quot;], &quot;plugins&quot;: [&quot;transform-decorators-legacy&quot;]&#125; OK,åŸºæœ¬çš„æ¶å­å·²ç»æ­å¥½.ç„¶åæ–°å»ºä¸€ä¸ªsrcç›®å½•.è¿™é‡Œå­˜æ”¾åŸºæœ¬ä»£ç å’ŒåŸºæœ¬å›¾ç‰‡ä¹‹ç±»çš„. ç„¶å,åœ¨å…¥å£æ–‡ä»¶index.jsä¸­,ä¿®æ”¹ä¸€ä¸‹ä»£ç : 12345678import &#x27;./App&#x27;;console.ignoredYellowBox = [ &#x27;Warning: componentWillMount is deprecated&#x27;, &#x27;Warning: componentWillReceiveProps is deprecated&#x27;, &#x27;Warning: componentWillUpdate is deprecated&#x27;, &#x27;Warning: isMounted(...) is deprecated&#x27;,] åœ¨App.jsä¸­åŸºç¡€ä»£ç : 1234567891011121314151617181920import React from &#x27;react&#x27;import &#123; AppRegistry &#125; from &#x27;react-native&#x27;import dva from &#x27;./src/Utils/dva&#x27;import Router, &#123; routerMiddleware, routerReducer &#125; from &#x27;./router&#x27;import appModel from &#x27;./src/models/app&#x27;const app = dva(&#123; initialState: &#123;&#125;, models: [appModel], extraReducers: &#123; router: routerReducer &#125;, onAction: [routerMiddleware], onError(e) &#123; console.log(&#x27;onError&#x27;, e) &#125;,&#125;)const App = app.start(&lt;Router /&gt;)AppRegistry.registerComponent(&#x27;rn_dva&#x27;, () =&gt; App) ok,å¦‚ä¸Šå›¾æ‰€ç¤º,dvaçš„ä»£ç ç›¸æ¯”reduxæ¥è¯´å°‘äº†å¾ˆå¤š,ä¸åœ¨éœ€è¦å¤§é‡çš„èµ‹å€¼ç²˜è´´,åŸºæœ¬çš„é€»è¾‘ä»£ç å‡å¯ä»¥æ”¾åœ¨modelsä¸­,å…¶ä¸­çš„Utilsåªæ˜¯dvaçš„ä¸€ä¸ªå·¥å…·ç»„,å…¶ä¸­çš„ä»£ç å¹¶ä¸å¤š.ä¸€å¦‚æ—¢å¾€,å¯¹ç€IDEå°±æ˜¯ä¸€å †ç–¯ç‹‚è¾“å‡º.å®Œæˆçš„åŠŸèƒ½å’Œä¹‹å‰çš„reduxå’ŒMobxä¸€æ ·.modelsä¸‹çš„app.js 1234567891011121314151617181920212223242526import &#123; createAction, NavigationActions &#125; from &#x27;../Utils&#x27;export default &#123; namespace: &#x27;app&#x27;, state: &#123; num: 0, mineType: &#x27;çº¢&#x27;, &#125;, reducers: &#123; updateState(state, &#123; payload &#125;) &#123; return &#123; ...state, ...payload &#125; &#125;, &#125;, effects: &#123; *add(&#123; payload &#125;, &#123; call, put &#125;) &#123; yield put(createAction(&#x27;updateState&#x27;)(&#123; num:payload ,mineType:&#x27;çº¢&#x27;&#125;)) &#125;, *sub(&#123; payload &#125;, &#123; call, put &#125;) &#123; yield put(createAction(&#x27;updateState&#x27;)(&#123; num:payload ,mineType:&#x27;è“&#x27; &#125;)) &#125; &#125;, subscriptions: &#123; &#125;,&#125; Utilsä¸‹çš„dva.js 12345678910111213141516171819202122import React from &#x27;react&#x27;import &#123; create &#125; from &#x27;dva-core&#x27;import &#123; Provider, connect &#125; from &#x27;react-redux&#x27;export &#123; connect &#125;export default function(options) &#123; const app = create(options) // HMR workaround if (!global.registered) options.models.forEach(model =&gt; app.model(model)) global.registered = true app.start() // eslint-disable-next-line no-underscore-dangle const store = app._store app.start = container =&gt; () =&gt; &lt;Provider store=&#123;store&#125;&gt;&#123;container&#125;&lt;/Provider&gt; app.getStore = () =&gt; store return app&#125; Utilsä¸‹çš„index.js 1234export &#123; NavigationActions, StackActions &#125; from &#x27;react-navigation&#x27;export const createAction = type =&gt; payload =&gt; (&#123; type, payload &#125;) å‰©ä¸‹çš„å°±æ˜¯ä¸¤ä¸ªUIç•Œé¢äº†:One.js 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &#x27;react&#x27;;import &#123; Platform, StyleSheet, Text, View, Image&#125; from &#x27;react-native&#x27;;import &#123; connect &#125; from &#x27;react-redux&#x27;import &#123; createAction, NavigationActions &#125; from &#x27;../Utils&#x27;import &#123;Images&#125; from &quot;../Image&quot;;const instructions = Platform.select(&#123; ios: &#x27;Press Cmd+R to reload,\\n&#x27; + &#x27;Cmd+D or shake for dev menu&#x27;, android: &#x27;Double tap R on your keyboard to reload,\\n&#x27; + &#x27;Shake or press menu button for dev menu&#x27;,&#125;);type Props = &#123;&#125;;@connect((&#123; app &#125;) =&gt; (&#123; ...app &#125;))export default class One extends Component&lt;Props&gt; &#123; static navigationOptions = &#123; tabBarLabel: &#x27;è‹¹æœ&#x27;, tabBarIcon: (&#123; focused, tintColor &#125;) =&gt; ( &lt;Image source=&#123;focused ? Images.Tab.OneActive : Images.Tab.One&#125; style=&#123;&#123; width: 25, height: 25 &#125;&#125; /&gt; ), &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text onPress=&#123;()=&gt;this.add()&#125;&gt; + çº¢ &lt;/Text&gt; &lt;Text&gt; One &#123;this.props.num&#125; &lt;/Text&gt; &lt;Text onPress=&#123;()=&gt;this.sub()&#125;&gt; - è“ &lt;/Text&gt; &lt;/View&gt; ); &#125; add =() =&gt;&#123; this.props.dispatch(createAction(&#x27;app/add&#x27;)(this.props.num + 1)) &#125; sub =() =&gt;&#123; this.props.dispatch(createAction(&#x27;app/sub&#x27;)(this.props.num - 1)) &#125; componentDidMount() &#123; console.log(this.props) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &#x27;center&#x27;, alignItems: &#x27;center&#x27;, backgroundColor: &#x27;#F5FCFF&#x27;, &#125;, welcome: &#123; fontSize: 20, textAlign: &#x27;center&#x27;, margin: 10, &#125;, instructions: &#123; textAlign: &#x27;center&#x27;, color: &#x27;#333333&#x27;, marginBottom: 5, &#125;,&#125;); Two.js 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &#x27;react&#x27;;import &#123; Platform, StyleSheet, Text, View, Image&#125; from &#x27;react-native&#x27;;import &#123; connect &#125; from &#x27;react-redux&#x27;import &#123; createAction, NavigationActions &#125; from &#x27;../Utils&#x27;import &#123;Images&#125; from &quot;../Image&quot;;const instructions = Platform.select(&#123; ios: &#x27;Press Cmd+R to reload,\\n&#x27; + &#x27;Cmd+D or shake for dev menu&#x27;, android: &#x27;Double tap R on your keyboard to reload,\\n&#x27; + &#x27;Shake or press menu button for dev menu&#x27;,&#125;);type Props = &#123;&#125;;@connect((&#123; app &#125;) =&gt; (&#123; ...app &#125;))export default class Two extends Component&lt;Props&gt; &#123; static navigationOptions = &#123; tabBarLabel: &#x27;å®‰å“&#x27;, tabBarIcon: (&#123; focused, tintColor &#125;) =&gt; ( &lt;Image source=&#123;focused ? Images.Tab.TwoActive : Images.Tab.Two&#125; style=&#123;&#123; width: 25, height: 25 &#125;&#125; /&gt; ), &#125; render() &#123; return ( &lt;View style=&#123;[styles.container,&#123;backgroundColor:this.props.mineType == &#x27;çº¢&#x27; ? &#x27;red&#x27; : &#x27;blue&#x27;&#125;]&#125;&gt; &lt;Text style=&#123;styles.welcome&#125;&gt; TWO + &#123;this.props.mineType&#125; &lt;/Text&gt; &lt;/View&gt; ); &#125; componentDidMount() &#123; console.log(this.props.mineType) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &#x27;center&#x27;, alignItems: &#x27;center&#x27;, backgroundColor: &#x27;#F5FCFF&#x27;, &#125;, welcome: &#123; fontSize: 20, textAlign: &#x27;center&#x27;, margin: 10, &#125;, instructions: &#123; textAlign: &#x27;center&#x27;, color: &#x27;#333333&#x27;, marginBottom: 5, &#125;,&#125;); OK,ä»¥ä¸Šå°±æ˜¯å…¨éƒ¨ä»£ç .æ•ˆæœå›¾: æºç åœ°å€ å¦å¤–:redux+react-navigationå¦å¤–:Mbox+react-navigation","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Reactå­¦ä¹ :ç®€å•ä¸ªäººæ¶ˆè´¹è®°è´¦ç³»ç»Ÿ","slug":"å‰ç«¯å­¦ä¹ /Reactå­¦ä¹ ~ç®€å•ä¸ªäººæ¶ˆè´¹è®°è´¦ç³»ç»Ÿ","date":"2018-06-28T16:00:00.000Z","updated":"2019-03-03T12:33:42.000Z","comments":true,"path":"2018/06/29/å‰ç«¯å­¦ä¹ /Reactå­¦ä¹ ~ç®€å•ä¸ªäººæ¶ˆè´¹è®°è´¦ç³»ç»Ÿ/","link":"","permalink":"https://zhoushaoting.com/2018/06/29/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/React%E5%AD%A6%E4%B9%A0~%E7%AE%80%E5%8D%95%E4%B8%AA%E4%BA%BA%E6%B6%88%E8%B4%B9%E8%AE%B0%E8%B4%A6%E7%B3%BB%E7%BB%9F/","excerpt":"ä»Šå¤©å­¦ä¹ React,å†™ä¸€ä¸ªå°demoè®°å½•ä¸€ä¸‹,å¼„ä¸€ä¸ªç®€å•çš„ä¸ªäººæ¶ˆè´¹è®°è´¦ç³»ç»Ÿ.","text":"ä»Šå¤©å­¦ä¹ React,å†™ä¸€ä¸ªå°demoè®°å½•ä¸€ä¸‹,å¼„ä¸€ä¸ªç®€å•çš„ä¸ªäººæ¶ˆè´¹è®°è´¦ç³»ç»Ÿ. ä½¿ç”¨è„šæ‰‹æ¶ create-react-app ,åå°ä½¿ç”¨mockAPIæ¨¡æ‹Ÿ,ç½‘ç»œè¯·æ±‚ä½¿ç”¨axios,cssæ•ˆæœä½¿ç”¨bootstrap/4.0.0 .å…ˆæ¥ä¸ªæ•ˆæœå›¾:å…¶ä¸»è¦ä»£ç å‡åœ¨../src/componentsä¸­,ä¸»æ–‡ä»¶æ˜¯Records.js,å…·ä½“çš„æ¶ˆè´¹è®°å½•æ˜¯Record.js,æ€»æ¶ˆè´¹è®°å½•æ˜¯Box.js,æ¶ˆè´¹è®°å½•çš„åˆ›å»ºæ˜¯RecordForm.js ,ä¸‹é¢æ˜¯å…¶æºç :Records.js 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175import React, &#123; Component &#125; from &#x27;react&#x27;;import Record from &#x27;./Record&#x27;import RecordForm from &#x27;./RecordForm&#x27;import Box from &#x27;./Box&#x27;import axios from &#x27;axios&#x27;export default class Records extends Component &#123; // æ„é€  constructor(props) &#123; super(props); // åˆå§‹çŠ¶æ€ this.state = &#123; error:null, //ç½‘ç»œé”™è¯¯ä¿¡æ¯ isLoader:true, //åŠ è½½æ ‡ç¤º records:[] //æ•°æ® &#125;; &#125; render() &#123; //æ ¹æ® error isLoader æ˜¾ç¤ºä¸åŒUI //å¦‚æœerroræœ‰å€¼,æ˜¾ç¤ºerrorUI //å¦‚æœisLoader ä¸ºtrue,æ˜¾ç¤ºåŠ è½½UI //å¦‚æœisLoader ä¸ºfalse,æ˜¾ç¤ºæ­£ç¡®æ•°æ®UI const &#123;error,isLoader,records&#125; = this.state let renderRecords; if(error)&#123; renderRecords = &lt;div&gt;å‡ºé”™äº†:&#123;error&#125;&lt;/div&gt; &#125;else if(isLoader)&#123; renderRecords = &lt;div&gt;&lt;img src=&#123;require(&#x27;./loading.gif&#x27;)&#125; /&gt;&lt;/div&gt; &#125;else &#123; renderRecords = ( &lt;div&gt; &lt;table className=&quot;table table-bordered&quot;&gt; &lt;thead&gt; &lt;tr&gt; &lt;th&gt;æ—¥æœŸ&lt;/th&gt; &lt;th&gt;æ ‡é¢˜&lt;/th&gt; &lt;th&gt;é‡‘é¢&lt;/th&gt; &lt;th&gt;äº‹ä»¶&lt;/th&gt; &lt;/tr&gt; &lt;/thead&gt; &lt;tbody&gt; &#123;records.map((item,index)=&gt; &lt;Record key =&#123;item.id&#125; record=&#123;item&#125; updateData=&#123;this.updateRecord.bind(this)&#125; deleteData=&#123;this.deleteRecord.bind(this)&#125; /&gt; )&#125; &lt;/tbody&gt; &lt;/table&gt; &lt;/div&gt; ); &#125; return( &lt;div&gt; &lt;h2&gt;æ¶ˆè´¹è®°å½•&lt;/h2&gt; &lt;div className=&quot;row mb-3&quot;&gt; &lt;Box text=&quot;æ”¶å…¥&quot; type=&quot;success&quot; amount=&#123;this.credits()&#125; /&gt; &lt;Box text=&quot;æ”¯å‡º&quot; type=&quot;danger&quot; amount=&#123;this.debits()&#125; /&gt; &lt;Box text=&quot;ä½™é¢&quot; type=&quot;info&quot; amount=&#123;this.balance()&#125; /&gt; &lt;/div&gt; &lt;RecordForm handleNewRecord = &#123;this.addRecord.bind(this)&#125; /&gt; &#123;renderRecords&#125; &lt;/div&gt; ) &#125; /** * æ”¶å…¥è®¡ç®— * */ credits() &#123; let credits = this.state.records.filter((record) =&gt; &#123; return record.account &gt;= 0; &#125;) return credits.reduce((prev, curr) =&gt; &#123; return prev + Number.parseInt(curr.account, 0) &#125;, 0) &#125; /** * æ”¯å‡ºè®¡ç®— * */ debits() &#123; let credits = this.state.records.filter((record) =&gt; &#123; return record.account &lt; 0; &#125;) return credits.reduce((prev, curr) =&gt; &#123; return prev + Number.parseInt(curr.account, 0) &#125;, 0) &#125; /** * ä½™é¢è®¡ç®— * */ balance() &#123; return this.credits() + this.debits(); &#125; /** * æ›´æ–°è´¦å• * */ updateRecord(record, data) &#123; const recordIndex = this.state.records.indexOf(record); const newRecords = this.state.records.map( (item, index) =&gt; &#123; if(index !== recordIndex) &#123; // This isn&#x27;t the item we care about - keep it as-is return item; &#125; // Otherwise, this is the one we want - return an updated value return &#123; ...item, ...data &#125;; &#125;); this.setState(&#123; records: newRecords &#125;); &#125; /** * åˆ é™¤è´¦å• * */ deleteRecord(record)&#123; // console.log(record) const recordIndex = this.state.records.indexOf(record); const newRecords = this.state.records.filter( (item, index) =&gt; index !== recordIndex); this.setState(&#123; records: newRecords &#125;); &#125; /** * æŠŠæœ€æ–°æ•°æ®èµ‹å€¼state * */ addRecord (record) &#123; console.log(record) this.setState(&#123; error:null, isLoader:false, //åŠ è½½æ ‡ç¤º records:[ ...this.state.records, record ] &#125;) &#125; //è¯·æ±‚æ•°æ® componentDidMount() &#123; var that = this axios.get(&#x27;http://5b3450a9d167760014c265b5.mockapi.io/accounts/v1/accounts&#x27;) .then(response =&gt; that.setState(&#123; isLoader:false, records:response.data &#125;) ) .catch(err =&gt; that.setState(&#123; error:err.message, &#125;) ) &#125;&#125; Record.js 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124import React, &#123; Component &#125; from &#x27;react&#x27;;import moment from &quot;moment&quot;; //æ—¥æœŸæ ¼å¼import axios from &#x27;axios&#x27;export default class Record extends Component &#123; // æ„é€  constructor(props) &#123; super(props); // åˆå§‹çŠ¶æ€ this.state = &#123; edit:false //ç¼–è¾‘æŒ‰é’®çŠ¶æ€ &#125;; &#125; render() &#123; //å¦‚æœç¼–è¾‘çŠ¶æ€ä¸ºtrue,æ˜¾ç¤ºç¼–è¾‘çŠ¶æ€,å¦åˆ™æ˜¾ç¤ºé»˜è®¤çŠ¶æ€ if(this.state.edit)&#123; return this.renderEditRow() &#125;else &#123; return this.renderRow() &#125; &#125; renderEditRow () &#123; var date = this.props.record.date var newDate = moment(date).format(&#x27;YYYY-MM-DD&#x27;); return ( &lt;tr&gt; &lt;td&gt;&lt;input type=&quot;text&quot; className=&quot;form-cantrol&quot; defaultValue=&#123;newDate&#125; ref=&quot;date&quot; /&gt;&lt;/td&gt; &lt;td&gt;&lt;input type=&quot;text&quot; className=&quot;form-cantrol&quot; defaultValue=&#123;this.props.record.title&#125; ref=&quot;title&quot; /&gt;&lt;/td&gt; &lt;td&gt;&lt;input type=&quot;text&quot; className=&quot;form-cantrol&quot; defaultValue=&#123;this.props.record.account&#125; ref=&quot;account&quot; /&gt;&lt;/td&gt; &lt;td&gt; &lt;button className=&quot;btn btn-info mr-1&quot; onClick=&#123;this.handleUpdate.bind(this)&#125;&gt;æ›´æ–°&lt;/button&gt; &lt;button className=&quot;btn btn-danger &quot; onClick=&#123;this.handleToggle.bind(this)&#125;&gt;å–æ¶ˆ&lt;/button&gt; &lt;/td&gt; &lt;/tr&gt; ); &#125; renderRow () &#123; var date = this.props.record.date var newDate = moment(date).format(&#x27;YYYY-MM-DD&#x27;); return ( &lt;tr&gt; &lt;td&gt;&#123;newDate&#125;&lt;/td&gt; &lt;td&gt;&#123;this.props.record.title&#125;&lt;/td&gt; &lt;td&gt;&#123;this.props.record.account&#125;&lt;/td&gt; &lt;td&gt; &lt;button className=&quot;btn btn-info mr-1&quot; onClick=&#123;this.handleToggle.bind(this)&#125;&gt;ç¼–è¾‘&lt;/button&gt; &lt;button className=&quot;btn btn-danger&quot; onClick=&#123;this.handleDelete.bind(this)&#125;&gt;åˆ é™¤&lt;/button&gt; &lt;/td&gt; &lt;/tr&gt; ); &#125; /** * ç¼–è¾‘æŒ‰é’®ç‚¹å‡»äº‹ä»¶ * å¯¹state editåšå–åæ“ä½œ * */ handleToggle () &#123; this.setState(&#123; edit:!this.state.edit &#125;) &#125; /** * åˆ é™¤ æŒ‰é’®ç‚¹å‡»äº‹ä»¶ * */ handleDelete (event) &#123; event.preventDefault() var that = this // alert(that.props.record.id) axios.delete(&#x27;http://5b3450a9d167760014c265b5.mockapi.io/accounts/v1/accounts/&#x27; + that.props.record.id) .then(response =&gt;&#123; console.log(response) this.props.deleteData(that.props.record) &#125;) .catch(err =&gt;&#123; &#125;) &#125; /** * æ›´æ–°è®°å½•äº‹ä»¶ * */ handleUpdate (event) &#123; event.preventDefault() // æ–¹æ³•é˜»æ­¢å…ƒç´ å‘ç”Ÿé»˜è®¤çš„è¡Œä¸º const record =&#123; date:this.refs.date.value, title:this.refs.title.value, account:this.refs.account.value &#125; var that = this // alert(that.props.record.id) axios.put(&#x27;http://5b3450a9d167760014c265b5.mockapi.io/accounts/v1/accounts/&#x27; + that.props.record.id,&#123; date:record.date, title:record.title, account:record.account &#125;) .then(response =&gt;&#123; this.props.updateData(this.props.record,response.data) this.setState(&#123; edit:false &#125;) &#125;) .catch(err =&gt; that.setState(&#123; error:err.message, &#125;) ) &#125;&#125; Box.js 12345678910111213141516171819202122/** * ä¸Šéƒ¨çš„æ€»æ¶ˆè´¹è®°å½• * */import React from &#x27;react&#x27;;const Box = (&#123; text, type, amount &#125;) =&gt; &#123; return ( &lt;div className=&quot;col&quot;&gt; &lt;div className=&quot;card&quot;&gt; &lt;div className=&#123;`card-header bg-$&#123;type&#125; text-white`&#125;&gt; &#123;text&#125; &lt;/div&gt; &lt;div className=&quot;card-body&quot;&gt; &#123;amount&#125; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; );&#125;export default Box RecordForm.js 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081import React, &#123; Component &#125; from &#x27;react&#x27;;import axios from &#x27;axios&#x27;export default class RecordForm extends Component &#123; // æ„é€  constructor(props) &#123; super(props); // åˆå§‹çŠ¶æ€ this.state = &#123; date:&quot;&quot;, title:&quot;&quot;, account:&quot;&quot; &#125;; &#125; /** * åˆ¤æ–­æŒ‰é’®æ˜¯å¦å¯ç”¨ * */ valid()&#123; return this.state.date &amp;&amp; this.state.title &amp;&amp; this.state.account; &#125; /** * è¾“å…¥æ”¹å˜è§¦å‘ * */ handleChange (event)&#123; let name,obj; name = event.target.name; this.setState(( obj = &#123;&#125;, obj[&quot;&quot; + name] = event.target.value, obj )) &#125; /** * æäº¤æŒ‰é’®è§¦å‘ * */ handleSubmit (event)&#123; event.preventDefault() var that = this axios.post(&#x27;http://5b3450a9d167760014c265b5.mockapi.io/accounts/v1/accounts&#x27;,&#123; date:that.state.date, title:that.state.title, account:that.state.account &#125;) .then(response =&gt;&#123; console.log(response); this.props.handleNewRecord(response.data) that.setState(&#123; date:&quot;&quot;, title:&quot;&quot;, account:&quot;&quot; &#125;) &#125;) .catch(err =&gt; that.setState(&#123; error:err.message, &#125;) ) &#125; render() &#123; return ( &lt;form className=&quot;form-inline mb-2&quot; onSubmit=&#123;this.handleSubmit.bind(this)&#125; &gt; &lt;div className=&quot;form-group mr-1&quot;&gt; &lt;input type=&quot;text&quot; onChange=&#123;this.handleChange.bind(this)&#125; value=&#123;this.state.date&#125; className=&quot;form-control&quot; placeholder=&quot;æ—¶é—´&quot; name=&quot;date&quot; /&gt; &lt;/div&gt; &lt;div className=&quot;form-group mr-1&quot;&gt; &lt;input type=&quot;text&quot; onChange=&#123;this.handleChange.bind(this)&#125; value=&#123;this.state.title&#125; className=&quot;form-control&quot; placeholder=&quot;æ ‡é¢˜&quot; name=&quot;title&quot; /&gt; &lt;/div&gt; &lt;div className=&quot;form-group mr-1&quot;&gt; &lt;input type=&quot;text&quot; onChange=&#123;this.handleChange.bind(this)&#125; value=&#123;this.state.account&#125; className=&quot;form-control&quot; placeholder=&quot;è´¦ç›®&quot; name=&quot;account&quot; /&gt; &lt;/div&gt; &lt;button type=&quot;submit&quot; className=&quot;btn btn-primary&quot; disabled=&#123;!this.valid()&#125; &gt;åˆ›å»º&lt;/button&gt; &lt;/form&gt; ); &#125;&#125; ok,ä¸‹é¢æ˜¯æºç :æºç åœ°å€å­¦ä¹ å‰ç«¯","categories":[{"name":"å‰ç«¯å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"å‰ç«¯å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"react-nativeä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /react-nativeä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡","date":"2018-06-25T16:00:00.000Z","updated":"2019-11-30T01:39:28.040Z","comments":true,"path":"2018/06/26/ç§»åŠ¨ç«¯å­¦ä¹ /react-nativeä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡/","link":"","permalink":"https://zhoushaoting.com/2018/06/26/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/react-native%E4%B8%83%E7%89%9B%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87/","excerpt":"ä»Šå¤©è¯•ä¸€ä¸‹React Native ä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡.å‘ä¹Ÿå°±éšä¹‹å¼€å§‹äº†.ä»¥demoä¸ºä¾‹.react-native:â€0.55.4â€,react-native-qiniu:â€™â€™0.3.0â€","text":"ä»Šå¤©è¯•ä¸€ä¸‹React Native ä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡.å‘ä¹Ÿå°±éšä¹‹å¼€å§‹äº†.ä»¥demoä¸ºä¾‹.react-native:â€0.55.4â€,react-native-qiniu:â€™â€™0.3.0â€ é¦–å…ˆæœ€å¤§çš„å‘å°±æ˜¯ä¸ƒç‰›å®˜æ–¹çš„è¿™ä¸ªåº“:react-native-qiniu,å¥½åƒæ˜¯è¯¥åº“çš„åˆ›å§‹äººç¦»èŒäº†,å¯¼è‡´äº†è¯¥åº“å·²ç»è’åºŸ,æ— äººæ›´æ–°ç»´æŠ¤.å¦‚æœä½ åªæ˜¯å•çº¯æŒ‰ç…§githubçš„è¯´æ˜å¯¼å…¥è¯¥åº“å°±ä½¿ç”¨çš„è¯,æ— è®ºä½ ä»¥ä»€ä¹ˆå§¿åŠ¿æ’¸.ç»“æœéƒ½æ˜¯Rpc.uploadFileçš„catchè¾“å‡ºé”™è¯¯,é”™è¯¯ä¿¡æ¯ä¸ºnullâ€¦â€¦â€¦..è¿™ä¸ªé”™è¯¯ä¿¡æ¯çœŸè®©æˆ‘å¤´å¤§.å¯å–œæœ‰äººåœ¨ç½‘ä¸Šåšå‡ºäº†æ›´æ–°,æ›´æ–°ä»£ç (éœ€è¦ä¿®æ”¹åº“ä¸­çš„ä¸¤ä¸ªæºæ–‡ä»¶../react-native-qiniu/core)å¦‚ä¸‹:rpc.js 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164import conf from &#x27;./conf.js&#x27;;import Auth from &#x27;./auth&#x27;;//å‘é€ç®¡ç†å’Œfopå‘½ä»¤,æ€»ä¹‹å°±æ˜¯ä¸ä¸Šä¼ æ–‡ä»¶function post(uri, adminToken, content) &#123; var headers = &#123; &#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;, &#125;; let payload = &#123; headers: headers, method: &#x27;POST&#x27;, dataType: &#x27;json&#x27;, timeout: conf.RPC_TIMEOUT, &#125;; if (typeof content === &#x27;undefined&#x27;) &#123; payload.headers[&#x27;Content-Length&#x27;] = 0; &#125; else &#123; //carry data payload.body = content; &#125; if (adminToken) &#123; headers[&#x27;Authorization&#x27;] = adminToken; &#125; return fetch(uri, payload);&#125;/*** ç›´ä¼ æ–‡ä»¶* formInputå¯¹è±¡å¦‚ä½•é…ç½®è¯·å‚è€ƒä¸ƒç‰›å®˜æ–¹æ–‡æ¡£â€œç›´ä¼ æ–‡ä»¶â€ä¸€èŠ‚*/function uploadFile(dataParams, policy, callbackUpDate = function () &#123; &#125;, callBackMethod = function () &#123; &#125;) &#123; let params = getParams(dataParams, policy); let uri = params.uri; let data = params.data; let oloaded = null; let responseObj = &#123;&#125;; return new Promise((resolve, reject) =&gt; &#123; if (typeof uri != &#x27;string&#x27; || uri == &#x27;&#x27; || typeof data.key == &#x27;undefined&#x27;) &#123; reject &amp;&amp; reject(null); return; &#125; if (uri[0] == &#x27;/&#x27;) &#123; uri = &quot;file://&quot; + uri; &#125; //åˆ›å»ºxhrå¹¶open var xhr = new XMLHttpRequest(); xhr.onreadystatechange = function () &#123; responseObj.readyState = xhr.readyState; //çŠ¶æ€0-4 responseObj.data = xhr.response;//è¿”å›å€¼ responseObj.textData = xhr.responseText; //è¿”å›å€¼Text responseObj.status = xhr.status; //çŠ¶æ€ç  // responseObj.message = &quot;&quot; switch (xhr.readyState) &#123; case 0: callBackMethod(responseObj) break; case 1: callBackMethod(responseObj) break; case 2: callBackMethod(responseObj) break; case 3: callBackMethod(responseObj) break; case 4: if ((xhr.status &gt;= 200 &amp;&amp; xhr.status &lt; 300) || xhr.status == 304) &#123; if (xhr.status == 200) &#123; callBackMethod(responseObj) &#125; &#125; else &#123; callBackMethod(responseObj) &#125; break; &#125; &#125;; xhr.open(&#x27;POST&#x27;, conf.UP_HOST); xhr.onload = () =&gt; &#123; if (xhr.status !== 200) &#123; reject &amp;&amp; reject(responseObj); return; &#125; resolve &amp;&amp; resolve(JSON.parse(responseObj.data)); &#125;; xhr.onerror = (evt) =&gt; &#123; reject &amp;&amp; reject(evt); return; &#125;; //è¯·æ±‚å¤±è´¥ xhr.upload.onloadstart = () =&gt; &#123;//ä¸Šä¼ å¼€å§‹æ‰§è¡Œæ–¹æ³• oloaded = 0;//è®¾ç½®ä¸Šä¼ å¼€å§‹æ—¶ï¼Œä»¥ä¸Šä¼ çš„æ–‡ä»¶å¤§å°ä¸º0 console(&quot;ä¸Šä¼ å¼€å§‹&quot;) &#125;; xhr.upload.onprogress = (evt) =&gt; &#123; oloaded = evt.loaded;//é‡æ–°èµ‹å€¼å·²ä¸Šä¼ æ–‡ä»¶å¤§å°ï¼Œç”¨ä»¥ä¸‹æ¬¡è®¡ç®— callbackUpDate(Math.round(oloaded / evt.total * 100), oloaded, evt.total) &#125;; xhr.upload.onloadend = (evt) =&gt; &#123; console(&quot;ä¸Šä¼ ç»“æŸ&quot;) &#125;; let formdata = creatFormData(params); xhr.send(formdata); &#125;);&#125;//æ„é€ ä¸Šä¼ å‚æ•°function getParams(data, policy) &#123; let putPolicy = new Auth.Policy( policy ); let uptoken = putPolicy.token(); data.token = uptoken; let params = &#123;&#125;; params.uri = data.uri; delete data.uri; params.data = data; return params;&#125;/*** åˆ›å»ºä¸€ä¸ªè¡¨å•å¯¹è±¡,ç”¨äºä¸Šä¼ å‚æ•°* @param &#123;*&#125; params*/function creatFormData(params) &#123; let formdata = new FormData(); let uri = params.uri; let formInput = creatFormInput(uri); let data = params.data; console.log(data) for (let key of Object.keys(data)) &#123; let value = data[key]; if (key.charAt(0) === &quot;_&quot;) &#123; formdata.append(&quot;x:&quot; + key.substring(1, key.length), value); &#125; else &#123; formdata.append(key, value); &#125; &#125; formdata.append(&quot;file&quot;, &#123; uri: uri, type: formInput.type, name: formInput.name &#125;); console.log(formdata) return formdata;&#125;/*** æ„é€ è¡¨å•å¯¹è±¡ä¸­fileå¯¹è±¡* @param &#123;*&#125; params*/function creatFormInput(uri) &#123; let formInput = &#123;&#125;; if (typeof formInput.type == &#x27;undefined&#x27;) formInput.type = &#x27;application/octet-stream&#x27;; if (typeof formInput.name == &#x27;undefined&#x27;) &#123; var filePath = uri.split(&quot;/&quot;); if (filePath.length &gt; 0) formInput.name = filePath[filePath.length - 1]; else formInput.name = &quot;&quot;; &#125; return formInput;&#125;export default &#123; uploadFile, post &#125; auth.js 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154import base64 from &#x27;base-64&#x27;;import CryptoJS from &quot;crypto-js&quot;;import conf from &quot;./conf.js&quot;;import parse from &#x27;url-parse&#x27;;function urlsafeBase64Encode(jsonFlags) &#123; var encoded = base64.encode(jsonFlags); return base64ToUrlSafe(encoded);&#125;;function base64ToUrlSafe(v) &#123; return v.replace(/\\//g, &#x27;_&#x27;).replace(/\\+/g, &#x27;-&#x27;);&#125;;function hmacSha1(encodedFlags, secretKey) &#123; var encoded = CryptoJS.HmacSHA1(encodedFlags, secretKey).toString(CryptoJS.enc.Base64); return encoded;&#125;;function generateAccessToken(url, body) &#123; var u = parse(url, true); var path = u.pathname; var access = path + &#x27;\\n&#x27;; if (body) &#123; access += body; &#125; var digest = hmacSha1(access, conf.SECRET_KEY); var safeDigest = base64ToUrlSafe(digest); let token = &#x27;QBox &#x27; + conf.ACCESS_KEY + &#x27;:&#x27; + safeDigest; //console.log(token); return token;&#125;;class Policy &#123; constructor(policy) &#123; if (typeof (policy) == &quot;undefined&quot;) &#123; &#125; else &#123; this.policy = policy; if (typeof (policy.deadline) == &quot;undefined&quot; || policy.deadline == null) &#123; this.policy.deadline = 3600 + Math.floor(Date.now() / 1000); &#125; &#125; &#125; _parse2Str(putPolicy) &#123; let str = &quot;&#123;&quot;; let keys = Object.keys(putPolicy); keys.forEach((key, i) =&gt; &#123; let value = putPolicy[key]; if (typeof (value) == &quot;object&quot;) &#123; str = `$&#123;str&#125;&quot;$&#123;key&#125;&quot;:` str = `$&#123;str&#125;&quot;&#123;` Object.keys(value).forEach((key2) =&gt; &#123; let value2 = value[key2]; let re = /(\\$\\(.*?\\))/g; if (re.test(value2)) &#123; str = `$&#123;str&#125;\\\\\\&quot;$&#123;key2&#125;\\\\\\&quot;:$&#123;value2&#125;,` &#125; else &#123; str = `$&#123;str&#125;\\\\\\&quot;$&#123;key2&#125;\\\\\\&quot;:&quot;$&#123;value2&#125;&quot;,` &#125; &#125;) console.log(keys.length + &quot;::&quot; + i) if (i &gt;= keys.length) &#123; str = `$&#123;str.substring(0, str.length - 1)&#125;&#125;&quot;` &#125; else &#123; str = `$&#123;str.substring(0, str.length - 1)&#125;&#125;&quot;,` &#125; &#125; else if (typeof (value) == &quot;number&quot;) &#123; str = `$&#123;str&#125;&quot;$&#123;key&#125;&quot;:$&#123;value&#125;,` &#125; else if (typeof (value) == &quot;string&quot;) &#123; str = `$&#123;str&#125;&quot;$&#123;key&#125;&quot;:&quot;$&#123;value&#125;&quot;,` &#125; else &#123; str = `$&#123;str&#125;&quot;$&#123;key&#125;&quot;:&quot;$&#123;value&#125;&quot;,` &#125; &#125;) str = `$&#123;str.substring(0, str.length - 1)&#125;&#125;`; return str; &#125; // _creatStr = (policy) =&gt; &#123; // policy[&#x27;deadline&#x27;] = this.expires + Math.floor(Date.now() / 1000); // let policyStr = JSON.stringify(policy); // let re = /(\\&quot;\\$\\(.*?\\)\\&quot;)/g; // let newStr = policyStr.replace(re, (value) =&gt; &#123; // return value.substring(1, value.length - 1); // &#125;) // return newStr; // &#125; token = () =&gt; &#123; policStr = this._parse2Str(this.policy); console.log(&quot;policStr&quot;, policStr); var encodedPutPolicy = this._urlsafeBase64Encode(policStr); console.log(&quot;encodedPutPolicy&quot;, encodedPutPolicy); var sign = this._hmacSha1(encodedPutPolicy, conf.SECRET_KEY); var encodedSign = this._base64ToUrlSafe(sign); console.log(&quot;encodedSign&quot;, encodedSign); var uploadToken = conf.ACCESS_KEY + &#x27;:&#x27; + encodedSign + &#x27;:&#x27; + encodedPutPolicy; console.log(&quot;uploadToken&quot;, uploadToken); return uploadToken; &#125; _urlsafeBase64Encode = (jsonFlags) =&gt; &#123; var encoded = base64.encode(jsonFlags); return base64ToUrlSafe(encoded); &#125;; _base64ToUrlSafe = (v) =&gt; &#123; return v.replace(/\\//g, &#x27;_&#x27;).replace(/\\+/g, &#x27;-&#x27;); &#125;; _hmacSha1 = (encodedFlags, secretKey) =&gt; &#123; var encoded = CryptoJS.HmacSHA1(encodedFlags, secretKey).toString(CryptoJS.enc.Base64); return encoded; &#125;;&#125;class GetPolicy &#123; constructor(expires) &#123; this.expires = expires || 3600; &#125; makeRequest(baseUrl) &#123; var deadline = this.expires + Math.floor(Date.now() / 1000); if (baseUrl.indexOf(&#x27;?&#x27;) &gt;= 0) &#123; baseUrl += &#x27;&amp;e=&#x27;; &#125; else &#123; baseUrl += &#x27;?e=&#x27;; &#125; baseUrl += deadline; var signature = hmacSha1(baseUrl, conf.SECRET_KEY); var encodedSign = base64ToUrlSafe(signature); var downloadToken = conf.ACCESS_KEY + &#x27;:&#x27; + encodedSign; return baseUrl + &#x27;&amp;token=&#x27; + downloadToken; &#125;&#125;export default &#123; urlsafeBase64Encode, generateAccessToken, Policy, GetPolicy &#125; ok,æ”¹å®Œä¹‹å,ä½ å°±å¯ä»¥æ„‰å¿«çš„æ’¸è‡ªå·±çš„ä¸šåŠ¡ä»£ç äº†.è‡³äºä¸šåŠ¡ä»£ç æˆ‘å°±ç®€å•å†™ä¸ªä¾‹å­:å…¶ä¸­,Conf.ACCESS_KEYå’ŒConf.SECRET_KEYä»ä¸ƒç‰›è´¦å·é‡Œé¢è·å–,Conf.UP_HOST ä»https://developer.qiniu.com/kodo/manual/1671/region-endpoint é‡Œé¢è·å–,å…¶ä¸­,scopeå°±æ˜¯ä¸ƒç‰›é‡Œé¢ä½ è‡ªå·±å»ºç«‹çš„å­˜å‚¨ç©ºé—´å 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108/*** Sample React Native App* https://github.com/facebook/react-native* @flow*/import React, &#123; Component &#125; from &#x27;react&#x27;;import &#123; Platform, StyleSheet, Text, View, Image&#125; from &#x27;react-native&#x27;;import Qiniu, &#123; Auth, ImgOps, Conf, Rs, Rpc &#125; from &#x27;react-native-qiniu&#x27;;//å¯¹äºä¸ƒç‰›ä¿®æ”¹æ–‡ä»¶å‚è€ƒ: https://blog.csdn.net/qq_33935895/article/details/78775819Conf.ACCESS_KEY = &quot;ä»ä¸ƒç‰›è´¦å·é‡Œé¢è·å–&quot;;Conf.SECRET_KEY = &quot;ä»ä¸ƒç‰›è´¦å·é‡Œé¢è·å–&quot;;Conf.UP_HOST = &#x27;ä»ä¸ƒç‰›è´¦å·é‡Œé¢è·å–&#x27;; // https://developer.qiniu.com/kodo/manual/1671/region-endpointtype Props = &#123;&#125;;export default class App extends Component&lt;Props&gt; &#123; // æ„é€  constructor(props) &#123; super(props); // åˆå§‹çŠ¶æ€ this.state = &#123; img: &#x27;å›¾ç‰‡url&#x27; &#125;; &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text style=&#123;styles.instructions&#125; onPress=&#123;() =&gt; this.upload()&#125;&gt; ä¸Šä¼ &lt;/Text&gt; &lt;Text&gt;&#123;this.state.img&#125;&lt;/Text&gt; &lt;Image source=&#123;&#123; uri: this.state.img &#125;&#125; style=&#123;&#123; width: 200, height: 400 &#125;&#125; /&gt; &lt;/View&gt; ); &#125; /** * å…ˆä¸Šä¼ ä¸ƒç‰› è·å–url * */ upload = () =&gt; &#123; var img = &#x27;/Users/shaotingzhou/Desktop/qiniuDemo/uploadImg.jpg&#x27; //å›¾ç‰‡è·¯å¾„ å¦‚æœæ˜¯ä»ç›¸å†Œè·å–å›¾ç‰‡çš„è¯,å…¶ç›¸å†Œä¼šè¿”å› var myDate = new Date(); const key = myDate.getTime() + &#x27;.jpg&#x27;; //ä¸Šä¼ æˆåŠŸåè¯¥keyå°±æ˜¯å›¾ç‰‡çš„urlè·¯å¾„ //ä¸Šä¼ å‚æ•° let params = &#123; uri: img,//å›¾ç‰‡è·¯å¾„ å¯ä»¥é€šè¿‡ç¬¬ä¸‰æ–¹å·¥å…· å¦‚:ImageCropPickerç­‰è·å–æœ¬åœ°å›¾ç‰‡è·¯å¾„ key: key,//è¦ä¸Šä¼ çš„key &#125; //æ„å»ºä¸Šä¼ ç­–ç•¥ let policy = &#123; scope: &quot;demo&quot;,//è®°å¾—è¿™é‡Œå¦‚æœæ ¼å¼ä¸º&lt;bucket&gt;:&lt;key&gt;å½¢å¼çš„è¯,keyè¦ä¸paramsé‡Œçš„keyä¿æŒä¸€è‡´,è¯¦è§ä¸ƒç‰›ä¸Šä¼ ç­–ç•¥ returnBody://returnBody è¯¦è§ä¸Šä¼ ç­–ç•¥ &#123; name: &quot;$(fname)&quot;,//è·å–æ–‡ä»¶å size: &quot;$(fsize)&quot;,//è·å–æ–‡ä»¶å¤§å° w: &quot;$(imageInfo.width)&quot;,//... h: &quot;$(imageInfo.height)&quot;,//... hash: &quot;$(etag)&quot;,//... &#125;, &#125; //è¿›è¡Œæ–‡ä»¶ä¸Šä¼  Rpc.uploadFile(params, policy).then((data) =&gt; &#123; console.log(&#x27;ä¸Šä¼ æˆåŠŸ&#x27;) var imgUrl = key //ä¸ƒç‰›ä¸Šçš„å›¾ç‰‡URL å°±æ˜¯ä¹‹å‰çš„key + ä½ å…¬å¸åŸŸå this.setState(&#123; img: &#x27;http://pax8cso07.bkt.clouddn.com/&#x27; + key &#125;) &#125;).catch((err) =&gt; &#123; console.log(err) &#125;); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &#x27;center&#x27;, alignItems: &#x27;center&#x27;, backgroundColor: &#x27;#F5FCFF&#x27;, &#125;, welcome: &#123; fontSize: 20, textAlign: &#x27;center&#x27;, margin: 10, &#125;, instructions: &#123; textAlign: &#x27;center&#x27;, color: &#x27;#333333&#x27;, marginBottom: 5, &#125;,&#125;); ok.ä¸‹é¢æ˜¯ä¸ƒç‰›é‡Œé¢çš„keyå¯¹åº”å›¾,ä¿®æ”¹åçš„è¾“å‡ºå›¾,æœ€åçš„ä¾‹å­å±•ç¤ºå›¾:ä¸‹é¢æ˜¯æºç .å…¶ä¸­ä¸ƒç‰›çš„ä¿®æ”¹æ–‡ä»¶åœ¨0.3.0ä¸­.æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"react-navigationå‰ç½®ç™»å½•","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /react-navigationå‰ç½®ç™»å½•","date":"2018-06-15T16:00:00.000Z","updated":"2018-06-16T06:36:06.000Z","comments":true,"path":"2018/06/16/ç§»åŠ¨ç«¯å­¦ä¹ /react-navigationå‰ç½®ç™»å½•/","link":"","permalink":"https://zhoushaoting.com/2018/06/16/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/react-navigation%E5%89%8D%E7%BD%AE%E7%99%BB%E5%BD%95/","excerpt":"å¥½å¤šåº”ç”¨éƒ½éœ€è¦æ¶‰åŠåˆ°å‰ç½®ç™»å½•,ä»Šå¤©å°±æ¥å®æ“ä¸€ä¸‹.æ‰€ç”¨çš„åº“æœ‰react-natigationå¯¼èˆªåº“å’ŒmobxçŠ¶æ€ç®¡ç†åº“.","text":"å¥½å¤šåº”ç”¨éƒ½éœ€è¦æ¶‰åŠåˆ°å‰ç½®ç™»å½•,ä»Šå¤©å°±æ¥å®æ“ä¸€ä¸‹.æ‰€ç”¨çš„åº“æœ‰react-natigationå¯¼èˆªåº“å’ŒmobxçŠ¶æ€ç®¡ç†åº“. è¿™é‡Œè´´ä¸€ä¸‹å„åº“çš„ä½¿ç”¨ç‰ˆæœ¬: 123456789101112131415161718192021222324252627 &#123; &quot;name&quot;: &quot;lead_the_login&quot;, &quot;version&quot;: &quot;0.0.1&quot;, &quot;private&quot;: true, &quot;scripts&quot;: &#123; &quot;start&quot;: &quot;node node_modules/react-native/local-cli/cli.js start&quot;, &quot;test&quot;: &quot;jest&quot; &#125;, &quot;dependencies&quot;: &#123; &quot;mobx&quot;: &quot;^4.3.0&quot;, &quot;mobx-react&quot;: &quot;^5.1.2&quot;, &quot;react&quot;: &quot;16.3.1&quot;, &quot;react-native&quot;: &quot;0.55.4&quot;, &quot;react-navigation&quot;: &quot;1.5.3&quot; &#125;, &quot;devDependencies&quot;: &#123; &quot;babel-jest&quot;: &quot;23.0.1&quot;, &quot;babel-plugin-transform-decorators-legacy&quot;: &quot;^1.3.5&quot;, &quot;babel-preset-react-native&quot;: &quot;4.0.0&quot;, &quot;babel-preset-react-native-stage-0&quot;: &quot;^1.0.1&quot;, &quot;jest&quot;: &quot;23.1.0&quot;, &quot;react-test-renderer&quot;: &quot;16.3.1&quot; &#125;, &quot;jest&quot;: &#123; &quot;preset&quot;: &quot;react-native&quot; &#125;&#125; å‰ç½®ç™»å½•ä¸»è¦ä½¿ç”¨çš„æ˜¯react-navigationçš„tabbarçš„ç‚¹å‡»äº‹ä»¶. ä½¿ç”¨æ–¹æ³•å¯ä»¥çœ‹ react navigationå®˜æ–¹ç½‘ç«™ æˆ–è€… å…”ä½¬çš„ç®€ä¹¦,è‡³äºmboxå’Œreact-navigationçš„ä½¿ç”¨å¯ä»¥å‚è€ƒä¹‹å‰å†™çš„è¿™ç¯‡æ–‡ç« :Mobxå’Œreact-navigationçš„ä½¿ç”¨. è¿™é‡Œä¸åšç»†è¯´.ç›´æ¥ä¸Šä»£ç .ä¸‹é¢æ˜¯åŸºæœ¬ä»£ç ç»“æ„.å‡†å¤‡å·¥ä½œ,å…ˆæŠŠmobx+react-navigationæ­å»ºå®Œæ¯•ä¹‹å.æˆ‘ä»¬åœ¨ç‚¹å‡»æˆ‘çš„Tabæ—¶,å¯¹tabBarç‚¹å‡»äº‹ä»¶åšå¤„ç†å³å¯,åœ¨ç‚¹å‡»äº‹ä»¶é‡Œé¢å…ˆè·å–æˆ‘ä»¬å­˜åœ¨Storeä¸­çš„ç™»å½•çŠ¶æ€,æ ¹æ®çŠ¶æ€åšä¸åŒçš„äº‹æƒ…,è¿™é‡Œæˆ‘æœªå¤„ç†æœ¬åœ°æ•°æ®æŒä¹…åŒ–å·¥ä½œ,åªæ˜¯å•çº¯çš„å­˜åœ¨Mobxä¸­çš„storeä¸­,æ˜¯ä¸ºäº†æ–¹ä¾¿å…¶ä»–åœ°æ–¹ä½¿ç”¨.å®é™…å¼€å‘ä¸­,æˆ‘ä»¬è¿˜éœ€è¦å¯¹æ•°æ®è¿›è¡ŒæŒä¹…åŒ–æ“ä½œ.ä¸»è¦ä»£ç æœ‰: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &#x27;react&#x27;;import &#123; Platform, StyleSheet, Text, View&#125; from &#x27;react-native&#x27;;import &#123; observer, inject &#125; from &#x27;mobx-react&#x27;import &#123; action, autorun, computed &#125; from &#x27;mobx&#x27;import &#123; NavigationActions &#125; from &#x27;react-navigation&#x27;const resetAction = NavigationActions.reset(&#123; index: 0, actions: [ NavigationActions.navigate(&#123;routeName: &#x27;Tab&#x27;, params: &#123;&#125;&#125;) ]&#125;)@inject(&#x27;rootStore&#x27;)@observerexport default class TwoView extends Component&lt;Props&gt; &#123; static navigationOptions = (&#123; navigation &#125;) =&gt; (&#123; header:null, tabBarOnPress: (tab) =&gt; &#123; //è®©tabBarå¯ç‚¹å‡»,åšå‰ç½®ç™»å½• // navigation.state.params.navigatePress() tab.jumpToIndex(tab.scene.index) &#125;, &#125;); render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text&gt; ç™»å½•çŠ¶æ€:&#123;this.loginStatus ? &#x27;å·²ç»ç™»å½•&#x27; : &#x27;æœªç™»å½•&#x27;&#125; &lt;/Text&gt; &lt;Text onPress=&#123;()=&gt;this.loginOutAction()&#125;&gt; æ³¨é”€ &lt;/Text&gt; &lt;/View&gt; ); &#125; @computed get loginStatus() &#123; return this.props.rootStore.TwoStore.allDatas.loginStatus; &#125; componentDidMount() &#123; this.props.navigation.setParams(&#123; navigatePress: this.needLogin() &#125;) // ä½¿ç”¨è¿™ä¸ªæ¥è°ƒç”¨this &#125; /** * åˆ¤æ–­æ˜¯å¦éœ€è¦ç™»å½• * */ needLogin =() =&gt;&#123; //åˆ¤æ–­ç™»å½• console.log(&#x27;loginStatus&#x27;) console.log(this.loginStatus) if(this.loginStatus)&#123; //å·²ç»ç™»å½• return; &#125;else &#123; //æœªç™»å½• è·³è½¬è‡³ç™»å½•ç•Œé¢ this.props.navigation.navigate(&#x27;LoginView&#x27;,&#123;callback:()=&gt;this.getPersonalInfo()&#125;) &#125; &#125; /** * ç™»å½•æˆåŠŸçš„å›è°ƒæ–¹æ³• * */ getPersonalInfo =() =&gt;&#123; // è¯·æ±‚æ•°æ®èµ‹å€¼å³å¯ &#125; loginOutAction =() =&gt;&#123; //æ³¨é”€ç™»å½• æ¸…ç©ºæœ¬åœ°åŒ–æ•°æ® å’Œ é‡ç½®storeä¸­çš„loginStatus this.props.rootStore.TwoStore.allDatas.loginStatus = false this.props.navigation.dispatch(resetAction); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &#x27;center&#x27;, alignItems: &#x27;center&#x27;, backgroundColor: &#x27;#F5FCFF&#x27;, &#125;, welcome: &#123; fontSize: 20, textAlign: &#x27;center&#x27;, margin: 10, &#125;, instructions: &#123; textAlign: &#x27;center&#x27;, color: &#x27;#333333&#x27;, marginBottom: 5, &#125;,&#125;); å’Œç™»å½•ä¹‹åä¿®æ”¹storeä¸­çŠ¶æ€ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &#x27;react&#x27;;import &#123; Platform, StyleSheet, Text, View&#125; from &#x27;react-native&#x27;;import &#123; observer, inject &#125; from &#x27;mobx-react&#x27;import &#123; action, autorun, computed &#125; from &#x27;mobx&#x27;@inject(&#x27;rootStore&#x27;)@observerexport default class LoginView extends Component&lt;Props&gt; &#123; static navigationOptions = (&#123; navigation &#125;) =&gt; (&#123; header:null, &#125;); render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text onPress=&#123;()=&gt;this.loginAction()&#125;&gt; ç™»å½• &lt;/Text&gt; &lt;/View&gt; ); &#125; /** * ç™»å½•/æ³¨é”€ å¯ä»¥åœ¨storeé‡Œé¢æ‰§è¡Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨è¿™é‡Œæ‰§è¡Œ,çœ‹ä½ ä¹ æƒ¯ * */ loginAction =() =&gt;&#123; //ç™»å½•è¯·æ±‚ //æˆåŠŸä¹‹å,ä¿®æ”¹loginStatus.æœ¬åœ°åŒ–æ•°æ®ç­‰ç­‰ this.props.rootStore.TwoStore.allDatas.loginStatus = true //è¿”å›ä¸Šä¸€ä¸ªç•Œé¢,å¹¶å›è°ƒåˆ·æ–° this.props.navigation.goBack() this.props.navigation.state.params.callback(); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &#x27;center&#x27;, alignItems: &#x27;center&#x27;, backgroundColor: &#x27;#F5FCFF&#x27;, &#125;, welcome: &#123; fontSize: 20, textAlign: &#x27;center&#x27;, margin: 10, &#125;, instructions: &#123; textAlign: &#x27;center&#x27;, color: &#x27;#333333&#x27;, marginBottom: 5, &#125;,&#125;); æ•ˆæœå¦‚å›¾:æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"Mobxä¸react-navigationçš„ç»“åˆä½¿ç”¨","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /Mobxä¸react-navigationçš„ä½¿ç”¨","date":"2018-05-26T16:00:00.000Z","updated":"2019-04-22T08:01:49.000Z","comments":true,"path":"2018/05/27/ç§»åŠ¨ç«¯å­¦ä¹ /Mobxä¸react-navigationçš„ä½¿ç”¨/","link":"","permalink":"https://zhoushaoting.com/2018/05/27/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/Mobx%E4%B8%8Ereact-navigation%E7%9A%84%E4%BD%BF%E7%94%A8/","excerpt":"ä»Šå¤©,å­¦ä¹ ä¸‹RNä¸­çš„å¦å¤–ä¸€ä¸ªå…¨å®¶æ¡¶å¥—é¤æ¶æ„:Mobx+React-Navigation,æœ¬æ–‡åŸºäºreact-native:0.55.4,Mbox:^4.3.0,react-navigation:^2.0.1æ‰€æ’¸.","text":"ä»Šå¤©,å­¦ä¹ ä¸‹RNä¸­çš„å¦å¤–ä¸€ä¸ªå…¨å®¶æ¡¶å¥—é¤æ¶æ„:Mobx+React-Navigation,æœ¬æ–‡åŸºäºreact-native:0.55.4,Mbox:^4.3.0,react-navigation:^2.0.1æ‰€æ’¸. Mboxä¸­æ–‡æ–‡æ¡£å¦å¤–ä¸€ä¸ªåŸºäºMboxå’Œreact-navigationçš„ä¸é”™é¡¹ç›® åºŸè¯ä¸å¤šç¼©,é¦–å…ˆ,æ–°å»ºä¸€ä¸ªé¡¹ç›®,æ·»åŠ ç›¸åº”åº“:npm i mobx mobx-react --save å¼•å…¥Mbox npm i babel-plugin-transform-decorators-legacy babel-preset-react-native-stage-0 --save-dev èƒ½å¤Ÿä½¿ç”¨@æ ‡ç­¾ npm i react-navigation --save å¼•å…¥å¯¼èˆªåº“ç„¶åä¿®æ”¹ä¸€ä¸‹å·¥ç¨‹é‡Œé¢çš„.babelrc: 12345&#123; &quot;presets&quot;: [&quot;react-native&quot;], &quot;plugins&quot;: [&quot;transform-decorators-legacy&quot;]&#125; OK,åŸºæœ¬çš„æ¶å­å·²ç»æ­å¥½.ç„¶åæ–°å»ºä¸€ä¸ªsrcç›®å½•.è¿™é‡Œå­˜æ”¾åŸºæœ¬ä»£ç å’ŒåŸºæœ¬å›¾ç‰‡ä¹‹ç±»çš„. ç„¶å,åœ¨å…¥å£æ–‡ä»¶App.jsä¸­,å…ˆæ­å»ºtabBarå’Œå¯¼èˆªæ¡.ä½¿ç”¨react-navigationè¿™é‡Œ,æˆ‘ä½¿ç”¨å…¨å±€æ³¨å†Œå¹¶æ³¨å…¥mobxï¼Œå…¶ä»–åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨store.import &#123;Provider&#125; from &#39;mobx-react&#39;;ç„¶ååœ¨src-&gt;Mobxè¿™é‡Œæ–°å»ºä¸€ä¸ªæ ¹storeçš„Store.jsæ–‡ä»¶.Store.js 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import &#123; observable, computed, action &#125; from &#x27;mobx&#x27;import oneInfo from &#x27;./OneInfo&#x27;import twoInfo from &#x27;./TwoInfo&#x27;/** * æ ¹store * OneInfo OneInfoæ•°æ® * TwoInfo TwoInfoæ•°æ®*/class RootStore &#123; constructor() &#123; this.OneInfo = new OneInfo(oneInfo,this) this.TwoInfo = new TwoInfo(twoInfo,this) &#125;&#125;// Oneclass OneInfo &#123; @observable allDatas = [] constructor(data,rootStore) &#123; this.allDatas = data this.rootStore = rootStore &#125; //åŠ  @action add(num) &#123; this.allDatas.oneNum = num + 1 this.rootStore.TwoInfo.allDatas.twoColor = &#x27;red&#x27; &#125; //å‡ @action sub(num) &#123; this.allDatas.oneNum = num - 1 this.rootStore.TwoInfo.allDatas.twoColor = &#x27;blue&#x27; &#125;&#125;// Twoclass TwoInfo &#123; @observable allDatas = &#123;&#125; constructor(data,rootStore) &#123; this.allDatas = data this.rootStore = rootStore &#125;&#125;export default new RootStore() å¦å¤–:OneInfo.js 12345678910const OneInfo = &#123; &quot;data&quot;: [ ], &quot;isOne&quot; : true, &quot;oneNum&quot; : 0&#125;export default OneInfo; TwoInfo.js 123456789const TwoInfo = &#123; &quot;data&quot;: [ ], &quot;isTwo&quot; : false, &quot;twoColor&quot;:&#x27;white&#x27;&#125;export default TwoInfo; ok,å›åˆ°App.jsä¸­: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106import React, &#123;Component&#125; from &#x27;react&#x27;;import &#123;Platform, StyleSheet, Text, View, Image&#125; from &#x27;react-native&#x27;;import &#123;StackNavigator, TabNavigator, TabBarBottom&#125; from &#x27;react-navigation&#x27;;// å…¨å±€æ³¨å†Œå¹¶æ³¨å…¥mobxï¼Œå…¶ä»–åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨storeimport &#123;Provider&#125; from &#x27;mobx-react&#x27;;// è·å–storeå®ä¾‹import store from &#x27;./src/Mobx/Store&#x27;;import One from &#x27;./src/One/One&#x27;;import Two from &#x27;./src/Two/Two&#x27;;export default class TwoDetails extends Component&lt;Props&gt; &#123; render () &#123; return ( &lt;Provider rootStore=&#123;store&#125;&gt; &lt;Navigator onNavigationStateChange=&#123;(prevState, currentState) =&gt; &#123; // åªè¦åˆ‡æ¢tab,push,pop,è¿™é‡Œä¸€å®šèµ° console.log (prevState); console.log (currentState); &#125;&#125; /&gt; &lt;/Provider&gt; ); &#125; componentDidMount = () =&gt; &#123; console.disableYellowBox = true; //å»é™¤é»„è‰²å¼¹æ¡†è­¦å‘Š &#125;;&#125;const Tab = TabNavigator ( &#123; One: &#123; screen: One, navigationOptions: (&#123;navigation&#125;) =&gt; (&#123; tabBarLabel: &#x27;ç”·å­©&#x27;, tabBarIcon: (&#123;focused, tintColor&#125;) =&gt; ( &lt;Image source=&#123; focused ? require (&#x27;./src/Image/boy_active.png&#x27;) : require (&#x27;./src/Image/boy.png&#x27;) &#125; style=&#123;&#123;width: 25, height: 25&#125;&#125; /&gt; ), &#125;), &#125;, Two: &#123; screen: Two, navigationOptions: (&#123;navigation&#125;) =&gt; (&#123; tabBarLabel: &#x27;å¥³å­©&#x27;, tabBarIcon: (&#123;focused, tintColor&#125;) =&gt; ( &lt;Image source=&#123; focused ? require (&#x27;./src/Image/girl_active.png&#x27;) : require (&#x27;./src/Image/girl.png&#x27;) &#125; style=&#123;&#123;width: 25, height: 25&#125;&#125; /&gt; ), &#125;), &#125;, &#125;, &#123; tabBarComponent: TabBarBottom, tabBarPosition: &#x27;bottom&#x27;, swipeEnabled: true, animationEnabled: true, lazy: true, tabBarOptions: &#123; activeTintColor: &#x27;#979797&#x27;, inactiveTintColor: &#x27;#979797&#x27;, style: &#123;backgroundColor: &#x27;#ffffff&#x27;&#125;, &#125;, &#125;);const Navigator = StackNavigator (&#123; Tab: &#123; screen: Tab, &#125;,&#125;);const styles = StyleSheet.create (&#123; container: &#123; flex: 1, justifyContent: &#x27;center&#x27;, alignItems: &#x27;center&#x27;, backgroundColor: &#x27;#F5FCFF&#x27;, &#125;, welcome: &#123; fontSize: 20, textAlign: &#x27;center&#x27;, margin: 10, &#125;, instructions: &#123; textAlign: &#x27;center&#x27;, color: &#x27;#333333&#x27;, marginBottom: 5, &#125;,&#125;); ç„¶åå°±æ˜¯åŸºæœ¬çš„UIç•Œé¢äº†:One.js 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &#x27;react&#x27;;import &#123; Platform, StyleSheet, Text, View&#125; from &#x27;react-native&#x27;;import &#123; observer, inject &#125; from &#x27;mobx-react&#x27;import &#123; action, autorun, computed &#125; from &#x27;mobx&#x27;@inject(&#x27;rootStore&#x27;)@observerexport default class One extends Component&lt;Props&gt; &#123; // æ„é€  constructor(props) &#123; super(props); // åˆå§‹çŠ¶æ€ this.state = &#123;&#125;; &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text onPress=&#123;()=&gt;this.add()&#125;&gt; + çº¢ &lt;/Text&gt; &lt;Text&gt; One &#123;this.dataSource&#125; &lt;/Text&gt; &lt;Text onPress=&#123;()=&gt;this.sub()&#125;&gt; - è“ &lt;/Text&gt; &lt;/View&gt; ); &#125; @computed get dataSource() &#123; return this.props.rootStore.OneInfo.allDatas.oneNum; &#125; /** * + * */ @action add() &#123; this.props.rootStore.OneInfo.add(this.dataSource) &#125; /** * - * */ @action sub() &#123; this.props.rootStore.OneInfo.sub(this.dataSource) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &#x27;center&#x27;, alignItems: &#x27;center&#x27;, backgroundColor: &#x27;#F5FCFF&#x27;, &#125;, welcome: &#123; fontSize: 20, textAlign: &#x27;center&#x27;, margin: 10, &#125;, instructions: &#123; textAlign: &#x27;center&#x27;, color: &#x27;#333333&#x27;, marginBottom: 5, &#125;,&#125;); Two.js 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &#x27;react&#x27;;import &#123; Platform, StyleSheet, Text, View&#125; from &#x27;react-native&#x27;;import &#123; observer, inject &#125; from &#x27;mobx-react&#x27;import &#123; action, autorun, computed &#125; from &#x27;mobx&#x27;@inject(&#x27;rootStore&#x27;)@observerexport default class Two extends Component&lt;Props&gt; &#123; render() &#123; return ( &lt;View style=&#123;[styles.container,&#123;backgroundColor:this.bgColor&#125;]&#125;&gt; &lt;Text&gt; TWO &lt;/Text&gt; &lt;/View&gt; ); &#125; @computed get bgColor() &#123; return this.props.rootStore.TwoInfo.allDatas.twoColor; &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &#x27;center&#x27;, alignItems: &#x27;center&#x27;, backgroundColor: &#x27;#F5FCFF&#x27;, &#125;, welcome: &#123; fontSize: 20, textAlign: &#x27;center&#x27;, margin: 10, &#125;, instructions: &#123; textAlign: &#x27;center&#x27;, color: &#x27;#333333&#x27;, marginBottom: 5, &#125;,&#125;); ok,ä»¥ä¸Šå°±æ˜¯Mbox+react-navigationçš„Demoçš„åŸºæœ¬ä»£ç äº†.æ•ˆæœå›¾: æºç  å¦å¤–:redux+react-navigationå¦å¤–:dva+react-navigation","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"å‰ç«¯ç²¾çµå›¾å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ /ç²¾çµå›¾å­¦ä¹ ","date":"2018-05-17T13:54:44.000Z","updated":"2018-05-17T13:54:44.000Z","comments":true,"path":"2018/05/17/å‰ç«¯å­¦ä¹ /ç²¾çµå›¾å­¦ä¹ /","link":"","permalink":"https://zhoushaoting.com/2018/05/17/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/%E7%B2%BE%E7%81%B5%E5%9B%BE%E5%AD%A6%E4%B9%A0/","excerpt":"ä»Šå¤©å­¦ä¹ ä¸‹å‰ç«¯ä¸­çš„ ç²¾çµå›¾.ä¸ºä½•å¼•å…¥ç²¾çµå›¾: ç½‘é¡µä¸Šé¢çš„æ¯å¼ å›¾ç‰‡éƒ½è¦ç»å†ä¸€æ¬¡è¯·æ±‚æ‰èƒ½å±•ç¤ºç»™ç”¨æˆ·ï¼Œå°çš„å›¾æ ‡é¢‘ç¹çš„è¯·æ±‚æœåŠ¡å™¨ï¼Œé™ä½é¡µé¢çš„åŠ è½½é€Ÿåº¦ï¼Œä¸ºäº†æœ‰æ•ˆåœ°å‡å°‘æœåŠ¡å™¨æ¥æ”¶å’Œå‘é€è¯·æ±‚çš„æ¬¡æ•°ï¼Œæé«˜é¡µé¢çš„åŠ è½½é€Ÿåº¦ï¼Œå› æ­¤ï¼Œäº§ç”Ÿäº†cssç²¾çµæŠ€æœ¯ã€‚","text":"ä»Šå¤©å­¦ä¹ ä¸‹å‰ç«¯ä¸­çš„ ç²¾çµå›¾.ä¸ºä½•å¼•å…¥ç²¾çµå›¾: ç½‘é¡µä¸Šé¢çš„æ¯å¼ å›¾ç‰‡éƒ½è¦ç»å†ä¸€æ¬¡è¯·æ±‚æ‰èƒ½å±•ç¤ºç»™ç”¨æˆ·ï¼Œå°çš„å›¾æ ‡é¢‘ç¹çš„è¯·æ±‚æœåŠ¡å™¨ï¼Œé™ä½é¡µé¢çš„åŠ è½½é€Ÿåº¦ï¼Œä¸ºäº†æœ‰æ•ˆåœ°å‡å°‘æœåŠ¡å™¨æ¥æ”¶å’Œå‘é€è¯·æ±‚çš„æ¬¡æ•°ï¼Œæé«˜é¡µé¢çš„åŠ è½½é€Ÿåº¦ï¼Œå› æ­¤ï¼Œäº§ç”Ÿäº†cssç²¾çµæŠ€æœ¯ã€‚ ä»¥æœ¬åœ°å›¾ç‰‡ä¸ºä¾‹:ç²¾çµå›¾ä½¿ç”¨å…¶å®å°±æ˜¯å¯¹background-position:x yå¯¹å›¾ç‰‡è¿›è¡Œåç§»æ˜¾ç¤ºè€Œå·².ä¸‹é¢æ˜¯ä»£ç : 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;html&gt; &lt;head&gt; &lt;style&gt; *&#123; margin:0; padding:0; &#125; .div0&#123; margin:10px; &#125; .demo1,.demo2,.demo3,.demo4,.demo5,.demo6&#123; display:inline-block; width:17px; height:17px; background-color:transparent; background-image:url(img/ç²¾çµå›¾.png); background-repeat:no-repeat; &#125; .demo1&#123; background-position:-38px -37px;&#125; .demo2&#123; background-position:-62px -37px;&#125; .demo3&#123; background-position:-86px -37px;&#125; .demo4&#123; background-position:-110px -37px;&#125; .demo5&#123; background-position:-134px -37px;&#125; .demo6&#123; background-position:-159px -37px;&#125; ul&#123; list-style:none; &#125; ul li &#123; margin:10px; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=&quot;div0&quot;&gt; &lt;ul&gt; &lt;li&gt;&lt;div class=&quot;demo1&quot;&gt;&lt;/div&gt; å›¾æ ‡1&lt;/li&gt; &lt;li&gt;&lt;div class=&quot;demo2&quot;&gt;&lt;/div&gt; å›¾æ ‡2&lt;/li&gt; &lt;li&gt;&lt;div class=&quot;demo3&quot;&gt;&lt;/div&gt; å›¾æ ‡3&lt;/li&gt; &lt;li&gt;&lt;div class=&quot;demo4&quot;&gt;&lt;/div&gt; å›¾æ ‡4&lt;/li&gt; &lt;li&gt;&lt;div class=&quot;demo5&quot;&gt;&lt;/div&gt; å›¾æ ‡5&lt;/li&gt; &lt;li&gt;&lt;div class=&quot;demo6&quot;&gt;&lt;/div&gt; å›¾æ ‡6&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/body&gt;&lt;/html&gt; æ•ˆæœå›¾: æºç ","categories":[{"name":"å‰ç«¯å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"å‰ç«¯å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"å‰ç«¯é©¬èµ›å…‹å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ /é©¬èµ›å…‹å­¦ä¹ ","date":"2018-05-17T13:45:31.000Z","updated":"2018-05-17T13:45:31.000Z","comments":true,"path":"2018/05/17/å‰ç«¯å­¦ä¹ /é©¬èµ›å…‹å­¦ä¹ /","link":"","permalink":"https://zhoushaoting.com/2018/05/17/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/%E9%A9%AC%E8%B5%9B%E5%85%8B%E5%AD%A6%E4%B9%A0/","excerpt":"ä¸Šå‘¨å»èœå¸‚åœºä¹°èœ,çœ‹åˆ°è·¯è¾¹ä¸€ä¸ªäºŒç»´ç ,äºæ˜¯æƒ³èµ·é˜¿é‡Œå·´å·´,æ¥ç€æƒ³èµ·ä¹‹å‰ä¸Šç­éƒ½ä¼šè·¯è¿‡é˜¿é‡Œå·´å·´,æ¥ç€æƒ³èµ·é©¬äº‘,ç„¶åæƒ³åˆ°é©¬èµ›å…‹!!!äºæ˜¯æˆ‘å›å®¶äº†,æƒ³å­¦ä¹ ä¸‹å‰ç«¯ä¸­çš„é©¬èµ›å…‹.","text":"ä¸Šå‘¨å»èœå¸‚åœºä¹°èœ,çœ‹åˆ°è·¯è¾¹ä¸€ä¸ªäºŒç»´ç ,äºæ˜¯æƒ³èµ·é˜¿é‡Œå·´å·´,æ¥ç€æƒ³èµ·ä¹‹å‰ä¸Šç­éƒ½ä¼šè·¯è¿‡é˜¿é‡Œå·´å·´,æ¥ç€æƒ³èµ·é©¬äº‘,ç„¶åæƒ³åˆ°é©¬èµ›å…‹!!!äºæ˜¯æˆ‘å›å®¶äº†,æƒ³å­¦ä¹ ä¸‹å‰ç«¯ä¸­çš„é©¬èµ›å…‹. å®Œæˆçš„åŠŸèƒ½ é€‰æ‹©å½“åœ°ä¸€å¼ å›¾ç‰‡ ç‚¹å‡»ç»˜åˆ¶é©¬èµ›å…‹ æ‹–åŠ¨ç»˜åˆ¶é©¬èµ›å…‹ ä¸ºäº†æ–¹ä¾¿,ç›¸å…³jsä»£ç ç›´æ¥å†™åœ¨äº†index.htmlä¸­,å¤§è‡´åˆ†ä¸ºåŠ è½½å›¾ç‰‡,æ·»åŠ ç›‘å¬,æ–¹æ³•è§¦å‘,ç»˜åˆ¶å°æ–¹å—(é©¬èµ›å…‹),è®¡ç®—é¢œè‰²,æ•°ç»„å‡ç»´è¿™å‡ ä¸ªæ–¹æ³•,UIéƒ¨åˆ†é€šè¿‡canvas æ ‡ç­¾å’Œinput æ ‡ç­¾ç»˜åˆ¶.ä¸‹é¢æ˜¯å®Œæ•´çš„index.htmlä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;&lt;/title&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;meta name=&quot;Keywords&quot; content=&quot;é©¬èµ›å…‹ canvas&quot;&gt; &lt;meta name=&quot;Description&quot; content=&quot;å­¦ä¹ å‰ç«¯é©¬èµ›å…‹&quot;&gt;&lt;/head&gt;&lt;style&gt; canvas &#123; border: 1px black solid; &#125;&lt;/style&gt;&lt;body&gt; &lt;div id=&quot;mask&quot;&gt; &lt;canvas width=&quot;600&quot; height=&quot;600&quot;&gt; &lt;/canvas&gt; &lt;input type=&quot;file&quot; class=&#x27;input&#x27;&gt; &lt;/div&gt; &lt;script&gt; var canvas = document.querySelector(&#x27;canvas&#x27;); var input = document.querySelector(&#x27;#mask .input&#x27;); var ctx = canvas.getContext(&#x27;2d&#x27;); var mousedown = false; var t = 15; input.onchange = function () &#123; loadimg(); &#125; /** *åŠ è½½å›¾ç‰‡ */ function loadimg() &#123; var img = new Image(); img.src = window.URL.createObjectURL(input.files[0]); img.onload = function () &#123; ctx.drawImage(img, 0, 0, 600, 600); &#125; register(); &#125; /** *æ·»åŠ ç›‘å¬ */ function register() &#123; canvas.addEventListener(&#x27;mousedown&#x27;, action) canvas.addEventListener(&#x27;mousemove&#x27;, action) canvas.addEventListener(&#x27;mouseup&#x27;, action) &#125; /** *æ–¹æ³•è§¦å‘ */ function action(e) &#123; var dx = parseInt(((e.offsetX - t / 2) / t) * t) var dy = parseInt(((e.offsetY - t / 2) / t) * t) if (e.type == &quot;mousedown&quot;) &#123; mousedown = true; computeColor(dx, dy); &#125; if (mousedown &amp;&amp; e.type == &quot;mousemove&quot;) &#123; computeColor(dx, dy); &#125; if (e.type == &quot;mouseup&quot;) &#123; mousedown = false; &#125; &#125; /* * ç”»å°æ–¹å— */ function rect(x, y, c) &#123; ctx.beginPath(); ctx.fillStyle = c; var dx = parseInt(x / t)*t,dy = parseInt(y / t)*t ctx.rect(dx, dy, t, t); ctx.fill(); &#125; /** è®¡ç®—é¢œè‰² */ function computeColor(x, y) &#123; var arrList = restore(ctx.getImageData(x,y,t,t).data,4); //ä¸€ç»´æ•°ç»„ var vr = 0, vg = 0, vb = 0,al = arrList.length; for(var i = 0; i &lt; al; i++)&#123; vr += arrList[i][0]; vg += arrList[i][1]; vb += arrList[i][2]; var color = &#x27;rgb(&#x27; + Math.floor(vr/al) + &#x27;,&#x27; + Math.floor(vg/al) + &#x27;,&#x27; + Math.floor(vb/al) + &#x27;)&#x27;; rect(x,y,color); &#125; &#125; /** *æ•°ç»„å‡ç»´ [1,2,3,4] =&gt; [[1,2],[3,4]] */ function restore(arr, step) &#123; var list = []; var index = 0; var n = Math.floor(arr.length/step); for(var i = 0; i &lt; n ;i++)&#123; list.push(arr.slice(index,index+step)); index += step; &#125; return list; &#125; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; æ•ˆæœå›¾: æ˜¯ä¸æ˜¯ç‰¹åˆ«æ£’,å†ä¹Ÿä¸ä¸ºå¥³æœ‹å‹ç…§ç‰‡çš„éšç§çŠ¯æ„äº†.ps:ç°åœ¨å°±å·®ä¸ªå¥³æœ‹å‹äº† æºç ","categories":[{"name":"å‰ç«¯å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"å‰ç«¯å­¦ä¹ ","slug":"å‰ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"åç«¯å­¦ä¹ ","slug":"åç«¯å­¦ä¹ /åç«¯å­¦ä¹ ","date":"2018-05-16T05:31:45.000Z","updated":"2018-05-16T05:31:45.000Z","comments":true,"path":"2018/05/16/åç«¯å­¦ä¹ /åç«¯å­¦ä¹ /","link":"","permalink":"https://zhoushaoting.com/2018/05/16/%E5%90%8E%E7%AB%AF%E5%AD%A6%E4%B9%A0/%E5%90%8E%E7%AB%AF%E5%AD%A6%E4%B9%A0/","excerpt":"åŠ ç´§æ–½å·¥ä¸­â€¦","text":"åŠ ç´§æ–½å·¥ä¸­â€¦","categories":[{"name":"åç«¯å­¦ä¹ ","slug":"åç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E5%90%8E%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"åç«¯å­¦ä¹ ","slug":"åç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E5%90%8E%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]},{"title":"react-navigationçš„åŸºæœ¬ä½¿ç”¨","slug":"ç§»åŠ¨ç«¯å­¦ä¹ /react-navigationçš„åŸºæœ¬ä½¿ç”¨","date":"2018-05-15T18:41:51.000Z","updated":"2018-05-15T18:41:51.000Z","comments":true,"path":"2018/05/16/ç§»åŠ¨ç«¯å­¦ä¹ /react-navigationçš„åŸºæœ¬ä½¿ç”¨/","link":"","permalink":"https://zhoushaoting.com/2018/05/16/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/react-navigation%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/","excerpt":"æœ¬æ–‡åŸºäºnpm 5.6.6 react-native-li 2.0.1 react-native 0.54.0 react-navigation ^1.4.0æ‰€å†™.","text":"æœ¬æ–‡åŸºäºnpm 5.6.6 react-native-li 2.0.1 react-native 0.54.0 react-navigation ^1.4.0æ‰€å†™. å®ç°çš„åŸºæœ¬åŠŸèƒ½ tabBar å¯¼èˆªæ  åœ¨staticä¸­ä½¿ç”¨this å›è°ƒ è·³å¤šçº§ç•Œé¢ é˜²æ­¢è¿ç»­ç‚¹å‡»å¤šæ¬¡è·³è½¬ç•Œé¢å¹¶ä¸”ä¸Šé¢è¿™äº›æ–¹æ³•å‡æœªä¿®æ”¹ä¸‰æ–¹åº“çš„æºç ,åŸå…ˆéœ€è¦ä¿®æ”¹æºç å®ç°:åŸç‰ˆå¯¹äºreact-navigationçš„ä½¿ç”¨çœ‹å®˜æ–¹æ–‡æ¡£å³å¯.é˜²æ­¢è¿ç»­ç‚¹å‡»å¤šæ¬¡è·³è½¬ç•Œé¢ é€šè¿‡stateåˆ¤æ–­:å…ˆå®šä¹‰ä¸ªstate waiting ä¸º false ,å†å®šä¹‰ç‚¹å‡»äº‹ä»¶çš„ disabled=&#123;this.state.waiting&#125; ,åœ¨å“åº”æ–¹æ³•é‡Œé¢å…ˆè¡Œä¿®æ”¹statewaiting ä¸º true,ç„¶åè·³è½¬ç•Œé¢,æœ€ååœ¨ä¸‹æ–¹å®šä¸€ä¸ªè®¡æ—¶å™¨,2ç§’åå†æ¬¡ä¿®æ”¹ state ä¸º false å³å¯.å®Œæ•´ä»£ç : 12345678910111213141516171819202122232425262728293031323334353637383940414243444546import React, &#123; Component &#125; from &#x27;react&#x27;;import &#123; Platform, StyleSheet, Text, View, Image, TouchableOpacity&#125; from &#x27;react-native&#x27;;type Props = &#123;&#125;;export default class OneDetails extends Component&lt;Props&gt; &#123; // æ„é€  constructor(props) &#123; super(props); // åˆå§‹çŠ¶æ€ this.state = &#123; waiting:false//é˜²æ­¢å¤šæ¬¡é‡å¤ç‚¹å‡» &#125;; &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;TouchableOpacity onPress=&#123;()=&gt;this.onclickBtn()&#125; disabled=&#123;this.state.waiting&#125;&gt; &lt;Text&gt;ç‚¹å‡»è·³è½¬&lt;/Text&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; ); &#125; onclickBtn =() =&gt;&#123; this.setState(&#123;waiting: true&#125;); this.props.navigation.navigate(&#x27;OneDetailsFlat&#x27;) setTimeout(()=&gt; &#123; this.setState(&#123;waiting: false&#125;) &#125;, 2000);//2ç§’åé‡ç½®stateä¸­çš„waitingçŠ¶æ€ &#125;&#125; ### åœ¨staticä¸­ä½¿ç”¨this å…ˆåœ¨`componentDidMount `é‡Œ 1234567//è®¾ç½®åœ¨staticä¸­ä½¿ç”¨this componentDidMount()&#123; this.props.navigation.setParams(&#123; navigatePress:this.navigatePress &#125;) &#125; ç„¶åå°±å¯ä»¥: 123456789static navigationOptions = (&#123; navigation, screenProps &#125;) =&gt; (&#123; title: &#x27;ListView&#x27;, headerStyle:&#123;backgroundColor:&#x27;red&#x27;&#125;, headerRight:( &lt;Text onPress=&#123;()=&gt;navigation.state.params.navigatePress()&#125;&gt; ç‚¹å‡» &lt;/Text&gt; ) &#125;); ä½¿ç”¨: 1234//å¯¼èˆªæ¡æŒ‰é’®ç‚¹å‡» navigatePress = () =&gt; &#123; alert(this.state.text) &#125; å›è°ƒ åœ¨A push åˆ° Bçš„æ—¶å€™å…ˆè¡Œå®šä¹‰ä¸ªæ–¹æ³•,ç„¶ååœ¨B pop å›Aè°ƒç”¨å³å¯.A -&gt; B 123456789101112//å¯¼èˆªæ¡æŒ‰é’®ç‚¹å‡»navigatePress = () =&gt; &#123; this.props.navigation.navigate(&#x27;OneDetailsFlatDetails&#x27;,&#123; // è·³è½¬çš„æ—¶å€™æºå¸¦ä¸€ä¸ªå‚æ•°å»ä¸‹ä¸ªé¡µé¢ callback: (data)=&gt;&#123; alert(data) &#125; &#125;);&#125; B -&gt; A 1234popTwo =() =&gt;&#123; this.props.navigation.state.params.callback(&#x27;å›è°ƒå‚æ•°&#x27;); this.props.navigation.goBack() &#125; å›åˆ°é¦–é¡µ this.props.navigation.popToTop()å›åˆ°ç›¸åº”é¡µ this.props.navigation.pop(2)æ•ˆæœå›¾: æºç ","categories":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç§»åŠ¨ç«¯å­¦ä¹ ","slug":"ç§»åŠ¨ç«¯å­¦ä¹ ","permalink":"https://zhoushaoting.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AD%A6%E4%B9%A0/"}]}]}